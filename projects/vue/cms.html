<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.51" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://github.com/xumingyu2018/projects/vue/cms.html"><meta property="og:site_name" content="Nevermore毓 的学习笔记"><meta property="og:title" content="后台管理项目"><meta property="og:type" content="article"><meta property="og:updated_time" content="2024-02-03T10:10:12.000Z"><meta property="og:locale" content="zh-CN"><meta property="article:tag" content="前端项目"><meta property="article:tag" content="Vue项目"><meta property="article:modified_time" content="2024-02-03T10:10:12.000Z"><link rel="icon" href="/favicon.svg"><title>后台管理项目 | Nevermore毓 的学习笔记</title><meta name="description" content="">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background-color: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="stylesheet" href="/assets/style.b2b1ec9b.css">
    <link rel="modulepreload" href="/assets/app.4445a247.js"><link rel="modulepreload" href="/assets/cms.html.3ef59725.js"><link rel="modulepreload" href="/assets/_plugin-vue_export-helper.cdc0426e.js"><link rel="modulepreload" href="/assets/cms.html.4e71f069.js"><link rel="prefetch" href="/assets/index.html.9dde4bd2.js"><link rel="prefetch" href="/assets/about.html.5a0f50be.js"><link rel="prefetch" href="/assets/Java-basic.html.0164d0b8.js"><link rel="prefetch" href="/assets/Java-collection.html.309cb236.js"><link rel="prefetch" href="/assets/Java-thread.html.cbc6a6e0.js"><link rel="prefetch" href="/assets/Java8-new-features.html.66204cc9.js"><link rel="prefetch" href="/assets/photoSql.html.7d37c784.js"><link rel="prefetch" href="/assets/mysql.html.a945b3c3.js"><link rel="prefetch" href="/assets/vite.html.5030f75a.js"><link rel="prefetch" href="/assets/webpack.html.5f12a7c6.js"><link rel="prefetch" href="/assets/OOP.html.395cce12.js"><link rel="prefetch" href="/assets/index.html.a8391e16.js"><link rel="prefetch" href="/assets/arrow-function.html.0138f0ab.js"><link rel="prefetch" href="/assets/async-await.html.9cafbd5f.js"><link rel="prefetch" href="/assets/closure.html.c64e056c.js"><link rel="prefetch" href="/assets/deepClone.html.89a81437.js"><link rel="prefetch" href="/assets/es6.html.3f714dc6.js"><link rel="prefetch" href="/assets/eventLoop.html.260b5440.js"><link rel="prefetch" href="/assets/executing-principle.html.86e74f70.js"><link rel="prefetch" href="/assets/executing-process.html.4459ddee.js"><link rel="prefetch" href="/assets/extend.html.af8d544d.js"><link rel="prefetch" href="/assets/functional-programming.html.717ff7df.js"><link rel="prefetch" href="/assets/intro.html.7565a10e.js"><link rel="prefetch" href="/assets/iterator-generator.html.b1c6950f.js"><link rel="prefetch" href="/assets/promise-implement.html.fceadaf6.js"><link rel="prefetch" href="/assets/promise.html.09ba9755.js"><link rel="prefetch" href="/assets/prototype.html.68ccaf7b.js"><link rel="prefetch" href="/assets/this.html.efca7c82.js"><link rel="prefetch" href="/assets/with-eval-strict.html.2441d651.js"><link rel="prefetch" href="/assets/express.html.bc7f1238.js"><link rel="prefetch" href="/assets/koa.html.a8ee489d.js"><link rel="prefetch" href="/assets/node-basic.html.961273b0.js"><link rel="prefetch" href="/assets/node-other.html.151eccdc.js"><link rel="prefetch" href="/assets/node-sql.html.eb28900f.js"><link rel="prefetch" href="/assets/advanced.html.8848c942.js"><link rel="prefetch" href="/assets/basic.html.b986bdb9.js"><link rel="prefetch" href="/assets/componentized.html.c3486e67.js"><link rel="prefetch" href="/assets/other.html.0bdcca51.js"><link rel="prefetch" href="/assets/react-cli.html.8f0273d5.js"><link rel="prefetch" href="/assets/react-css.html.0beb923c.js"><link rel="prefetch" href="/assets/react-hooks.html.3d7073c6.js"><link rel="prefetch" href="/assets/react-router.html.1d0d95d5.js"><link rel="prefetch" href="/assets/react-transition.html.be3525bf.js"><link rel="prefetch" href="/assets/redux-toolkit.html.b0f1c434.js"><link rel="prefetch" href="/assets/redux.html.f4a95643.js"><link rel="prefetch" href="/assets/index.html.3cb4aa07.js"><link rel="prefetch" href="/assets/class.html.7d1cf5d5.js"><link rel="prefetch" href="/assets/dataType.html.d30ede64.js"><link rel="prefetch" href="/assets/demo.html.b41c6ca5.js"><link rel="prefetch" href="/assets/function.html.fb71326b.js"><link rel="prefetch" href="/assets/generics.html.0a578b34.js"><link rel="prefetch" href="/assets/interface.html.ca442670.js"><link rel="prefetch" href="/assets/variable.html.edbcdd6e.js"><link rel="prefetch" href="/assets/index.html.8696e0b0.js"><link rel="prefetch" href="/assets/TabBar-demo.html.0844564d.js"><link rel="prefetch" href="/assets/componentized.html.544a354a.js"><link rel="prefetch" href="/assets/pinia.html.409c254b.js"><link rel="prefetch" href="/assets/slot.html.2d679c77.js"><link rel="prefetch" href="/assets/vue-cli.html.a2a31bf5.js"><link rel="prefetch" href="/assets/vue-router.html.c879ebec.js"><link rel="prefetch" href="/assets/vue2-advanced.html.a8389b87.js"><link rel="prefetch" href="/assets/vue2-basic.html.1f35d7e9.js"><link rel="prefetch" href="/assets/vue3-basic.html.a7687cf4.js"><link rel="prefetch" href="/assets/vuex.html.f997a7b5.js"><link rel="prefetch" href="/assets/index.html.f81ebb3d.js"><link rel="prefetch" href="/assets/gulimall-demo.html.c39bdc23.js"><link rel="prefetch" href="/assets/nowcoder.html.45bed2ff.js"><link rel="prefetch" href="/assets/coderhub.html.d17adb3b.js"><link rel="prefetch" href="/assets/trip-site.html.8fd453ec.js"><link rel="prefetch" href="/assets/browser-render.html.69c4a6eb.js"><link rel="prefetch" href="/assets/BFC.html.039ce767.js"><link rel="prefetch" href="/assets/align-center.html.60458cdc.js"><link rel="prefetch" href="/assets/basic.html.ad03494e.js"><link rel="prefetch" href="/assets/box.html.061f50fb.js"><link rel="prefetch" href="/assets/css-priority.html.66dfebf5.js"><link rel="prefetch" href="/assets/css-triangle.html.782d5ac5.js"><link rel="prefetch" href="/assets/flex.html.3199230b.js"><link rel="prefetch" href="/assets/intro.html.720112a2.js"><link rel="prefetch" href="/assets/less.html.c1145826.js"><link rel="prefetch" href="/assets/responsive.html.b4ac3faf.js"><link rel="prefetch" href="/assets/html5.html.637e9c1a.js"><link rel="prefetch" href="/assets/intro.html.d66b0f0d.js"><link rel="prefetch" href="/assets/tag.html.e8c082ed.js"><link rel="prefetch" href="/assets/cookie-session.html.5be16140.js"><link rel="prefetch" href="/assets/http-cache.html.8f0da6eb.js"><link rel="prefetch" href="/assets/http.html.f150f8e8.js"><link rel="prefetch" href="/assets/same-origin-policy.html.97090126.js"><link rel="prefetch" href="/assets/tcp.html.e16cf5f7.js"><link rel="prefetch" href="/assets/404.html.ecbcb5e7.js"><link rel="prefetch" href="/assets/index.html.6d697fae.js"><link rel="prefetch" href="/assets/index.html.36893461.js"><link rel="prefetch" href="/assets/index.html.4cc6530c.js"><link rel="prefetch" href="/assets/index.html.7062aee5.js"><link rel="prefetch" href="/assets/index.html.bd64629d.js"><link rel="prefetch" href="/assets/index.html.a8054ecf.js"><link rel="prefetch" href="/assets/index.html.58c2d96e.js"><link rel="prefetch" href="/assets/index.html.1a4f3a30.js"><link rel="prefetch" href="/assets/index.html.0eb7bc03.js"><link rel="prefetch" href="/assets/index.html.916b1fb1.js"><link rel="prefetch" href="/assets/index.html.69ad796c.js"><link rel="prefetch" href="/assets/index.html.822e2c3b.js"><link rel="prefetch" href="/assets/index.html.98d4bbf1.js"><link rel="prefetch" href="/assets/index.html.f93d2dfa.js"><link rel="prefetch" href="/assets/index.html.3c380501.js"><link rel="prefetch" href="/assets/index.html.e8cda796.js"><link rel="prefetch" href="/assets/index.html.cd08bdd6.js"><link rel="prefetch" href="/assets/index.html.a04d4857.js"><link rel="prefetch" href="/assets/index.html.138680c2.js"><link rel="prefetch" href="/assets/index.html.a01b29dd.js"><link rel="prefetch" href="/assets/index.html.1c91f667.js"><link rel="prefetch" href="/assets/index.html.82944efe.js"><link rel="prefetch" href="/assets/index.html.5abe7a12.js"><link rel="prefetch" href="/assets/index.html.9e4878f3.js"><link rel="prefetch" href="/assets/index.html.50513093.js"><link rel="prefetch" href="/assets/index.html.8025e42b.js"><link rel="prefetch" href="/assets/index.html.6be6938b.js"><link rel="prefetch" href="/assets/index.html.046fde74.js"><link rel="prefetch" href="/assets/index.html.edbba14a.js"><link rel="prefetch" href="/assets/index.html.e0b0475d.js"><link rel="prefetch" href="/assets/index.html.2088810e.js"><link rel="prefetch" href="/assets/about.html.0288343e.js"><link rel="prefetch" href="/assets/Java-basic.html.6495a2e1.js"><link rel="prefetch" href="/assets/Java-collection.html.0c9c557b.js"><link rel="prefetch" href="/assets/Java-thread.html.de4e184c.js"><link rel="prefetch" href="/assets/Java8-new-features.html.d7d644e0.js"><link rel="prefetch" href="/assets/photoSql.html.a58f9da3.js"><link rel="prefetch" href="/assets/mysql.html.7867d0e9.js"><link rel="prefetch" href="/assets/vite.html.9a89c482.js"><link rel="prefetch" href="/assets/webpack.html.c72868a8.js"><link rel="prefetch" href="/assets/OOP.html.123b52f0.js"><link rel="prefetch" href="/assets/index.html.e33543bd.js"><link rel="prefetch" href="/assets/arrow-function.html.a8554b16.js"><link rel="prefetch" href="/assets/async-await.html.cc25110a.js"><link rel="prefetch" href="/assets/closure.html.7117bf44.js"><link rel="prefetch" href="/assets/deepClone.html.c5c4a73f.js"><link rel="prefetch" href="/assets/es6.html.80e4430a.js"><link rel="prefetch" href="/assets/eventLoop.html.9dc2e6d0.js"><link rel="prefetch" href="/assets/executing-principle.html.571aef40.js"><link rel="prefetch" href="/assets/executing-process.html.e62a61c3.js"><link rel="prefetch" href="/assets/extend.html.517d4be3.js"><link rel="prefetch" href="/assets/functional-programming.html.e030e38f.js"><link rel="prefetch" href="/assets/intro.html.c9f661c7.js"><link rel="prefetch" href="/assets/iterator-generator.html.70a83d65.js"><link rel="prefetch" href="/assets/promise-implement.html.f23873ae.js"><link rel="prefetch" href="/assets/promise.html.41e5bef9.js"><link rel="prefetch" href="/assets/prototype.html.b30380e2.js"><link rel="prefetch" href="/assets/this.html.b07f9837.js"><link rel="prefetch" href="/assets/with-eval-strict.html.77feb4a3.js"><link rel="prefetch" href="/assets/express.html.ef30bae1.js"><link rel="prefetch" href="/assets/koa.html.a2753f12.js"><link rel="prefetch" href="/assets/node-basic.html.3cc1c07a.js"><link rel="prefetch" href="/assets/node-other.html.1d4a9354.js"><link rel="prefetch" href="/assets/node-sql.html.f48e6dc6.js"><link rel="prefetch" href="/assets/advanced.html.e2f0e3ce.js"><link rel="prefetch" href="/assets/basic.html.bb0b23ae.js"><link rel="prefetch" href="/assets/componentized.html.03fbbbbf.js"><link rel="prefetch" href="/assets/other.html.6a3da8f8.js"><link rel="prefetch" href="/assets/react-cli.html.2cc545b5.js"><link rel="prefetch" href="/assets/react-css.html.2e4b214b.js"><link rel="prefetch" href="/assets/react-hooks.html.c864f098.js"><link rel="prefetch" href="/assets/react-router.html.55bffc71.js"><link rel="prefetch" href="/assets/react-transition.html.33645fa3.js"><link rel="prefetch" href="/assets/redux-toolkit.html.f3f5e675.js"><link rel="prefetch" href="/assets/redux.html.516e8614.js"><link rel="prefetch" href="/assets/index.html.e7103f69.js"><link rel="prefetch" href="/assets/class.html.962bead5.js"><link rel="prefetch" href="/assets/dataType.html.1d25d8af.js"><link rel="prefetch" href="/assets/demo.html.fd0eb4b9.js"><link rel="prefetch" href="/assets/function.html.e4b81547.js"><link rel="prefetch" href="/assets/generics.html.d4488c3b.js"><link rel="prefetch" href="/assets/interface.html.917998dc.js"><link rel="prefetch" href="/assets/variable.html.3f187a5c.js"><link rel="prefetch" href="/assets/index.html.f04c87c1.js"><link rel="prefetch" href="/assets/TabBar-demo.html.9ed859f6.js"><link rel="prefetch" href="/assets/componentized.html.08bb8e12.js"><link rel="prefetch" href="/assets/pinia.html.4ff11a10.js"><link rel="prefetch" href="/assets/slot.html.1f1d6096.js"><link rel="prefetch" href="/assets/vue-cli.html.801062c7.js"><link rel="prefetch" href="/assets/vue-router.html.0a36fa87.js"><link rel="prefetch" href="/assets/vue2-advanced.html.db912faa.js"><link rel="prefetch" href="/assets/vue2-basic.html.dab9ca97.js"><link rel="prefetch" href="/assets/vue3-basic.html.c1730dbd.js"><link rel="prefetch" href="/assets/vuex.html.0eb38ddd.js"><link rel="prefetch" href="/assets/index.html.53ec6320.js"><link rel="prefetch" href="/assets/gulimall-demo.html.240e7c84.js"><link rel="prefetch" href="/assets/nowcoder.html.867b2587.js"><link rel="prefetch" href="/assets/coderhub.html.2b080634.js"><link rel="prefetch" href="/assets/trip-site.html.e26f4851.js"><link rel="prefetch" href="/assets/browser-render.html.170e19be.js"><link rel="prefetch" href="/assets/BFC.html.1857cfd9.js"><link rel="prefetch" href="/assets/align-center.html.de338565.js"><link rel="prefetch" href="/assets/basic.html.b4516b1a.js"><link rel="prefetch" href="/assets/box.html.e6431220.js"><link rel="prefetch" href="/assets/css-priority.html.9348eb6a.js"><link rel="prefetch" href="/assets/css-triangle.html.570346f4.js"><link rel="prefetch" href="/assets/flex.html.84543a08.js"><link rel="prefetch" href="/assets/intro.html.8d42fd4f.js"><link rel="prefetch" href="/assets/less.html.9300d250.js"><link rel="prefetch" href="/assets/responsive.html.2bd8f608.js"><link rel="prefetch" href="/assets/html5.html.feae88b8.js"><link rel="prefetch" href="/assets/intro.html.2f18b313.js"><link rel="prefetch" href="/assets/tag.html.27d63b14.js"><link rel="prefetch" href="/assets/cookie-session.html.1bd51aae.js"><link rel="prefetch" href="/assets/http-cache.html.d33c63ed.js"><link rel="prefetch" href="/assets/http.html.99bb91be.js"><link rel="prefetch" href="/assets/same-origin-policy.html.de80de62.js"><link rel="prefetch" href="/assets/tcp.html.7422d86e.js"><link rel="prefetch" href="/assets/404.html.f39409d0.js"><link rel="prefetch" href="/assets/index.html.9aab2bc8.js"><link rel="prefetch" href="/assets/index.html.feff12d0.js"><link rel="prefetch" href="/assets/index.html.7de93e34.js"><link rel="prefetch" href="/assets/index.html.0399f347.js"><link rel="prefetch" href="/assets/index.html.cc0d464d.js"><link rel="prefetch" href="/assets/index.html.9f0b1ba3.js"><link rel="prefetch" href="/assets/index.html.9907f1d2.js"><link rel="prefetch" href="/assets/index.html.9f3b7cf7.js"><link rel="prefetch" href="/assets/index.html.187258ff.js"><link rel="prefetch" href="/assets/index.html.4f6e24c5.js"><link rel="prefetch" href="/assets/index.html.ff63c77b.js"><link rel="prefetch" href="/assets/index.html.80d42947.js"><link rel="prefetch" href="/assets/index.html.24679f42.js"><link rel="prefetch" href="/assets/index.html.2d73e285.js"><link rel="prefetch" href="/assets/index.html.88cd7639.js"><link rel="prefetch" href="/assets/index.html.f770bc0a.js"><link rel="prefetch" href="/assets/index.html.e3849ed9.js"><link rel="prefetch" href="/assets/index.html.f36e7859.js"><link rel="prefetch" href="/assets/index.html.5028b4e0.js"><link rel="prefetch" href="/assets/index.html.42b9b91a.js"><link rel="prefetch" href="/assets/index.html.c97dfd62.js"><link rel="prefetch" href="/assets/index.html.1cb79a6b.js"><link rel="prefetch" href="/assets/index.html.500e6f3a.js"><link rel="prefetch" href="/assets/index.html.b09efc53.js"><link rel="prefetch" href="/assets/index.html.df378805.js"><link rel="prefetch" href="/assets/index.html.6fab8693.js"><link rel="prefetch" href="/assets/index.html.1b111f51.js"><link rel="prefetch" href="/assets/index.html.a76249f4.js"><link rel="prefetch" href="/assets/index.html.fd612760.js"><link rel="prefetch" href="/assets/index.html.36c7dc85.js"><link rel="prefetch" href="/assets/giscus.15440425.js"><link rel="prefetch" href="/assets/highlight.esm.d982e650.js"><link rel="prefetch" href="/assets/markdown.esm.832a189d.js"><link rel="prefetch" href="/assets/math.esm.a3f84b6f.js"><link rel="prefetch" href="/assets/notes.esm.3c361cb7.js"><link rel="prefetch" href="/assets/reveal.esm.b96f05d8.js"><link rel="prefetch" href="/assets/search.esm.80da4a02.js"><link rel="prefetch" href="/assets/zoom.esm.8514a202.js"><link rel="prefetch" href="/assets/photoswipe.esm.382b1873.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container no-sidebar has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><a href="/" class="brand"><img class="logo" src="/favicon.svg" alt="Nevermore毓 的学习笔记"><!----><span class="site-name hide-in-pad">Nevermore毓 的学习笔记</span></a><!----></div><div class="navbar-center"><!----><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/" class="nav-link" aria-label="主页"><span class="icon iconfont icon-home"></span>主页<!----></a></div><div class="nav-item hide-in-mobile"><a href="/back-end/Java-basic.html" class="nav-link" aria-label="后端开发"><span class="icon iconfont icon-note"></span>后端开发<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="前端开发"><span class="title"><span class="icon iconfont icon-flow"></span>前端开发</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/front-end/webpage/html/intro.html" class="nav-link" aria-label="网页"><span class="icon iconfont icon-html"></span>网页<!----></a></li><li class="dropdown-item"><a href="/front-end/javascript/intro.html" class="nav-link" aria-label="JavaScript"><span class="icon iconfont icon-javascript"></span>JavaScript<!----></a></li><li class="dropdown-item"><a href="/front-end/typescript/demo.html" class="nav-link" aria-label="TypeScript"><span class="icon iconfont icon-typescript"></span>TypeScript<!----></a></li><li class="dropdown-item"><a href="/front-end/node/node-basic.html" class="nav-link" aria-label="Node"><span class="icon iconfont icon-javascript"></span>Node<!----></a></li><li class="dropdown-item"><a href="/front-end/vue/vue2-basic.html" class="nav-link" aria-label="Vue"><span class="icon iconfont icon-vue"></span>Vue<!----></a></li><li class="dropdown-item"><a href="/front-end/react/basic.html" class="nav-link" aria-label="React"><span class="icon iconfont icon-react"></span>React<!----></a></li><li class="dropdown-item"><a href="/front-end/builder/webpack.html" class="nav-link" aria-label="构建工具"><span class="icon iconfont icon-build"></span>构建工具<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="项目源码"><span class="title"><span class="icon iconfont icon-proposal"></span>项目源码</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Java项目</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/projects/java/nowcoder.html" class="nav-link" aria-label="仿牛客网项目"><span class="icon iconfont icon-java"></span>仿牛客网项目<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Vue项目</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/projects/vue/trip-site.html" class="nav-link" aria-label="移动端旅游项目"><span class="icon iconfont icon-vue"></span>移动端旅游项目<!----></a></li><li class="dropdown-subitem"><a aria-current="page" href="/projects/vue/cms.html" class="router-link-active router-link-exact-active nav-link active" aria-label="后台管理项目"><span class="icon iconfont icon-vue"></span>后台管理项目<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Node项目</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/projects/node/coderhub.html" class="nav-link" aria-label="coderhub项目"><span class="icon iconfont icon-javascript"></span>coderhub项目<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="项目资源"><span class="title"><span class="icon iconfont icon-proposal"></span>项目资源</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/sql/photoSql.html" class="nav-link" aria-label="摄影约拍sql"><span class="icon iconfont icon-edit"></span>摄影约拍sql<!----></a></li></ul></button></div></div></nav><!----></div><div class="navbar-right"><!----><!----><div class="nav-item"><a class="repo-link" href="https://github.com/xumingyu2018/xumingyu2018.github.io" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!----><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><span class="icon iconfont icon-edit"></span>后台管理项目</h1><div class="page-info"><span class="author-info" aria-label="作者🖊" data-balloon-pos="down" localizeddate="2023年8月22日" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="author-item" href="https://github.com/xumingyu2018" target="_blank" rel="noopener noreferrer">Nevermore毓</a></span><span property="author" content="Nevermore毓"></span></span><!----><span class="date-info" aria-label="写作日期📅" data-balloon-pos="down" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span>2023年8月22日</span><meta property="datePublished" content="2023-08-22T15:12:26.000Z"></span><span class="category-info" aria-label="分类🌈" data-balloon-pos="down" localizeddate="2023年8月22日" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><ul class="categories-wrapper"><li class="category category2 clickable" role="navigation">Vue</li><meta property="articleSection" content="Vue"></ul></span><span aria-label="标签🏷" data-balloon-pos="down" localizeddate="2023年8月22日" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><ul class="tags-wrapper"><li class="tag tag7 clickable" role="navigation">前端项目</li><li class="tag tag7 clickable" role="navigation">Vue项目</li></ul><meta property="keywords" content="前端项目,Vue项目"></span><span class="reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="down" localizeddate="2023年8月22日" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 74 分钟</span><meta property="timeRequired" content="PT74M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">此页内容</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#项目地址" class="router-link-active router-link-exact-active toc-link level2">项目地址</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#项目初始化" class="router-link-active router-link-exact-active toc-link level2">项目初始化</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#按需引入-element-plus" class="router-link-active router-link-exact-active toc-link level2">按需引入 Element-Plus</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#实现登录页面" class="router-link-active router-link-exact-active toc-link level2">实现登录页面</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#设置-app-宽高铺满屏幕" class="router-link-active router-link-exact-active toc-link level3">设置 App 宽高铺满屏幕</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#搭建后台管理帐号登录页面" class="router-link-active router-link-exact-active toc-link level3">搭建后台管理帐号登录页面</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#实现点击登录按钮逻辑" class="router-link-active router-link-exact-active toc-link level3">实现点击登录按钮逻辑</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#实现记住密码" class="router-link-active router-link-exact-active toc-link level3">实现记住密码</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#实现获取登录用户详细信息-包括角色权限菜单" class="router-link-active router-link-exact-active toc-link level3">实现获取登录用户详细信息（包括角色权限菜单）</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#实现主页左侧导航栏" class="router-link-active router-link-exact-active toc-link level2">实现主页左侧导航栏</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#整体容器布局" class="router-link-active router-link-exact-active toc-link level3">整体容器布局</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#实现左侧导航栏静态布局" class="router-link-active router-link-exact-active toc-link level3">实现左侧导航栏静态布局</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#实现左侧导航栏动态展示效果" class="router-link-active router-link-exact-active toc-link level3">实现左侧导航栏动态展示效果</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#导航栏图标的动态组件-细节处理" class="router-link-active router-link-exact-active toc-link level3">导航栏图标的动态组件（细节处理）</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#导航栏注册所有静态路由-有缺陷" class="router-link-active router-link-exact-active toc-link level3">导航栏注册所有静态路由（有缺陷）</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#实现主页头部面包屑" class="router-link-active router-link-exact-active toc-link level2">实现主页头部面包屑</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#搭建整体布局" class="router-link-active router-link-exact-active toc-link level3">搭建整体布局</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#实现头部左侧图标点击折叠功能" class="router-link-active router-link-exact-active toc-link level3">实现头部左侧图标点击折叠功能</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#实现头部右侧个人信息功能" class="router-link-active router-link-exact-active toc-link level3">实现头部右侧个人信息功能</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#动态路由" class="router-link-active router-link-exact-active toc-link level2">动态路由</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#安装自动化生成路由配置信息和-vue-页面的工具" class="router-link-active router-link-exact-active toc-link level3">安装自动化生成路由配置信息和 vue 页面的工具</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#使用-coderwhy-工具" class="router-link-active router-link-exact-active toc-link level3">使用 coderwhy 工具</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#编写菜单映射路由工具类" class="router-link-active router-link-exact-active toc-link level3">编写菜单映射路由工具类</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#有弊端-登录时调用工具类" class="router-link-active router-link-exact-active toc-link level3">(有弊端)登录时调用工具类</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#改进-使用全局加载数据方法" class="router-link-active router-link-exact-active toc-link level3">(改进)使用全局加载数据方法</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#进入主页时匹配第一个菜单" class="router-link-active router-link-exact-active toc-link level3">进入主页时匹配第一个菜单</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#刷新页面时-菜单默认值问题" class="router-link-active router-link-exact-active toc-link level3">刷新页面时，菜单默认值问题</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#实现面包屑功能" class="router-link-active router-link-exact-active toc-link level2">实现面包屑功能</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#搭建面包屑页面" class="router-link-active router-link-exact-active toc-link level3">搭建面包屑页面</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#路由映射面包屑工具类" class="router-link-active router-link-exact-active toc-link level3">路由映射面包屑工具类</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#解决点击面包屑跳到目录下的第一个子目录问题" class="router-link-active router-link-exact-active toc-link level3">解决点击面包屑跳到目录下的第一个子目录问题</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#实现主页中部-main-页面" class="router-link-active router-link-exact-active toc-link level2">实现主页中部 main 页面</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#实现-search-表单搜索框界面" class="router-link-active router-link-exact-active toc-link level3">实现 search 表单搜索框界面</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#实现展示用户列表功能" class="router-link-active router-link-exact-active toc-link level3">实现展示用户列表功能</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#实现分页功能" class="router-link-active router-link-exact-active toc-link level3">实现分页功能</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#实现查询用户功能" class="router-link-active router-link-exact-active toc-link level3">实现查询用户功能</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#实现删除用户功能" class="router-link-active router-link-exact-active toc-link level3">实现删除用户功能</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#实现新增用户功能" class="router-link-active router-link-exact-active toc-link level3">实现新增用户功能</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#实现编辑用户功能" class="router-link-active router-link-exact-active toc-link level3">实现编辑用户功能</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#高级复用性代码抽取" class="router-link-active router-link-exact-active toc-link level2">高级复用性代码抽取</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#封装网络请求" class="router-link-active router-link-exact-active toc-link level3">封装网络请求</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#封装表单搜索组件" class="router-link-active router-link-exact-active toc-link level3">封装表单搜索组件</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#封装表格内容组件" class="router-link-active router-link-exact-active toc-link level3">封装表格内容组件</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#封装模态框组件" class="router-link-active router-link-exact-active toc-link level3">封装模态框组件</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#页面公共逻辑的-hooks-抽取" class="router-link-active router-link-exact-active toc-link level3">页面公共逻辑的 hooks 抽取</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#实现菜单管理功能" class="router-link-active router-link-exact-active toc-link level2">实现菜单管理功能</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#实现树形子树的展示" class="router-link-active router-link-exact-active toc-link level3">实现树形子树的展示</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#实现新增、编辑模态框功能以及删除功能" class="router-link-active router-link-exact-active toc-link level3">实现新增、编辑模态框功能以及删除功能</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#实现角色管理中的权限分配-难点" class="router-link-active router-link-exact-active toc-link level2">实现角色管理中的权限分配（难点）</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#创建角色的菜单树展示" class="router-link-active router-link-exact-active toc-link level3">创建角色的菜单树展示</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#创建角色携带菜单树的权限数据" class="router-link-active router-link-exact-active toc-link level3">创建角色携带菜单树的权限数据</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#编辑时角色菜单权限回显" class="router-link-active router-link-exact-active toc-link level3">编辑时角色菜单权限回显</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#新增时角色菜单权限回显重置" class="router-link-active router-link-exact-active toc-link level3">新增时角色菜单权限回显重置</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#实现登录用户的权限功能" class="router-link-active router-link-exact-active toc-link level2">实现登录用户的权限功能</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#封装菜单映射按钮权限工具" class="router-link-active router-link-exact-active toc-link level3">封装菜单映射按钮权限工具</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#获取登录用户的所有按钮权限" class="router-link-active router-link-exact-active toc-link level3">获取登录用户的所有按钮权限</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#封装权限-hooks" class="router-link-active router-link-exact-active toc-link level3">封装权限 hooks</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#编写-page-content-组件" class="router-link-active router-link-exact-active toc-link level3">编写 Page-content 组件</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#细节处理-新增编辑删除操作重置-current-分页" class="router-link-active router-link-exact-active toc-link level2">(细节处理)新增编辑删除操作重置 current 分页</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#实现数据统计页面" class="router-link-active router-link-exact-active toc-link level2">实现数据统计页面</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#实现顶部卡片组件页面" class="router-link-active router-link-exact-active toc-link level3">实现顶部卡片组件页面</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#顶部卡片中的数据递增动画实现" class="router-link-active router-link-exact-active toc-link level3">顶部卡片中的数据递增动画实现</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#实现顶部卡片响应式布局" class="router-link-active router-link-exact-active toc-link level3">实现顶部卡片响应式布局</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#实现-echart-可视化" class="router-link-active router-link-exact-active toc-link level2">实现 echart 可视化</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#初步搭建可视化页面" class="router-link-active router-link-exact-active toc-link level3">初步搭建可视化页面</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#三层组件封装-echart" class="router-link-active router-link-exact-active toc-link level3">三层组件封装 echart</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#获取请求数据用于-echarts-显示" class="router-link-active router-link-exact-active toc-link level3">获取请求数据用于 ECharts 显示</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#实现各种-echart-图动态数据展示" class="router-link-active router-link-exact-active toc-link level3">实现各种 Echart 图动态数据展示</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#实现-echart-地图数据展示" class="router-link-active router-link-exact-active toc-link level3">实现 echart 地图数据展示</a></li><!----><!--]--></ul><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h2 id="项目地址" tabindex="-1"><a class="header-anchor" href="#项目地址" aria-hidden="true">#</a> <a href="http://129.204.230.159:8001" target="_blank" rel="noopener noreferrer">项目地址<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></h2><h2 id="项目初始化" tabindex="-1"><a class="header-anchor" href="#项目初始化" aria-hidden="true">#</a> 项目初始化</h2><p>搭建 vue3 脚手架</p><p><code>npm init vue@latest</code></p><p>安装依赖</p><p><code>npm install</code></p><p>css 样式重置（略）</p><p>配置路由（略）</p><p>配置 pinia 状态管理（略）</p><p>配置 axios 网络请求 ts 写法</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// service/request/index.ts</span>
<span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">&#39;axios&#39;</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> AxiosInstance<span class="token punctuation">,</span> AxiosRequestConfig<span class="token punctuation">,</span> AxiosResponse <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;axios&#39;</span>

<span class="token keyword">interface</span> <span class="token class-name">HYInstanceInterceptors<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">=</span> AxiosResponse<span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
  requestInterceptor<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span>config<span class="token operator">:</span> AxiosRequestConfig<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> AxiosRequestConfig
  requestInterceptorCatch<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span>err<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">any</span>
  responseInterceptor<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span>res<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">T</span>
  responseInterceptorCatch<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span>err<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">any</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">HYRequestConfig<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">=</span> AxiosResponse<span class="token operator">&gt;</span></span> <span class="token keyword">extends</span> <span class="token class-name">AxiosRequestConfig</span> <span class="token punctuation">{</span>
  interceptors<span class="token operator">?</span><span class="token operator">:</span> HYInstanceInterceptors<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">HYRequest</span> <span class="token punctuation">{</span>
  instance<span class="token operator">:</span> AxiosInstance

  <span class="token function">constructor</span><span class="token punctuation">(</span>config<span class="token operator">:</span> HYRequestConfig<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>instance <span class="token operator">=</span> axios<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span>

    <span class="token comment">// 全局的拦截器</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>instance<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
      <span class="token punctuation">(</span>config<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> config
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> err
      <span class="token punctuation">}</span>
    <span class="token punctuation">)</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>instance<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
      <span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> res<span class="token punctuation">.</span>data
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> err
      <span class="token punctuation">}</span>
    <span class="token punctuation">)</span>

    <span class="token comment">// 实例的拦截器</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>instance<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
      config<span class="token punctuation">.</span>interceptors<span class="token operator">?.</span>requestInterceptor<span class="token punctuation">,</span>
      config<span class="token punctuation">.</span>interceptors<span class="token operator">?.</span>requestInterceptorCatch
    <span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>instance<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
      config<span class="token punctuation">.</span>interceptors<span class="token operator">?.</span>responseInterceptor<span class="token punctuation">,</span>
      config<span class="token punctuation">.</span>interceptors<span class="token operator">?.</span>responseInterceptorCatch
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token generic-function"><span class="token function">request</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">=</span> <span class="token builtin">any</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>config<span class="token operator">:</span> HYRequestConfig<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>config<span class="token punctuation">.</span>interceptors<span class="token operator">?.</span>requestInterceptor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      config <span class="token operator">=</span> config<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span><span class="token function">requestInterceptor</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>instance
        <span class="token punctuation">.</span><span class="token generic-function"><span class="token function">request</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>config<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>config<span class="token punctuation">.</span>interceptors<span class="token operator">?.</span>responseInterceptor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            res <span class="token operator">=</span> config<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span><span class="token function">responseInterceptor</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
          <span class="token function">resolve</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>err<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>config<span class="token punctuation">.</span>interceptors<span class="token operator">?.</span>responseInterceptorCatch<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            err <span class="token operator">=</span> config<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span><span class="token function">responseInterceptorCatch</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
          <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token generic-function"><span class="token function">get</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">=</span> <span class="token builtin">any</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>config<span class="token operator">:</span> HYRequestConfig<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token generic-function"><span class="token function">request</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span>config<span class="token punctuation">,</span> method<span class="token operator">:</span> <span class="token string">&#39;GET&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token generic-function"><span class="token function">post</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">=</span> <span class="token builtin">any</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>config<span class="token operator">:</span> HYRequestConfig<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token generic-function"><span class="token function">request</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span>config<span class="token punctuation">,</span> method<span class="token operator">:</span> <span class="token string">&#39;POST&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">delete</span><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">=</span> <span class="token builtin">any</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>config<span class="token operator">:</span> HYRequestConfig<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token generic-function"><span class="token function">request</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span>config<span class="token punctuation">,</span> method<span class="token operator">:</span> <span class="token string">&#39;DELETE&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token generic-function"><span class="token function">patch</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">=</span> <span class="token builtin">any</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>config<span class="token operator">:</span> HYRequestConfig<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token generic-function"><span class="token function">request</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span>config<span class="token punctuation">,</span> method<span class="token operator">:</span> <span class="token string">&#39;PATCH&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> HYRequest
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// service/index.ts</span>
<span class="token keyword">import</span> HYRequest <span class="token keyword">from</span> <span class="token string">&#39;./request&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">BASE_URL1</span><span class="token punctuation">,</span> <span class="token constant">TIME_OUT1</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./config&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> localCache <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/utils/cache&#39;</span>

<span class="token keyword">const</span> hyRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HYRequest</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  baseURL<span class="token operator">:</span> <span class="token constant">BASE_URL1</span><span class="token punctuation">,</span>
  timeout<span class="token operator">:</span> <span class="token constant">TIME_OUT1</span><span class="token punctuation">,</span>
  interceptors<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">requestInterceptor</span><span class="token operator">:</span> <span class="token punctuation">(</span>config<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> token <span class="token operator">=</span> localCache<span class="token punctuation">.</span><span class="token function">getCache</span><span class="token punctuation">(</span><span class="token string">&#39;token&#39;</span><span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>token <span class="token operator">&amp;&amp;</span> config<span class="token punctuation">.</span>headers<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        config<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>Authorization <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Bearer </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>token<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> config
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">requestInterceptorCatch</span><span class="token operator">:</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> err
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">responseInterceptor</span><span class="token operator">:</span> <span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> res
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">responseInterceptorCatch</span><span class="token operator">:</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> err
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> hyRequest
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// service/config/index.ts</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">BASE_URL1</span> <span class="token operator">=</span> <span class="token string">&#39;http://152.136.185.210:5000&#39;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">TIME_OUT1</span> <span class="token operator">=</span> <span class="token number">10000</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>配置生产环境和开发环境（略）</p><h2 id="按需引入-element-plus" tabindex="-1"><a class="header-anchor" href="#按需引入-element-plus" aria-hidden="true">#</a> 按需引入 Element-Plus</h2><p>安装插件<code>npm install -D unplugin-vue-components unplugin-auto-import</code></p><p>然后把下列代码插入到你的 Vite 或 Webpack 的配置文件中</p><p><strong>Vite</strong></p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// vite.config.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vite&#39;</span>
<span class="token keyword">import</span> AutoImport <span class="token keyword">from</span> <span class="token string">&#39;unplugin-auto-import/vite&#39;</span>
<span class="token keyword">import</span> Components <span class="token keyword">from</span> <span class="token string">&#39;unplugin-vue-components/vite&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ElementPlusResolver <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;unplugin-vue-components/resolvers&#39;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// ...</span>
    <span class="token function">AutoImport</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      resolvers<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">ElementPlusResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">Components</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      resolvers<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">ElementPlusResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Webpack</strong></p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// webpack.config.js</span>
<span class="token keyword">const</span> AutoImport <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">&#39;unplugin-auto-import/webpack&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> Components <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">&#39;unplugin-vue-components/webpack&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> ElementPlusResolver <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">&#39;unplugin-vue-components/resolvers&#39;</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token function">AutoImport</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      resolvers<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">ElementPlusResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">Components</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      resolvers<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">ElementPlusResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="实现登录页面" tabindex="-1"><a class="header-anchor" href="#实现登录页面" aria-hidden="true">#</a> 实现登录页面</h2><p><img src="https://nevermore-picbed-1304219157.cos.ap-guangzhou.myqcloud.com/image_EgQqzVLzYM.png" alt=""></p><h3 id="设置-app-宽高铺满屏幕" tabindex="-1"><a class="header-anchor" href="#设置-app-宽高铺满屏幕" aria-hidden="true">#</a> 设置 App 宽高铺满屏幕</h3><p>注意这里不能用%号</p><div class="language-css ext-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">&lt;style scoped&gt;
.app</span> <span class="token punctuation">{</span>
  <span class="token comment">/* 不能使用%，因为相对于父元素；vh相对于视口 */</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100vw<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100vh<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> skyblue<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
&lt;/style&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="搭建后台管理帐号登录页面" tabindex="-1"><a class="header-anchor" href="#搭建后台管理帐号登录页面" aria-hidden="true">#</a> 搭建后台管理帐号登录页面</h3><h4 id="login-父组件设置背景及位置" tabindex="-1"><a class="header-anchor" href="#login-父组件设置背景及位置" aria-hidden="true">#</a> Login 父组件设置背景及位置</h4><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token comment">&lt;!-- Login.vue --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>login<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>login-panel</span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> loginPanel <span class="token keyword">from</span> <span class="token string">&#39;./cpns/login-panel.vue&#39;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>less<span class="token punctuation">&quot;</span></span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">.login</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>

  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>

  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>../../assets/img/login-bg.svg<span class="token punctuation">)</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="全局图标及-elmessage-组件等样式引入" tabindex="-1"><a class="header-anchor" href="#全局图标及-elmessage-组件等样式引入" aria-hidden="true">#</a> 全局图标及 ElMessage 组件等样式引入</h4><p>图标引入安装：<code>npm install @element-plus/icons-vue</code></p><p>ElMessage 组件等样式引入安装：</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 图标的全局注册</span>
<span class="token comment">// global/register-icons.ts</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> ElementPlusIconsVue <span class="token keyword">from</span> <span class="token string">&#39;@element-plus/icons-vue&#39;</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> App <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>

<span class="token keyword">function</span> <span class="token function">registerIcons</span><span class="token punctuation">(</span>app<span class="token operator">:</span> App<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token punctuation">[</span>key<span class="token punctuation">,</span> component<span class="token punctuation">]</span> <span class="token keyword">of</span> Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>ElementPlusIconsVue<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    app<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> component<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> registerIcons

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>main.ts 中进行注册</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createApp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">&#39;./App.vue&#39;</span>
<span class="token keyword">import</span> <span class="token string">&#39;normalize.css&#39;</span>
<span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">&#39;./router&#39;</span>
<span class="token keyword">import</span> pinia <span class="token keyword">from</span> <span class="token string">&#39;./store&#39;</span>
<span class="token keyword">import</span> registerIcons <span class="token keyword">from</span> <span class="token string">&#39;./global/register-icons&#39;</span>

<span class="token comment">// 针对ElMessage和ElLoading等组件引入样式(手动按需引入)</span>
<span class="token keyword">import</span> <span class="token string">&#39;element-plus/theme-chalk/el-message.css&#39;</span>

<span class="token comment">// 全局注册element-plus</span>
<span class="token comment">// import ElementPlus from &#39;element-plus&#39;</span>
<span class="token comment">// import &#39;element-plus/dist/index.css&#39;</span>

<span class="token comment">// 安装vite-plugin-style-import/consola并配置vite.config.ts（自动按需引入样式）</span>

<span class="token function">createApp</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>pinia<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>registerIcons<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">&#39;#app&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="实现登录面板父组件" tabindex="-1"><a class="header-anchor" href="#实现登录面板父组件" aria-hidden="true">#</a> 实现登录面板父组件</h4><p>涉及到的 Element-Plus 组件有<code>el-tabs(选项卡)</code>、<code>el-check(记住密码勾选框)</code>、<code>el-button(立即登录)</code>、<code>el-link(记住密码/忘记密码)</code>、<code>el-icon(选项卡图标)</code></p><p>tabs 中插入图标需要用到<code>label</code>插槽<code>&lt;template #label&gt;...&lt;/template&gt;</code></p><p>tabs 中通过 v-model 绑定选项卡的 name</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token comment">&lt;!-- login-panel.vue --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>login-panel<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 顶部标题 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>后台管理系统<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- tabs标签页 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tabs<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-tabs</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>activeName<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>border-card<span class="token punctuation">&quot;</span></span> <span class="token attr-name">stretch</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-tab-pane</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>帐号登录<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>account<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

          <span class="token comment">&lt;!-- 图标插槽 --&gt;</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">#label</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>label<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-icon</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>UserFilled</span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-icon</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>帐号登录<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

          <span class="token comment">&lt;!-- pane-account子组件 --&gt;</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pane-account</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>accountRef<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-tab-pane</span><span class="token punctuation">&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-tab-pane</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>手机登录<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>phone<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token comment">&lt;!-- 图标插槽 --&gt;</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">#label</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>label<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-icon</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Cellphone</span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-icon</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>手机登录<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>手机登录<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>验证码<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-tab-pane</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-tabs</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- 底部区域 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>controls<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-checkbox</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>isRemPwd<span class="token punctuation">&quot;</span></span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>记住密码<span class="token punctuation">&quot;</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>large<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-checkbox</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-link</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>忘记密码<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-link</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>login-btn<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>large<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handleLoginBtnClick<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      立即登录
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token keyword">import</span> paneAccount <span class="token keyword">from</span> <span class="token string">&#39;./pane-account.vue&#39;</span>

<span class="token keyword">const</span> activeName <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">&#39;account&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> isRemPwd <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> accountRef <span class="token operator">=</span> ref<span class="token operator">&lt;</span>InstanceType<span class="token operator">&lt;</span><span class="token keyword">typeof</span> paneAccount<span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 按钮监听</span>
<span class="token keyword">const</span> <span class="token function-variable function">handleLoginBtnClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>activeName<span class="token punctuation">.</span>value <span class="token operator">===</span> <span class="token string">&#39;account&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 父组件调用子组件方法</span>
    accountRef<span class="token punctuation">.</span>value<span class="token operator">?.</span><span class="token function">loginAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;手机登录&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>less<span class="token punctuation">&quot;</span></span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">.login-panel</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 330px<span class="token punctuation">;</span>

  <span class="token selector">.title</span> <span class="token punctuation">{</span>
    <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token selector">.label</span> <span class="token punctuation">{</span>
    <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>

    <span class="token selector">.text</span> <span class="token punctuation">{</span>
      <span class="token property">margin-left</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token selector">.controls</span> <span class="token punctuation">{</span>
    <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
    <span class="token property">justify-content</span><span class="token punctuation">:</span> space-between<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token selector">.login-btn</span> <span class="token punctuation">{</span>
    <span class="token property">margin-top</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="封装面板中登录表单子组件" tabindex="-1"><a class="header-anchor" href="#封装面板中登录表单子组件" aria-hidden="true">#</a> 封装面板中登录表单子组件</h4><p>涉及到的 Element-Plus 组件有<code>el-form</code>、<code>el-input</code>、<code>el-message</code></p><p><code>form</code>的校验规则需要使用到<code>FormRules</code></p><p><code>form</code>的通过验证需要使用<code>formRef.value.validate()</code></p><p><code>defineExpose</code>将子组件的用户名/密码暴露给父组件，从而实现登录逻辑（涉及 pinia、axios）</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> pane<span class="token operator">-</span>account<span class="token punctuation">.</span>vue <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;account&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>el<span class="token operator">-</span>form <span class="token operator">:</span>model<span class="token operator">=</span><span class="token string">&quot;account&quot;</span> label<span class="token operator">-</span>width<span class="token operator">=</span><span class="token string">&quot;60px&quot;</span> size<span class="token operator">=</span><span class="token string">&quot;large&quot;</span> <span class="token operator">:</span>rules<span class="token operator">=</span><span class="token string">&quot;accountRules&quot;</span> status<span class="token operator">-</span>icon ref<span class="token operator">=</span><span class="token string">&quot;formRef&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item label<span class="token operator">=</span><span class="token string">&quot;帐号&quot;</span> prop<span class="token operator">=</span><span class="token string">&quot;username&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>el<span class="token operator">-</span>input v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;account.username&quot;</span> placeholder<span class="token operator">=</span><span class="token string">&quot;请输入帐号&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>input<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item label<span class="token operator">=</span><span class="token string">&quot;密码&quot;</span> prop<span class="token operator">=</span><span class="token string">&quot;password&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>el<span class="token operator">-</span>input v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;account.password&quot;</span> placeholder<span class="token operator">=</span><span class="token string">&quot;请输入密码&quot;</span> show<span class="token operator">-</span>password<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>input<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> reactive<span class="token punctuation">,</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> ElForm<span class="token punctuation">,</span> FormRules <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;element-plus&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ElMessage <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;element-plus&#39;</span>
<span class="token keyword">import</span> useLoginStore <span class="token keyword">from</span> <span class="token string">&#39;@/store/login/login&#39;</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> IAccount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/types&#39;</span>

<span class="token comment">// 定义account数据</span>
<span class="token keyword">const</span> account <span class="token operator">=</span> <span class="token generic-function"><span class="token function">reactive</span><span class="token generic class-name"><span class="token operator">&lt;</span>IAccount<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  username<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
  password<span class="token operator">:</span> <span class="token string">&#39;&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 定义校验规则</span>
<span class="token keyword">const</span> accountRules<span class="token operator">:</span> FormRules <span class="token operator">=</span> <span class="token punctuation">{</span>
  username<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> required<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> message<span class="token operator">:</span> <span class="token string">&#39;必须输入用户名&#39;</span><span class="token punctuation">,</span> trigger<span class="token operator">:</span> <span class="token string">&#39;blur&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> pattern<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^[a-z0-9]{6,20}$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> message<span class="token operator">:</span> <span class="token string">&#39;必须是6～20位以小写字母或数字开头&#39;</span><span class="token punctuation">,</span> trigger<span class="token operator">:</span> <span class="token string">&#39;blur&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  password<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> required<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> message<span class="token operator">:</span> <span class="token string">&#39;必须输入密码&#39;</span><span class="token punctuation">,</span> trigger<span class="token operator">:</span> <span class="token string">&#39;blur&#39;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> min<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> max<span class="token operator">:</span> <span class="token number">11</span><span class="token punctuation">,</span> message<span class="token operator">:</span> <span class="token string">&#39;长度必须在3~11个字符&#39;</span><span class="token punctuation">,</span> trigger<span class="token operator">:</span> <span class="token string">&#39;blur&#39;</span><span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token comment">// 执行帐号登录逻辑</span>
<span class="token keyword">const</span> formRef <span class="token operator">=</span> <span class="token generic-function"><span class="token function">ref</span><span class="token generic class-name"><span class="token operator">&lt;</span>InstanceType<span class="token operator">&lt;</span><span class="token keyword">typeof</span> ElForm<span class="token operator">&gt;&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> loginStore <span class="token operator">=</span> <span class="token function">useLoginStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">loginAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  formRef<span class="token punctuation">.</span>value<span class="token operator">?.</span><span class="token function">validate</span><span class="token punctuation">(</span><span class="token punctuation">(</span>valid<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>valid<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> username <span class="token operator">=</span> account<span class="token punctuation">.</span>username
        <span class="token keyword">const</span> password <span class="token operator">=</span> account<span class="token punctuation">.</span>password

        loginStore<span class="token punctuation">.</span><span class="token function">loginAccountAction</span><span class="token punctuation">(</span><span class="token punctuation">{</span> username<span class="token punctuation">,</span> password <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        ElMessage<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&#39;Oops, 请输入正确的格式.&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 暴露给父组件</span>
<span class="token function">defineExpose</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    loginAction
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style lang<span class="token operator">=</span><span class="token string">&quot;less&quot;</span> scoped<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="实现点击登录按钮逻辑" tabindex="-1"><a class="header-anchor" href="#实现点击登录按钮逻辑" aria-hidden="true">#</a> 实现点击登录按钮逻辑</h3><h4 id="封装-iaccount-对象类型" tabindex="-1"><a class="header-anchor" href="#封装-iaccount-对象类型" aria-hidden="true">#</a> 封装 IAccount 对象类型</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// types/login.ts</span>
<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">IAccount</span> <span class="token punctuation">{</span>
    username<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
    password<span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token comment">// types/index.ts(统一导出)</span>
<span class="token keyword">export</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">&#39;./login&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="封装-axios-登录请求" tabindex="-1"><a class="header-anchor" href="#封装-axios-登录请求" aria-hidden="true">#</a> 封装 axios 登录请求</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> hyRequest <span class="token keyword">from</span> <span class="token string">&quot;..&quot;</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> IAccount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/types&quot;</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">accountLoginRequest</span><span class="token punctuation">(</span>account<span class="token operator">:</span> IAccount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> hyRequest<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token operator">:</span> <span class="token string">&#39;/login&#39;</span><span class="token punctuation">,</span>
        data<span class="token operator">:</span> account
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="使用-pinia-存储请求数据-在pane-account组件中调用" tabindex="-1"><a class="header-anchor" href="#使用-pinia-存储请求数据-在pane-account组件中调用" aria-hidden="true">#</a> 使用 pinia 存储请求数据(在<code>pane-account</code>组件中调用)</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// store/index.ts</span>
<span class="token comment">// 初始化pinia</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createPinia <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;pinia&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> pinia <span class="token operator">=</span> <span class="token function">createPinia</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> pinia
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// store/login/login.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;pinia&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> accountLoginRequest <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/service/login/login&#39;</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> IAccount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/types&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> localCache <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/utils/cache&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> useLoginStore <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token string">&#39;login&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">state</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
        id<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
        <span class="token comment">// token: localStorage.getItem(&#39;token&#39;) ?? &#39;&#39;,</span>
        token<span class="token operator">:</span> localCache<span class="token punctuation">.</span><span class="token function">getCache</span><span class="token punctuation">(</span><span class="token string">&#39;token&#39;</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
        username<span class="token operator">:</span> <span class="token string">&#39;&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

    actions<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token keyword">async</span> <span class="token function">loginAccountAction</span><span class="token punctuation">(</span>account<span class="token operator">:</span> IAccount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> loginResult <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">accountLoginRequest</span><span class="token punctuation">(</span>account<span class="token punctuation">)</span>
            <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;登录成功&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> loginResult<span class="token punctuation">.</span>data<span class="token punctuation">.</span>id
            <span class="token keyword">this</span><span class="token punctuation">.</span>token <span class="token operator">=</span> loginResult<span class="token punctuation">.</span>data<span class="token punctuation">.</span>token
            <span class="token keyword">this</span><span class="token punctuation">.</span>username <span class="token operator">=</span> loginResult<span class="token punctuation">.</span>data<span class="token punctuation">.</span>username

            <span class="token comment">// 进行本地缓存</span>
            <span class="token comment">// localStorage.setItem(&#39;token&#39;, this.token)</span>
            localCache<span class="token punctuation">.</span><span class="token function">setCache</span><span class="token punctuation">(</span><span class="token string">&#39;token&#39;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>token<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> useLoginStore
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="封装本地缓存-token-工具-localstorage、sessionstorage" tabindex="-1"><a class="header-anchor" href="#封装本地缓存-token-工具-localstorage、sessionstorage" aria-hidden="true">#</a> 封装本地缓存 token 工具（localStorage、sessionStorage）</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// utils/cache.ts</span>
<span class="token keyword">enum</span> CacheType <span class="token punctuation">{</span>
  local <span class="token operator">=</span> <span class="token string">&#39;local&#39;</span><span class="token punctuation">,</span>
  session <span class="token operator">=</span> <span class="token string">&#39;session&#39;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">MyCache</span> <span class="token punctuation">{</span>
  storage<span class="token operator">:</span> Storage

  <span class="token comment">// 判断是localStorage还是sessionStorage</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>type<span class="token operator">:</span> CacheType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>storage <span class="token operator">=</span> type <span class="token operator">===</span> CacheType<span class="token punctuation">.</span>local <span class="token operator">?</span> localStorage <span class="token operator">:</span> sessionStorage
  <span class="token punctuation">}</span>

  <span class="token function">setCache</span><span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>storage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">getCache</span><span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>storage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">deleteCache</span><span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>storage<span class="token punctuation">.</span><span class="token function">removeItem</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">clearCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>storage<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> localCache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyCache</span><span class="token punctuation">(</span>CacheType<span class="token punctuation">.</span>local<span class="token punctuation">)</span>
<span class="token keyword">const</span> sessionCache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyCache</span><span class="token punctuation">(</span>CacheType<span class="token punctuation">.</span>session<span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span> localCache<span class="token punctuation">,</span> sessionCache <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="登录拦截-路由导航守卫" tabindex="-1"><a class="header-anchor" href="#登录拦截-路由导航守卫" aria-hidden="true">#</a> 登录拦截（路由导航守卫）</h4><p><code>router.beforeEach(to, from)</code></p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// router/index.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> localCache <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/utils/cache&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createRouter<span class="token punctuation">,</span> createWebHashHistory <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue-router&#39;</span>

<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">createRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>to<span class="token punctuation">,</span> from<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> token <span class="token operator">=</span> localCache<span class="token punctuation">.</span><span class="token function">getCache</span><span class="token punctuation">(</span><span class="token string">&#39;token&#39;</span><span class="token punctuation">)</span>

  <span class="token keyword">if</span><span class="token punctuation">(</span>to<span class="token punctuation">.</span>path <span class="token operator">===</span> <span class="token string">&#39;/main&#39;</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>token<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token string">&#39;/login&#39;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> router
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="实现记住密码" tabindex="-1"><a class="header-anchor" href="#实现记住密码" aria-hidden="true">#</a> 实现记住密码</h3><p>父组件将<code>isRemPwd</code>作为参数传入子组件登录逻辑，判断<code>isRemPwd</code>的布尔值，来选择是否存入或删除<code>LocalStore</code>本地缓存，再获取本地缓存将值赋值给初始化的<code>username</code>和<code>password</code>进行回显。将勾选框是否选中也作为<code>LocalStore</code>缓存存入。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 父组件login-panel</span>
<span class="token comment">// ...</span>
<span class="token keyword">const</span> isRemPwd <span class="token operator">=</span> <span class="token generic-function"><span class="token function">ref</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">boolean</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>localCache<span class="token punctuation">.</span><span class="token function">getCache</span><span class="token punctuation">(</span><span class="token string">&#39;isRemPwd&#39;</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token function">watch</span><span class="token punctuation">(</span>isRemPwd<span class="token punctuation">,</span> <span class="token punctuation">(</span>newValue<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  localCache<span class="token punctuation">.</span><span class="token function">setCache</span><span class="token punctuation">(</span><span class="token string">&#39;isRemPwd&#39;</span><span class="token punctuation">,</span> newValue<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// ...</span>
<span class="token comment">// 按钮监听</span>
<span class="token keyword">const</span> <span class="token function-variable function">handleLoginBtnClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>activeName<span class="token punctuation">.</span>value <span class="token operator">===</span> <span class="token string">&#39;account&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 父组件调用子组件方法</span>
    accountRef<span class="token punctuation">.</span>value<span class="token operator">?.</span><span class="token function">loginAction</span><span class="token punctuation">(</span>isRemPwd<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;手机登录&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code>
<span class="token comment">// 定义account数据</span>
<span class="token keyword">const</span> account <span class="token operator">=</span> <span class="token generic-function"><span class="token function">reactive</span><span class="token generic class-name"><span class="token operator">&lt;</span>IAccount<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  username<span class="token operator">:</span> localCache<span class="token punctuation">.</span><span class="token function">getCache</span><span class="token punctuation">(</span><span class="token string">&#39;username&#39;</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
  password<span class="token operator">:</span> localCache<span class="token punctuation">.</span><span class="token function">getCache</span><span class="token punctuation">(</span><span class="token string">&#39;password&#39;</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token string">&#39;&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 执行帐号登录逻辑</span>
<span class="token comment">// ...</span>
<span class="token keyword">function</span> <span class="token function">loginAction</span><span class="token punctuation">(</span>isRemPwd<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  formRef<span class="token punctuation">.</span>value<span class="token operator">?.</span><span class="token function">validate</span><span class="token punctuation">(</span><span class="token punctuation">(</span>valid<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>valid<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> username <span class="token operator">=</span> account<span class="token punctuation">.</span>username
        <span class="token keyword">const</span> password <span class="token operator">=</span> account<span class="token punctuation">.</span>password

        <span class="token comment">// 调用store中的loginAccountAction(pinia)</span>
        loginStore<span class="token punctuation">.</span><span class="token function">loginAccountAction</span><span class="token punctuation">(</span><span class="token punctuation">{</span> username<span class="token punctuation">,</span> password <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token comment">// 登录成功后记住密码</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span>isRemPwd<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            localCache<span class="token punctuation">.</span><span class="token function">setCache</span><span class="token punctuation">(</span><span class="token string">&#39;username&#39;</span><span class="token punctuation">,</span> username<span class="token punctuation">)</span>
            localCache<span class="token punctuation">.</span><span class="token function">setCache</span><span class="token punctuation">(</span><span class="token string">&#39;password&#39;</span><span class="token punctuation">,</span> password<span class="token punctuation">)</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            localCache<span class="token punctuation">.</span><span class="token function">deleteCache</span><span class="token punctuation">(</span><span class="token string">&#39;username&#39;</span><span class="token punctuation">)</span>
            localCache<span class="token punctuation">.</span><span class="token function">deleteCache</span><span class="token punctuation">(</span><span class="token string">&#39;password&#39;</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        ElMessage<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&#39;错误, 请输入正确的格式！&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="实现获取登录用户详细信息-包括角色权限菜单" tabindex="-1"><a class="header-anchor" href="#实现获取登录用户详细信息-包括角色权限菜单" aria-hidden="true">#</a> 实现获取登录用户详细信息（包括角色权限菜单）</h3><h4 id="封装-axios-接口请求" tabindex="-1"><a class="header-anchor" href="#封装-axios-接口请求" aria-hidden="true">#</a> 封装 axios 接口请求</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 获取用户详细信息</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getUserInfoById</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> hyRequest<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/users/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
        <span class="token comment">// headers: {</span>
        <span class="token comment">//     Authorization: &#39;Bearer &#39; + localCache.getCache(&#39;token&#39;)</span>
        <span class="token comment">// }</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 获取角色权限信息</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getUserMenusByRoleId</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> hyRequest<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/role/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/menu</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="使用-pinia-存储请求数据" tabindex="-1"><a class="header-anchor" href="#使用-pinia-存储请求数据" aria-hidden="true">#</a> 使用 pinia 存储请求数据</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">interface</span> <span class="token class-name">ILoginState</span> <span class="token punctuation">{</span>
    token<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
    userInfo<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span>
    userMenus<span class="token operator">:</span> <span class="token builtin">any</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> useLoginStore <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token string">&#39;login&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    state<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> ILoginState <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
        token<span class="token operator">:</span> localCache<span class="token punctuation">.</span><span class="token function">getCache</span><span class="token punctuation">(</span><span class="token string">&#39;token&#39;</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
        userInfo<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        userMenus<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

    actions<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token keyword">async</span> <span class="token function">loginAccountAction</span><span class="token punctuation">(</span>account<span class="token operator">:</span> IAccount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 1. 帐号登录，axios获取token等信息</span>
            <span class="token keyword">const</span> loginResult <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">accountLogin</span><span class="token punctuation">(</span>account<span class="token punctuation">)</span>
            <span class="token keyword">const</span> id <span class="token operator">=</span> loginResult<span class="token punctuation">.</span>data<span class="token punctuation">.</span>id
            <span class="token keyword">this</span><span class="token punctuation">.</span>token <span class="token operator">=</span> loginResult<span class="token punctuation">.</span>data<span class="token punctuation">.</span>token

            <span class="token comment">// 2. 进行本地缓存（使用封装的cache工具）</span>
            localCache<span class="token punctuation">.</span><span class="token function">setCache</span><span class="token punctuation">(</span><span class="token string">&#39;token&#39;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>token<span class="token punctuation">)</span>

            <span class="token comment">// 3.获取登录用户的详细信息（role角色信息）</span>
            <span class="token keyword">const</span> userInfoResult <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getUserInfoById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>userInfo <span class="token operator">=</span> userInfoResult<span class="token punctuation">.</span>data

            <span class="token comment">// 4.根据角色请求用户的权限（菜单menus）</span>
            <span class="token keyword">const</span> userMenusResult <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getUserMenusByRoleId</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>userInfo<span class="token punctuation">.</span>role<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>userMenus <span class="token operator">=</span> userMenusResult<span class="token punctuation">.</span>data

            <span class="token comment">//  页面跳转</span>
            router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&#39;/main&#39;</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> useLoginStore
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="实现主页左侧导航栏" tabindex="-1"><a class="header-anchor" href="#实现主页左侧导航栏" aria-hidden="true">#</a> 实现主页左侧导航栏</h2><p><img src="https://nevermore-picbed-1304219157.cos.ap-guangzhou.myqcloud.com/image_Omxnqoo1Oj.png" alt=""></p><h3 id="整体容器布局" tabindex="-1"><a class="header-anchor" href="#整体容器布局" aria-hidden="true">#</a> 整体容器布局</h3><p>使用<code>el-container</code>包裹侧边栏容器<code>el-aside</code>以及包裹<code>el-header</code>顶栏容器和<code>el-main</code>主要区域容器。</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>main<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-container</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>main-content<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      // 左侧导航栏
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-aside</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>210px<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>main-menu</span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-aside</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-container</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-header</span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>50px<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Header<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-header</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-main</span><span class="token punctuation">&gt;</span></span>
          // 路由占位
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-main</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-container</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-container</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>less<span class="token punctuation">&quot;</span></span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">.main</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>

  <span class="token selector">.main-content</span> <span class="token punctuation">{</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>

    <span class="token selector">.el-aside</span> <span class="token punctuation">{</span>
      <span class="token property">overflow-x</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>
      <span class="token property">overflow-y</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>
      <span class="token property">line-height</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span>
      <span class="token property">text-align</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>
      <span class="token property">cursor</span><span class="token punctuation">:</span> pointer<span class="token punctuation">;</span>
      <span class="token property">background-color</span><span class="token punctuation">:</span> #001529<span class="token punctuation">;</span>
      <span class="token property">transition</span><span class="token punctuation">:</span> width 0.3s linear<span class="token punctuation">;</span>
      <span class="token property">scrollbar-width</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span> <span class="token comment">/* firefox */</span>
      <span class="token property">-ms-overflow-style</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span> <span class="token comment">/* IE 10+ */</span>

      <span class="token selector">&amp;::-webkit-scrollbar</span> <span class="token punctuation">{</span>
        <span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token selector">.el-main</span> <span class="token punctuation">{</span>
      <span class="token property">background-color</span><span class="token punctuation">:</span> #f0f2f5<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="实现左侧导航栏静态布局" tabindex="-1"><a class="header-anchor" href="#实现左侧导航栏静态布局" aria-hidden="true">#</a> 实现左侧导航栏静态布局</h3><p>使用<code>elementUI</code>中菜单<code>menu</code>组件由<code>el-menu</code>、<code>el-sub-menu</code>（需要使用插槽）、<code>el-menu-item</code>组成。</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>main-menu<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>logo<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>img<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@/assets/img/logo.svg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>图标<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>后台管理系统<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>menu<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-menu</span>
        <span class="token attr-name">:default-active</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>defaultValue<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">:collapse</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>isFold<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">text-color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#b7bdc3<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">active-text-color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#fff<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">background-color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#001529<span class="token punctuation">&quot;</span></span>
      <span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-sub-menu</span> <span class="token attr-name">index</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token comment">&lt;!-- 插槽 --&gt;</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">#title</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-icon</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Monitor</span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-icon</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>系统总览<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-menu-item</span><span class="token punctuation">&gt;</span></span>核心技术<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-menu-item</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-menu-item</span><span class="token punctuation">&gt;</span></span>商品统计<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-menu-item</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-sub-menu</span><span class="token punctuation">&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-sub-menu</span> <span class="token attr-name">index</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">#title</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-icon</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>location</span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-icon</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>系统管理<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-menu-item</span><span class="token punctuation">&gt;</span></span>用户管理<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-menu-item</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-menu-item</span><span class="token punctuation">&gt;</span></span>部门管理<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-menu-item</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-menu-item</span><span class="token punctuation">&gt;</span></span>菜单管理<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-menu-item</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-menu-item</span><span class="token punctuation">&gt;</span></span>角色管理<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-menu-item</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-sub-menu</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-menu</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>less<span class="token punctuation">&quot;</span></span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">.main-menu</span> <span class="token punctuation">{</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #001529<span class="token punctuation">;</span>

  <span class="token selector">.logo</span> <span class="token punctuation">{</span>
    <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 28px<span class="token punctuation">;</span>
    <span class="token property">padding</span><span class="token punctuation">:</span> 12px 10px 8px 10px<span class="token punctuation">;</span>
    <span class="token property">flex-direction</span><span class="token punctuation">:</span> row<span class="token punctuation">;</span>
    <span class="token property">justify-content</span><span class="token punctuation">:</span> flex-start<span class="token punctuation">;</span>
    <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>

    <span class="token selector">.img</span> <span class="token punctuation">{</span>
      <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
      <span class="token property">margin</span><span class="token punctuation">:</span> 0 10px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token selector">.title</span> <span class="token punctuation">{</span>
      <span class="token property">font-size</span><span class="token punctuation">:</span> 16px<span class="token punctuation">;</span>
      <span class="token property">font-weight</span><span class="token punctuation">:</span> 700<span class="token punctuation">;</span>
      <span class="token property">color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span>
      <span class="token property">white-space</span><span class="token punctuation">:</span> nowrap<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token selector">.el-menu</span> <span class="token punctuation">{</span>
  <span class="token property">border-right</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  <span class="token property">user-select</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.el-sub-menu</span> <span class="token punctuation">{</span>
  <span class="token selector">.el-menu-item</span> <span class="token punctuation">{</span>
    <span class="token property">padding-left</span><span class="token punctuation">:</span> 50px <span class="token important">!important</span><span class="token punctuation">;</span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> #0c2135<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token selector">.el-menu-item:hover</span> <span class="token punctuation">{</span>
    <span class="token property">color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token selector">.el-menu-item.is-active</span> <span class="token punctuation">{</span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> #0a60bd<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="实现左侧导航栏动态展示效果" tabindex="-1"><a class="header-anchor" href="#实现左侧导航栏动态展示效果" aria-hidden="true">#</a> 实现左侧导航栏动态展示效果</h3><p>首先将用户详细信息，权限信息缓存处理（刷新时依然存在），然后使用<code>&lt;template v-for=&quot;&quot;&gt;</code>、<code>mustache</code>表达式动态遍历即可。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 登录时store缓存用户权限信息</span>
state<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> ILoginState <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    userInfo<span class="token operator">:</span> localCache<span class="token punctuation">.</span><span class="token function">getCache</span><span class="token punctuation">(</span><span class="token string">&#39;userInfo&#39;</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    userMenus<span class="token operator">:</span> localCache<span class="token punctuation">.</span><span class="token function">getCache</span><span class="token punctuation">(</span><span class="token string">&#39;userMenus&#39;</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
actions<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token keyword">async</span> <span class="token function">loginAccountAction</span><span class="token punctuation">(</span>account<span class="token operator">:</span> IAccount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// ....</span>
        <span class="token comment">// 进行用户权限信息缓存</span>
        localCache<span class="token punctuation">.</span><span class="token function">setCache</span><span class="token punctuation">(</span><span class="token string">&#39;userInfo&#39;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>userInfo<span class="token punctuation">)</span>
        localCache<span class="token punctuation">.</span><span class="token function">setCache</span><span class="token punctuation">(</span><span class="token string">&#39;userMenus&#39;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>userMenus<span class="token punctuation">)</span>

        <span class="token comment">//  页面跳转</span>
        router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&#39;/main&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>main-menu<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>logo<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>img<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@/assets/img/logo.svg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>图标<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>后台管理系统<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>menu<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-menu</span>
        <span class="token attr-name">:default-active</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>defaultValue<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">:collapse</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>isFold<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">text-color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#b7bdc3<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">active-text-color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#fff<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">background-color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#001529<span class="token punctuation">&quot;</span></span>
      <span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item in userMenus<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item.id<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token comment">&lt;!-- 子菜单 --&gt;</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-sub-menu</span> <span class="token attr-name">:index</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item.id + &#39;&#39;<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">#title</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>{{ item.name }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

            <span class="token comment">&lt;!-- 子菜单的每一项 --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>subItem in item.children<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>subItem.id<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-menu-item</span> <span class="token attr-name">:index</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>subItem.id + &#39;&#39;<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handleItemClick(subItem)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ subItem.name }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-menu-item</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-sub-menu</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-menu</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> useLoginStore <span class="token keyword">from</span> <span class="token string">&#39;@/store/login/login&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> loginStore <span class="token operator">=</span> <span class="token function">useLoginStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> userMenus <span class="token operator">=</span> loginStore<span class="token punctuation">.</span>userMenus

<span class="token keyword">function</span> <span class="token function">handleItemClick</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">subItem</span><span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> url <span class="token operator">=</span> subItem<span class="token punctuation">.</span>url
  router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="导航栏图标的动态组件-细节处理" tabindex="-1"><a class="header-anchor" href="#导航栏图标的动态组件-细节处理" aria-hidden="true">#</a> 导航栏图标的动态组件（细节处理）</h3><p>服务器返回的是字符串<code>el-icon-monitor</code>，需要使用动态组件<code>componet</code>来处理图标字符串并且使用<code>split</code>函数分隔字符串。</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token comment">&lt;!-- 子菜单 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-sub-menu</span> <span class="token attr-name">:index</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item.id + &#39;&#39;<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">#title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-icon</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>component</span> <span class="token attr-name">:is</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item.icon.split(&#39;-icon-&#39;)[1]<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-icon</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>{{ item.name }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
  //.......
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-sub-menu</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="导航栏注册所有静态路由-有缺陷" tabindex="-1"><a class="header-anchor" href="#导航栏注册所有静态路由-有缺陷" aria-hidden="true">#</a> 导航栏注册所有静态路由（有缺陷）</h3><p>当用户没有权限时，可以手动在地址栏输入 url 去访问没有权限的页面。后面使用动态路由。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token punctuation">{</span>
  path<span class="token operator">:</span> <span class="token string">&#39;/main&#39;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&#39;../views/main/Main.vue&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  children<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      path<span class="token operator">:</span> <span class="token string">&#39;/main/analysis/overview&#39;</span><span class="token punctuation">,</span>
      <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&#39;../views/main/analysis/overview/overview.vue&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      path<span class="token operator">:</span> <span class="token string">&#39;/main/analysis/dashboard&#39;</span><span class="token punctuation">,</span>
      <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&#39;../views/main/analysis/dashboard/dashboard.vue&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      path<span class="token operator">:</span> <span class="token string">&#39;/main/system/role&#39;</span><span class="token punctuation">,</span>
      <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&#39;../views/main/system/role/role.vue&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      path<span class="token operator">:</span> <span class="token string">&#39;/main/system/user&#39;</span><span class="token punctuation">,</span>
      <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&#39;../views/main/system/user/user.vue&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="实现主页头部面包屑" tabindex="-1"><a class="header-anchor" href="#实现主页头部面包屑" aria-hidden="true">#</a> 实现主页头部面包屑</h2><p><img src="https://nevermore-picbed-1304219157.cos.ap-guangzhou.myqcloud.com/image_Or2gIT2k8K.png" alt=""></p><h3 id="搭建整体布局" tabindex="-1"><a class="header-anchor" href="#搭建整体布局" aria-hidden="true">#</a> 搭建整体布局</h3><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>main-header<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>menu-icon<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handleMenuIconClick<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-icon</span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>28px<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-icon</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Fold</span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-icon</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-icon</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>content<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>breadcrumb<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>面包屑<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>info<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>个人信息<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>less<span class="token punctuation">&quot;</span></span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">.main-header</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token property">flex</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>

  <span class="token selector">.menu-icon</span> <span class="token punctuation">{</span>
    <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
    <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">cursor</span><span class="token punctuation">:</span> pointer<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token selector">.content</span> <span class="token punctuation">{</span>
    <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
    <span class="token property">justify-content</span><span class="token punctuation">:</span> space-between<span class="token punctuation">;</span>
    <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">flex</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>
    <span class="token property">padding</span><span class="token punctuation">:</span> 0 18px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="实现头部左侧图标点击折叠功能" tabindex="-1"><a class="header-anchor" href="#实现头部左侧图标点击折叠功能" aria-hidden="true">#</a> 实现头部左侧图标点击折叠功能</h3><p>由<code>main-header</code>子组件通过<code>defineEmits</code>将折叠状态<code>isFold</code>传入给父组件<code>main</code>中的<code>el-aside</code>从而控制其宽度。</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token comment">&lt;!-- main-header.vue --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>main-header<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>menu-icon<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handleMenuIconClick<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-icon</span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>28px<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>component</span> <span class="token attr-name">:is</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>isFold ? &#39;Expand&#39; : &#39;Fold&#39;<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-icon</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>content<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>breadcrumb<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>面包屑<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>info<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>个人信息<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// 1.内部自定义事件</span>
<span class="token keyword">const</span> emit <span class="token operator">=</span> <span class="token function">defineEmits</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;foldChange&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment">// 2.记录折叠状态</span>
<span class="token keyword">const</span> isFold <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">handleMenuIconClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 3.子组件内部改变状态</span>
  isFold<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token operator">!</span>isFold<span class="token punctuation">.</span>value

  <span class="token comment">// 4.将事件和状态传递给父组件</span>
  <span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&#39;foldChange&#39;</span><span class="token punctuation">,</span> isFold<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>父组件在定义<code>main-header</code>上通过<code>@fold-change</code>接收子组件传来的<code>emit(&#39;foldChange&#39;, isFold.value)</code>。</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token comment">&lt;!-- main.vue --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>main<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-container</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>main-content<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-aside</span> <span class="token attr-name">:width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>isFold ? &#39;60px&#39; : &#39;210px&#39;<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- 父传子（defineProps） --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>main-menu</span> <span class="token attr-name">:is-fold</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>isFold<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-aside</span><span class="token punctuation">&gt;</span></span>

      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-container</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-header</span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>50px<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token comment">&lt;!-- emit子传父（defineEmits） --&gt;</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>main-header</span> <span class="token attr-name">@fold-change</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handleFoldChange<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-header</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-main</span><span class="token punctuation">&gt;</span></span>Main<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-main</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-container</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-container</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> localCache <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/utils/cache&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useRouter <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue-router&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> MainMenu <span class="token keyword">from</span> <span class="token string">&#39;@/components/main-menu/main-menu.vue&#39;</span>
<span class="token keyword">import</span> MainHeader <span class="token keyword">from</span> <span class="token string">&#39;@/components/main-header/main-header.vue&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> isFold <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">handleFoldChange</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">isFoldValue</span><span class="token operator">:</span> boolean</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  isFold<span class="token punctuation">.</span>value <span class="token operator">=</span> isFoldValue
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>父组件通过子组件的<code>defineProps</code>将<code>:is-fold=&quot;isFold&quot;</code>折叠状态传入到<code>el-menu</code>的属性<code>:collapse</code>上，从而控制<code>menu</code>菜单的折叠。</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token comment">&lt;!-- main-menu.vue --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>main-menu<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    // ....
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>menu<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      &lt;el-menu
        // ....
        :collapse=&quot;isFold&quot;
      &gt;
      // ....
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-menu</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token function">defineProps</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">isFold</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> Boolean<span class="token punctuation">,</span>
    <span class="token keyword">default</span><span class="token operator">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="实现头部右侧个人信息功能" tabindex="-1"><a class="header-anchor" href="#实现头部右侧个人信息功能" aria-hidden="true">#</a> 实现头部右侧个人信息功能</h3><h4 id="静态布局搭建-包含注销功能" tabindex="-1"><a class="header-anchor" href="#静态布局搭建-包含注销功能" aria-hidden="true">#</a> 静态布局搭建（包含注销功能）</h4><p>使用<code>el-dropdown</code>下拉菜单组件，这里要调节下拉框的样式需要加<code>:global</code>（原因：它不在 app 父组件下，它在与 app 同级的组件 el-popper-container 下）</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>header-info<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>operation<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-icon</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bell</span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-icon</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-icon</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ChatDotRound</span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-icon</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dot<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-icon</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Postcard</span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-icon</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>info<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-dropdown</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user-info<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-avatar</span> <span class="token attr-name">:size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>30<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>avatar<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://xumingyu2018.github.io/avatar.png<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ loginStore.userInfo.name }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">#dropdown</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-dropdown-menu</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-dropdown-item</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handleExitClick<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-icon</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>CircleCloseFilled</span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-icon</span><span class="token punctuation">&gt;</span></span>
              注销
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-dropdown-item</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-dropdown-item</span> <span class="token attr-name">divided</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-icon</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>InfoFilled</span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-icon</span><span class="token punctuation">&gt;</span></span>
              个人信息
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-dropdown-item</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-dropdown-item</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-icon</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Unlock</span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-icon</span><span class="token punctuation">&gt;</span></span>
              修改密码
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-dropdown-item</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-dropdown-menu</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-dropdown</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> useRouter <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue-router&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> localCache <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/utils/cache&#39;</span>
<span class="token keyword">import</span> useLoginStore <span class="token keyword">from</span> <span class="token string">&#39;@/store/login/login&#39;</span>

<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">useRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">handleExitClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  localCache<span class="token punctuation">.</span><span class="token function">deleteCache</span><span class="token punctuation">(</span><span class="token string">&#39;token&#39;</span><span class="token punctuation">)</span>
  localCache<span class="token punctuation">.</span><span class="token function">deleteCache</span><span class="token punctuation">(</span><span class="token string">&#39;userInfo&#39;</span><span class="token punctuation">)</span>
  localCache<span class="token punctuation">.</span><span class="token function">deleteCache</span><span class="token punctuation">(</span><span class="token string">&#39;userMenus&#39;</span><span class="token punctuation">)</span>
  router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&#39;/login&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 显示用户名称信息</span>
<span class="token keyword">const</span> loginStore <span class="token operator">=</span> <span class="token function">useLoginStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>less<span class="token punctuation">&quot;</span></span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">.header-info</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.operation</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> inline-flex<span class="token punctuation">;</span>
  <span class="token property">margin-right</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
  <span class="token selector">span</span> <span class="token punctuation">{</span>
    <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
    <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
    <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 40px<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 35px<span class="token punctuation">;</span>

    <span class="token selector">&amp;:hover</span> <span class="token punctuation">{</span>
      <span class="token property">background</span><span class="token punctuation">:</span> #f2f2f2<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token selector">i</span> <span class="token punctuation">{</span>
      <span class="token property">font-size</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token selector">.dot</span> <span class="token punctuation">{</span>
      <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
      <span class="token property">top</span><span class="token punctuation">:</span> 3px<span class="token punctuation">;</span>
      <span class="token property">right</span><span class="token punctuation">:</span> 3px<span class="token punctuation">;</span>
      <span class="token property">z-index</span><span class="token punctuation">:</span> 10<span class="token punctuation">;</span>
      <span class="token property">width</span><span class="token punctuation">:</span> 6px<span class="token punctuation">;</span>
      <span class="token property">height</span><span class="token punctuation">:</span> 6px<span class="token punctuation">;</span>
      <span class="token property">background</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>
      <span class="token property">border-radius</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token selector">.user-info</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token property">cursor</span><span class="token punctuation">:</span> pointer<span class="token punctuation">;</span>

  <span class="token selector">.name</span> <span class="token punctuation">{</span>
    <span class="token property">margin-left</span><span class="token punctuation">:</span> 8px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token selector">.info</span> <span class="token punctuation">{</span>
  <span class="token selector">// 使用global的原因是因为它不在app父组件下，它在与app同级的组件el-popper-container下
  :global(.el-dropdown-menu__item)</span> <span class="token punctuation">{</span>
    <span class="token property">line-height</span><span class="token punctuation">:</span> 36px <span class="token important">!important</span><span class="token punctuation">;</span>
    <span class="token property">padding</span><span class="token punctuation">:</span> 6px 22px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="动态路由" tabindex="-1"><a class="header-anchor" href="#动态路由" aria-hidden="true">#</a> 动态路由</h2><p><img src="https://nevermore-picbed-1304219157.cos.ap-guangzhou.myqcloud.com/image_Or2gIT2k8K.png" alt=""></p><p>本文采用基于菜单的动态路由管理实现（结合 coderwhy 全局工具）。</p><h3 id="安装自动化生成路由配置信息和-vue-页面的工具" tabindex="-1"><a class="header-anchor" href="#安装自动化生成路由配置信息和-vue-页面的工具" aria-hidden="true">#</a> 安装自动化生成路由配置信息和 vue 页面的工具</h3><p><code>npm install coderwhy -g</code></p><h3 id="使用-coderwhy-工具" tabindex="-1"><a class="header-anchor" href="#使用-coderwhy-工具" aria-hidden="true">#</a> 使用 coderwhy 工具</h3><p>例：<code>coderwhy add3page_setup list -d src/views/main/story/list</code></p><p><code>add3page_setup</code>：针对 vue3 的 setup 语法。</p><p><code>-d</code>：生成指定文件的地址。</p><p><code>list</code>：生成的路由名字和 vue 页面名字。</p><h3 id="编写菜单映射路由工具类" tabindex="-1"><a class="header-anchor" href="#编写菜单映射路由工具类" aria-hidden="true">#</a> 编写菜单映射路由工具类</h3><ol><li>根据菜单映射对应的路由。</li><li>进入主页匹配第一个菜单的路由。</li></ol><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// utils/map-menus.ts</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> RouteRecordRaw <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue-router&quot;</span>

<span class="token comment">// 自动化加载所有的路由（也可以收到写死）</span>
<span class="token keyword">function</span> <span class="token function">loadLocalRoutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 1.加载所有的模板</span>
  <span class="token keyword">const</span> modules<span class="token operator">:</span> Record<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span><span class="token function">glob</span><span class="token punctuation">(</span><span class="token string">&#39;../router/main/**/*.ts&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> eager<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token comment">// 2.遍历所有的模板为路由对象</span>
  <span class="token keyword">const</span> routes<span class="token operator">:</span> RouteRecordRaw<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> modules<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> route <span class="token operator">=</span> modules<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">.</span>default
    routes<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>route<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> routes
<span class="token punctuation">}</span>

<span class="token comment">// 记录第一个菜单信息</span>
<span class="token keyword">export</span> <span class="token keyword">let</span> firstMenu<span class="token operator">:</span> <span class="token builtin">any</span> <span class="token operator">=</span> <span class="token keyword">null</span>
<span class="token comment">/**
 * 映射菜单到路由
 * @param menus 菜单
 * @returns 路由
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">mapMenuToRoutes</span><span class="token punctuation">(</span>menus<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 1.加载所有的路由对象</span>
    <span class="token keyword">const</span> loadRoutes <span class="token operator">=</span> <span class="token function">loadLocalRoutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment">// 2.根据菜单获取需要添加的路由对象</span>
    <span class="token keyword">const</span> finalRoutes<span class="token operator">:</span> RouteRecordRaw<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">const</span> menu <span class="token keyword">of</span> menus<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">const</span> submenu <span class="token keyword">of</span> menu<span class="token punctuation">.</span>children<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> route <span class="token operator">=</span> loadRoutes<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>route <span class="token operator">=&gt;</span> route<span class="token punctuation">.</span>path <span class="token operator">===</span> submenu<span class="token punctuation">.</span>url<span class="token punctuation">)</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>route<span class="token punctuation">)</span> finalRoutes<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>route<span class="token punctuation">)</span>

            <span class="token comment">// 记录第一个被匹配菜单</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>firstMenu <span class="token operator">&amp;&amp;</span> route<span class="token punctuation">)</span> firstMenu <span class="token operator">=</span> submenu
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> finalRoutes
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="有弊端-登录时调用工具类" tabindex="-1"><a class="header-anchor" href="#有弊端-登录时调用工具类" aria-hidden="true">#</a> (有弊端)登录时调用工具类</h3><p>在发送登录请求时，使用<code>router.addRoute(&#39;main&#39;, route)</code>将菜单信息<code>userMenus</code>里的路由和全部注册进<code>loadLocalRoutes</code>匹配时调用。</p><p>弊端：刷新时路由注册不了，代码重新执行时，动态路由就加载不了，因为只有点击登录按钮时才会执行该代码。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// store/login/login.ts</span>
<span class="token keyword">interface</span> <span class="token class-name">ILoginState</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    userMenus<span class="token operator">:</span> <span class="token builtin">any</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> useLoginStore <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token string">&#39;login&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    state<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> ILoginState <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token comment">// ...</span>
        userMenus<span class="token operator">:</span> localCache<span class="token punctuation">.</span><span class="token function">getCache</span><span class="token punctuation">(</span><span class="token string">&#39;userMenus&#39;</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

    actions<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token keyword">async</span> <span class="token function">loginAccountAction</span><span class="token punctuation">(</span>account<span class="token operator">:</span> IAccount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// ...</span>
            <span class="token comment">// 6.根据菜单menu动态加载路由(使用工具类map-menus.ts)，刷新时这段代码不会重新执行，因为只有点击登录按钮时才会执行该代码。</span>
            <span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token function">mapMenuToRoutes</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>userMenus<span class="token punctuation">)</span>
            <span class="token comment">// 这里的&#39;main&#39;是根据路由里的name属性来的</span>
            routes<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>route <span class="token operator">=&gt;</span> router<span class="token punctuation">.</span><span class="token function">addRoute</span><span class="token punctuation">(</span><span class="token string">&#39;main&#39;</span><span class="token punctuation">,</span> route<span class="token punctuation">)</span><span class="token punctuation">)</span>

            <span class="token comment">//  页面跳转</span>
            router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&#39;/main&#39;</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> useLoginStore
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>router.addRoute(&#39;main&#39;, route)</code>里的 main 是需要在路由表中设置<code>name</code>属性。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">createRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  history<span class="token operator">:</span> <span class="token function">createWebHashHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  routes<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// ...</span>
    <span class="token punctuation">{</span>
      path<span class="token operator">:</span> <span class="token string">&#39;/main&#39;</span><span class="token punctuation">,</span>
      name<span class="token operator">:</span> <span class="token string">&#39;main&#39;</span><span class="token punctuation">,</span>
      <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&#39;@/views/main/Main.vue&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token comment">// 以下替换成动态注册路由的方法(也可以不使用工具类，在这里全部路由写死)</span>
      <span class="token comment">// children: [</span>
      <span class="token comment">//   {</span>
      <span class="token comment">//     path: &#39;/main/analysis/overview&#39;,</span>
      <span class="token comment">//     component: () =&gt; import(&#39;../views/main/analysis/overview/overview.vue&#39;)</span>
      <span class="token comment">//   },</span>
      <span class="token comment">//   {</span>
      <span class="token comment">//     path: &#39;/main/analysis/dashboard&#39;,</span>
      <span class="token comment">//     component: () =&gt; import(&#39;../views/main/analysis/dashboard/dashboard.vue&#39;)</span>
      <span class="token comment">//   },</span>
      <span class="token comment">// ]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// ....</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> router
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="改进-使用全局加载数据方法" tabindex="-1"><a class="header-anchor" href="#改进-使用全局加载数据方法" aria-hidden="true">#</a> (改进)使用全局加载数据方法</h3><p>不再仅限于在登录时调用<code>mapMenuToRoutes</code>工具类，而在全局当刷新页面时调用。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> useLoginStore <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token string">&#39;login&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    state<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> ILoginState <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
        token<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
        userInfo<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        userMenus<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

    actions<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token keyword">async</span> <span class="token function">loginAccountAction</span><span class="token punctuation">(</span>account<span class="token operator">:</span> IAccount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// ....</span>
            router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&#39;/main&#39;</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>

        <span class="token comment">// 解决刷新页面后，动态路由丢失的问题(不再是loginAccountAction登录时才执行)</span>
        <span class="token function">loadLocalDataAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 用户进行刷新时默认加载数据</span>
            <span class="token keyword">const</span> token <span class="token operator">=</span> localCache<span class="token punctuation">.</span><span class="token function">getCache</span><span class="token punctuation">(</span><span class="token string">&#39;token&#39;</span><span class="token punctuation">)</span>
            <span class="token keyword">const</span> userInfo <span class="token operator">=</span> localCache<span class="token punctuation">.</span><span class="token function">getCache</span><span class="token punctuation">(</span><span class="token string">&#39;userInfo&#39;</span><span class="token punctuation">)</span>
            <span class="token keyword">const</span> userMenus <span class="token operator">=</span> localCache<span class="token punctuation">.</span><span class="token function">getCache</span><span class="token punctuation">(</span><span class="token string">&#39;userMenus&#39;</span><span class="token punctuation">)</span>

            <span class="token keyword">if</span><span class="token punctuation">(</span>token <span class="token operator">&amp;&amp;</span> userInfo <span class="token operator">&amp;&amp;</span> userMenus<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>token <span class="token operator">=</span> token
                <span class="token keyword">this</span><span class="token punctuation">.</span>userInfo <span class="token operator">=</span> userInfo
                <span class="token keyword">this</span><span class="token punctuation">.</span>userMenus <span class="token operator">=</span> userMenus
                <span class="token comment">// 6.根据菜单menu动态加载路由(使用工具类map-menus.ts)</span>
                <span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token function">mapMenuToRoutes</span><span class="token punctuation">(</span>userMenus<span class="token punctuation">)</span>
                <span class="token comment">// 这里的&#39;main&#39;是根据路由里的name属性来的</span>
                routes<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>route <span class="token operator">=&gt;</span> router<span class="token punctuation">.</span><span class="token function">addRoute</span><span class="token punctuation">(</span><span class="token string">&#39;main&#39;</span><span class="token punctuation">,</span> route<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在 App 组件中调用<code>loadLocalDataAction</code>方法，注意：此方法一定要放在<code>app.router</code>之前执行。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">createApp</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>pinia<span class="token punctuation">)</span>
<span class="token keyword">const</span> loginStore <span class="token operator">=</span> <span class="token function">useLoginStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
loginStore<span class="token punctuation">.</span><span class="token function">loadLocalDataAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>registerIcons<span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">&#39;#app&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以将<code>loadLocalDataAction</code>方法封装进<code>pinia</code>导出的地方，从而使用<code>app.use()</code>方法注册进全局 App 组件。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">//store/index.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createPinia <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;pinia&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> useLoginStore <span class="token keyword">from</span> <span class="token string">&quot;./login/login&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> pinia <span class="token operator">=</span> <span class="token function">createPinia</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">registerStore</span><span class="token punctuation">(</span>app<span class="token operator">:</span> App<span class="token operator">&lt;</span>Element<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>pinia<span class="token punctuation">)</span>

    <span class="token comment">// 加载本地缓存数据</span>
    <span class="token keyword">const</span> loginStore <span class="token operator">=</span> <span class="token function">useLoginStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    loginStore<span class="token punctuation">.</span><span class="token function">loadLocalDataAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> registerStore

<span class="token comment">// App.vue</span>
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">&#39;./store&#39;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>registerIcons<span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">&#39;#app&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="进入主页时匹配第一个菜单" tabindex="-1"><a class="header-anchor" href="#进入主页时匹配第一个菜单" aria-hidden="true">#</a> 进入主页时匹配第一个菜单</h3><p>从<code>mapMenuToRoutes</code>工具类中获取<code>firstMenu</code>第一个菜单，在路由导航守卫中判断。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> firstMenu <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/utils/map-menus&#39;</span>

<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">createRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  history<span class="token operator">:</span> <span class="token function">createWebHashHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  routes<span class="token operator">:</span> <span class="token comment">// ....</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>to<span class="token punctuation">,</span> from<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// ....</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>to<span class="token punctuation">.</span>path <span class="token operator">===</span> <span class="token string">&#39;/main&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> firstMenu<span class="token punctuation">.</span>url
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> router
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="刷新页面时-菜单默认值问题" tabindex="-1"><a class="header-anchor" href="#刷新页面时-菜单默认值问题" aria-hidden="true">#</a> 刷新页面时，菜单默认值问题</h3><p>根据路由的<code>url</code>路径，映射对应菜单<code>menu</code>（需要一个路由映射菜单的工具类），从而获得<code>menu</code>的<code>id</code>属性，将<code>el-menu</code>组件属性<code>:default-active=&quot;defaultValue&quot;</code>的<code>defaultValue</code>动态绑定给<code>menu.id</code>。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// utils/map-menus.ts</span>
<span class="token comment">/**
 * 映射路由到菜单工具类
 * @param path 路由url
 * @param menus 菜单
 * @returns 菜单
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">mapPathToMenu</span><span class="token punctuation">(</span>menus<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> path<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> menu <span class="token keyword">of</span> menus<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> submenu <span class="token keyword">of</span> menu<span class="token punctuation">.</span>children<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>path <span class="token operator">===</span> submenu<span class="token punctuation">.</span>url<span class="token punctuation">)</span> <span class="token keyword">return</span> submenu
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token comment">&lt;!-- main-menu.vue --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>main-menu<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    // ....
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>menu<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      &lt;el-menu
        :default-active=&quot;defaultValue&quot;
        // ....
      &gt;
      // .....
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-menu</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> mapPathToMenu <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/utils/map-menus&#39;</span><span class="token punctuation">;</span>
<span class="token comment">// .....</span>

<span class="token comment">// 1.存放动态的菜单</span>
<span class="token keyword">const</span> loginStore <span class="token operator">=</span> <span class="token function">useLoginStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> userMenus <span class="token operator">=</span> loginStore<span class="token punctuation">.</span>userMenus

<span class="token comment">// 3.页面刷新时，根据当前的路由地址，设置默认选中的菜单项(默认值问题)</span>
<span class="token keyword">const</span> route <span class="token operator">=</span> <span class="token function">useRoute</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> defaultValue <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> currentMenu <span class="token operator">=</span> <span class="token function">mapPathToMenu</span><span class="token punctuation">(</span>userMenus<span class="token punctuation">,</span> route<span class="token punctuation">.</span>path<span class="token punctuation">)</span>
  <span class="token keyword">return</span> currentMenu<span class="token punctuation">.</span>id <span class="token operator">+</span> <span class="token string">&#39;&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="实现面包屑功能" tabindex="-1"><a class="header-anchor" href="#实现面包屑功能" aria-hidden="true">#</a> 实现面包屑功能</h2><p><img src="https://nevermore-picbed-1304219157.cos.ap-guangzhou.myqcloud.com/image_OrlIEIPhXw.png" alt=""></p><h3 id="搭建面包屑页面" tabindex="-1"><a class="header-anchor" href="#搭建面包屑页面" aria-hidden="true">#</a> 搭建面包屑页面</h3><p>使用<code>el-breadcrumb</code>搭建面包屑页面，使用工具类<code>mapPathToBreadCrumb</code>将菜单<code>menu</code>以及子菜单<code>submenu</code>放入<code>breadcrumb</code>数组，用于动态遍历<code>el-breadcrumb</code>。</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token comment">&lt;!-- header-crumb.vue --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>header-crumb<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-breadcrumb</span> <span class="token attr-name">separator-icon</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ArrowRight<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>(item, index) in breadcrumb<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>index<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-breadcrumb-item</span> <span class="token attr-name">:to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>item.url</span><span class="token punctuation">&gt;</span></span>{{ item.name }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-breadcrumb-item</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-breadcrumb</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> mapPathToBreadCrumb <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/utils/map-menus&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useRoute <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue-router&#39;</span>
<span class="token keyword">import</span> useLoginStore <span class="token keyword">from</span> <span class="token string">&#39;@/store/login/login&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> computed <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>

<span class="token keyword">const</span> route <span class="token operator">=</span> <span class="token function">useRoute</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> loginStore <span class="token operator">=</span> <span class="token function">useLoginStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 路径改变时，重新计算面包屑</span>
<span class="token keyword">const</span> breadcrumb <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">mapPathToBreadCrumb</span><span class="token punctuation">(</span>loginStore<span class="token punctuation">.</span>userMenus<span class="token punctuation">,</span> route<span class="token punctuation">.</span>path<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="路由映射面包屑工具类" tabindex="-1"><a class="header-anchor" href="#路由映射面包屑工具类" aria-hidden="true">#</a> 路由映射面包屑工具类</h3><p><code>mapPathToBreadCrumb</code>工具类</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// map-menus.ts</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">mapPathToBreadCrumb</span><span class="token punctuation">(</span>menus<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> path<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> breadCrumb<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> menu <span class="token keyword">of</span> menus<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> submenu <span class="token keyword">of</span> menu<span class="token punctuation">.</span>children<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>path <span class="token operator">===</span> submenu<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">{</span>
            breadCrumb<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>menu<span class="token punctuation">)</span>
            breadCrumb<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>submenu<span class="token punctuation">)</span>
            <span class="token keyword">return</span> breadCrumb
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="解决点击面包屑跳到目录下的第一个子目录问题" tabindex="-1"><a class="header-anchor" href="#解决点击面包屑跳到目录下的第一个子目录问题" aria-hidden="true">#</a> 解决点击面包屑跳到目录下的第一个子目录问题</h3><p><code>el-breadcrumb</code>的<code>:to=item.url</code>属性问题，修改工具类<code>mapMenuToRoutes</code>将根目录路径重定向到根目录下的第一个子目录。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">mapMenuToRoutes</span><span class="token punctuation">(</span>menus<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    <span class="token keyword">const</span> finalRoutes<span class="token operator">:</span> RouteRecordRaw<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">const</span> menu <span class="token keyword">of</span> menus<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">const</span> submenu <span class="token keyword">of</span> menu<span class="token punctuation">.</span>children<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// ....</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>route<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// 给route的顶层菜单增加重定向功能（但是只需要添加一次即可）</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>finalRoutes<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>path <span class="token operator">===</span> route<span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    finalRoutes<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> path<span class="token operator">:</span> menu<span class="token punctuation">.</span>url<span class="token punctuation">,</span> redirect<span class="token operator">:</span> route<span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
                finalRoutes<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>route<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// 记录第一个被匹配菜单</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>firstMenu <span class="token operator">&amp;&amp;</span> route<span class="token punctuation">)</span> firstMenu <span class="token operator">=</span> submenu
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> finalRoutes
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="实现主页中部-main-页面" tabindex="-1"><a class="header-anchor" href="#实现主页中部-main-页面" aria-hidden="true">#</a> 实现主页中部 main 页面</h2><p>主体页面<code>main</code>中包括三个部分表达搜索框<code>search</code>、内容部分的头部及表格数据。</p><h3 id="实现-search-表单搜索框界面" tabindex="-1"><a class="header-anchor" href="#实现-search-表单搜索框界面" aria-hidden="true">#</a> 实现 search 表单搜索框界面</h3><p><img src="https://nevermore-picbed-1304219157.cos.ap-guangzhou.myqcloud.com/image_8g3h9E3Wpj.png" alt=""></p><h4 id="搭建静态-search-表单搜索框界面" tabindex="-1"><a class="header-anchor" href="#搭建静态-search-表单搜索框界面" aria-hidden="true">#</a> 搭建静态 search 表单搜索框界面</h4><p>通过<code>layout</code>布局组件中的<code>el-row</code>和<code>el-col</code>对每行每列做布局，使用<code>el-form</code>表单组件包含的<code>el-input</code>输入框、<code>el-select</code>下拉选择以及<code>el-date-picker</code>日期选择器实现。</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token comment">&lt;!-- user/cpns/user-search.vue --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>search<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-form</span> <span class="token attr-name">label-width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>120px<span class="token punctuation">&quot;</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>large<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-row</span> <span class="token attr-name">:gutter</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>20<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-col</span> <span class="token attr-name">:span</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-form-item</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>用户名<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-input</span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>请输入查询的用户名<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-input</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-form-item</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-col</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-col</span> <span class="token attr-name">:span</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-form-item</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>真实姓名<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-input</span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>请输入查询的真实姓名<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-input</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-form-item</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-col</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-col</span> <span class="token attr-name">:span</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-form-item</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>电话号码<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-input</span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>请输入查询的电话号码<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-input</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-form-item</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-col</span><span class="token punctuation">&gt;</span></span>

            <span class="token comment">&lt;!-- 另起一行 --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-col</span> <span class="token attr-name">:span</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-form-item</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>状态<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-select</span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>请选择查询的状态<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-option</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>启用<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-option</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>禁用<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-select</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-form-item</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-col</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-col</span> <span class="token attr-name">:span</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-form-item</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>创建时间<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-date-picker</span>
                        <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>daterange<span class="token punctuation">&quot;</span></span>
                        <span class="token attr-name">range-separator</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>-<span class="token punctuation">&quot;</span></span>
                        <span class="token attr-name">start-placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>开始时间<span class="token punctuation">&quot;</span></span>
                        <span class="token attr-name">end-placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>结束时间<span class="token punctuation">&quot;</span></span>
                    <span class="token punctuation">/&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-form-item</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-col</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-row</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-form</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btns<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">icon</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Refresh<span class="token punctuation">&quot;</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>large<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>重置<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">icon</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Search<span class="token punctuation">&quot;</span></span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>large<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>primary<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>搜索<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">

</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>less<span class="token punctuation">&quot;</span></span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">.search</span> <span class="token punctuation">{</span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
    <span class="token property">padding</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>

    <span class="token selector">.el-form-item</span> <span class="token punctuation">{</span>
        <span class="token property">padding</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
        <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token selector">.btns</span> <span class="token punctuation">{</span>
        <span class="token property">text-align</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span>
        <span class="token property">padding</span><span class="token punctuation">:</span> 0 50px 10px 0<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>对日期选择器里的日期实现国际化。<a href="https://element-plus.gitee.io/zh-CN/guide/i18n.html" target="_blank" rel="noopener noreferrer">Element Plus<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 提供了一个 Vue 组件 <a href="https://element-plus.gitee.io/en-US/component/config-provider.html" target="_blank" rel="noopener noreferrer">ConfigProvider<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> （<code>el-config-provider</code>）用于全局配置国际化的设置。（需要包裹 App 组件）并在<code>env.d.ts</code>中声明<code>.mjs</code>文件</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token comment">&lt;!-- App.vue --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- 国际化配置（将组件中的英文转为中文-&gt;日期组件） --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-config-provider</span> <span class="token attr-name">:locale</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>zhCn<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-config-provider</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> zhCn <span class="token keyword">from</span> <span class="token string">&#39;element-plus/dist/locale/zh-cn.mjs&#39;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

// env.d.ts
declare module &#39;*.vue&#39; {
    import { DefineComponent } from &#39;vue&#39;
    const component: DefineComponent
    export default component
}

// 声明国际化配置文件mjs
declare module &#39;*.mjs&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="实现重置功能" tabindex="-1"><a class="header-anchor" href="#实现重置功能" aria-hidden="true">#</a> 实现重置功能</h4><p><code>el-form</code>表单组件要想输入值，需要使用<code>reactive()</code>和<code>:model</code>绑定值，并且在相应的组件如<code>el-input</code>使用<code>v-model</code>绑定<code>reactive</code>里面对应的值。重置值调用<code>formRef.value?.resetFields()</code>方法（<code>formRef</code>绑定到<code>el-form</code>上，<code>el-form-item</code>上添加属性<code>prop=&quot;xxx&quot;</code>即可实现）</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;search&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>el<span class="token operator">-</span>form <span class="token operator">**</span><span class="token operator">:</span>model<span class="token operator">=</span><span class="token string">&quot;searchForm&quot;</span> ref<span class="token operator">=</span><span class="token string">&quot;formRef&quot;</span><span class="token operator">**</span> label<span class="token operator">-</span>width<span class="token operator">=</span><span class="token string">&quot;120px&quot;</span> size<span class="token operator">=</span><span class="token string">&quot;large&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>row <span class="token operator">:</span>gutter<span class="token operator">=</span><span class="token string">&quot;20&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>el<span class="token operator">-</span>col <span class="token operator">:</span>span<span class="token operator">=</span><span class="token string">&quot;8&quot;</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item label<span class="token operator">=</span><span class="token string">&quot;用户名&quot;</span> prop<span class="token operator">=</span><span class="token string">&quot;name&quot;</span><span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>el<span class="token operator">-</span>input <span class="token operator">**</span>v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;searchForm.name&quot;</span><span class="token operator">**</span> placeholder<span class="token operator">=</span><span class="token string">&quot;请输入查询的用户名&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>input<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>col<span class="token operator">&gt;</span>
       <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>row<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">&gt;</span>
    <span class="token comment">// ....</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;btns&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>button icon<span class="token operator">=</span><span class="token string">&quot;Refresh&quot;</span> size<span class="token operator">=</span><span class="token string">&quot;large&quot;</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">click</span></span><span class="token operator">=</span><span class="token string">&quot;handleResetClick()&quot;</span><span class="token operator">&gt;</span>重置<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>button icon<span class="token operator">=</span><span class="token string">&quot;Search&quot;</span> size<span class="token operator">=</span><span class="token string">&quot;large&quot;</span> type<span class="token operator">=</span><span class="token string">&quot;primary&quot;</span><span class="token operator">&gt;</span>搜索<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> reactive<span class="token punctuation">,</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> ElForm <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;element-plus&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> searchForm <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
    realname<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
    cellphone<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
    enable<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    createAt<span class="token operator">:</span> <span class="token string">&#39;&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 重置功能</span>
<span class="token keyword">const</span> formRef <span class="token operator">=</span> <span class="token generic-function"><span class="token function">ref</span><span class="token generic class-name"><span class="token operator">&lt;</span>InstanceType<span class="token operator">&lt;</span><span class="token keyword">typeof</span> ElForm<span class="token operator">&gt;&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">handleResetClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 方法一</span>
    <span class="token comment">// searchForm.name = &#39;&#39;</span>
    <span class="token comment">// searchForm.realname = &#39;&#39;</span>
    <span class="token comment">// searchForm.cellphone = &#39;&#39;</span>
    <span class="token comment">// searchForm.enable = 1</span>
    <span class="token comment">// searchForm.createAt = &#39;&#39;</span>

    <span class="token comment">// 方法二</span>
    formRef<span class="token punctuation">.</span>value<span class="token operator">?.</span><span class="token function">resetFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="实现展示用户列表功能" tabindex="-1"><a class="header-anchor" href="#实现展示用户列表功能" aria-hidden="true">#</a> 实现展示用户列表功能</h3><p><img src="https://nevermore-picbed-1304219157.cos.ap-guangzhou.myqcloud.com/image_QJax7-SQRM.png" alt=""></p><h4 id="使用-pinia-发起获取用户数据请求" tabindex="-1"><a class="header-anchor" href="#使用-pinia-发起获取用户数据请求" aria-hidden="true">#</a> 使用 pinia 发起获取用户数据请求</h4><p>编写<code>axios</code>请求接口（使用了<code>hyRequest</code>进行了封装，直接调用即可）</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> hyRequest <span class="token keyword">from</span> <span class="token string">&quot;@/service&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// 获取用户列表数据</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getUserListData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> hyRequest<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token operator">:</span> <span class="token string">&#39;/users/list&#39;</span><span class="token punctuation">,</span>
        data<span class="token operator">:</span> <span class="token punctuation">{</span>
            offset<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            size<span class="token operator">:</span> <span class="token number">10</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>编写<code>pinia</code>进行数据存储</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> getUserListData <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/service/main/system/system&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;pinia&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> ISystemState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./type&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> useSystemStore <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token string">&#39;system&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token comment">// 使用typescript进行类型限制</span>
    state<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token operator">**</span>ISystemState<span class="token operator">**</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
        usersList<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        usersTotalCount<span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    actions<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token keyword">async</span> <span class="token function">getUsersListAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 调用axios请求</span>
            <span class="token keyword">const</span> userListResult <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getUserListData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">const</span> <span class="token punctuation">{</span> totalCount<span class="token punctuation">,</span> list <span class="token punctuation">}</span> <span class="token operator">=</span> userListResult<span class="token punctuation">.</span>data
            <span class="token comment">// 存入store中</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>usersList <span class="token operator">=</span> list
            <span class="token keyword">this</span><span class="token punctuation">.</span>usersTotalCount <span class="token operator">=</span> totalCount
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> useSystemStore
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使用<code>typescript</code>进行类型限制</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// type.ts</span>
<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">IUser</span> <span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token builtin">number</span>
    name<span class="token operator">:</span> <span class="token builtin">string</span>
    realname<span class="token operator">:</span> <span class="token builtin">string</span>
    cellphone<span class="token operator">:</span> <span class="token builtin">number</span>
    enable<span class="token operator">:</span> <span class="token builtin">number</span>
    departmentId<span class="token operator">:</span> <span class="token builtin">number</span>
    roleId<span class="token operator">:</span> <span class="token builtin">number</span>
    createAt<span class="token operator">:</span> <span class="token builtin">string</span>
    updateAt<span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">ISystemState</span> <span class="token punctuation">{</span>
    usersList<span class="token operator">:</span> IUser<span class="token punctuation">[</span><span class="token punctuation">]</span>
    usersTotalCount<span class="token operator">:</span> <span class="token builtin">number</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>用户列表页面（<code>user-content.vue</code>）中调用<code>pinia</code>中的<code>getUsersListAction</code>，从而发起请求。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// user-content.vue</span>
<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
<span class="token keyword">import</span> useSystemStore <span class="token keyword">from</span> <span class="token string">&#39;@/store/main/system/system&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> storeToRefs <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;pinia&#39;</span><span class="token punctuation">;</span>

<span class="token comment">// 1.发起action，请求usersList数据</span>
<span class="token keyword">const</span> systemStore <span class="token operator">=</span> <span class="token function">useSystemStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
systemStore<span class="token punctuation">.</span><span class="token function">getUsersListAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 2.获取usersList数据(响应式数据：上面代码是异步的，当数据还没拿到是，这一句不起作用，需要用storeToRefs)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> usersList <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">storeToRefs</span><span class="token punctuation">(</span>systemStore<span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="初步搭建表格数据页面" tabindex="-1"><a class="header-anchor" href="#初步搭建表格数据页面" aria-hidden="true">#</a> 初步搭建表格数据页面</h4><p>使用<code>el-table</code>及<code>el-table-column</code>搭建表格数据页面，<code>prop</code>对应请求数据中相应的属性，<code>type</code>为<code>selection</code>展示勾选框，<code>type</code>为<code>index</code>展示索引值。<code>el-table-column</code>可作为插槽传入其它组件，<code>:data</code>传入请求返回的数据。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;content&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;header&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>h2 <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;title&quot;</span><span class="token operator">&gt;</span>用户列表<span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">&quot;primary&quot;</span><span class="token operator">&gt;</span>新建用户<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;table&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>table <span class="token operator">:</span>data<span class="token operator">=</span><span class="token string">&quot;usersList&quot;</span> border style<span class="token operator">=</span><span class="token string">&quot;width: 100%&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 勾选框 <span class="token operator">--</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>el<span class="token operator">-</span>table<span class="token operator">-</span>column align<span class="token operator">=</span><span class="token string">&quot;center&quot;</span> type<span class="token operator">=</span><span class="token string">&quot;selection&quot;</span> width<span class="token operator">=</span><span class="token string">&quot;50px&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 序号 <span class="token operator">--</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>el<span class="token operator">-</span>table<span class="token operator">-</span>column align<span class="token operator">=</span><span class="token string">&quot;center&quot;</span> type<span class="token operator">=</span><span class="token string">&quot;index&quot;</span> label<span class="token operator">=</span><span class="token string">&quot;序号&quot;</span> width<span class="token operator">=</span><span class="token string">&quot;60px&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>

            <span class="token operator">&lt;</span>el<span class="token operator">-</span>table<span class="token operator">-</span>column align<span class="token operator">=</span><span class="token string">&quot;center&quot;</span> prop<span class="token operator">=</span><span class="token string">&quot;name&quot;</span> label<span class="token operator">=</span><span class="token string">&quot;用户名&quot;</span> width<span class="token operator">=</span><span class="token string">&quot;150px&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>el<span class="token operator">-</span>table<span class="token operator">-</span>column align<span class="token operator">=</span><span class="token string">&quot;center&quot;</span> prop<span class="token operator">=</span><span class="token string">&quot;realname&quot;</span> label<span class="token operator">=</span><span class="token string">&quot;真实姓名&quot;</span> width<span class="token operator">=</span><span class="token string">&quot;150px&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>el<span class="token operator">-</span>table<span class="token operator">-</span>column align<span class="token operator">=</span><span class="token string">&quot;center&quot;</span> prop<span class="token operator">=</span><span class="token string">&quot;cellphone&quot;</span> label<span class="token operator">=</span><span class="token string">&quot;电话号码&quot;</span> width<span class="token operator">=</span><span class="token string">&quot;150px&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>el<span class="token operator">-</span>table<span class="token operator">-</span>column align<span class="token operator">=</span><span class="token string">&quot;center&quot;</span> prop<span class="token operator">=</span><span class="token string">&quot;enable&quot;</span> label<span class="token operator">=</span><span class="token string">&quot;状态&quot;</span> width<span class="token operator">=</span><span class="token string">&quot;100px&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>el<span class="token operator">-</span>table<span class="token operator">-</span>column align<span class="token operator">=</span><span class="token string">&quot;center&quot;</span> prop<span class="token operator">=</span><span class="token string">&quot;createAt&quot;</span> label<span class="token operator">=</span><span class="token string">&quot;创建时间&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>el<span class="token operator">-</span>table<span class="token operator">-</span>column align<span class="token operator">=</span><span class="token string">&quot;center&quot;</span> prop<span class="token operator">=</span><span class="token string">&quot;updateAt&quot;</span> label<span class="token operator">=</span><span class="token string">&quot;更新时间&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>

            <span class="token operator">&lt;</span>el<span class="token operator">-</span>table<span class="token operator">-</span>column align<span class="token operator">=</span><span class="token string">&quot;center&quot;</span> label<span class="token operator">=</span><span class="token string">&quot;操作&quot;</span> width<span class="token operator">=</span><span class="token string">&quot;150px&quot;</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>el<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">&quot;primary&quot;</span> icon<span class="token operator">=</span><span class="token string">&quot;Edit&quot;</span> size<span class="token operator">=</span><span class="token string">&quot;small&quot;</span> text<span class="token operator">&gt;</span>编辑<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>el<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">&quot;danger &quot;</span> icon<span class="token operator">=</span><span class="token string">&quot;Delete&quot;</span> size<span class="token operator">=</span><span class="token string">&quot;small&quot;</span> text<span class="token operator">&gt;</span>删除<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>table<span class="token operator">-</span>column<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>table<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;pagination&quot;</span><span class="token operator">&gt;</span>分页<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
<span class="token keyword">import</span> useSystemStore <span class="token keyword">from</span> <span class="token string">&#39;@/store/main/system/system&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> storeToRefs <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;pinia&#39;</span><span class="token punctuation">;</span>

<span class="token comment">// 1.发起action，请求usersList数据</span>
<span class="token keyword">const</span> systemStore <span class="token operator">=</span> <span class="token function">useSystemStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
systemStore<span class="token punctuation">.</span><span class="token function">getUsersListAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 2.获取usersList数据(响应式数据：上面代码是异步的，当数据还没拿到是，这一句不起作用，需要用storeToRefs)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> usersList <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">storeToRefs</span><span class="token punctuation">(</span>systemStore<span class="token punctuation">)</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>usersList<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style lang<span class="token operator">=</span><span class="token string">&quot;less&quot;</span> scoped<span class="token operator">&gt;</span>
<span class="token punctuation">.</span>content <span class="token punctuation">{</span>
    margin<span class="token operator">-</span>top<span class="token operator">:</span> 20px<span class="token punctuation">;</span>
    padding<span class="token operator">:</span> 20px<span class="token punctuation">;</span>
    background<span class="token operator">-</span>color<span class="token operator">:</span> #fff<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">.</span>header <span class="token punctuation">{</span>
    display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
    justify<span class="token operator">-</span>content<span class="token operator">:</span> space<span class="token operator">-</span>between<span class="token punctuation">;</span>
    align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
    margin<span class="token operator">-</span>bottom<span class="token operator">:</span> 20px<span class="token punctuation">;</span>

    <span class="token punctuation">.</span>title <span class="token punctuation">{</span>
        font<span class="token operator">-</span>size<span class="token operator">:</span> 22px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token punctuation">.</span>table <span class="token punctuation">{</span>
    <span class="token operator">:</span><span class="token function">deep</span><span class="token punctuation">(</span><span class="token punctuation">.</span>el<span class="token operator">-</span>table__cell<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        padding<span class="token operator">:</span> 12px <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token punctuation">.</span>el<span class="token operator">-</span>button <span class="token punctuation">{</span>
        margin<span class="token operator">-</span>left<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
        padding<span class="token operator">:</span> 5px 8px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="使用作用域插槽处理表格数据中的状态以及时间格式化" tabindex="-1"><a class="header-anchor" href="#使用作用域插槽处理表格数据中的状态以及时间格式化" aria-hidden="true">#</a> 使用作用域插槽处理表格数据中的状态以及时间格式化</h4><p>科普：作用域插槽（子组件提供内容（数据），在父组件中展示，延伸了子组件的作用域），插槽（父组件提供内容，在子组件中展示）</p><p><strong>处理状态属性</strong></p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// ....</span>
<span class="token operator">&lt;</span>el<span class="token operator">-</span>table<span class="token operator">-</span>column align<span class="token operator">=</span><span class="token string">&quot;center&quot;</span> prop<span class="token operator">=</span><span class="token string">&quot;enable&quot;</span> label<span class="token operator">=</span><span class="token string">&quot;状态&quot;</span> width<span class="token operator">=</span><span class="token string">&quot;100px&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 作用域插槽 <span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>template #<span class="token keyword">default</span><span class="token operator">=</span><span class="token string">&quot;{ row }&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>button size<span class="token operator">=</span><span class="token string">&quot;small&quot;</span> <span class="token operator">:</span>type<span class="token operator">=</span><span class="token string">&quot;row.enable ? &#39;primary&#39; : &#39;danger&#39;&quot;</span> plain<span class="token operator">&gt;</span>
            <span class="token punctuation">{</span><span class="token punctuation">{</span> row<span class="token punctuation">.</span>enable <span class="token operator">?</span> <span class="token string">&#39;启用&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;禁用&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
    <span class="token comment">//&lt;template #default=&quot;scope&quot;&gt;</span>
    <span class="token comment">//    &lt;el-button size=&quot;small&quot; :type=&quot;scope.row.enable ? &#39;primary&#39; : &#39;danger&#39;&quot; plain&gt;</span>
    <span class="token comment">//        {{ scope.row.enable ? &#39;启用&#39; : &#39;禁用&#39; }}</span>
    <span class="token comment">//    &lt;/el-button&gt;</span>
    <span class="token comment">//&lt;/template&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>table<span class="token operator">-</span>column<span class="token operator">&gt;</span>
<span class="token comment">// ....</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>处理时间格式</strong></p><p>安装 dayjs：<code>npm install dayjs</code></p><p>封装时间格式化工具<code>format.ts</code></p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> dayjs <span class="token keyword">from</span> <span class="token string">&#39;dayjs&#39;</span>
<span class="token keyword">import</span> utc <span class="token keyword">from</span> <span class="token string">&#39;dayjs/plugin/utc&#39;</span>

dayjs<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span>utc<span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">formatUTC</span><span class="token punctuation">(</span>utcString<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> format <span class="token operator">=</span> <span class="token string">&#39;YYYY-MM-DD HH:mm:ss&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// utcOffset东八区偏移8小时</span>
    <span class="token keyword">return</span> dayjs<span class="token punctuation">.</span><span class="token function">utc</span><span class="token punctuation">(</span>utcString<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">utcOffset</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>format<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在作用域插槽中使用<code>formatUTC</code></p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// ...</span>
<span class="token operator">&lt;</span>el<span class="token operator">-</span>table<span class="token operator">-</span>column align<span class="token operator">=</span><span class="token string">&quot;center&quot;</span> prop<span class="token operator">=</span><span class="token string">&quot;createAt&quot;</span> label<span class="token operator">=</span><span class="token string">&quot;创建时间&quot;</span> <span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>template #<span class="token keyword">default</span><span class="token operator">=</span><span class="token string">&quot;scope&quot;</span><span class="token operator">&gt;</span>
        <span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token function">formatUTC</span><span class="token punctuation">(</span>scope<span class="token punctuation">.</span>row<span class="token punctuation">.</span>createAt<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>table<span class="token operator">-</span>column<span class="token operator">&gt;</span>
<span class="token comment">// ...</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> formatUTC <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/utils/format&#39;</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="实现分页功能" tabindex="-1"><a class="header-anchor" href="#实现分页功能" aria-hidden="true">#</a> 实现分页功能</h3><p><img src="https://nevermore-picbed-1304219157.cos.ap-guangzhou.myqcloud.com/image_N1AqUvRrLC.png" alt=""></p><h4 id="从请求接口中获取offset和size分页数据。" tabindex="-1"><a class="header-anchor" href="#从请求接口中获取offset和size分页数据。" aria-hidden="true">#</a> 从请求接口中获取<code>offset</code>和<code>size</code>分页数据。</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> hyRequest <span class="token keyword">from</span> <span class="token string">&quot;@/service&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// 获取用户列表数据</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getUserListData</span><span class="token punctuation">(</span>queryInfo<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> hyRequest<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token operator">:</span> <span class="token string">&#39;/users/list&#39;</span><span class="token punctuation">,</span>
        data<span class="token operator">:</span> queryInfo
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="参数传递" tabindex="-1"><a class="header-anchor" href="#参数传递" aria-hidden="true">#</a> 参数传递</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> useSystemStore <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token string">&#39;system&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    actions<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token keyword">async</span> <span class="token function">getUsersListAction</span><span class="token punctuation">(</span>queryInfo<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 调用axios请求</span>
            <span class="token keyword">const</span> userListResult <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getUserListData</span><span class="token punctuation">(</span>queryInfo<span class="token punctuation">)</span>
            <span class="token keyword">const</span> <span class="token punctuation">{</span> totalCount<span class="token punctuation">,</span> list <span class="token punctuation">}</span> <span class="token operator">=</span> userListResult<span class="token punctuation">.</span>data
            <span class="token comment">// ...</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> useSystemStore
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="使用el-pagination完成页面搭建。" tabindex="-1"><a class="header-anchor" href="#使用el-pagination完成页面搭建。" aria-hidden="true">#</a> 使用<code>el-pagination</code>完成页面搭建。</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// user-content.vue</span>
<span class="token comment">// ....</span>
<span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;pagination&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>pagination
      v<span class="token operator">-</span>model<span class="token operator">:</span>current<span class="token operator">-</span>page<span class="token operator">=</span><span class="token string">&quot;currentPage&quot;</span>
      v<span class="token operator">-</span>model<span class="token operator">:</span>page<span class="token operator">-</span>size<span class="token operator">=</span><span class="token string">&quot;pageSize&quot;</span>
      <span class="token operator">:</span>page<span class="token operator">-</span>sizes<span class="token operator">=</span><span class="token string">&quot;[10, 20, 30]&quot;</span>
      <span class="token operator">:</span>small<span class="token operator">=</span><span class="token string">&quot;small&quot;</span>
      layout<span class="token operator">=</span><span class="token string">&quot;sizes, prev, pager, next, jumper, total&quot;</span>
      <span class="token operator">:</span>total<span class="token operator">=</span><span class="token string">&quot;usersTotalCount&quot;</span>
      <span class="token decorator"><span class="token at operator">@</span><span class="token function">size</span></span><span class="token operator">-</span>change<span class="token operator">=</span><span class="token string">&quot;handleSizeChange&quot;</span>
      <span class="token decorator"><span class="token at operator">@</span><span class="token function">current</span></span><span class="token operator">-</span>change<span class="token operator">=</span><span class="token string">&quot;handleCurrentChange&quot;</span>
  <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span><span class="token punctuation">;</span>

<span class="token comment">// 1.发起action，请求usersList和分页数据</span>
<span class="token keyword">const</span> systemStore <span class="token operator">=</span> <span class="token function">useSystemStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> currentPage <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> pageSize <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token function">fetchUserListData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 2.获取usersList和usersTotalCount数据(响应式数据：上面代码是异步的，当数据还没拿到是，这一句不起作用，需要用storeToRefs)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> usersList<span class="token punctuation">,</span> usersTotalCount <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">storeToRefs</span><span class="token punctuation">(</span>systemStore<span class="token punctuation">)</span>

<span class="token comment">// 3.分页功能</span>
<span class="token keyword">function</span> <span class="token function">handleSizeChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">fetchUserListData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">handleCurrentChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">fetchUserListData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 4.定义函数，用于发送网络请求</span>
<span class="token keyword">function</span> <span class="token function">fetchUserListData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> size <span class="token operator">=</span> pageSize<span class="token punctuation">.</span>value
    <span class="token keyword">const</span> offset <span class="token operator">=</span> <span class="token punctuation">(</span>currentPage<span class="token punctuation">.</span>value <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> size
    <span class="token keyword">const</span> info <span class="token operator">=</span> <span class="token punctuation">{</span> size<span class="token punctuation">,</span> offset<span class="token punctuation">}</span>

    <span class="token comment">// 发起网络请求</span>
    systemStore<span class="token punctuation">.</span><span class="token function">getUsersListAction</span><span class="token punctuation">(</span>info<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style lang<span class="token operator">=</span><span class="token string">&quot;less&quot;</span> scoped<span class="token operator">&gt;</span>
<span class="token punctuation">.</span>pagination <span class="token punctuation">{</span>
    display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
    justify<span class="token operator">-</span>content<span class="token operator">:</span> flex<span class="token operator">-</span>end<span class="token punctuation">;</span>
    margin<span class="token operator">-</span>top<span class="token operator">:</span> 10px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="实现查询用户功能" tabindex="-1"><a class="header-anchor" href="#实现查询用户功能" aria-hidden="true">#</a> 实现查询用户功能</h3><p><img src="https://nevermore-picbed-1304219157.cos.ap-guangzhou.myqcloud.com/image_-2ElEwJZek.png" alt=""></p><h4 id="通过事件将表单内容传递给父组件" tabindex="-1"><a class="header-anchor" href="#通过事件将表单内容传递给父组件" aria-hidden="true">#</a> 通过事件将表单内容传递给父组件</h4><p>子传父：使用<code>const emit = defineEmits(&#39;xxx&#39;)</code>，<code>emit(&#39;xxx&#39;)</code></p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// user-search.vue</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
    <span class="token comment">// ...</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;btns&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>button icon<span class="token operator">=</span><span class="token string">&quot;Refresh&quot;</span> size<span class="token operator">=</span><span class="token string">&quot;large&quot;</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">click</span></span><span class="token operator">=</span><span class="token string">&quot;handleResetClick()&quot;</span><span class="token operator">&gt;</span>重置<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>button icon<span class="token operator">=</span><span class="token string">&quot;Search&quot;</span> size<span class="token operator">=</span><span class="token string">&quot;large&quot;</span> type<span class="token operator">=</span><span class="token string">&quot;primary&quot;</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">click</span></span> <span class="token operator">=</span> <span class="token string">&quot;handleQueryClick()&quot;</span><span class="token operator">&gt;</span>搜索<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> reactive<span class="token punctuation">,</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> ElForm <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;element-plus&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> emit <span class="token operator">=</span> <span class="token function">defineEmits</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;queryClick&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;resetClick&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> searchForm <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
    realname<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
    cellphone<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
    enable<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    createAt<span class="token operator">:</span> <span class="token string">&#39;&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 重置功能</span>
<span class="token comment">// ...</span>

<span class="token comment">// 搜索功能</span>
<span class="token keyword">function</span> <span class="token function">handleQueryClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 通过事件抛出（子传父）</span>
    <span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&#39;queryClick&#39;</span><span class="token punctuation">,</span> searchForm<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="父组件接受事件并调用另一个子组件暴露的函数" tabindex="-1"><a class="header-anchor" href="#父组件接受事件并调用另一个子组件暴露的函数" aria-hidden="true">#</a> 父组件接受事件并调用另一个子组件暴露的函数</h4><p>子传父也可以用<code>defineExpose()</code>，这里<code>user-content</code>子组件使用此函数接受父组件（由<code>user-search</code>传过来）传过来的<code>searchForm</code>信息。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// user.vue</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;user&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>user<span class="token operator">-</span>search <span class="token decorator"><span class="token at operator">@</span><span class="token function">query</span></span><span class="token operator">-</span>click<span class="token operator">=</span><span class="token string">&quot;handleQueryClick&quot;</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">reset</span></span><span class="token operator">-</span>click<span class="token operator">=</span><span class="token string">&quot;handleResetClick&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>user<span class="token operator">-</span>content ref<span class="token operator">=</span><span class="token string">&quot;contentRef&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token keyword">import</span> userContent <span class="token keyword">from</span> <span class="token string">&#39;./cpns/user-content.vue&#39;</span>
<span class="token keyword">import</span> userSearch <span class="token keyword">from</span> <span class="token string">&#39;./cpns/user-search.vue&#39;</span>

<span class="token keyword">const</span> contentRef <span class="token operator">=</span> <span class="token generic-function"><span class="token function">ref</span><span class="token generic class-name"><span class="token operator">&lt;</span>InstanceType<span class="token operator">&lt;</span><span class="token keyword">typeof</span> userContent<span class="token operator">&gt;&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">handleQueryClick</span><span class="token punctuation">(</span>searchInfo<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  contentRef<span class="token punctuation">.</span>value<span class="token operator">?.</span><span class="token function">fetchUserListData</span><span class="token punctuation">(</span>searchInfo<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">handleResetClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  contentRef<span class="token punctuation">.</span>value<span class="token operator">?.</span><span class="token function">fetchUserListData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style lang<span class="token operator">=</span><span class="token string">&quot;less&quot;</span> scoped<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token comment">// ...</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
<span class="token comment">// ...</span>
<span class="token comment">// 4.定义函数，用于发送网络请求</span>
<span class="token keyword">function</span> <span class="token function">fetchUserListData</span><span class="token punctuation">(</span>formData<span class="token operator">:</span> <span class="token builtin">any</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> size <span class="token operator">=</span> pageSize<span class="token punctuation">.</span>value
    <span class="token keyword">const</span> offset <span class="token operator">=</span> <span class="token punctuation">(</span>currentPage<span class="token punctuation">.</span>value <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> size
    <span class="token keyword">const</span> pageInfo <span class="token operator">=</span> <span class="token punctuation">{</span> size<span class="token punctuation">,</span> offset<span class="token punctuation">}</span>

    <span class="token keyword">const</span> queryInfo <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>formData<span class="token punctuation">,</span> <span class="token operator">...</span>pageInfo <span class="token punctuation">}</span>
    <span class="token comment">// 发起网络请求</span>
    systemStore<span class="token punctuation">.</span><span class="token function">getUsersListAction</span><span class="token punctuation">(</span>queryInfo<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 暴露函数给父组件</span>
<span class="token function">defineExpose</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    fetchUserListData
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="实现删除用户功能" tabindex="-1"><a class="header-anchor" href="#实现删除用户功能" aria-hidden="true">#</a> 实现删除用户功能</h3><p><img src="https://nevermore-picbed-1304219157.cos.ap-guangzhou.myqcloud.com/image_JyyGiGUc-9.png" alt=""></p><p>通过作用域插槽获取当前点击删除按钮那一行的用户<code>id</code>，即<code>scope.row.id</code>，将<code>id</code>传入用户删除接口。</p><h4 id="封装删除用户数据接口" tabindex="-1"><a class="header-anchor" href="#封装删除用户数据接口" aria-hidden="true">#</a> 封装删除用户数据接口</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> hyRequest <span class="token keyword">from</span> <span class="token string">&quot;@/service&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>
<span class="token comment">// 删除用户数据</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">deleteUserData</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> hyRequest<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/users/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="pinia-中调用接口的-actions" tabindex="-1"><a class="header-anchor" href="#pinia-中调用接口的-actions" aria-hidden="true">#</a> pinia 中调用接口的 actions</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> useSystemStore <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token string">&#39;system&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    state<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> ISystemState <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token comment">// ...</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    actions<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// ...</span>
        <span class="token comment">// 删除用户数据</span>
        <span class="token keyword">async</span> <span class="token function">deleteUserDataAction</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 调用axios请求</span>
            <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">deleteUserData</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
            <span class="token comment">// 重新请求数据刷新页面</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getUsersListAction</span><span class="token punctuation">(</span><span class="token punctuation">{</span> offset<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> size<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> useSystemStore
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="页面中获取-id-传入-actions" tabindex="-1"><a class="header-anchor" href="#页面中获取-id-传入-actions" aria-hidden="true">#</a> 页面中获取 id 传入 actions</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;content&quot;</span><span class="token operator">&gt;</span>
      <span class="token comment">// ...</span>
      <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;table&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>table <span class="token operator">:</span>data<span class="token operator">=</span><span class="token string">&quot;usersList&quot;</span> border style<span class="token operator">=</span><span class="token string">&quot;width: 100%&quot;</span><span class="token operator">&gt;</span>
            <span class="token comment">// ...</span>
            <span class="token operator">&lt;</span>el<span class="token operator">-</span>table<span class="token operator">-</span>column align<span class="token operator">=</span><span class="token string">&quot;center&quot;</span> label<span class="token operator">=</span><span class="token string">&quot;操作&quot;</span> width<span class="token operator">=</span><span class="token string">&quot;150px&quot;</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>template #<span class="token keyword">default</span><span class="token operator">=</span><span class="token string">&quot;scope&quot;</span><span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>el<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">&quot;primary&quot;</span> icon<span class="token operator">=</span><span class="token string">&quot;Edit&quot;</span> size<span class="token operator">=</span><span class="token string">&quot;small&quot;</span> text<span class="token operator">&gt;</span>编辑<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>el<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">&quot;danger&quot;</span> icon<span class="token operator">=</span><span class="token string">&quot;Delete&quot;</span> size<span class="token operator">=</span><span class="token string">&quot;small&quot;</span> text <span class="token decorator"><span class="token at operator">@</span><span class="token function">click</span></span><span class="token operator">=</span><span class="token string">&quot;handleDeleteClick(scope.row.id)&quot;</span><span class="token operator">&gt;</span>删除<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>table<span class="token operator">-</span>column<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>table<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
<span class="token keyword">import</span> useSystemStore <span class="token keyword">from</span> <span class="token string">&#39;@/store/main/system/system&#39;</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>
<span class="token keyword">const</span> systemStore <span class="token operator">=</span> <span class="token function">useSystemStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 删除用户数据</span>
<span class="token keyword">function</span> <span class="token function">handleDeleteClick</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    systemStore<span class="token punctuation">.</span><span class="token function">deleteUserDataAction</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="实现新增用户功能" tabindex="-1"><a class="header-anchor" href="#实现新增用户功能" aria-hidden="true">#</a> 实现新增用户功能</h3><p><img src="https://nevermore-picbed-1304219157.cos.ap-guangzhou.myqcloud.com/image_YsaeThWQO2.png" alt=""></p><p>由于新建用户按钮在<code>user-content.vue</code>页面中，与<code>user-modal.vue</code>是兄弟组件，需要用到组件通信，由<code>user-content.vue</code>发起事件<code>defineEmits()</code></p><h4 id="初步搭建模态框页面" tabindex="-1"><a class="header-anchor" href="#初步搭建模态框页面" aria-hidden="true">#</a> 初步搭建模态框页面</h4><p>使用<code>el-dialog</code>组件实现，<code>v-model</code>绑定模态框的<code>dialogVisible</code>可见值，封装到函数中，将其暴露给父组件。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// user-modal.vue</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;modal&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>el<span class="token operator">-</span>dialog v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;dialogVisible&quot;</span> title<span class="token operator">=</span><span class="token string">&quot;新建用户&quot;</span> width<span class="token operator">=</span><span class="token string">&quot;30%&quot;</span> center<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;form&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>form <span class="token operator">:</span>model<span class="token operator">=</span><span class="token string">&quot;formData&quot;</span> label<span class="token operator">-</span>width<span class="token operator">=</span><span class="token string">&quot;80px&quot;</span> size<span class="token operator">=</span><span class="token string">&quot;large&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item label<span class="token operator">=</span><span class="token string">&quot;用户名&quot;</span> prop<span class="token operator">=</span><span class="token string">&quot;name&quot;</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>el<span class="token operator">-</span>input v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;formData.name&quot;</span> placeholder<span class="token operator">=</span><span class="token string">&quot;请输入用户名&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>input<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item label<span class="token operator">=</span><span class="token string">&quot;真实姓名&quot;</span> prop<span class="token operator">=</span><span class="token string">&quot;realname&quot;</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>el<span class="token operator">-</span>input v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;formData.realname&quot;</span> placeholder<span class="token operator">=</span><span class="token string">&quot;请输入真实姓名&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>input<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item label<span class="token operator">=</span><span class="token string">&quot;密码&quot;</span> prop<span class="token operator">=</span><span class="token string">&quot;password&quot;</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>el<span class="token operator">-</span>input v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;formData.password&quot;</span> placeholder<span class="token operator">=</span><span class="token string">&quot;请输入密码&quot;</span> show<span class="token operator">-</span>password<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>input<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item label<span class="token operator">=</span><span class="token string">&quot;电话号码&quot;</span> prop<span class="token operator">=</span><span class="token string">&quot;cellphone&quot;</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>el<span class="token operator">-</span>input v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;formData.cellphone&quot;</span> placeholder<span class="token operator">=</span><span class="token string">&quot;请输入电话号码&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>input<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item label<span class="token operator">=</span><span class="token string">&quot;选择角色&quot;</span> prop<span class="token operator">=</span><span class="token string">&quot;roleId&quot;</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>el<span class="token operator">-</span>select v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;formData.roleId&quot;</span> placeholder<span class="token operator">=</span><span class="token string">&quot;请选择角色&quot;</span> style<span class="token operator">=</span><span class="token string">&quot;width: 100%&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>select<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item label<span class="token operator">=</span><span class="token string">&quot;选择部门&quot;</span> prop<span class="token operator">=</span><span class="token string">&quot;departmentId&quot;</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>el<span class="token operator">-</span>select v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;formData.departmentId&quot;</span> placeholder<span class="token operator">=</span><span class="token string">&quot;请选择部门&quot;</span> style<span class="token operator">=</span><span class="token string">&quot;width: 100%&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>select<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>template #footer<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;dialog-footer&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>button <span class="token decorator"><span class="token at operator">@</span><span class="token function">click</span></span><span class="token operator">=</span><span class="token string">&quot;dialogVisible = false&quot;</span><span class="token operator">&gt;</span>取消<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">&quot;primary&quot;</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">click</span></span><span class="token operator">=</span><span class="token string">&quot;dialogVisible = false&quot;</span><span class="token operator">&gt;</span>确定<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>dialog<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> reactive<span class="token punctuation">,</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> dialogVisible <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> formData <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
    realname<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
    password<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
    cellphone<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
    roleId<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
    departmentId<span class="token operator">:</span> <span class="token string">&#39;&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">setDialogVisible</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  dialogVisible<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>

<span class="token function">defineExpose</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    setDialogVisible
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style lang<span class="token operator">=</span><span class="token string">&quot;less&quot;</span> scoped<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>点击新建用户按钮发起组件通信</strong></p><p>使用<code>defineEmits</code>发起点击事件传递给父组件<code>user.vue</code>。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// user-content.vue</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;content&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;header&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>h2 <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;title&quot;</span><span class="token operator">&gt;</span>用户列表<span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">&quot;primary&quot;</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">click</span></span><span class="token operator">=</span><span class="token string">&quot;handleNewData&quot;</span><span class="token operator">&gt;</span>新建用户<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;table&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>table <span class="token operator">:</span>data<span class="token operator">=</span><span class="token string">&quot;usersList&quot;</span> border style<span class="token operator">=</span><span class="token string">&quot;width: 100%&quot;</span><span class="token operator">&gt;</span>
           <span class="token comment">// ...</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>table<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
<span class="token comment">// ...</span>
<span class="token keyword">const</span> emit <span class="token operator">=</span> <span class="token function">defineEmits</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;newDataClick&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment">// 6.新建用户功能</span>
<span class="token keyword">function</span> <span class="token function">handleNewData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&#39;newDataClick&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>父组件获取事件</strong></p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// user.vue</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;user&quot;</span><span class="token operator">&gt;</span>
    <span class="token comment">// ...</span>
    <span class="token operator">&lt;</span>user<span class="token operator">-</span>content ref<span class="token operator">=</span><span class="token string">&quot;contentRef&quot;</span> @<span class="token keyword">new</span><span class="token operator">-</span>data<span class="token operator">-</span>click<span class="token operator">=</span><span class="token string">&quot;handleNewDataClick&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>user<span class="token operator">-</span>modal ref<span class="token operator">=</span><span class="token string">&quot;modalRef&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> userModal <span class="token keyword">from</span> <span class="token string">&#39;./cpns/user-modal.vue&#39;</span>

<span class="token keyword">const</span> modalRef <span class="token operator">=</span> <span class="token generic-function"><span class="token function">ref</span><span class="token generic class-name"><span class="token operator">&lt;</span>InstanceType<span class="token operator">&lt;</span><span class="token keyword">typeof</span> userModal<span class="token operator">&gt;&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 新增用户功能</span>
<span class="token keyword">function</span> <span class="token function">handleNewDataClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  modalRef<span class="token punctuation">.</span>value<span class="token operator">?.</span><span class="token function">setDialogVisible</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="全局封装获取角色和部门的请求接口数据" tabindex="-1"><a class="header-anchor" href="#全局封装获取角色和部门的请求接口数据" aria-hidden="true">#</a> 全局封装获取角色和部门的请求接口数据</h4><p><code>service</code>层使用<code>hyRequest</code>封装接口。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// serivce/main.ts</span>
<span class="token keyword">import</span> hyRequest <span class="token keyword">from</span> <span class="token string">&quot;..&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getEntireRoles</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> hyRequest<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token operator">:</span> <span class="token string">&quot;/role/list&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getEntireDepartments</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> hyRequest<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token operator">:</span> <span class="token string">&quot;/department/list&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>pinia</code>调用接口存储在本地<code>store</code>。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// store/main.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> getEntireDepartments<span class="token punctuation">,</span> getEntireRoles <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/service/main/main&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;pinia&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">IMainState</span> <span class="token punctuation">{</span>
    entireRoles<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    entireDepartments<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> useMainStore <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token string">&#39;main&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    state<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> IMainState <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
        entireRoles<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        entireDepartments<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    actions<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token keyword">async</span> <span class="token function">fetchEntireDataAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> rolesResult <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getEntireRoles</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">const</span> departmentResult <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getEntireDepartments</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>entireRoles <span class="token operator">=</span> rolesResult<span class="token punctuation">.</span>data<span class="token punctuation">.</span>list
            <span class="token keyword">this</span><span class="token punctuation">.</span>entireDepartments <span class="token operator">=</span> departmentResult<span class="token punctuation">.</span>data<span class="token punctuation">.</span>list
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> useMainStore
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在登录<code>actions</code>中发起调用。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// store/login.ts</span>
<span class="token keyword">import</span> useMainStore <span class="token keyword">from</span> <span class="token string">&quot;../main/main&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">ILoginState</span> <span class="token punctuation">{</span>
    token<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
    userInfo<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span>
    userMenus<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> useLoginStore <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token string">&#39;login&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    state<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> ILoginState <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
        token<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
        userInfo<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        userMenus<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    actions<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token keyword">async</span> <span class="token function">loginAccountAction</span><span class="token punctuation">(</span>account<span class="token operator">:</span> IAccount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// ...</span>

            <span class="token comment">// 6.请求所有roles/department数据(刷新时数据会消失)</span>
            <span class="token keyword">const</span> mainStore <span class="token operator">=</span> <span class="token function">useMainStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            mainStore<span class="token punctuation">.</span><span class="token function">fetchEntireDataAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

            <span class="token comment">//  页面跳转</span>
            router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&#39;/main&#39;</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>

        <span class="token comment">// 解决刷新页面后，动态路由丢失的问题(不再是loginAccountAction登录时才执行)</span>
        <span class="token function">loadLocalDataAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// ...</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>token <span class="token operator">&amp;&amp;</span> userInfo <span class="token operator">&amp;&amp;</span> userMenus<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// ...</span>
                <span class="token comment">// 请求所有roles/department数据(刷新时数据不会消失，经常变化，不放缓存，刷新时请求最新的)</span>
                <span class="token keyword">const</span> mainStore <span class="token operator">=</span> <span class="token function">useMainStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                mainStore<span class="token punctuation">.</span><span class="token function">fetchEntireDataAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token comment">// ...</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> useLoginStore
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="处理角色和部门下拉框" tabindex="-1"><a class="header-anchor" href="#处理角色和部门下拉框" aria-hidden="true">#</a> 处理角色和部门下拉框</h4><p>在<code>el-select</code>中使用<code>v-for</code>循环遍历<code>el-option</code>，动态回显到<code>label</code>属性中。角色和部门数据从<code>pinia</code>中获取。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;modal&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>el<span class="token operator">-</span>dialog v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;dialogVisible&quot;</span> title<span class="token operator">=</span><span class="token string">&quot;新建用户&quot;</span> width<span class="token operator">=</span><span class="token string">&quot;30%&quot;</span> center<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;form&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>form <span class="token operator">:</span>model<span class="token operator">=</span><span class="token string">&quot;formData&quot;</span> label<span class="token operator">-</span>width<span class="token operator">=</span><span class="token string">&quot;80px&quot;</span> size<span class="token operator">=</span><span class="token string">&quot;large&quot;</span><span class="token operator">&gt;</span>
            <span class="token comment">// ...</span>
            <span class="token operator">&lt;</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item label<span class="token operator">=</span><span class="token string">&quot;选择角色&quot;</span> prop<span class="token operator">=</span><span class="token string">&quot;roleId&quot;</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>el<span class="token operator">-</span>select v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;formData.roleId&quot;</span> placeholder<span class="token operator">=</span><span class="token string">&quot;请选择角色&quot;</span> style<span class="token operator">=</span><span class="token string">&quot;width: 100%&quot;</span><span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>template v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;item in entireRoles&quot;</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">&quot;item.id&quot;</span><span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>el<span class="token operator">-</span>option <span class="token operator">:</span>label<span class="token operator">=</span><span class="token string">&quot;item.name&quot;</span> <span class="token operator">:</span>value<span class="token operator">=</span><span class="token string">&quot;item.id&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>select<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item label<span class="token operator">=</span><span class="token string">&quot;选择部门&quot;</span> prop<span class="token operator">=</span><span class="token string">&quot;departmentId&quot;</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>el<span class="token operator">-</span>select v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;formData.departmentId&quot;</span> placeholder<span class="token operator">=</span><span class="token string">&quot;请选择部门&quot;</span> style<span class="token operator">=</span><span class="token string">&quot;width: 100%&quot;</span><span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>template v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;item in entireDepartments&quot;</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">&quot;item.id&quot;</span><span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>el<span class="token operator">-</span>option <span class="token operator">:</span>label<span class="token operator">=</span><span class="token string">&quot;item.name&quot;</span> <span class="token operator">:</span>value<span class="token operator">=</span><span class="token string">&quot;item.id&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>select<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> useMainStore <span class="token keyword">from</span> <span class="token string">&quot;@/store/main/main&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> storeToRefs <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;pinia&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>

<span class="token comment">// 获取roles/departments数据</span>
<span class="token keyword">const</span> mainStore <span class="token operator">=</span> <span class="token function">useMainStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> entireRoles<span class="token punctuation">,</span> entireDepartments <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">storeToRefs</span><span class="token punctuation">(</span>mainStore<span class="token punctuation">)</span>
<span class="token comment">// ...</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="封装新建用户请求接口并调用" tabindex="-1"><a class="header-anchor" href="#封装新建用户请求接口并调用" aria-hidden="true">#</a> 封装新建用户请求接口并调用</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">//sevice/main/system/system.ts</span>
<span class="token keyword">import</span> hyRequest <span class="token keyword">from</span> <span class="token string">&quot;@/service&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// 获取用户列表数据...</span>

<span class="token comment">// 删除用户数据...</span>

<span class="token comment">// 新建用户数据</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">newUserData</span><span class="token punctuation">(</span>userInfo<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> hyRequest<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token operator">:</span> <span class="token string">&#39;/users&#39;</span><span class="token punctuation">,</span>
        data<span class="token operator">:</span> userInfo
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> deleteUserData<span class="token punctuation">,</span> getUserListData<span class="token punctuation">,</span> newUserData <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/service/main/system/system&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>
<span class="token keyword">const</span> useSystemStore <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token string">&#39;system&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    state<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> ISystemState <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
        usersList<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        usersTotalCount<span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    actions<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// 获取用户数据列表...</span>

        <span class="token comment">// 删除用户数据...</span>

        <span class="token comment">// 新增用户数据</span>
        <span class="token keyword">async</span> <span class="token function">newUserDataAction</span><span class="token punctuation">(</span>userInfo<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 创建新的用户</span>
            <span class="token keyword">const</span> newResult <span class="token operator">=</span>  <span class="token keyword">await</span> <span class="token function">newUserData</span><span class="token punctuation">(</span>userInfo<span class="token punctuation">)</span>
            <span class="token comment">// 重新发送请求数据刷新页面</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getUsersListAction</span><span class="token punctuation">(</span><span class="token punctuation">{</span> offset<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> size<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;modal&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>el<span class="token operator">-</span>dialog v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;dialogVisible&quot;</span> title<span class="token operator">=</span><span class="token string">&quot;新建用户&quot;</span> width<span class="token operator">=</span><span class="token string">&quot;30%&quot;</span> center<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;form&quot;</span><span class="token operator">&gt;</span>
            <span class="token comment">// ...</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>template #footer<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;dialog-footer&quot;</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>el<span class="token operator">-</span>button <span class="token decorator"><span class="token at operator">@</span><span class="token function">click</span></span><span class="token operator">=</span><span class="token string">&quot;dialogVisible = false&quot;</span><span class="token operator">&gt;</span>取消<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>el<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">&quot;primary&quot;</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">click</span></span><span class="token operator">=</span><span class="token string">&quot;handleConfirmClick&quot;</span><span class="token operator">&gt;</span>确定<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>dialog<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> useSystemStore <span class="token keyword">from</span> <span class="token string">&quot;@/store/main/system/system&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> dialogVisible <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> formData <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
    realname<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
    password<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
    cellphone<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
    roleId<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
    departmentId<span class="token operator">:</span> <span class="token string">&#39;&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> systemStore <span class="token operator">=</span> <span class="token function">useSystemStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// ...</span>

<span class="token comment">// dialog点击确定按钮逻辑</span>
<span class="token keyword">function</span> <span class="token function">handleConfirmClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 关门dialog</span>
    dialogVisible<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span>
    <span class="token comment">// 发送新建用户请求</span>
    systemStore<span class="token punctuation">.</span><span class="token function">newUserDataAction</span><span class="token punctuation">(</span>formData<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="实现编辑用户功能" tabindex="-1"><a class="header-anchor" href="#实现编辑用户功能" aria-hidden="true">#</a> 实现编辑用户功能</h3><p><img src="https://nevermore-picbed-1304219157.cos.ap-guangzhou.myqcloud.com/image_ONXbS8GUdk.png" alt=""></p><h4 id="封装修改用户请求接口" tabindex="-1"><a class="header-anchor" href="#封装修改用户请求接口" aria-hidden="true">#</a> 封装修改用户请求接口</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> hyRequest <span class="token keyword">from</span> <span class="token string">&quot;@/service&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>
<span class="token comment">// 编辑用户数据</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">editUserData</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> userInfo<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> hyRequest<span class="token punctuation">.</span><span class="token function">patch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/users/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
        data<span class="token operator">:</span> userInfo
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="pinia-中调用接口的-actions-1" tabindex="-1"><a class="header-anchor" href="#pinia-中调用接口的-actions-1" aria-hidden="true">#</a> pinia 中调用接口的 actions</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> deleteUserData<span class="token punctuation">,</span> editUserData<span class="token punctuation">,</span> getUserListData<span class="token punctuation">,</span> newUserData <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/service/main/system/system&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> useSystemStore <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token string">&#39;system&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    state<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> ISystemState <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token comment">// ...</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    actions<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// ...</span>
        <span class="token comment">// 编辑用户数据</span>
        <span class="token keyword">async</span> <span class="token function">editUserDataAction</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> userInfo<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> editResult <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">editUserData</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> userInfo<span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getUsersListAction</span><span class="token punctuation">(</span><span class="token punctuation">{</span> offset<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> size<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> useSystemStore
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="实现点击编辑按钮弹出模态框" tabindex="-1"><a class="header-anchor" href="#实现点击编辑按钮弹出模态框" aria-hidden="true">#</a> 实现点击编辑按钮弹出模态框</h4><p>使用作用域插槽将子组件<code>user-content</code>的点击事件发送给父组件。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// user-content.vue</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;content&quot;</span><span class="token operator">&gt;</span>
      <span class="token comment">// ...</span>
      <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;table&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>table <span class="token operator">:</span>data<span class="token operator">=</span><span class="token string">&quot;usersList&quot;</span> border style<span class="token operator">=</span><span class="token string">&quot;width: 100%&quot;</span><span class="token operator">&gt;</span>
            <span class="token comment">// ...</span>
            <span class="token operator">&lt;</span>el<span class="token operator">-</span>table<span class="token operator">-</span>column align<span class="token operator">=</span><span class="token string">&quot;center&quot;</span> label<span class="token operator">=</span><span class="token string">&quot;操作&quot;</span> width<span class="token operator">=</span><span class="token string">&quot;150px&quot;</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>template #<span class="token keyword">default</span><span class="token operator">=</span><span class="token string">&quot;scope&quot;</span><span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>el<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">&quot;primary&quot;</span> icon<span class="token operator">=</span><span class="token string">&quot;Edit&quot;</span> size<span class="token operator">=</span><span class="token string">&quot;small&quot;</span> text <span class="token decorator"><span class="token at operator">@</span><span class="token function">click</span></span><span class="token operator">=</span><span class="token string">&quot;handleEditClick(scope.row)&quot;</span><span class="token operator">&gt;</span>编辑<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>el<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">&quot;danger&quot;</span> icon<span class="token operator">=</span><span class="token string">&quot;Delete&quot;</span> size<span class="token operator">=</span><span class="token string">&quot;small&quot;</span> text <span class="token decorator"><span class="token at operator">@</span><span class="token function">click</span></span><span class="token operator">=</span><span class="token string">&quot;handleDeleteClick(scope.row.id)&quot;</span><span class="token operator">&gt;</span>删除<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>table<span class="token operator">-</span>column<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>table<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
<span class="token comment">// ...</span>
<span class="token keyword">const</span> emit <span class="token operator">=</span> <span class="token function">defineEmits</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;newDataClick&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;editDataClick&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">// ...</span>

<span class="token comment">// 7.编辑用户功能</span>
<span class="token keyword">function</span> <span class="token function">handleEditClick</span><span class="token punctuation">(</span>itemData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&#39;editDataClick&#39;</span><span class="token punctuation">,</span> itemData<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>父组件接受点击事件。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;user&quot;</span><span class="token operator">&gt;</span>
    <span class="token comment">// ...</span>
    <span class="token operator">&lt;</span>user<span class="token operator">-</span>content ref<span class="token operator">=</span><span class="token string">&quot;contentRef&quot;</span> @<span class="token keyword">new</span><span class="token operator">-</span>data<span class="token operator">-</span>click<span class="token operator">=</span><span class="token string">&quot;handleNewDataClick&quot;</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">edit</span></span><span class="token operator">-</span>data<span class="token operator">-</span>click<span class="token operator">=</span><span class="token string">&quot;handleEditDataClick&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>user<span class="token operator">-</span>modal ref<span class="token operator">=</span><span class="token string">&quot;modalRef&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> userModal <span class="token keyword">from</span> <span class="token string">&#39;./cpns/user-modal.vue&#39;</span>
<span class="token comment">// ...</span>

<span class="token keyword">const</span> modalRef <span class="token operator">=</span> <span class="token generic-function"><span class="token function">ref</span><span class="token generic class-name"><span class="token operator">&lt;</span>InstanceType<span class="token operator">&lt;</span><span class="token keyword">typeof</span> userModal<span class="token operator">&gt;&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// ...</span>
<span class="token comment">// 编辑用户功能</span>
<span class="token keyword">function</span> <span class="token function">handleEditDataClick</span><span class="token punctuation">(</span>itemData<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// setDialogVisible由user-modal子组件暴露出来的方法</span>
  modalRef<span class="token punctuation">.</span>value<span class="token operator">?.</span><span class="token function">setDialogVisible</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> itemData<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>子组件<code>user-modal</code>接受父组件传来的方法和参数。对模态框的表单内容进行判断，在编辑数据时除了密码，其它属性都进行回显，<code>title</code>变为编辑用户文本。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;modal&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>el<span class="token operator">-</span>dialog v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;dialogVisible&quot;</span> <span class="token operator">:</span>title<span class="token operator">=</span><span class="token string">&quot;isNewRef? &#39;新建用户&#39;: &#39;编辑用户&#39;&quot;</span> width<span class="token operator">=</span><span class="token string">&quot;30%&quot;</span> center<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;form&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>el<span class="token operator">-</span>form <span class="token operator">:</span>model<span class="token operator">=</span><span class="token string">&quot;formData&quot;</span> label<span class="token operator">-</span>width<span class="token operator">=</span><span class="token string">&quot;80px&quot;</span> size<span class="token operator">=</span><span class="token string">&quot;large&quot;</span><span class="token operator">&gt;</span>
                <span class="token comment">// 编辑数据时密码不进行回显。</span>
                <span class="token operator">&lt;</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;isNewRef&quot;</span> label<span class="token operator">=</span><span class="token string">&quot;密码&quot;</span> prop<span class="token operator">=</span><span class="token string">&quot;password&quot;</span><span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>el<span class="token operator">-</span>input v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;formData.password&quot;</span> placeholder<span class="token operator">=</span><span class="token string">&quot;请输入密码&quot;</span> show<span class="token operator">-</span>password<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>input<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>
                <span class="token comment">// ...</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>template #footer<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;dialog-footer&quot;</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>el<span class="token operator">-</span>button <span class="token decorator"><span class="token at operator">@</span><span class="token function">click</span></span><span class="token operator">=</span><span class="token string">&quot;dialogVisible = false&quot;</span><span class="token operator">&gt;</span>取消<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>el<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">&quot;primary&quot;</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">click</span></span><span class="token operator">=</span><span class="token string">&quot;handleConfirmClick&quot;</span><span class="token operator">&gt;</span>确定<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>dialog<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> useSystemStore <span class="token keyword">from</span> <span class="token string">&quot;@/store/main/system/system&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>

<span class="token keyword">const</span> dialogVisible <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token comment">// 编辑时密码不显示</span>
<span class="token keyword">const</span> isNewRef <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> editData <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> formData <span class="token operator">=</span> <span class="token generic-function"><span class="token function">reactive</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
    realname<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
    password<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
    cellphone<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
    roleId<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
    departmentId<span class="token operator">:</span> <span class="token string">&#39;&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// ...</span>
<span class="token comment">// 定义设置dialogVisible的方法</span>
<span class="token keyword">function</span> <span class="token function">setDialogVisible</span><span class="token punctuation">(</span>isNew<span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span> itemData<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  dialogVisible<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span>
  isNewRef<span class="token punctuation">.</span>value <span class="token operator">=</span> isNew
  <span class="token comment">// 模态框表单回显</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>isNew <span class="token operator">&amp;&amp;</span> itemData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 编辑数据</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> formData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// key不一定在formData中,所以需要加类型判断any(reactive&lt;any&gt;)</span>
        formData<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> itemData<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    editData<span class="token punctuation">.</span>value <span class="token operator">=</span> itemData
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// 新增数据</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> formData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        formData<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&#39;&#39;</span>
    <span class="token punctuation">}</span>
    editData<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">null</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// dialog点击确定按钮逻辑</span>
<span class="token keyword">function</span> <span class="token function">handleConfirmClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 关门dialog</span>
    dialogVisible<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span>
    <span class="token comment">// isNewRef为false时，发送编辑用户请求</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>isNewRef<span class="token punctuation">.</span>value <span class="token operator">&amp;&amp;</span> editData<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        systemStore<span class="token punctuation">.</span><span class="token function">editUserDataAction</span><span class="token punctuation">(</span>editData<span class="token punctuation">.</span>value<span class="token punctuation">.</span>id<span class="token punctuation">,</span> formData<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// 否则发送新建用户请求</span>
        systemStore<span class="token punctuation">.</span><span class="token function">newUserDataAction</span><span class="token punctuation">(</span>formData<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 暴露给父组件的方法</span>
<span class="token function">defineExpose</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    setDialogVisible
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="高级复用性代码抽取" tabindex="-1"><a class="header-anchor" href="#高级复用性代码抽取" aria-hidden="true">#</a> 高级复用性代码抽取</h2><p><strong>封装抽取成配置文件来实现，增强复用性。</strong></p><h3 id="封装网络请求" tabindex="-1"><a class="header-anchor" href="#封装网络请求" aria-hidden="true">#</a> 封装网络请求</h3><h4 id="抽取接口的公共特性" tabindex="-1"><a class="header-anchor" href="#抽取接口的公共特性" aria-hidden="true">#</a> 抽取接口的公共特性</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">/** 抽取公共页面接口 */</span>
<span class="token comment">// 查询</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getPageListData</span><span class="token punctuation">(</span>pageName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> queryInfo<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> hyRequest<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      url<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>pageName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/list</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
      data<span class="token operator">:</span> queryInfo
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 删除</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">deletePageData</span><span class="token punctuation">(</span>pageName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> hyRequest<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      url<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>pageName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 新增</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">newPageData</span><span class="token punctuation">(</span>pageName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> dataInfo<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> hyRequest<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    url<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>pageName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    data<span class="token operator">:</span> dataInfo
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 修改</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">editPageData</span><span class="token punctuation">(</span>pageName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> dataInfo<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> hyRequest<span class="token punctuation">.</span><span class="token function">patch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    url<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>pageName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    data<span class="token operator">:</span> dataInfo
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="抽取-pinia-对应的-actions" tabindex="-1"><a class="header-anchor" href="#抽取-pinia-对应的-actions" aria-hidden="true">#</a> 抽取 pinia 对应的 actions</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> deleteUserData<span class="token punctuation">,</span> editUserData<span class="token punctuation">,</span> getUserListData<span class="token punctuation">,</span> newUserData<span class="token punctuation">,</span> deletePageData<span class="token punctuation">,</span> editPageData<span class="token punctuation">,</span> getPageListData<span class="token punctuation">,</span> newPageData <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/service/main/system/system&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;pinia&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> ISystemState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./type&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> useSystemStore <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token string">&#39;system&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    state<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> ISystemState <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token comment">// 抽取公共页面数据</span>
        pageList<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        pageTotalCount<span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    actions<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// 抽取公共页面action</span>
        <span class="token keyword">async</span> <span class="token function">getPageListDataAction</span><span class="token punctuation">(</span>pageName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> queryInfo<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 1.请求用户列表数据</span>
            <span class="token keyword">const</span> pageListResult <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getPageListData</span><span class="token punctuation">(</span>pageName<span class="token punctuation">,</span> queryInfo<span class="token punctuation">)</span>
            <span class="token keyword">const</span> <span class="token punctuation">{</span> list<span class="token punctuation">,</span> totalCount <span class="token punctuation">}</span> <span class="token operator">=</span> pageListResult<span class="token punctuation">.</span>data
            <span class="token keyword">this</span><span class="token punctuation">.</span>pageList <span class="token operator">=</span> list
            <span class="token keyword">this</span><span class="token punctuation">.</span>pageTotalCount <span class="token operator">=</span> totalCount
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token keyword">async</span> <span class="token function">deletePageDataAction</span><span class="token punctuation">(</span>pageName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">deletePageData</span><span class="token punctuation">(</span>pageName<span class="token punctuation">,</span> id<span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getPageListDataAction</span><span class="token punctuation">(</span>pageName<span class="token punctuation">,</span> <span class="token punctuation">{</span> offset<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> size<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token keyword">async</span> <span class="token function">newPageDataAction</span><span class="token punctuation">(</span>pageName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> pageData<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">newPageData</span><span class="token punctuation">(</span>pageName<span class="token punctuation">,</span> pageData<span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getPageListDataAction</span><span class="token punctuation">(</span>pageName<span class="token punctuation">,</span> <span class="token punctuation">{</span> offset<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> size<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token keyword">async</span> <span class="token function">editPageDataAction</span><span class="token punctuation">(</span>pageName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> pageData<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">editPageData</span><span class="token punctuation">(</span>pageName<span class="token punctuation">,</span> id<span class="token punctuation">,</span> pageData<span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getPageListDataAction</span><span class="token punctuation">(</span>pageName<span class="token punctuation">,</span> <span class="token punctuation">{</span> offset<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> size<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> useSystemStore
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">ISystemState</span> <span class="token punctuation">{</span>
    <span class="token comment">// 抽取公共页面数据</span>
    pageList<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    pageTotalCount<span class="token operator">:</span> <span class="token builtin">number</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="封装表单搜索组件" tabindex="-1"><a class="header-anchor" href="#封装表单搜索组件" aria-hidden="true">#</a> 封装表单搜索组件</h3><p><img src="https://nevermore-picbed-1304219157.cos.ap-guangzhou.myqcloud.com/image_9XcwMn65Vo.png" alt=""></p><h4 id="编写表单搜索配置文件" tabindex="-1"><a class="header-anchor" href="#编写表单搜索配置文件" aria-hidden="true">#</a> 编写表单搜索配置文件</h4><p><code>search.config.ts</code></p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> searchConfig <span class="token operator">=</span> <span class="token punctuation">{</span>
    labelWidth<span class="token operator">:</span> <span class="token string">&#39;120px&#39;</span><span class="token punctuation">,</span>
    formItems<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            type<span class="token operator">:</span> <span class="token string">&#39;input&#39;</span><span class="token punctuation">,</span>
            prop<span class="token operator">:</span> <span class="token string">&#39;name&#39;</span><span class="token punctuation">,</span>
            label<span class="token operator">:</span> <span class="token string">&#39;部门名称&#39;</span><span class="token punctuation">,</span>
            placeholder<span class="token operator">:</span> <span class="token string">&#39;请输入查询的部门名称&#39;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            type<span class="token operator">:</span> <span class="token string">&#39;input&#39;</span><span class="token punctuation">,</span>
            prop<span class="token operator">:</span> <span class="token string">&#39;leader&#39;</span><span class="token punctuation">,</span>
            label<span class="token operator">:</span> <span class="token string">&#39;部门领导&#39;</span><span class="token punctuation">,</span>
            placeholder<span class="token operator">:</span> <span class="token string">&#39;请输入查询的领导名称&#39;</span><span class="token punctuation">,</span>
            initialValue<span class="token operator">:</span> <span class="token string">&#39;张三&#39;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            type<span class="token operator">:</span> <span class="token string">&#39;select&#39;</span><span class="token punctuation">,</span>
            prop<span class="token operator">:</span> <span class="token string">&#39;enable&#39;</span><span class="token punctuation">,</span>
            label<span class="token operator">:</span> <span class="token string">&#39;状态&#39;</span><span class="token punctuation">,</span>
            placeholder<span class="token operator">:</span> <span class="token string">&#39;请选择查询的状态&#39;</span><span class="token punctuation">,</span>
            options<span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token punctuation">{</span> label<span class="token operator">:</span> <span class="token string">&#39;启用&#39;</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">{</span> label<span class="token operator">:</span> <span class="token string">&#39;禁用&#39;</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            type<span class="token operator">:</span> <span class="token string">&#39;time&#39;</span><span class="token punctuation">,</span>
            prop<span class="token operator">:</span> <span class="token string">&#39;createAt&#39;</span><span class="token punctuation">,</span>
            label<span class="token operator">:</span> <span class="token string">&#39;创建时间&#39;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> searchConfig
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="重构表单搜索组件" tabindex="-1"><a class="header-anchor" href="#重构表单搜索组件" aria-hidden="true">#</a> 重构表单搜索组件</h4><p>将里面的具体的属性名称通过<code>search.config.ts</code>配置文件来动态遍历具体的属性和表单类型。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// page-search.vue</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;search&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>el<span class="token operator">-</span>form <span class="token operator">:</span>model<span class="token operator">=</span><span class="token string">&quot;searchForm&quot;</span> ref<span class="token operator">=</span><span class="token string">&quot;formRef&quot;</span> <span class="token operator">:</span>label<span class="token operator">-</span>width<span class="token operator">=</span><span class="token string">&quot;searchConfig.labelWidth ?? &#39;80px&#39;&quot;</span> size<span class="token operator">=</span><span class="token string">&quot;large&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>row <span class="token operator">:</span>gutter<span class="token operator">=</span><span class="token string">&quot;20&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 动态遍历配置config文件 <span class="token operator">--</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>template v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;item in searchConfig.formItems&quot;</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">&quot;item.prop&quot;</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>el<span class="token operator">-</span>col <span class="token operator">:</span>span<span class="token operator">=</span><span class="token string">&quot;8&quot;</span><span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item <span class="token operator">:</span>label<span class="token operator">=</span><span class="token string">&quot;item.label&quot;</span> <span class="token operator">:</span>prop<span class="token operator">=</span><span class="token string">&quot;item.prop&quot;</span><span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>template v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;item.type === &#39;input&#39;&quot;</span><span class="token operator">&gt;</span>
                            <span class="token operator">&lt;</span>el<span class="token operator">-</span>input v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;searchForm[item.prop]&quot;</span> <span class="token operator">:</span>placeholder<span class="token operator">=</span><span class="token string">&quot;item.placeholder&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>input<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>template v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;item.type === &#39;time&#39;&quot;</span><span class="token operator">&gt;</span>
                            <span class="token operator">&lt;</span>el<span class="token operator">-</span>date<span class="token operator">-</span>picker
                                v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;searchForm[item.prop]&quot;</span>
                                type<span class="token operator">=</span><span class="token string">&quot;daterange&quot;</span>
                                range<span class="token operator">-</span>separator<span class="token operator">=</span><span class="token string">&quot;-&quot;</span>
                                start<span class="token operator">-</span>placeholder<span class="token operator">=</span><span class="token string">&quot;开始时间&quot;</span>
                                end<span class="token operator">-</span>placeholder<span class="token operator">=</span><span class="token string">&quot;结束时间&quot;</span>
                            <span class="token operator">/</span><span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>template v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;item.type === &#39;select&#39;&quot;</span><span class="token operator">&gt;</span>
                            <span class="token operator">&lt;</span>el<span class="token operator">-</span>select v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;searchForm[item.prop]&quot;</span> <span class="token operator">:</span>placeholder<span class="token operator">=</span><span class="token string">&quot;item.placeholder&quot;</span> style<span class="token operator">=</span><span class="token string">&quot;width: 100%&quot;</span><span class="token operator">&gt;</span>
                                <span class="token operator">&lt;</span>template v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;option in item.options&quot;</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">&quot;option.value&quot;</span><span class="token operator">&gt;</span>
                                    <span class="token operator">&lt;</span>el<span class="token operator">-</span>option <span class="token operator">:</span>label<span class="token operator">=</span><span class="token string">&quot;option.label&quot;</span> <span class="token operator">:</span>value<span class="token operator">=</span><span class="token string">&quot;option.value&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>option<span class="token operator">&gt;</span>
                                <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
                            <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>select<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>col<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>row<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;btns&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>button icon<span class="token operator">=</span><span class="token string">&quot;Refresh&quot;</span> size<span class="token operator">=</span><span class="token string">&quot;large&quot;</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">click</span></span><span class="token operator">=</span><span class="token string">&quot;handleResetClick()&quot;</span><span class="token operator">&gt;</span>重置<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>button icon<span class="token operator">=</span><span class="token string">&quot;Search&quot;</span> size<span class="token operator">=</span><span class="token string">&quot;large&quot;</span> type<span class="token operator">=</span><span class="token string">&quot;primary&quot;</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">click</span></span> <span class="token operator">=</span> <span class="token string">&quot;handleQueryClick()&quot;</span><span class="token operator">&gt;</span>搜索<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> reactive<span class="token punctuation">,</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> ElForm <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;element-plus&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// 定义的参数需与配置文件中的参数一致</span>
<span class="token keyword">interface</span> <span class="token class-name">IProps</span> <span class="token punctuation">{</span>
    searchConfig<span class="token operator">:</span> <span class="token punctuation">{</span>
        labelWidth<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
        formItems<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 接受父组件传来的配置参数</span>
<span class="token keyword">const</span> props <span class="token operator">=</span> <span class="token generic-function"><span class="token function">defineProps</span><span class="token generic class-name"><span class="token operator">&lt;</span>IProps<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> emit <span class="token operator">=</span> <span class="token function">defineEmits</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;queryClick&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;resetClick&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> initialForm<span class="token operator">:</span> <span class="token builtin">any</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">const</span> item <span class="token keyword">of</span> props<span class="token punctuation">.</span>searchConfig<span class="token punctuation">.</span>formItems<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    initialForm<span class="token punctuation">[</span>item<span class="token punctuation">.</span>prop<span class="token punctuation">]</span> <span class="token operator">=</span> item<span class="token punctuation">.</span>initialValue <span class="token operator">??</span> <span class="token string">&#39;&#39;</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> searchForm <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    initialForm
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 重置功能</span>
<span class="token keyword">const</span> formRef <span class="token operator">=</span> <span class="token generic-function"><span class="token function">ref</span><span class="token generic class-name"><span class="token operator">&lt;</span>InstanceType<span class="token operator">&lt;</span><span class="token keyword">typeof</span> ElForm<span class="token operator">&gt;&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">handleResetClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    formRef<span class="token punctuation">.</span>value<span class="token operator">?.</span><span class="token function">resetFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// 发送请求重置查找</span>
    <span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&#39;resetClick&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 搜索功能</span>
<span class="token keyword">function</span> <span class="token function">handleQueryClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 通过事件抛出（子传父）</span>
    <span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&#39;queryClick&#39;</span><span class="token punctuation">,</span> searchForm<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style lang<span class="token operator">=</span><span class="token string">&quot;less&quot;</span> scoped<span class="token operator">&gt;</span>
<span class="token punctuation">.</span>search <span class="token punctuation">{</span>
    background<span class="token operator">-</span>color<span class="token operator">:</span> #fff<span class="token punctuation">;</span>
    padding<span class="token operator">:</span> 20px<span class="token punctuation">;</span>

    <span class="token punctuation">.</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item <span class="token punctuation">{</span>
        padding<span class="token operator">:</span> 20px<span class="token punctuation">;</span>
        margin<span class="token operator">-</span>bottom<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token punctuation">.</span>btns <span class="token punctuation">{</span>
        text<span class="token operator">-</span>align<span class="token operator">:</span> right<span class="token punctuation">;</span>
        padding<span class="token operator">:</span> <span class="token number">0</span> 50px 10px <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="父组件引用配置文件" tabindex="-1"><a class="header-anchor" href="#父组件引用配置文件" aria-hidden="true">#</a> 父组件引用配置文件</h4><p>父组件传递参数为<code>search-config</code>给子组件。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// department.vue</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;department&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>page<span class="token operator">-</span>search <span class="token operator">:</span>search<span class="token operator">-</span>config<span class="token operator">=</span><span class="token string">&quot;searchConfig&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token comment">// ...</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span> name<span class="token operator">=</span><span class="token string">&quot;department&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> pageSearch <span class="token keyword">from</span> <span class="token string">&#39;@/components/page-search/page-search.vue&#39;</span>
<span class="token keyword">import</span> searchConfig <span class="token keyword">from</span> <span class="token string">&#39;./config/search.config&#39;</span>
<span class="token comment">// ...</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="封装表格内容组件" tabindex="-1"><a class="header-anchor" href="#封装表格内容组件" aria-hidden="true">#</a> 封装表格内容组件</h3><p><img src="https://nevermore-picbed-1304219157.cos.ap-guangzhou.myqcloud.com/image_V3RocAKr0d.png" alt=""></p><h4 id="编写表格内容配置文件" tabindex="-1"><a class="header-anchor" href="#编写表格内容配置文件" aria-hidden="true">#</a> 编写表格内容配置文件</h4><p><code>content.config.ts</code></p><p>针对不同类型的表格数据的作用域插槽，区分不同的<code>type</code>。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> contentConfig <span class="token operator">=</span> <span class="token punctuation">{</span>
    pageName<span class="token operator">:</span> <span class="token string">&#39;Department&#39;</span><span class="token punctuation">,</span>
    header<span class="token operator">:</span> <span class="token punctuation">{</span>
        title<span class="token operator">:</span> <span class="token string">&#39;部门列表&#39;</span><span class="token punctuation">,</span>
        btnTitle<span class="token operator">:</span> <span class="token string">&#39;新建部门&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    propsList<span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&#39;selection&#39;</span><span class="token punctuation">,</span> label<span class="token operator">:</span> <span class="token string">&#39;选择&#39;</span><span class="token punctuation">,</span> width<span class="token operator">:</span> <span class="token string">&#39;80px&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&#39;index&#39;</span><span class="token punctuation">,</span> label<span class="token operator">:</span> <span class="token string">&#39;序号&#39;</span><span class="token punctuation">,</span> width<span class="token operator">:</span> <span class="token string">&#39;80px&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>

        <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&#39;normal&#39;</span><span class="token punctuation">,</span> prop<span class="token operator">:</span> <span class="token string">&#39;name&#39;</span><span class="token punctuation">,</span> label<span class="token operator">:</span> <span class="token string">&#39;部门名称&#39;</span><span class="token punctuation">,</span> width<span class="token operator">:</span> <span class="token string">&#39;150px&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&#39;normal&#39;</span><span class="token punctuation">,</span> prop<span class="token operator">:</span> <span class="token string">&#39;leader&#39;</span><span class="token punctuation">,</span> label<span class="token operator">:</span> <span class="token string">&#39;部门领导&#39;</span><span class="token punctuation">,</span> width<span class="token operator">:</span> <span class="token string">&#39;150px&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&#39;normal&#39;</span><span class="token punctuation">,</span> prop<span class="token operator">:</span> <span class="token string">&#39;parentId&#39;</span><span class="token punctuation">,</span> label<span class="token operator">:</span> <span class="token string">&#39;上级部门&#39;</span><span class="token punctuation">,</span> width<span class="token operator">:</span> <span class="token string">&#39;150px&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>

        <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&#39;time&#39;</span><span class="token punctuation">,</span> prop<span class="token operator">:</span> <span class="token string">&#39;createAt&#39;</span><span class="token punctuation">,</span> label<span class="token operator">:</span> <span class="token string">&#39;创建时间&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&#39;time&#39;</span><span class="token punctuation">,</span> prop<span class="token operator">:</span> <span class="token string">&#39;updateAt&#39;</span><span class="token punctuation">,</span> label<span class="token operator">:</span> <span class="token string">&#39;更新时间&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>

        <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&#39;handler&#39;</span><span class="token punctuation">,</span> label<span class="token operator">:</span> <span class="token string">&#39;操作&#39;</span><span class="token punctuation">,</span> width<span class="token operator">:</span> <span class="token string">&#39;180px&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> contentConfig
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="重构表格内容组件" tabindex="-1"><a class="header-anchor" href="#重构表格内容组件" aria-hidden="true">#</a> 重构表格内容组件</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// page-content.vue</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;content&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;header&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>h3 <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;title&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> contentConfig<span class="token operator">?.</span>header<span class="token operator">?.</span>title <span class="token operator">??</span> <span class="token string">&#39;数据列表&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h3<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>el<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">&quot;primary&quot;</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">click</span></span><span class="token operator">=</span><span class="token string">&quot;handleNewData&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> contentConfig<span class="token operator">?.</span>header<span class="token operator">?.</span>btnTitle <span class="token operator">??</span> <span class="token string">&#39;新建数据&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;table&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>el<span class="token operator">-</span>table <span class="token operator">:</span>data<span class="token operator">=</span><span class="token string">&quot;pageList&quot;</span> <span class="token operator">:</span>border<span class="token operator">=</span><span class="token string">&quot;true&quot;</span> style<span class="token operator">=</span><span class="token string">&quot;width: 100%&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>template v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;item in contentConfig.propsList&quot;</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">&quot;item.prop&quot;</span><span class="token operator">&gt;</span>

          <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 处理带自定义插槽的时间格式类型 <span class="token operator">--</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>template v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;item.type === &#39;time&#39;&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>el<span class="token operator">-</span>table<span class="token operator">-</span>column align<span class="token operator">=</span><span class="token string">&quot;center&quot;</span> v<span class="token operator">-</span>bind<span class="token operator">=</span><span class="token string">&quot;item&quot;</span><span class="token operator">&gt;</span>
              <span class="token operator">&lt;</span>template #<span class="token keyword">default</span><span class="token operator">=</span><span class="token string">&quot;scope&quot;</span><span class="token operator">&gt;</span>
                <span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token function">formatUTC</span><span class="token punctuation">(</span>scope<span class="token punctuation">.</span>row<span class="token punctuation">[</span>item<span class="token punctuation">.</span>prop<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
              <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>table<span class="token operator">-</span>column<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

          <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 处理handle类型 <span class="token operator">--</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>template v<span class="token operator">-</span><span class="token keyword">else</span><span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;item.type === &#39;handler&#39;&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>el<span class="token operator">-</span>table<span class="token operator">-</span>column align<span class="token operator">=</span><span class="token string">&quot;center&quot;</span> v<span class="token operator">-</span>bind<span class="token operator">=</span><span class="token string">&quot;item&quot;</span><span class="token operator">&gt;</span>
              <span class="token operator">&lt;</span>template #<span class="token keyword">default</span><span class="token operator">=</span><span class="token string">&quot;scope&quot;</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>el<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">&quot;primary&quot;</span> size<span class="token operator">=</span><span class="token string">&quot;small&quot;</span> icon<span class="token operator">=</span><span class="token string">&quot;EditPen&quot;</span> link <span class="token decorator"><span class="token at operator">@</span><span class="token function">click</span></span><span class="token operator">=</span><span class="token string">&quot;handleEditClick(scope.row)&quot;</span><span class="token operator">&gt;</span>
                  编辑
                <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>el<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">&quot;danger&quot;</span> size<span class="token operator">=</span><span class="token string">&quot;small&quot;</span> icon<span class="token operator">=</span><span class="token string">&quot;Delete&quot;</span> link <span class="token decorator"><span class="token at operator">@</span><span class="token function">click</span></span><span class="token operator">=</span><span class="token string">&quot;handleDeleteClick(scope.row.id)&quot;</span><span class="token operator">&gt;</span>
                  删除
                <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
              <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>table<span class="token operator">-</span>column<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

          <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 处理普通类型 <span class="token operator">--</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>template v<span class="token operator">-</span><span class="token keyword">else</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token operator">&lt;</span>el<span class="token operator">-</span>table<span class="token operator">-</span>column align<span class="token operator">=</span><span class="token string">&quot;center&quot;</span> <span class="token operator">:</span>type<span class="token operator">=</span><span class="token string">&quot;item.type&quot;</span> <span class="token operator">:</span>prop<span class="token operator">=</span><span class="token string">&quot;item.prop&quot;</span> <span class="token operator">:</span>label<span class="token operator">=</span><span class="token string">&quot;item.label&quot;</span> <span class="token operator">:</span>width<span class="token operator">=</span><span class="token string">&quot;item.width&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span> 相当于下面<span class="token operator">--</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>el<span class="token operator">-</span>table<span class="token operator">-</span>column align<span class="token operator">=</span><span class="token string">&quot;center&quot;</span> v<span class="token operator">-</span>bind<span class="token operator">=</span><span class="token string">&quot;item&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>table<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;footer&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>el<span class="token operator">-</span>pagination
        v<span class="token operator">-</span>model<span class="token operator">:</span>currentPage<span class="token operator">=</span><span class="token string">&quot;currentPage&quot;</span>
        v<span class="token operator">-</span>model<span class="token operator">:</span>page<span class="token operator">-</span>size<span class="token operator">=</span><span class="token string">&quot;pageSize&quot;</span>
        <span class="token operator">:</span>page<span class="token operator">-</span>sizes<span class="token operator">=</span><span class="token string">&quot;[10, 20, 30]&quot;</span>
        layout<span class="token operator">=</span><span class="token string">&quot;total, sizes, prev, pager, next, jumper&quot;</span>
        <span class="token operator">:</span>total<span class="token operator">=</span><span class="token string">&quot;pageTotalCount&quot;</span>
        <span class="token decorator"><span class="token at operator">@</span><span class="token function">current</span></span><span class="token operator">-</span>change<span class="token operator">=</span><span class="token string">&quot;handleCurrentChange&quot;</span>
      <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span> name<span class="token operator">=</span><span class="token string">&quot;content&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> storeToRefs <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;pinia&#39;</span>
<span class="token keyword">import</span> useSystemStore <span class="token keyword">from</span> <span class="token string">&#39;@/store/main/system/system&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> formatUTC <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/utils/format&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>

<span class="token keyword">interface</span> <span class="token class-name">IProps</span> <span class="token punctuation">{</span>
  contentConfig<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 用于处理接口方法中传入的pageName参数</span>
    pageName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
    header<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      title<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
      btnTitle<span class="token operator">:</span> <span class="token builtin">string</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    propsList<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> props <span class="token operator">=</span> <span class="token generic-function"><span class="token function">defineProps</span><span class="token generic class-name"><span class="token operator">&lt;</span>IProps<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> emit <span class="token operator">=</span> <span class="token function">defineEmits</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;newDataClick&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;editDataClick&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment">// 1.请求数据</span>
<span class="token keyword">const</span> systemStore <span class="token operator">=</span> <span class="token function">useSystemStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> currentPage <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> pageSize <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">fetchPageListData</span><span class="token punctuation">(</span>formData<span class="token operator">:</span> <span class="token builtin">any</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 1.获取offset和size</span>
  <span class="token keyword">const</span> size <span class="token operator">=</span> pageSize<span class="token punctuation">.</span>value
  <span class="token keyword">const</span> offset <span class="token operator">=</span> <span class="token punctuation">(</span>currentPage<span class="token punctuation">.</span>value <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> size
  <span class="token keyword">const</span> pageInfo <span class="token operator">=</span> <span class="token punctuation">{</span> size<span class="token punctuation">,</span> offset<span class="token punctuation">}</span>

  <span class="token comment">// 2.发起网络请求</span>
  <span class="token keyword">const</span> queryInfo <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>pageInfo<span class="token punctuation">,</span> <span class="token operator">...</span>formData<span class="token punctuation">}</span>
  <span class="token comment">// 从配置文件中获取pageName</span>
  systemStore<span class="token punctuation">.</span><span class="token function">getPageListDataAction</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>contentConfig<span class="token punctuation">.</span>pageName<span class="token punctuation">,</span> <span class="token punctuation">{</span> offset<span class="token punctuation">,</span> size<span class="token punctuation">,</span> <span class="token operator">...</span>queryInfo <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">fetchPageListData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 2.展示数据</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> pageList<span class="token punctuation">,</span> pageTotalCount <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">storeToRefs</span><span class="token punctuation">(</span>systemStore<span class="token punctuation">)</span>

<span class="token comment">// 3.绑定分页数据</span>
<span class="token keyword">function</span> <span class="token function">handleCurrentChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">fetchPageListData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">handleResetClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  currentPage<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">1</span>
  pageSize<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">10</span>
  <span class="token function">fetchPageListData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 4.新建数据的处理</span>
<span class="token keyword">function</span> <span class="token function">handleNewData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&#39;newDataClick&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 5.删除和编辑操作</span>
<span class="token keyword">function</span> <span class="token function">handleDeleteClick</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 从配置文件中获取pageName</span>
  systemStore<span class="token punctuation">.</span><span class="token function">deletePageDataAction</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>contentConfig<span class="token punctuation">.</span>pageName<span class="token punctuation">,</span> id<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">handleEditClick</span><span class="token punctuation">(</span>data<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&#39;editDataClick&#39;</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 暴露函数</span>
<span class="token function">defineExpose</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  fetchPageListData<span class="token punctuation">,</span>
  handleResetClick
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped lang<span class="token operator">=</span><span class="token string">&quot;less&quot;</span><span class="token operator">&gt;</span>
<span class="token punctuation">.</span>content <span class="token punctuation">{</span>
  margin<span class="token operator">-</span>top<span class="token operator">:</span> 20px<span class="token punctuation">;</span>
  padding<span class="token operator">:</span> 20px<span class="token punctuation">;</span>
  background<span class="token operator">-</span>color<span class="token operator">:</span> #fff<span class="token punctuation">;</span>

  <span class="token punctuation">.</span>header <span class="token punctuation">{</span>
    display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
    height<span class="token operator">:</span> 45px<span class="token punctuation">;</span>
    padding<span class="token operator">:</span> <span class="token number">0</span> 5px<span class="token punctuation">;</span>
    justify<span class="token operator">-</span>content<span class="token operator">:</span> space<span class="token operator">-</span>between<span class="token punctuation">;</span>
    align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>

    <span class="token punctuation">.</span>title <span class="token punctuation">{</span>
      font<span class="token operator">-</span>size<span class="token operator">:</span> 20px<span class="token punctuation">;</span>
      font<span class="token operator">-</span>weight<span class="token operator">:</span> <span class="token number">700</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token punctuation">.</span>handler <span class="token punctuation">{</span>
      align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token punctuation">.</span>table <span class="token punctuation">{</span>
    <span class="token operator">:</span><span class="token function">deep</span><span class="token punctuation">(</span><span class="token punctuation">.</span>el<span class="token operator">-</span>table__cell<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      padding<span class="token operator">:</span> 14px <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token punctuation">.</span>footer <span class="token punctuation">{</span>
    display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
    justify<span class="token operator">-</span>content<span class="token operator">:</span> flex<span class="token operator">-</span>end<span class="token punctuation">;</span>
    margin<span class="token operator">-</span>top<span class="token operator">:</span> 15px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="父组件引用配置文件-后面统一起来整理" tabindex="-1"><a class="header-anchor" href="#父组件引用配置文件-后面统一起来整理" aria-hidden="true">#</a> 父组件引用配置文件（后面统一起来整理）</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;department&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>page<span class="token operator">-</span>search <span class="token decorator"><span class="token at operator">@</span><span class="token function">query</span></span><span class="token operator">-</span>click<span class="token operator">=</span><span class="token string">&quot;handleQueryClick&quot;</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">reset</span></span><span class="token operator">-</span>click<span class="token operator">=</span><span class="token string">&quot;handleResetClick&quot;</span> <span class="token operator">:</span>search<span class="token operator">-</span>config<span class="token operator">=</span><span class="token string">&quot;searchConfig&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>page<span class="token operator">-</span>content ref<span class="token operator">=</span><span class="token string">&quot;contentRef&quot;</span> @<span class="token keyword">new</span><span class="token operator">-</span>data<span class="token operator">-</span>click<span class="token operator">=</span><span class="token string">&quot;handleNewDataClick&quot;</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">edit</span></span><span class="token operator">-</span>data<span class="token operator">-</span>click<span class="token operator">=</span><span class="token string">&quot;handleEditDataClick&quot;</span> <span class="token operator">:</span>content<span class="token operator">-</span>config<span class="token operator">=</span><span class="token string">&quot;contentConfig&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>page<span class="token operator">-</span>modal ref<span class="token operator">=</span><span class="token string">&quot;modalRef&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span> name<span class="token operator">=</span><span class="token string">&quot;department&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> pageSearch <span class="token keyword">from</span> <span class="token string">&#39;@/components/page-search/page-search.vue&#39;</span>
<span class="token keyword">import</span> PageContent <span class="token keyword">from</span> <span class="token string">&#39;@/components/page-content/page-content.vue&#39;</span>
<span class="token keyword">import</span> PageModal <span class="token keyword">from</span> <span class="token string">&#39;./cpns/page-modal.vue&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>

<span class="token keyword">import</span> searchConfig <span class="token keyword">from</span> <span class="token string">&#39;./config/search.config&#39;</span>
<span class="token keyword">import</span> contentConfig <span class="token keyword">from</span> <span class="token string">&#39;./config/content.config&#39;</span>

<span class="token keyword">const</span> contentRef <span class="token operator">=</span> <span class="token generic-function"><span class="token function">ref</span><span class="token generic class-name"><span class="token operator">&lt;</span>InstanceType<span class="token operator">&lt;</span><span class="token keyword">typeof</span> PageContent<span class="token operator">&gt;&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> modalRef <span class="token operator">=</span> <span class="token generic-function"><span class="token function">ref</span><span class="token generic class-name"><span class="token operator">&lt;</span>InstanceType<span class="token operator">&lt;</span><span class="token keyword">typeof</span> PageModal<span class="token operator">&gt;&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 搜索功能</span>
<span class="token keyword">function</span> <span class="token function">handleQueryClick</span><span class="token punctuation">(</span>searchInfo<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>searchInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
  contentRef<span class="token punctuation">.</span>value<span class="token operator">?.</span><span class="token function">fetchPageListData</span><span class="token punctuation">(</span>searchInfo<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 重置功能</span>
<span class="token keyword">function</span> <span class="token function">handleResetClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  contentRef<span class="token punctuation">.</span>value<span class="token operator">?.</span><span class="token function">fetchPageListData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 新增功能</span>
<span class="token keyword">function</span> <span class="token function">handleNewDataClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  modalRef<span class="token punctuation">.</span>value<span class="token operator">?.</span><span class="token function">setDialogVisible</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 编辑功能</span>
<span class="token keyword">function</span> <span class="token function">handleEditDataClick</span><span class="token punctuation">(</span>itemData<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  modalRef<span class="token punctuation">.</span>value<span class="token operator">?.</span><span class="token function">setDialogVisible</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> itemData<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="进阶-封装自定义的定制作用域插槽" tabindex="-1"><a class="header-anchor" href="#进阶-封装自定义的定制作用域插槽" aria-hidden="true">#</a> (进阶)封装自定义的定制作用域插槽</h4><p>以上代码是通过不断的<code>if</code>判断 <code>&lt;template v-else-if=&quot;item.type === &#39;custom&#39;&quot;&gt;</code>，来处理不同类型（带有作用域插槽）的<code>table</code>数据，如图片、<code>el-tag</code>、<code>button</code>等。因此通过编写通用的自定义插槽来预留一个插槽<code>slot</code>给父组件，使用户可以定制<code>table</code>数据内容。</p><p><strong>配置文件</strong></p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> contentConfig <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    propsList<span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token comment">// ...</span>
        <span class="token comment">// 自定义插槽定制（通用）</span>
        <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&#39;custom&#39;</span><span class="token punctuation">,</span> label<span class="token operator">:</span> <span class="token string">&#39;自定义插槽1&#39;</span><span class="token punctuation">,</span> prop<span class="token operator">:</span> <span class="token string">&#39;leader&#39;</span><span class="token punctuation">,</span> width<span class="token operator">:</span> <span class="token string">&#39;150px&#39;</span><span class="token punctuation">,</span> slotName<span class="token operator">:</span> <span class="token string">&#39;leader&#39;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&#39;custom&#39;</span><span class="token punctuation">,</span> label<span class="token operator">:</span> <span class="token string">&#39;自定义插槽2&#39;</span><span class="token punctuation">,</span> prop<span class="token operator">:</span> <span class="token string">&#39;parentId&#39;</span><span class="token punctuation">,</span> width<span class="token operator">:</span> <span class="token string">&#39;150px&#39;</span><span class="token punctuation">,</span> slotName<span class="token operator">:</span> <span class="token string">&#39;parent&#39;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> contentConfig
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>自定义插槽的组件模版</strong></p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;content&quot;</span><span class="token operator">&gt;</span>
    <span class="token comment">// ...</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;table&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>el<span class="token operator">-</span>table <span class="token operator">:</span>data<span class="token operator">=</span><span class="token string">&quot;pageList&quot;</span> <span class="token operator">:</span>border<span class="token operator">=</span><span class="token string">&quot;true&quot;</span> style<span class="token operator">=</span><span class="token string">&quot;width: 100%&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>template v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;item in contentConfig.propsList&quot;</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">&quot;item.prop&quot;</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 处理带自定义插槽的时间格式类型 <span class="token operator">--</span><span class="token operator">&gt;</span>
          <span class="token comment">// ...</span>
          <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 处理handle类型 <span class="token operator">--</span><span class="token operator">&gt;</span>
          <span class="token comment">// ....</span>
          <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 处理普通类型 <span class="token operator">--</span><span class="token operator">&gt;</span>
          <span class="token comment">// ....</span>

          <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token function">自定义插槽定制处理</span><span class="token punctuation">(</span>通用<span class="token punctuation">)</span> <span class="token operator">--</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>template v<span class="token operator">-</span><span class="token keyword">else</span><span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;item.type === &#39;custom&#39;&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>el<span class="token operator">-</span>table<span class="token operator">-</span>column align<span class="token operator">=</span><span class="token string">&quot;center&quot;</span> v<span class="token operator">-</span>bind<span class="token operator">=</span><span class="token string">&quot;item&quot;</span><span class="token operator">&gt;</span>
              <span class="token operator">&lt;</span>template #<span class="token keyword">default</span><span class="token operator">=</span><span class="token string">&quot;scope&quot;</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 给用户预留定制插槽 <span class="token operator">--</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>slot <span class="token operator">:</span>name<span class="token operator">=</span><span class="token string">&quot;item.slotName&quot;</span> v<span class="token operator">-</span>bind<span class="token operator">=</span><span class="token string">&quot;scope&quot;</span> <span class="token operator">:</span>prop<span class="token operator">=</span><span class="token string">&quot;item.prop&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>slot<span class="token operator">&gt;</span>
              <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>table<span class="token operator">-</span>column<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

        <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

      <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>table<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>父组件编写定制插槽</strong></p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;department&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>page<span class="token operator">-</span>search <span class="token decorator"><span class="token at operator">@</span><span class="token function">query</span></span><span class="token operator">-</span>click<span class="token operator">=</span><span class="token string">&quot;handleQueryClick&quot;</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">reset</span></span><span class="token operator">-</span>click<span class="token operator">=</span><span class="token string">&quot;handleResetClick&quot;</span> <span class="token operator">:</span>search<span class="token operator">-</span>config<span class="token operator">=</span><span class="token string">&quot;searchConfig&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span>page<span class="token operator">-</span>content ref<span class="token operator">=</span><span class="token string">&quot;contentRef&quot;</span> @<span class="token keyword">new</span><span class="token operator">-</span>data<span class="token operator">-</span>click<span class="token operator">=</span><span class="token string">&quot;handleNewDataClick&quot;</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">edit</span></span><span class="token operator">-</span>data<span class="token operator">-</span>click<span class="token operator">=</span><span class="token string">&quot;handleEditDataClick&quot;</span> <span class="token operator">:</span>content<span class="token operator">-</span>config<span class="token operator">=</span><span class="token string">&quot;contentConfig&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>template #leader<span class="token operator">=</span><span class="token string">&quot;scope&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>span style<span class="token operator">=</span><span class="token string">&quot;color: red;&quot;</span><span class="token operator">&gt;</span>
          <span class="token punctuation">{</span><span class="token punctuation">{</span> scope<span class="token punctuation">.</span>row<span class="token punctuation">[</span>scope<span class="token punctuation">.</span>prop<span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>template #parent<span class="token operator">=</span><span class="token string">&quot;scope&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>tag<span class="token operator">&gt;</span>
          <span class="token punctuation">{</span><span class="token punctuation">{</span> scope<span class="token punctuation">.</span>row<span class="token punctuation">[</span>scope<span class="token punctuation">.</span>prop<span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>tag<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>page<span class="token operator">-</span>content<span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span>page<span class="token operator">-</span>modal ref<span class="token operator">=</span><span class="token string">&quot;modalRef&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="封装模态框组件" tabindex="-1"><a class="header-anchor" href="#封装模态框组件" aria-hidden="true">#</a> 封装模态框组件</h3><p><img src="https://nevermore-picbed-1304219157.cos.ap-guangzhou.myqcloud.com/image_rLSWO79LOv.png" alt=""></p><h4 id="编写模态框内容配置文件" tabindex="-1"><a class="header-anchor" href="#编写模态框内容配置文件" aria-hidden="true">#</a> 编写模态框内容配置文件</h4><p><code>motal.config.ts</code></p><p>这里的<code>options</code>应该是由获取接口数据得到的，后续会进行封装，这里先写为静态的。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> modalConfig <span class="token operator">=</span> <span class="token punctuation">{</span>
    header<span class="token operator">:</span> <span class="token punctuation">{</span>
        newTitle<span class="token operator">:</span> <span class="token string">&#39;新建部门&#39;</span><span class="token punctuation">,</span>
        editTitle<span class="token operator">:</span> <span class="token string">&#39;编辑部门&#39;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    pageName<span class="token operator">:</span> <span class="token string">&#39;department&#39;</span><span class="token punctuation">,</span>
    formItems<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            type<span class="token operator">:</span> <span class="token string">&#39;input&#39;</span><span class="token punctuation">,</span>
            prop<span class="token operator">:</span> <span class="token string">&#39;name&#39;</span><span class="token punctuation">,</span>
            label<span class="token operator">:</span> <span class="token string">&#39;部门名称&#39;</span><span class="token punctuation">,</span>
            placeholder<span class="token operator">:</span> <span class="token string">&#39;请输入部门名称&#39;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            type<span class="token operator">:</span> <span class="token string">&#39;input&#39;</span><span class="token punctuation">,</span>
            prop<span class="token operator">:</span> <span class="token string">&#39;leader&#39;</span><span class="token punctuation">,</span>
            label<span class="token operator">:</span> <span class="token string">&#39;部门领导&#39;</span><span class="token punctuation">,</span>
            placeholder<span class="token operator">:</span> <span class="token string">&#39;请输入查询的领导名称&#39;</span><span class="token punctuation">,</span>
            initialValue<span class="token operator">:</span> <span class="token string">&#39;张三&#39;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            type<span class="token operator">:</span> <span class="token string">&#39;select&#39;</span><span class="token punctuation">,</span>
            prop<span class="token operator">:</span> <span class="token string">&#39;parentId&#39;</span><span class="token punctuation">,</span>
            label<span class="token operator">:</span> <span class="token string">&#39;上级部门&#39;</span><span class="token punctuation">,</span>
            options<span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token comment">// 后面使用动态获取</span>
                <span class="token comment">// { label: &#39;部门1&#39;, value: &#39;1&#39; },</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> modalConfig
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="重构模态框内容组件" tabindex="-1"><a class="header-anchor" href="#重构模态框内容组件" aria-hidden="true">#</a> 重构模态框内容组件</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// page-modal.vue</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;modal&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>el<span class="token operator">-</span>dialog v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;dialogVisible&quot;</span> <span class="token operator">:</span>title<span class="token operator">=</span><span class="token string">&quot;isEdit ? modalConfig.header.editTitle : modalConfig.header.newTitle&quot;</span> width<span class="token operator">=</span><span class="token string">&quot;30%&quot;</span> center<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;form&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>form <span class="token operator">:</span>model<span class="token operator">=</span><span class="token string">&quot;formData&quot;</span> label<span class="token operator">-</span>width<span class="token operator">=</span><span class="token string">&quot;80px&quot;</span> size<span class="token operator">=</span><span class="token string">&quot;large&quot;</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>template v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;item in modalConfig.formItems&quot;</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">&quot;item.prop&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item v<span class="token operator">-</span>bind<span class="token operator">=</span><span class="token string">&quot;item&quot;</span><span class="token operator">&gt;</span>
              <span class="token operator">&lt;</span>template v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;item.type === &#39;input&#39;&quot;</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>el<span class="token operator">-</span>input v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;formData[item.prop]&quot;</span> <span class="token operator">:</span>placeholder<span class="token operator">=</span><span class="token string">&quot;item.placeholder&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
              <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

              <span class="token operator">&lt;</span>template v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;item.type === &#39;select&#39;&quot;</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>el<span class="token operator">-</span>select v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;formData[item.prop]&quot;</span> <span class="token operator">:</span>placeholder<span class="token operator">=</span><span class="token string">&quot;item.placeholder&quot;</span> style<span class="token operator">=</span><span class="token string">&quot;width: 100%&quot;</span><span class="token operator">&gt;</span>
                  <span class="token operator">&lt;</span>template v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;option in item.options&quot;</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">&quot;option.value&quot;</span><span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>el<span class="token operator">-</span>option <span class="token operator">:</span>value<span class="token operator">=</span><span class="token string">&quot;option.value&quot;</span> <span class="token operator">:</span>label<span class="token operator">=</span><span class="token string">&quot;option.label&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
                  <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>select<span class="token operator">&gt;</span>
              <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>template #footer<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;dialog-footer&quot;</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>el<span class="token operator">-</span>button <span class="token decorator"><span class="token at operator">@</span><span class="token function">click</span></span><span class="token operator">=</span><span class="token string">&quot;dialogVisible = false&quot;</span><span class="token operator">&gt;</span>取消<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>el<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">&quot;primary&quot;</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">click</span></span><span class="token operator">=</span><span class="token string">&quot;handleConfirmClick&quot;</span><span class="token operator">&gt;</span>确定<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>dialog<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span> name<span class="token operator">=</span><span class="token string">&quot;modal&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> useMainStore <span class="token keyword">from</span> <span class="token string">&#39;@/store/main/main&#39;</span>
<span class="token keyword">import</span> useSystemStore <span class="token keyword">from</span> <span class="token string">&#39;@/store/main/system/system&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> storeToRefs <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;pinia&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> reactive<span class="token punctuation">,</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>

<span class="token keyword">const</span> dialogVisible <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> isEdit <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> editData <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 部门和角色的数据</span>
<span class="token keyword">const</span> mainStore <span class="token operator">=</span> <span class="token function">useMainStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> entireDepartments <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">storeToRefs</span><span class="token punctuation">(</span>mainStore<span class="token punctuation">)</span>

<span class="token keyword">interface</span> <span class="token class-name">IProps</span> <span class="token punctuation">{</span>
  modalConfig<span class="token operator">:</span> <span class="token punctuation">{</span>
    header<span class="token operator">:</span> <span class="token punctuation">{</span>
      newTitle<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
      editTitle<span class="token operator">:</span> <span class="token builtin">string</span>
    <span class="token punctuation">}</span>
    pageName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
    formItems<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 定义props</span>
<span class="token keyword">const</span> props <span class="token operator">=</span> <span class="token generic-function"><span class="token function">defineProps</span><span class="token generic class-name"><span class="token operator">&lt;</span>IProps<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 定义数据绑定</span>
<span class="token keyword">const</span> initialForm<span class="token operator">:</span> <span class="token builtin">any</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">const</span> item <span class="token keyword">of</span> props<span class="token punctuation">.</span>modalConfig<span class="token punctuation">.</span>formItems<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    initialForm<span class="token punctuation">[</span>item<span class="token punctuation">.</span>prop<span class="token punctuation">]</span> <span class="token operator">=</span> item<span class="token punctuation">.</span>initialValue <span class="token operator">??</span> <span class="token string">&#39;&#39;</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> formData <span class="token operator">=</span> <span class="token generic-function"><span class="token function">reactive</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>initialForm<span class="token punctuation">)</span>

<span class="token comment">// 点击确定</span>
<span class="token keyword">const</span> systemStore <span class="token operator">=</span> <span class="token function">useSystemStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">handleConfirmClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  dialogVisible<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isEdit<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    systemStore<span class="token punctuation">.</span><span class="token function">newPageDataAction</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>modalConfig<span class="token punctuation">.</span>pageName<span class="token punctuation">,</span> formData<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    systemStore<span class="token punctuation">.</span><span class="token function">editPageDataAction</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>modalConfig<span class="token punctuation">.</span>pageName<span class="token punctuation">,</span> editData<span class="token punctuation">.</span>value<span class="token punctuation">.</span>id<span class="token punctuation">,</span> formData<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 新建或者编辑</span>
<span class="token keyword">function</span> <span class="token function">setDialogVisible</span><span class="token punctuation">(</span>isNew<span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span> data<span class="token operator">:</span> <span class="token builtin">any</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  dialogVisible<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span>
  isEdit<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token operator">!</span>isNew
  editData<span class="token punctuation">.</span>value <span class="token operator">=</span> data
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> formData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>isNew<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      formData<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&#39;&#39;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      formData<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token function">defineExpose</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  setDialogVisible
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped lang<span class="token operator">=</span><span class="token string">&quot;less&quot;</span><span class="token operator">&gt;</span>
<span class="token punctuation">.</span>form <span class="token punctuation">{</span>
  padding<span class="token operator">:</span> 10px 30px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="将选择器下拉内容-options-改为动态获取接口数据" tabindex="-1"><a class="header-anchor" href="#将选择器下拉内容-options-改为动态获取接口数据" aria-hidden="true">#</a> 将选择器下拉内容 options 改为动态获取接口数据</h4><p>在父组件中将要传入的<code>modalConfig</code>进行预处理，使用<code>pinia</code>将接口数据（<code>name</code>, <code>id</code>）先映射成<code>options</code>需要的参数（<code>label</code>, <code>value</code>），再将数据推入到<code>prop</code>为<code>parentId</code>下的<code>options</code>数组中。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 父组件deparment.vue</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;department&quot;</span><span class="token operator">&gt;</span>
    <span class="token comment">// ...</span>
    <span class="token operator">&lt;</span>page<span class="token operator">-</span>modal ref<span class="token operator">=</span><span class="token string">&quot;modalRef&quot;</span> <span class="token operator">:</span>modal<span class="token operator">-</span>config<span class="token operator">=</span><span class="token string">&quot;modalConfigRef&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span> name<span class="token operator">=</span><span class="token string">&quot;department&quot;</span><span class="token operator">&gt;</span>
<span class="token comment">// ...</span>
<span class="token keyword">import</span> PageModal <span class="token keyword">from</span> <span class="token string">&#39;@/components/page-modal/page-modal.vue&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> computed<span class="token punctuation">,</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token keyword">import</span> modalConfig <span class="token keyword">from</span> <span class="token string">&#39;./config/modal.config&#39;</span>
<span class="token keyword">import</span> useMainStore <span class="token keyword">from</span> <span class="token string">&#39;@/store/main/main&#39;</span>

<span class="token comment">// 对modalConfig进行操作，用于select中的options来自于接口数据</span>
<span class="token keyword">const</span> modalConfigRef <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> mainStore <span class="token operator">=</span> <span class="token function">useMainStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// 将获取到的name和id映射成option需要的label和value形式</span>
  <span class="token keyword">const</span> departments <span class="token operator">=</span> mainStore<span class="token punctuation">.</span>entireDepartments<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> label<span class="token operator">:</span> item<span class="token punctuation">.</span>name<span class="token punctuation">,</span> value<span class="token operator">:</span> item<span class="token punctuation">.</span>id <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  modalConfig<span class="token punctuation">.</span>formItems<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>prop <span class="token operator">===</span> <span class="token string">&#39;parentId&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      item<span class="token punctuation">.</span>options<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">...</span>departments<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> modalConfig
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// ...</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="页面公共逻辑的-hooks-抽取" tabindex="-1"><a class="header-anchor" href="#页面公共逻辑的-hooks-抽取" aria-hidden="true">#</a> 页面公共逻辑的 hooks 抽取</h3><h4 id="抽取表单搜索内容中的搜索功能和重置功能。" tabindex="-1"><a class="header-anchor" href="#抽取表单搜索内容中的搜索功能和重置功能。" aria-hidden="true">#</a> 抽取表单搜索内容中的搜索功能和重置功能。</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// hooks/usePageContent.ts</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token class-name">PageContent</span> <span class="token keyword">from</span> <span class="token string">&quot;@/components/page-content/page-content.vue&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">usePageContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> contentRef <span class="token operator">=</span> <span class="token generic-function"><span class="token function">ref</span><span class="token generic class-name"><span class="token operator">&lt;</span>InstanceType<span class="token operator">&lt;</span><span class="token keyword">typeof</span> PageContent<span class="token operator">&gt;&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// 搜索功能</span>
    <span class="token keyword">function</span> <span class="token function">handleQueryClick</span><span class="token punctuation">(</span>searchInfo<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>searchInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
        contentRef<span class="token punctuation">.</span>value<span class="token operator">?.</span><span class="token function">fetchPageListData</span><span class="token punctuation">(</span>searchInfo<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 重置功能</span>
    <span class="token keyword">function</span> <span class="token function">handleResetClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        contentRef<span class="token punctuation">.</span>value<span class="token operator">?.</span><span class="token function">fetchPageListData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        contentRef<span class="token punctuation">,</span>
        handleQueryClick<span class="token punctuation">,</span>
        handleResetClick
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="抽取模态框中新增和编辑功能。" tabindex="-1"><a class="header-anchor" href="#抽取模态框中新增和编辑功能。" aria-hidden="true">#</a> 抽取模态框中新增和编辑功能。</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// hooks/usePageModal.ts</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token class-name">PageModal</span> <span class="token keyword">from</span> <span class="token string">&quot;@/components/page-modal/page-modal.vue&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">usePageModal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> modalRef <span class="token operator">=</span> <span class="token generic-function"><span class="token function">ref</span><span class="token generic class-name"><span class="token operator">&lt;</span>InstanceType<span class="token operator">&lt;</span><span class="token keyword">typeof</span> PageModal<span class="token operator">&gt;&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment">// 新增功能</span>
    <span class="token keyword">function</span> <span class="token function">handleNewDataClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        modalRef<span class="token punctuation">.</span>value<span class="token operator">?.</span><span class="token function">setDialogVisible</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 编辑功能</span>
    <span class="token keyword">function</span> <span class="token function">handleEditDataClick</span><span class="token punctuation">(</span>itemData<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        modalRef<span class="token punctuation">.</span>value<span class="token operator">?.</span><span class="token function">setDialogVisible</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> itemData<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        modalRef<span class="token punctuation">,</span>
        handleEditDataClick<span class="token punctuation">,</span>
        handleNewDataClick
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="父组件中调用-hooks。" tabindex="-1"><a class="header-anchor" href="#父组件中调用-hooks。" aria-hidden="true">#</a> 父组件中调用 hooks。</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span> name<span class="token operator">=</span><span class="token string">&quot;department&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> usePageContent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/hooks/usePageContent&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> usePageModal <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/hooks/usePageModal&#39;</span>
<span class="token comment">// ...</span>
<span class="token comment">// 抽取成hooks</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> contentRef<span class="token punctuation">,</span> handleQueryClick<span class="token punctuation">,</span> handleResetClick <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">usePageContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> modalRef<span class="token punctuation">,</span> handleEditDataClick<span class="token punctuation">,</span> handleNewDataClick <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">usePageModal</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="实现菜单管理功能" tabindex="-1"><a class="header-anchor" href="#实现菜单管理功能" aria-hidden="true">#</a> 实现菜单管理功能</h2><p><img src="https://nevermore-picbed-1304219157.cos.ap-guangzhou.myqcloud.com/image_8C-i5wpqZt.png" alt=""></p><h3 id="实现树形子树的展示" tabindex="-1"><a class="header-anchor" href="#实现树形子树的展示" aria-hidden="true">#</a> 实现树形子树的展示</h3><p>使用<code>el-table</code>中的<code>row-key=&quot;id&quot;</code>来绑定子树的<code>id</code>。这里使用配置项来在表格数据中动态绑定。</p><blockquote><p><a href="https://element-plus.gitee.io/zh-CN/component/table.html#%E6%A0%91%E5%BD%A2%E6%95%B0%E6%8D%AE%E4%B8%8E%E6%87%92%E5%8A%A0%E8%BD%BD" target="_blank" rel="noopener noreferrer">树形数据<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>：支持树类型的数据的显示。 当 row 中包含 <code>children</code> 字段时，被视为树形数据。 渲染嵌套数据需要 prop 的 <code>row-key</code>。 此外，子行数据可以异步加载。 设置 Table 的<code>lazy</code>属性为 true 与加载函数 <code>load</code> 。 通过指定 row 中的<code>hasChildren</code>字段来指定哪些行是包含子节点。 <code>children</code> 与<code>hasChildren</code>都可以通过 <code>tree-props</code> 配置。</p></blockquote><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// page-content.vue</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;content&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;header&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>h3 <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;title&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> contentConfig<span class="token operator">?.</span>header<span class="token operator">?.</span>title <span class="token operator">??</span> <span class="token string">&#39;数据列表&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h3<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>el<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">&quot;primary&quot;</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">click</span></span><span class="token operator">=</span><span class="token string">&quot;handleNewData&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> contentConfig<span class="token operator">?.</span>header<span class="token operator">?.</span>btnTitle <span class="token operator">??</span> <span class="token string">&#39;新建数据&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;table&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>el<span class="token operator">-</span>table <span class="token operator">:</span>data<span class="token operator">=</span><span class="token string">&quot;pageList&quot;</span> <span class="token operator">:</span>border<span class="token operator">=</span><span class="token string">&quot;true&quot;</span> style<span class="token operator">=</span><span class="token string">&quot;width: 100%&quot;</span> v<span class="token operator">-</span>bind<span class="token operator">=</span><span class="token string">&quot;contentConfig.childrenTree&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>template v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;item in contentConfig.propsList&quot;</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">&quot;item.prop&quot;</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 处理带自定义插槽的时间格式类型 <span class="token operator">--</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>template v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;item.type === &#39;timer&#39;&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>el<span class="token operator">-</span>table<span class="token operator">-</span>column align<span class="token operator">=</span><span class="token string">&quot;center&quot;</span> v<span class="token operator">-</span>bind<span class="token operator">=</span><span class="token string">&quot;item&quot;</span><span class="token operator">&gt;</span>
              <span class="token operator">&lt;</span>template #<span class="token keyword">default</span><span class="token operator">=</span><span class="token string">&quot;scope&quot;</span><span class="token operator">&gt;</span>
                <span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token function">formatUTC</span><span class="token punctuation">(</span>scope<span class="token punctuation">.</span>row<span class="token punctuation">[</span>item<span class="token punctuation">.</span>prop<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
              <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>table<span class="token operator">-</span>column<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

          <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 处理handle类型 <span class="token operator">--</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>template v<span class="token operator">-</span><span class="token keyword">else</span><span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;item.type === &#39;handler&#39;&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>el<span class="token operator">-</span>table<span class="token operator">-</span>column align<span class="token operator">=</span><span class="token string">&quot;center&quot;</span> v<span class="token operator">-</span>bind<span class="token operator">=</span><span class="token string">&quot;item&quot;</span><span class="token operator">&gt;</span>
              <span class="token operator">&lt;</span>template #<span class="token keyword">default</span><span class="token operator">=</span><span class="token string">&quot;scope&quot;</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>el<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">&quot;primary&quot;</span> size<span class="token operator">=</span><span class="token string">&quot;small&quot;</span> icon<span class="token operator">=</span><span class="token string">&quot;EditPen&quot;</span> link <span class="token decorator"><span class="token at operator">@</span><span class="token function">click</span></span><span class="token operator">=</span><span class="token string">&quot;handleEditClick(scope.row)&quot;</span><span class="token operator">&gt;</span>
                  编辑
                <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>el<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">&quot;danger&quot;</span> size<span class="token operator">=</span><span class="token string">&quot;small&quot;</span> icon<span class="token operator">=</span><span class="token string">&quot;Delete&quot;</span> link <span class="token decorator"><span class="token at operator">@</span><span class="token function">click</span></span><span class="token operator">=</span><span class="token string">&quot;handleDeleteClick(scope.row.id)&quot;</span><span class="token operator">&gt;</span>
                  删除
                <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
              <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>table<span class="token operator">-</span>column<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

          <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 处理普通类型 <span class="token operator">--</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>template v<span class="token operator">-</span><span class="token keyword">else</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token operator">&lt;</span>el<span class="token operator">-</span>table<span class="token operator">-</span>column align<span class="token operator">=</span><span class="token string">&quot;center&quot;</span> <span class="token operator">:</span>type<span class="token operator">=</span><span class="token string">&quot;item.type&quot;</span> <span class="token operator">:</span>prop<span class="token operator">=</span><span class="token string">&quot;item.prop&quot;</span> <span class="token operator">:</span>label<span class="token operator">=</span><span class="token string">&quot;item.label&quot;</span> <span class="token operator">:</span>width<span class="token operator">=</span><span class="token string">&quot;item.width&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span> 相当于下面<span class="token operator">--</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>el<span class="token operator">-</span>table<span class="token operator">-</span>column align<span class="token operator">=</span><span class="token string">&quot;center&quot;</span> v<span class="token operator">-</span>bind<span class="token operator">=</span><span class="token string">&quot;item&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

      <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>table<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;footer&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>el<span class="token operator">-</span>pagination
        v<span class="token operator">-</span>model<span class="token operator">:</span>currentPage<span class="token operator">=</span><span class="token string">&quot;currentPage&quot;</span>
        v<span class="token operator">-</span>model<span class="token operator">:</span>page<span class="token operator">-</span>size<span class="token operator">=</span><span class="token string">&quot;pageSize&quot;</span>
        <span class="token operator">:</span>page<span class="token operator">-</span>sizes<span class="token operator">=</span><span class="token string">&quot;[10, 20, 30]&quot;</span>
        layout<span class="token operator">=</span><span class="token string">&quot;total, sizes, prev, pager, next, jumper&quot;</span>
        <span class="token operator">:</span>total<span class="token operator">=</span><span class="token string">&quot;pageTotalCount&quot;</span>
        <span class="token decorator"><span class="token at operator">@</span><span class="token function">current</span></span><span class="token operator">-</span>change<span class="token operator">=</span><span class="token string">&quot;handleCurrentChange&quot;</span>
      <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span> name<span class="token operator">=</span><span class="token string">&quot;content&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> storeToRefs <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;pinia&#39;</span>
<span class="token keyword">import</span> useSystemStore <span class="token keyword">from</span> <span class="token string">&#39;@/store/main/system/system&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> formatUTC <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/utils/format&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>

<span class="token keyword">interface</span> <span class="token class-name">IProps</span> <span class="token punctuation">{</span>
  contentConfig<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 用于处理接口方法中传入的pageName参数</span>
    pageName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
    header<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      title<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
      btnTitle<span class="token operator">:</span> <span class="token builtin">string</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    propsList<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    childrenTree<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> props <span class="token operator">=</span> <span class="token generic-function"><span class="token function">defineProps</span><span class="token generic class-name"><span class="token operator">&lt;</span>IProps<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> emit <span class="token operator">=</span> <span class="token function">defineEmits</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;newDataClick&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;editDataClick&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment">// 1.请求数据</span>
<span class="token keyword">const</span> systemStore <span class="token operator">=</span> <span class="token function">useSystemStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> currentPage <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> pageSize <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">fetchPageListData</span><span class="token punctuation">(</span>formData<span class="token operator">:</span> <span class="token builtin">any</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 1.获取offset和size</span>
  <span class="token keyword">const</span> size <span class="token operator">=</span> pageSize<span class="token punctuation">.</span>value
  <span class="token keyword">const</span> offset <span class="token operator">=</span> <span class="token punctuation">(</span>currentPage<span class="token punctuation">.</span>value <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> size
  <span class="token keyword">const</span> pageInfo <span class="token operator">=</span> <span class="token punctuation">{</span> size<span class="token punctuation">,</span> offset<span class="token punctuation">}</span>

  <span class="token comment">// 2.发起网络请求</span>
  <span class="token keyword">const</span> queryInfo <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>pageInfo<span class="token punctuation">,</span> <span class="token operator">...</span>formData<span class="token punctuation">}</span>
  systemStore<span class="token punctuation">.</span><span class="token function">getPageListDataAction</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>contentConfig<span class="token punctuation">.</span>pageName<span class="token punctuation">,</span> <span class="token punctuation">{</span> offset<span class="token punctuation">,</span> size<span class="token punctuation">,</span> <span class="token operator">...</span>queryInfo <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">fetchPageListData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 2.展示数据</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> pageList<span class="token punctuation">,</span> pageTotalCount <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">storeToRefs</span><span class="token punctuation">(</span>systemStore<span class="token punctuation">)</span>

<span class="token comment">// 3.绑定分页数据</span>
<span class="token keyword">function</span> <span class="token function">handleCurrentChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">fetchPageListData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">handleResetClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  currentPage<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">1</span>
  pageSize<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">10</span>
  <span class="token function">fetchPageListData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 4.新建数据的处理</span>
<span class="token keyword">function</span> <span class="token function">handleNewData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&#39;newDataClick&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 5.删除和编辑操作</span>
<span class="token keyword">function</span> <span class="token function">handleDeleteClick</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  systemStore<span class="token punctuation">.</span><span class="token function">deletePageDataAction</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>contentConfig<span class="token punctuation">.</span>pageName<span class="token punctuation">,</span> id<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">handleEditClick</span><span class="token punctuation">(</span>data<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&#39;editDataClick&#39;</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 暴露函数</span>
<span class="token function">defineExpose</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  fetchPageListData<span class="token punctuation">,</span>
  handleResetClick
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped lang<span class="token operator">=</span><span class="token string">&quot;less&quot;</span><span class="token operator">&gt;</span>
<span class="token punctuation">.</span>content <span class="token punctuation">{</span>
  margin<span class="token operator">-</span>top<span class="token operator">:</span> 20px<span class="token punctuation">;</span>
  padding<span class="token operator">:</span> 20px<span class="token punctuation">;</span>
  background<span class="token operator">-</span>color<span class="token operator">:</span> #fff<span class="token punctuation">;</span>

  <span class="token punctuation">.</span>header <span class="token punctuation">{</span>
    display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
    height<span class="token operator">:</span> 45px<span class="token punctuation">;</span>
    padding<span class="token operator">:</span> <span class="token number">0</span> 5px<span class="token punctuation">;</span>
    justify<span class="token operator">-</span>content<span class="token operator">:</span> space<span class="token operator">-</span>between<span class="token punctuation">;</span>
    align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>

    <span class="token punctuation">.</span>title <span class="token punctuation">{</span>
      font<span class="token operator">-</span>size<span class="token operator">:</span> 20px<span class="token punctuation">;</span>
      font<span class="token operator">-</span>weight<span class="token operator">:</span> <span class="token number">700</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token punctuation">.</span>handler <span class="token punctuation">{</span>
      align<span class="token operator">-</span>items<span class="token operator">:</span> center<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token punctuation">.</span>table <span class="token punctuation">{</span>
    <span class="token operator">:</span><span class="token function">deep</span><span class="token punctuation">(</span><span class="token punctuation">.</span>el<span class="token operator">-</span>table__cell<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      padding<span class="token operator">:</span> 14px <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token punctuation">.</span>footer <span class="token punctuation">{</span>
    display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
    justify<span class="token operator">-</span>content<span class="token operator">:</span> flex<span class="token operator">-</span>end<span class="token punctuation">;</span>
    margin<span class="token operator">-</span>top<span class="token operator">:</span> 15px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使用配置项绑定<code>row-key</code>属性。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// content.config.ts</span>
<span class="token keyword">const</span> contentConfig <span class="token operator">=</span> <span class="token punctuation">{</span>
    pageName<span class="token operator">:</span> <span class="token string">&#39;menu&#39;</span><span class="token punctuation">,</span>
    header<span class="token operator">:</span> <span class="token punctuation">{</span>
      title<span class="token operator">:</span> <span class="token string">&#39;菜单列表&#39;</span><span class="token punctuation">,</span>
      btnTitle<span class="token operator">:</span> <span class="token string">&#39;新建菜单&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    propsList<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token comment">// 若要实现树形数据，就不能加type，会冲突</span>
      <span class="token punctuation">{</span> prop<span class="token operator">:</span> <span class="token string">&#39;name&#39;</span><span class="token punctuation">,</span> label<span class="token operator">:</span> <span class="token string">&#39;菜单名称&#39;</span><span class="token punctuation">,</span> width<span class="token operator">:</span> <span class="token string">&#39;180px&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> prop<span class="token operator">:</span> <span class="token string">&#39;type&#39;</span><span class="token punctuation">,</span> label<span class="token operator">:</span> <span class="token string">&#39;级别&#39;</span><span class="token punctuation">,</span> width<span class="token operator">:</span> <span class="token string">&#39;120px&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> prop<span class="token operator">:</span> <span class="token string">&#39;url&#39;</span><span class="token punctuation">,</span> label<span class="token operator">:</span> <span class="token string">&#39;菜单url&#39;</span><span class="token punctuation">,</span> width<span class="token operator">:</span> <span class="token string">&#39;150px&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> prop<span class="token operator">:</span> <span class="token string">&#39;icon&#39;</span><span class="token punctuation">,</span> label<span class="token operator">:</span> <span class="token string">&#39;菜单icon&#39;</span><span class="token punctuation">,</span> width<span class="token operator">:</span> <span class="token string">&#39;180px&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> prop<span class="token operator">:</span> <span class="token string">&#39;sort&#39;</span><span class="token punctuation">,</span> label<span class="token operator">:</span> <span class="token string">&#39;排序&#39;</span><span class="token punctuation">,</span> width<span class="token operator">:</span> <span class="token string">&#39;120px&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> prop<span class="token operator">:</span> <span class="token string">&#39;permission&#39;</span><span class="token punctuation">,</span> label<span class="token operator">:</span> <span class="token string">&#39;权限&#39;</span><span class="token punctuation">,</span> width<span class="token operator">:</span> <span class="token string">&#39;150px&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&#39;time&#39;</span><span class="token punctuation">,</span> prop<span class="token operator">:</span> <span class="token string">&#39;createAt&#39;</span><span class="token punctuation">,</span> label<span class="token operator">:</span> <span class="token string">&#39;创建时间&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&#39;time&#39;</span><span class="token punctuation">,</span> prop<span class="token operator">:</span> <span class="token string">&#39;updateAt&#39;</span><span class="token punctuation">,</span> label<span class="token operator">:</span> <span class="token string">&#39;更新时间&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&#39;handler&#39;</span><span class="token punctuation">,</span> label<span class="token operator">:</span> <span class="token string">&#39;操作&#39;</span><span class="token punctuation">,</span> width<span class="token operator">:</span> <span class="token string">&#39;150px&#39;</span><span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    childrenTree<span class="token operator">:</span> <span class="token punctuation">{</span>
      rowKey<span class="token operator">:</span> <span class="token string">&#39;id&#39;</span><span class="token punctuation">,</span>
      treeProps<span class="token operator">:</span> <span class="token punctuation">{</span>
        children<span class="token operator">:</span> <span class="token string">&#39;children&#39;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> contentConfig
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="实现新增、编辑模态框功能以及删除功能" tabindex="-1"><a class="header-anchor" href="#实现新增、编辑模态框功能以及删除功能" aria-hidden="true">#</a> 实现新增、编辑模态框功能以及删除功能</h3><p>使用配置文件完成。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// modal.config.ts</span>
<span class="token keyword">const</span> modalConfig <span class="token operator">=</span> <span class="token punctuation">{</span>
    pageName<span class="token operator">:</span> <span class="token string">&#39;menu&#39;</span><span class="token punctuation">,</span>
    header<span class="token operator">:</span> <span class="token punctuation">{</span>
      newTitle<span class="token operator">:</span> <span class="token string">&#39;新建菜单&#39;</span><span class="token punctuation">,</span>
      editTitle<span class="token operator">:</span> <span class="token string">&#39;编辑菜单&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    formItems<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        type<span class="token operator">:</span> <span class="token string">&#39;input&#39;</span><span class="token punctuation">,</span>
        label<span class="token operator">:</span> <span class="token string">&#39;菜单名称&#39;</span><span class="token punctuation">,</span>
        prop<span class="token operator">:</span> <span class="token string">&#39;name&#39;</span><span class="token punctuation">,</span>
        placeholder<span class="token operator">:</span> <span class="token string">&#39;请输入菜单名称&#39;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        type<span class="token operator">:</span> <span class="token string">&#39;input&#39;</span><span class="token punctuation">,</span>
        label<span class="token operator">:</span> <span class="token string">&#39;菜单级别&#39;</span><span class="token punctuation">,</span>
        prop<span class="token operator">:</span> <span class="token string">&#39;type&#39;</span><span class="token punctuation">,</span>
        placeholder<span class="token operator">:</span> <span class="token string">&#39;请输入菜单级别&#39;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        type<span class="token operator">:</span> <span class="token string">&#39;input&#39;</span><span class="token punctuation">,</span>
        label<span class="token operator">:</span> <span class="token string">&#39;菜单级别&#39;</span><span class="token punctuation">,</span>
        prop<span class="token operator">:</span> <span class="token string">&#39;type&#39;</span><span class="token punctuation">,</span>
        placeholder<span class="token operator">:</span> <span class="token string">&#39;请输入菜单级别&#39;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        type<span class="token operator">:</span> <span class="token string">&#39;input&#39;</span><span class="token punctuation">,</span>
        label<span class="token operator">:</span> <span class="token string">&#39;菜单url&#39;</span><span class="token punctuation">,</span>
        prop<span class="token operator">:</span> <span class="token string">&#39;url&#39;</span><span class="token punctuation">,</span>
        placeholder<span class="token operator">:</span> <span class="token string">&#39;请输入菜单url&#39;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        type<span class="token operator">:</span> <span class="token string">&#39;input&#39;</span><span class="token punctuation">,</span>
        label<span class="token operator">:</span> <span class="token string">&#39;菜单icon&#39;</span><span class="token punctuation">,</span>
        prop<span class="token operator">:</span> <span class="token string">&#39;icon&#39;</span><span class="token punctuation">,</span>
        placeholder<span class="token operator">:</span> <span class="token string">&#39;请输入菜单icon&#39;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        type<span class="token operator">:</span> <span class="token string">&#39;input&#39;</span><span class="token punctuation">,</span>
        label<span class="token operator">:</span> <span class="token string">&#39;排序&#39;</span><span class="token punctuation">,</span>
        prop<span class="token operator">:</span> <span class="token string">&#39;sort&#39;</span><span class="token punctuation">,</span>
        placeholder<span class="token operator">:</span> <span class="token string">&#39;请输入排序&#39;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        type<span class="token operator">:</span> <span class="token string">&#39;input&#39;</span><span class="token punctuation">,</span>
        label<span class="token operator">:</span> <span class="token string">&#39;权限&#39;</span><span class="token punctuation">,</span>
        prop<span class="token operator">:</span> <span class="token string">&#39;permission&#39;</span><span class="token punctuation">,</span>
        placeholder<span class="token operator">:</span> <span class="token string">&#39;请输入权限&#39;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        type<span class="token operator">:</span> <span class="token string">&#39;input&#39;</span><span class="token punctuation">,</span>
        label<span class="token operator">:</span> <span class="token string">&#39;创建时间&#39;</span><span class="token punctuation">,</span>
        prop<span class="token operator">:</span> <span class="token string">&#39;createAt&#39;</span><span class="token punctuation">,</span>
        placeholder<span class="token operator">:</span> <span class="token string">&#39;请输入创建时间&#39;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        type<span class="token operator">:</span> <span class="token string">&#39;input&#39;</span><span class="token punctuation">,</span>
        label<span class="token operator">:</span> <span class="token string">&#39;更新时间&#39;</span><span class="token punctuation">,</span>
        prop<span class="token operator">:</span> <span class="token string">&#39;updateAt&#39;</span><span class="token punctuation">,</span>
        placeholder<span class="token operator">:</span> <span class="token string">&#39;请输入更新时间&#39;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        type<span class="token operator">:</span> <span class="token string">&#39;custom&#39;</span><span class="token punctuation">,</span>
        slotName<span class="token operator">:</span> <span class="token string">&#39;menulist&#39;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> modalConfig
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>父组件<code>menu.vue</code>传递配置文件中的配置项。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;menu&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>page<span class="token operator">-</span>content <span class="token operator">:</span>content<span class="token operator">-</span>config<span class="token operator">=</span><span class="token string">&quot;contentConfig&quot;</span> @<span class="token keyword">new</span><span class="token operator">-</span>data<span class="token operator">-</span>click<span class="token operator">=</span><span class="token string">&quot;handleNewDataClick&quot;</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">edit</span></span><span class="token operator">-</span>data<span class="token operator">-</span>click<span class="token operator">=</span><span class="token string">&quot;handleEditDataClick&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>page<span class="token operator">-</span>modal <span class="token operator">:</span>modal<span class="token operator">-</span>config<span class="token operator">=</span><span class="token string">&quot;modalConfig&quot;</span> ref<span class="token operator">=</span><span class="token string">&quot;modalRef&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span> name<span class="token operator">=</span><span class="token string">&quot;menu&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> PageContent <span class="token keyword">from</span> <span class="token string">&#39;@/components/page-content/page-content.vue&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> contentConfig <span class="token keyword">from</span> <span class="token string">&#39;./config/content.config&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> PageModal <span class="token keyword">from</span> <span class="token string">&#39;@/components/page-modal/page-modal.vue&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> modalConfig <span class="token keyword">from</span> <span class="token string">&#39;./config/modal.config&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> usePageModal <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/hooks/usePageModal&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> modalRef<span class="token punctuation">,</span> handleEditDataClick<span class="token punctuation">,</span> handleNewDataClick <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">usePageModal</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="实现角色管理中的权限分配-难点" tabindex="-1"><a class="header-anchor" href="#实现角色管理中的权限分配-难点" aria-hidden="true">#</a> 实现角色管理中的权限分配（难点）</h2><p><strong>在新建角色时使用上文写的自定义作用域插槽定制化树形选择角色权限列表。</strong></p><h3 id="创建角色的菜单树展示" tabindex="-1"><a class="header-anchor" href="#创建角色的菜单树展示" aria-hidden="true">#</a> 创建角色的菜单树展示</h3><p><img src="https://nevermore-picbed-1304219157.cos.ap-guangzhou.myqcloud.com/image_eZshQ2Ucrq.png" alt=""></p><h4 id="封装请求接口数据" tabindex="-1"><a class="header-anchor" href="#封装请求接口数据" aria-hidden="true">#</a> 封装请求接口数据</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// service/main.ts</span>
<span class="token comment">// 获取所有菜单</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getEntireMenus</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> hyRequest<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token operator">:</span> <span class="token string">&quot;/menu/list&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// store/main.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> getEntireDepartments<span class="token punctuation">,</span> getEntireMenus<span class="token punctuation">,</span> getEntireRoles <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/service/main/main&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;pinia&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">IMainState</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    entireMenus<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> useMainStore <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token string">&#39;main&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    state<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> IMainState <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token comment">// ...</span>
        entireMenus<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    actions<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token keyword">async</span> <span class="token function">fetchEntireDataAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// ...</span>
            <span class="token keyword">const</span> menuResult <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getEntireMenus</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>entireMenus <span class="token operator">=</span> menuResult<span class="token punctuation">.</span>data<span class="token punctuation">.</span>list
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> useMainStore
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="在配置文件中定义自定义类型" tabindex="-1"><a class="header-anchor" href="#在配置文件中定义自定义类型" aria-hidden="true">#</a> 在配置文件中定义自定义类型</h4><p>因为新建角色在模态框中展现，因此在<code>modal.config.ts</code>中定义。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> modalConfig <span class="token operator">=</span> <span class="token punctuation">{</span>
    pageName<span class="token operator">:</span> <span class="token string">&#39;role&#39;</span><span class="token punctuation">,</span>
    header<span class="token operator">:</span> <span class="token punctuation">{</span>
      newTitle<span class="token operator">:</span> <span class="token string">&#39;新建角色&#39;</span><span class="token punctuation">,</span>
      editTitle<span class="token operator">:</span> <span class="token string">&#39;编辑角色&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    formItems<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        type<span class="token operator">:</span> <span class="token string">&#39;input&#39;</span><span class="token punctuation">,</span>
        label<span class="token operator">:</span> <span class="token string">&#39;角色名称&#39;</span><span class="token punctuation">,</span>
        prop<span class="token operator">:</span> <span class="token string">&#39;name&#39;</span><span class="token punctuation">,</span>
        placeholder<span class="token operator">:</span> <span class="token string">&#39;请输入角色名称&#39;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        type<span class="token operator">:</span> <span class="token string">&#39;input&#39;</span><span class="token punctuation">,</span>
        label<span class="token operator">:</span> <span class="token string">&#39;权限介绍&#39;</span><span class="token punctuation">,</span>
        prop<span class="token operator">:</span> <span class="token string">&#39;intro&#39;</span><span class="token punctuation">,</span>
        placeholder<span class="token operator">:</span> <span class="token string">&#39;请输入权限介绍&#39;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// 自定义类型</span>
      <span class="token punctuation">{</span>
        type<span class="token operator">:</span> <span class="token string">&#39;custom&#39;</span><span class="token punctuation">,</span>
        slotName<span class="token operator">:</span> <span class="token string">&#39;menulist&#39;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> modalConfig
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="编写自定义插槽" tabindex="-1"><a class="header-anchor" href="#编写自定义插槽" aria-hidden="true">#</a> 编写自定义插槽</h4><p>在<code>page-modal.vue</code>中编写<code>type</code>为<code>custom</code>的作用域插槽。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;modal&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>el<span class="token operator">-</span>dialog v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;dialogVisible&quot;</span> <span class="token operator">:</span>title<span class="token operator">=</span><span class="token string">&quot;isEdit ? modalConfig.header.editTitle : modalConfig.header.newTitle&quot;</span> width<span class="token operator">=</span><span class="token string">&quot;30%&quot;</span> center<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;form&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>form <span class="token operator">:</span>model<span class="token operator">=</span><span class="token string">&quot;formData&quot;</span> label<span class="token operator">-</span>width<span class="token operator">=</span><span class="token string">&quot;80px&quot;</span> size<span class="token operator">=</span><span class="token string">&quot;large&quot;</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>template v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;item in modalConfig.formItems&quot;</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">&quot;item.prop&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item v<span class="token operator">-</span>bind<span class="token operator">=</span><span class="token string">&quot;item&quot;</span><span class="token operator">&gt;</span>
              <span class="token operator">&lt;</span>template v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;item.type === &#39;input&#39;&quot;</span><span class="token operator">&gt;</span>
                <span class="token comment">// ...</span>
              <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

              <span class="token operator">&lt;</span>template v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;item.type === &#39;select&#39;&quot;</span><span class="token operator">&gt;</span>
                <span class="token comment">// ...</span>
              <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

              <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 自定义插槽：如角色管理中的权限树形选择 <span class="token operator">--</span><span class="token operator">&gt;</span>
              <span class="token operator">&lt;</span>template v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;item.type === &#39;custom&#39;&quot;</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>slot <span class="token operator">:</span>name<span class="token operator">=</span><span class="token string">&quot;item.slotName&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>slot<span class="token operator">&gt;</span>
              <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token comment">// ...</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>dialog<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="在父组件中实现菜单列表的自定义插槽" tabindex="-1"><a class="header-anchor" href="#在父组件中实现菜单列表的自定义插槽" aria-hidden="true">#</a> 在父组件中实现菜单列表的自定义插槽</h4><p>使用<code>el-tree</code>中的树节点选择实现，将请求接口数据<code>entireMenus</code>传入给<code>:data</code>即可。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;role&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>page<span class="token operator">-</span>search <span class="token operator">:</span>search<span class="token operator">-</span>config<span class="token operator">=</span><span class="token string">&quot;searchConfig&quot;</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">query</span></span><span class="token operator">-</span>click<span class="token operator">=</span><span class="token string">&quot;handleQueryClick&quot;</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">reset</span></span><span class="token operator">-</span>click<span class="token operator">=</span><span class="token string">&quot;handleResetClick&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>page<span class="token operator">-</span>content <span class="token operator">:</span>content<span class="token operator">-</span>config<span class="token operator">=</span><span class="token string">&quot;contentConfig&quot;</span> ref<span class="token operator">=</span><span class="token string">&quot;contentRef&quot;</span> @<span class="token keyword">new</span><span class="token operator">-</span>data<span class="token operator">-</span>click<span class="token operator">=</span><span class="token string">&quot;handleNewDataClick&quot;</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">edit</span></span><span class="token operator">-</span>data<span class="token operator">-</span>click<span class="token operator">=</span><span class="token string">&quot;handleEditDataClick&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>page<span class="token operator">-</span>modal <span class="token operator">:</span>modal<span class="token operator">-</span>config<span class="token operator">=</span><span class="token string">&quot;modalConfig&quot;</span> ref<span class="token operator">=</span><span class="token string">&quot;modalRef&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 自定义菜单列表 <span class="token operator">--</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>template #menulist<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>tree
          ref<span class="token operator">=</span><span class="token string">&quot;treeRef&quot;</span>
          <span class="token operator">:</span>data<span class="token operator">=</span><span class="token string">&quot;entireMenus&quot;</span>
          show<span class="token operator">-</span>checkbox
          <span class="token keyword">default</span><span class="token operator">-</span>expand<span class="token operator">-</span>all
          node<span class="token operator">-</span>key<span class="token operator">=</span><span class="token string">&quot;id&quot;</span>
          highlight<span class="token operator">-</span>current
          <span class="token operator">:</span>props<span class="token operator">=</span><span class="token string">&quot;{ children: &#39;children&#39;, label: &#39;name&#39; }&quot;</span>
        <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>page<span class="token operator">-</span>modal<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> pageSearch <span class="token keyword">from</span> <span class="token string">&#39;@/components/page-search/page-search.vue&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> searchConfig <span class="token keyword">from</span> <span class="token string">&#39;./config/search.config&#39;</span>

<span class="token keyword">import</span> pageContent <span class="token keyword">from</span> <span class="token string">&#39;@/components/page-content/page-content.vue&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> contentConfig <span class="token keyword">from</span> <span class="token string">&#39;./config/content.config&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> pageModal <span class="token keyword">from</span> <span class="token string">&#39;@/components/page-modal/page-modal.vue&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> modalConfig <span class="token keyword">from</span> <span class="token string">&#39;./config/modal.config&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> usePageContent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/hooks/usePageContent&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> usePageModal <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/hooks/usePageModal&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> useMainStore <span class="token keyword">from</span> <span class="token string">&#39;@/store/main/main&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> storeToRefs <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;pinia&#39;</span><span class="token punctuation">;</span>

<span class="token comment">// hooks逻辑关系</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> contentRef<span class="token punctuation">,</span> handleQueryClick<span class="token punctuation">,</span> handleResetClick <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">usePageContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> modalRef<span class="token punctuation">,</span> handleEditDataClick<span class="token punctuation">,</span> handleNewDataClick <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">usePageModal</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> mainStore <span class="token operator">=</span> <span class="token function">useMainStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> entireMenus <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">storeToRefs</span><span class="token punctuation">(</span>mainStore<span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="创建角色携带菜单树的权限数据" tabindex="-1"><a class="header-anchor" href="#创建角色携带菜单树的权限数据" aria-hidden="true">#</a> 创建角色携带菜单树的权限数据</h3><p>将菜单树的<code>menulist</code>和<code>formData</code>绑定一起传递给服务器，使用<code>el-tree</code>中<code>check</code>属性获取选中值，里面有 2 个参数，第 2 个参数能够获取当前选中的结点<code>checkedNodes</code>以及它的父结点<code>halfCheckedNodes</code>和它们的<code>key</code>。</p><h4 id="父组件中获取权限数据并传递给-page-modal-子组件" tabindex="-1"><a class="header-anchor" href="#父组件中获取权限数据并传递给-page-modal-子组件" aria-hidden="true">#</a> 父组件中获取权限数据并传递给 page-modal 子组件</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// role.vue</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;role&quot;</span><span class="token operator">&gt;</span>
    <span class="token comment">// ...</span>
    <span class="token operator">&lt;</span>page<span class="token operator">-</span>modal <span class="token operator">:</span>modal<span class="token operator">-</span>config<span class="token operator">=</span><span class="token string">&quot;modalConfig&quot;</span> ref<span class="token operator">=</span><span class="token string">&quot;modalRef&quot;</span> <span class="token operator">:</span>other<span class="token operator">-</span>info<span class="token operator">=</span><span class="token string">&quot;otherInfo&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 自定义菜单列表 <span class="token operator">--</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>template #menulist<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>tree
          <span class="token comment">// ...</span>
          <span class="token decorator"><span class="token at operator">@</span><span class="token function">check</span></span><span class="token operator">=</span><span class="token string">&quot;handleELTreeCheck&quot;</span>
        <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>page<span class="token operator">-</span>modal<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span><span class="token operator">&gt;</span>
<span class="token comment">// ...</span>
<span class="token comment">// 获取树形列表的key(id)</span>
<span class="token keyword">const</span> otherInfo <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">handleELTreeCheck</span><span class="token punctuation">(</span>data1<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> data2<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> menuList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>data2<span class="token punctuation">.</span>checkedKeys<span class="token punctuation">,</span> <span class="token operator">...</span>data2<span class="token punctuation">.</span>halfCheckedKeys<span class="token punctuation">]</span>
  otherInfo<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">{</span> menuList <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="子组件接受数据并将其合并发送给服务器" tabindex="-1"><a class="header-anchor" href="#子组件接受数据并将其合并发送给服务器" aria-hidden="true">#</a> 子组件接受数据并将其合并发送给服务器</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// page-modal.vue</span>
<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span> name<span class="token operator">=</span><span class="token string">&quot;modal&quot;</span><span class="token operator">&gt;</span>
<span class="token comment">// ...</span>
<span class="token keyword">interface</span> <span class="token class-name">IProps</span> <span class="token punctuation">{</span>
  modalConfig<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
  otherInfo<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">any</span>
<span class="token punctuation">}</span>

<span class="token comment">// ...</span>

<span class="token comment">// 点击确定</span>
<span class="token keyword">const</span> systemStore <span class="token operator">=</span> <span class="token function">useSystemStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">handleConfirmClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  dialogVisible<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span>

  <span class="token comment">// 若有其它info进行合并发送给服务器（如：角色管理中新建角色的权限分配菜单树menuList）</span>
  <span class="token keyword">let</span> infoData <span class="token operator">=</span> formData
  <span class="token keyword">if</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>otherInfo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    infoData <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>formData<span class="token punctuation">,</span> <span class="token operator">...</span>props<span class="token punctuation">.</span>otherInfo<span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isEdit<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    systemStore<span class="token punctuation">.</span><span class="token function">newPageDataAction</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>modalConfig<span class="token punctuation">.</span>pageName<span class="token punctuation">,</span> infoData<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    systemStore<span class="token punctuation">.</span><span class="token function">editPageDataAction</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>modalConfig<span class="token punctuation">.</span>pageName<span class="token punctuation">,</span> editData<span class="token punctuation">.</span>value<span class="token punctuation">.</span>id<span class="token punctuation">,</span> infoData<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="编辑时角色菜单权限回显" tabindex="-1"><a class="header-anchor" href="#编辑时角色菜单权限回显" aria-hidden="true">#</a> 编辑时角色菜单权限回显</h3><h4 id="封装菜单映射权限-id-列表的工具" tabindex="-1"><a class="header-anchor" href="#封装菜单映射权限-id-列表的工具" aria-hidden="true">#</a> 封装菜单映射权限 Id 列表的工具</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// utils/map-menus.ts</span>
<span class="token comment">/**
 * 菜单映射到id的列表（用于角色管理的权限树分配）
 * @param menuList
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">mapMenuListToIds</span><span class="token punctuation">(</span>menuList<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> ids<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

  <span class="token keyword">function</span> <span class="token function">recurseGetId</span><span class="token punctuation">(</span>menus<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">const</span> item <span class="token keyword">of</span> menus<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 如果有子菜单，就递归直到没有子菜单，然后把id添加到ids中</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>children<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">recurseGetId</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>children<span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        ids<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token function">recurseGetId</span><span class="token punctuation">(</span>menuList<span class="token punctuation">)</span>
  <span class="token keyword">return</span> ids
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="获取角色权限菜单的数据" tabindex="-1"><a class="header-anchor" href="#获取角色权限菜单的数据" aria-hidden="true">#</a> 获取角色权限菜单的数据</h4><p>在点击编辑按钮触发<code>usePageModal</code>事件时，传入的参数<code>itemData</code>中可以拿到模态框里的数据（包括菜单树控件<code>el-tree</code>），但是因为点击编辑事件封装在<code>hooks</code>里面，在<code>role.vue</code>中需要传入一个函数<code>editCallback</code>来获取。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">callbackType</span> <span class="token operator">=</span> <span class="token punctuation">(</span>item<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">usePageModal</span><span class="token punctuation">(</span>editCallback<span class="token operator">?</span><span class="token operator">:</span> callbackType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> modalRef <span class="token operator">=</span> <span class="token generic-function"><span class="token function">ref</span><span class="token generic class-name"><span class="token operator">&lt;</span>InstanceType<span class="token operator">&lt;</span><span class="token keyword">typeof</span> PageModal<span class="token operator">&gt;&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// ...</span>
    <span class="token comment">// 编辑功能</span>
    <span class="token keyword">function</span> <span class="token function">handleEditDataClick</span><span class="token punctuation">(</span>itemData<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        modalRef<span class="token punctuation">.</span>value<span class="token operator">?.</span><span class="token function">setDialogVisible</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> itemData<span class="token punctuation">)</span>
        <span class="token comment">// 回显角色管理中权限菜单树</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>editCallback<span class="token punctuation">)</span> <span class="token function">editCallback</span><span class="token punctuation">(</span>itemData<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        handleEditDataClick<span class="token punctuation">,</span>
        <span class="token comment">// ...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在 role.vue 中使用<code>editCallback</code>函数来接受编辑事件传来的<code>itemData</code>（对象），并将其用<code>mapMenuListToIds</code>工具处理成<code>id</code>数组，在<code>nextTick()</code>中调用。</p><blockquote><p><code>nextTick</code>：当你在 Vue 中更改响应式状态时，最终的 DOM 更新并不是同步生效的，而是由 Vue 将它们缓存在一个队列中，直到下一个“tick”才一起执行。这样是为了确保每个组件无论发生多少状态改变，都仅执行一次更新。<code>nextTick()</code> 可以在状态改变后立即使用，以等待 DOM 更新完成。</p></blockquote><blockquote><p>Vue 是异步执行 dom 更新的，一旦观察到数据变化，Vue 就会开启一个队列，然后把在同一个事件循环 (event loop) 当中观察到数据变化的 watcher 推送进这个队列。如果这个 watcher 被触发多次，只会被推送到队列一次。这种缓冲行为可以有效的去掉重复数据造成的不必要的计算和 DOm 操作。而在下一个事件循环时，Vue 会清空队列，并进行必要的 DOM 更新。<br> 当你设置 vm.someData = &#39;new value&#39;，DOM 并不会马上更新，而是在异步队列被清除，也就是下一个事件循环开始时执行更新时才会进行必要的 DOM 更新。如果此时你想要根据更新的 DOM 状态去做某些事情，就会出现问题。。为了在数据变化之后等待 Vue 完成更新 DOM ，可以在数据变化之后立即使用 Vue.nextTick(callback) ，这样回调函数在 DOM 更新完成后就会调用。在 Vue3 中是微任务，Vue2 中不断更新变化。</p></blockquote><p><img src="https://nevermore-picbed-1304219157.cos.ap-guangzhou.myqcloud.com/image_gYbI_P1Qvc.png" alt=""></p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;role&quot;</span><span class="token operator">&gt;</span>
    <span class="token comment">// ...</span>
    <span class="token operator">&lt;</span>page<span class="token operator">-</span>modal <span class="token operator">:</span>modal<span class="token operator">-</span>config<span class="token operator">=</span><span class="token string">&quot;modalConfig&quot;</span> ref<span class="token operator">=</span><span class="token string">&quot;modalRef&quot;</span> <span class="token operator">:</span>other<span class="token operator">-</span>info<span class="token operator">=</span><span class="token string">&quot;otherInfo&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 自定义菜单列表 <span class="token operator">--</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>template #menulist<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>tree
          ref<span class="token operator">=</span><span class="token string">&quot;treeRef&quot;</span>
          <span class="token operator">:</span>data<span class="token operator">=</span><span class="token string">&quot;entireMenus&quot;</span>
          show<span class="token operator">-</span>checkbox
          <span class="token keyword">default</span><span class="token operator">-</span>expand<span class="token operator">-</span>all
          node<span class="token operator">-</span>key<span class="token operator">=</span><span class="token string">&quot;id&quot;</span>
          highlight<span class="token operator">-</span>current
          <span class="token operator">:</span>props<span class="token operator">=</span><span class="token string">&quot;{ children: &#39;children&#39;, label: &#39;name&#39; }&quot;</span>
          <span class="token decorator"><span class="token at operator">@</span><span class="token function">check</span></span><span class="token operator">=</span><span class="token string">&quot;handleELTreeCheck&quot;</span>
        <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>page<span class="token operator">-</span>modal<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span><span class="token operator">&gt;</span>
<span class="token comment">// ...</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ref<span class="token punctuation">,</span> nextTick <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> mapMenuListToIds <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/utils/map-menus&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> ElTree <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;element-plus/es/components/index.js&#39;</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> modalRef<span class="token punctuation">,</span> handleEditDataClick<span class="token punctuation">,</span> handleNewDataClick <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">usePageModal</span><span class="token punctuation">(</span>editCallback<span class="token punctuation">)</span>

<span class="token comment">// ...</span>
<span class="token comment">// 编辑角色菜单权限回显</span>
<span class="token keyword">const</span> treeRef <span class="token operator">=</span> <span class="token generic-function"><span class="token function">ref</span><span class="token generic class-name"><span class="token operator">&lt;</span>InstanceType<span class="token operator">&lt;</span><span class="token keyword">typeof</span> ElTree<span class="token operator">&gt;&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">editCallback</span><span class="token punctuation">(</span>data<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> menuList <span class="token operator">=</span> <span class="token function">mapMenuListToIds</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>menuList<span class="token punctuation">)</span>
    <span class="token comment">// 只有在nextTick之后才能设置setCheckedKeys</span>
    treeRef<span class="token punctuation">.</span>value<span class="token operator">?.</span><span class="token function">setCheckedKeys</span><span class="token punctuation">(</span>menuList<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="新增时角色菜单权限回显重置" tabindex="-1"><a class="header-anchor" href="#新增时角色菜单权限回显重置" aria-hidden="true">#</a> 新增时角色菜单权限回显重置</h3><h4 id="重置角色权限菜单树的数据" tabindex="-1"><a class="header-anchor" href="#重置角色权限菜单树的数据" aria-hidden="true">#</a> 重置角色权限菜单树的数据</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// role.vue</span>
<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ref<span class="token punctuation">,</span> nextTick <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> mapMenuListToIds <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/utils/map-menus&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> ElTree <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;element-plus/es/components/index.js&#39;</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> modalRef<span class="token punctuation">,</span> handleEditDataClick<span class="token punctuation">,</span> handleNewDataClick <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">usePageModal</span><span class="token punctuation">(</span>newCallback<span class="token punctuation">,</span> editCallback<span class="token punctuation">)</span>

<span class="token comment">// ...</span>
<span class="token comment">// 新增角色菜单权限重置</span>
<span class="token keyword">function</span> <span class="token function">newCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    treeRef<span class="token punctuation">.</span>value<span class="token operator">?.</span><span class="token function">setCheckedKeys</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 编辑角色菜单权限回显...</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="hooks-中调用" tabindex="-1"><a class="header-anchor" href="#hooks-中调用" aria-hidden="true">#</a> hooks 中调用</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// ...</span>
<span class="token keyword">type</span> <span class="token class-name">callbackType</span> <span class="token operator">=</span> <span class="token punctuation">(</span>item<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">usePageModal</span><span class="token punctuation">(</span>newCallback<span class="token operator">?</span><span class="token operator">:</span> callbackType<span class="token punctuation">,</span> editCallback<span class="token operator">?</span><span class="token operator">:</span> callbackType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> modalRef <span class="token operator">=</span> <span class="token generic-function"><span class="token function">ref</span><span class="token generic class-name"><span class="token operator">&lt;</span>InstanceType<span class="token operator">&lt;</span><span class="token keyword">typeof</span> PageModal<span class="token operator">&gt;&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// 新增功能</span>
    <span class="token keyword">function</span> <span class="token function">handleNewDataClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        modalRef<span class="token punctuation">.</span>value<span class="token operator">?.</span><span class="token function">setDialogVisible</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>newCallback<span class="token punctuation">)</span> <span class="token function">newCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 编辑功能...</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        modalRef<span class="token punctuation">,</span>
        handleEditDataClick<span class="token punctuation">,</span>
        handleNewDataClick
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="实现登录用户的权限功能" tabindex="-1"><a class="header-anchor" href="#实现登录用户的权限功能" aria-hidden="true">#</a> 实现登录用户的权限功能</h2><p>通过每个子菜单下增删改查的如<code>permission:&quot;system:users:create&quot;</code>字段实现，用于控制按钮权限的展示。</p><h3 id="封装菜单映射按钮权限工具" tabindex="-1"><a class="header-anchor" href="#封装菜单映射按钮权限工具" aria-hidden="true">#</a> 封装菜单映射按钮权限工具</h3><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// map-menus.ts</span>
<span class="token comment">/**
 * 菜单映射到按钮的权限permissions
 * @param menuList 菜单列表
 * @returns 权限的数组
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">mapMenuListToPermissions</span><span class="token punctuation">(</span>menuList <span class="token operator">:</span><span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> permissions<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

  <span class="token keyword">function</span> <span class="token function">recurseGetPermission</span><span class="token punctuation">(</span>menus<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">const</span> item <span class="token keyword">of</span> menus<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        permissions<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>permission<span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// 没有子树的话就将menus设置为空数组，否则会null/undefine报错</span>
        <span class="token function">recurseGetPermission</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>children <span class="token operator">??</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token function">recurseGetPermission</span><span class="token punctuation">(</span>menuList<span class="token punctuation">)</span>

  <span class="token keyword">return</span> permissions
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="获取登录用户的所有按钮权限" tabindex="-1"><a class="header-anchor" href="#获取登录用户的所有按钮权限" aria-hidden="true">#</a> 获取登录用户的所有按钮权限</h3><p>使用菜单映射按钮权限工具，获取登录用户的所有权限，存入<code>pinia</code>中。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> mapMenuListToPermissions<span class="token punctuation">,</span> mapMenuToRoutes <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/utils/map-menus&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">ILoginState</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    permissions<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> useLoginStore <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token string">&#39;login&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    state<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> ILoginState <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token comment">// ...</span>
        permissions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    actions<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token keyword">async</span> <span class="token function">loginAccountAction</span><span class="token punctuation">(</span>account<span class="token operator">:</span> IAccount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// ...</span>

            <span class="token comment">// 7.获取登录用户的所有按钮权限</span>
            <span class="token keyword">const</span> permissions <span class="token operator">=</span> <span class="token function">mapMenuListToPermissions</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>userMenus<span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>permissions <span class="token operator">=</span> permissions
        <span class="token punctuation">}</span><span class="token punctuation">,</span>

        <span class="token comment">// 解决刷新页面后，动态路由丢失的问题(不再是loginAccountAction登录时才执行)</span>
        <span class="token function">loadLocalDataAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// ...</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>token <span class="token operator">&amp;&amp;</span> userInfo <span class="token operator">&amp;&amp;</span> userMenus<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// ...</span>
                <span class="token comment">// 刷新时缓存按钮权限</span>
                <span class="token keyword">const</span> permissions <span class="token operator">=</span> <span class="token function">mapMenuListToPermissions</span><span class="token punctuation">(</span>userMenus<span class="token punctuation">)</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>permissions <span class="token operator">=</span> permissions
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> useLoginStore
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="封装权限-hooks" tabindex="-1"><a class="header-anchor" href="#封装权限-hooks" aria-hidden="true">#</a> 封装权限 hooks</h3><p>用于查询某个页面的权限是否在获取到的登录用户所有权限中，如判断<code>department:create</code>、<code>department:update</code>是否包含在登录用户存入在<code>pinia</code>中的<code>permissions</code>数组，用<code>permissions.find</code>去查找。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// hooks/usePermission.ts</span>
<span class="token keyword">import</span> useLoginStore <span class="token keyword">from</span> <span class="token string">&#39;@/store/login/login&#39;</span>

<span class="token keyword">function</span> <span class="token function">usePermission</span><span class="token punctuation">(</span>pageName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> handleName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> queryPermission <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>pageName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>handleName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> permissions <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useLoginStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token comment">// !!将字符串转换为布尔值</span>
  <span class="token keyword">return</span> <span class="token operator">!</span><span class="token operator">!</span>permissions<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>queryPermission<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> usePermission
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="编写-page-content-组件" tabindex="-1"><a class="header-anchor" href="#编写-page-content-组件" aria-hidden="true">#</a> 编写 Page-content 组件</h3><p>调用 hooks，判断每一个按钮是否有有对应的增删改查权限，使用<code>v-if</code>控制对应按钮的显示。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;content&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;header&quot;</span><span class="token operator">&gt;</span>
      <span class="token comment">// ...</span>
      <span class="token comment">// 增</span>
      <span class="token operator">&lt;</span>el<span class="token operator">-</span>button v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;isCreate&quot;</span> type<span class="token operator">=</span><span class="token string">&quot;primary&quot;</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">click</span></span><span class="token operator">=</span><span class="token string">&quot;handleNewData&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> contentConfig<span class="token operator">?.</span>header<span class="token operator">?.</span>btnTitle <span class="token operator">??</span> <span class="token string">&#39;新建数据&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;table&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>el<span class="token operator">-</span>table <span class="token operator">:</span>data<span class="token operator">=</span><span class="token string">&quot;pageList&quot;</span> <span class="token operator">:</span>border<span class="token operator">=</span><span class="token string">&quot;true&quot;</span> style<span class="token operator">=</span><span class="token string">&quot;width: 100%&quot;</span> v<span class="token operator">-</span>bind<span class="token operator">=</span><span class="token string">&quot;contentConfig.childrenTree&quot;</span><span class="token operator">&gt;</span>
            <span class="token comment">// ...</span>
          <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 处理handle类型 <span class="token operator">--</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>template v<span class="token operator">-</span><span class="token keyword">else</span><span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;item.type === &#39;handler&#39;&quot;</span><span class="token operator">&gt;</span>
            <span class="token comment">// ...</span>
            <span class="token comment">// 改</span>
            <span class="token operator">&lt;</span>el<span class="token operator">-</span>button v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;isUpdate&quot;</span> type<span class="token operator">=</span><span class="token string">&quot;primary&quot;</span> size<span class="token operator">=</span><span class="token string">&quot;small&quot;</span> icon<span class="token operator">=</span><span class="token string">&quot;EditPen&quot;</span> link <span class="token decorator"><span class="token at operator">@</span><span class="token function">click</span></span><span class="token operator">=</span><span class="token string">&quot;handleEditClick(scope.row)&quot;</span><span class="token operator">&gt;</span>
              编辑
            <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
            <span class="token comment">// 删</span>
            <span class="token operator">&lt;</span>el<span class="token operator">-</span>button v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;isDelete&quot;</span> type<span class="token operator">=</span><span class="token string">&quot;danger&quot;</span> size<span class="token operator">=</span><span class="token string">&quot;small&quot;</span> icon<span class="token operator">=</span><span class="token string">&quot;Delete&quot;</span> link <span class="token decorator"><span class="token at operator">@</span><span class="token function">click</span></span><span class="token operator">=</span><span class="token string">&quot;handleDeleteClick(scope.row.id)&quot;</span><span class="token operator">&gt;</span>
              删除
            <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
          <span class="token comment">// ...</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>table<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span> name<span class="token operator">=</span><span class="token string">&quot;content&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> usePermission <span class="token keyword">from</span> <span class="token string">&#39;@/hooks/usePermission&#39;</span>

<span class="token keyword">interface</span> <span class="token class-name">IProps</span> <span class="token punctuation">{</span>
  contentConfig<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 用于处理接口方法中传入的pageName参数</span>
    pageName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
    header<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      title<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
      btnTitle<span class="token operator">:</span> <span class="token builtin">string</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    propsList<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    childrenTree<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> props <span class="token operator">=</span> <span class="token generic-function"><span class="token function">defineProps</span><span class="token generic class-name"><span class="token operator">&lt;</span>IProps<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> emit <span class="token operator">=</span> <span class="token function">defineEmits</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;newDataClick&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;editDataClick&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment">// 0. 获取是否有对应的增删改查权限</span>
<span class="token comment">// 增</span>
<span class="token keyword">const</span> isCreate <span class="token operator">=</span> <span class="token function">usePermission</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>contentConfig<span class="token punctuation">.</span>pageName<span class="token punctuation">,</span> <span class="token string">&#39;create&#39;</span><span class="token punctuation">)</span>
<span class="token comment">// 删</span>
<span class="token keyword">const</span> isDelete <span class="token operator">=</span> <span class="token function">usePermission</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>contentConfig<span class="token punctuation">.</span>pageName<span class="token punctuation">,</span> <span class="token string">&#39;delete&#39;</span><span class="token punctuation">)</span>】
<span class="token comment">// 改</span>
<span class="token keyword">const</span> isUpdate <span class="token operator">=</span> <span class="token function">usePermission</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>contentConfig<span class="token punctuation">.</span>pageName<span class="token punctuation">,</span> <span class="token string">&#39;update&#39;</span><span class="token punctuation">)</span>
<span class="token comment">// 查</span>
<span class="token keyword">const</span> isQuery <span class="token operator">=</span> <span class="token function">usePermission</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>contentConfig<span class="token punctuation">.</span>pageName<span class="token punctuation">,</span> <span class="token string">&#39;query&#39;</span><span class="token punctuation">)</span>

<span class="token comment">// 1.请求数据...</span>
<span class="token keyword">function</span> <span class="token function">fetchPageListData</span><span class="token punctuation">(</span>formData<span class="token operator">:</span> <span class="token builtin">any</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 查</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>isQuery<span class="token punctuation">)</span> <span class="token keyword">return</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
<span class="token comment">// ...</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="细节处理-新增编辑删除操作重置-current-分页" tabindex="-1"><a class="header-anchor" href="#细节处理-新增编辑删除操作重置-current-分页" aria-hidden="true">#</a> (细节处理)新增编辑删除操作重置 current 分页</h2><p>通过使用<code>pinia</code>中的<a href="https://pinia.vuejs.org/zh/core-concepts/actions.html#subscribing-to-actions" target="_blank" rel="noopener noreferrer">订阅<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a><a href="https://pinia.vuejs.org/zh/core-concepts/actions.html#subscribing-to-actions" target="_blank" rel="noopener noreferrer"><code>action</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>，去监听增删改的<code>actions</code>，从而将<code>current</code>重置。</p><blockquote><p>订阅 <code>action</code>：你可以通过 <code>store.$onAction()</code> 来监听 <code>action</code> 和它们的结果。传递给它的回调函数会在 <code>action</code> 本身之前执行。<code>after</code> 表示在 promise 解决之后，允许你在 <code>action</code> 解决后执行一个回调函数。同样地，<code>onError</code> 允许你在 <code>action</code> 抛出错误或 <code>reject</code> 时执行一个回调函数。</p></blockquote><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// page-content.vue</span>
<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span> name<span class="token operator">=</span><span class="token string">&quot;content&quot;</span><span class="token operator">&gt;</span>
<span class="token comment">// ...</span>
<span class="token comment">// 6.监听systemStore的增删改action,将页面currentPage重置</span>
systemStore<span class="token punctuation">.</span><span class="token function">$onAction</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">,</span> after <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// after表示在action成功执行之后执行（失败时不执行）</span>
  <span class="token function">after</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>name <span class="token operator">===</span> <span class="token string">&#39;editPageDataAction&#39;</span> <span class="token operator">||</span> name <span class="token operator">===</span> <span class="token string">&#39;newPageDataAction&#39;</span> <span class="token operator">||</span> name <span class="token operator">===</span> <span class="token string">&#39;deletePageDataAction&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      currentPage<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="实现数据统计页面" tabindex="-1"><a class="header-anchor" href="#实现数据统计页面" aria-hidden="true">#</a> 实现数据统计页面</h2><h3 id="实现顶部卡片组件页面" tabindex="-1"><a class="header-anchor" href="#实现顶部卡片组件页面" aria-hidden="true">#</a> 实现顶部卡片组件页面</h3><h4 id="实现子组件数字统计卡片的静态默认展示。" tabindex="-1"><a class="header-anchor" href="#实现子组件数字统计卡片的静态默认展示。" aria-hidden="true">#</a> 实现子组件数字统计卡片的静态默认展示。</h4><p>使用了<code>withDefaults</code>实现。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// cpns/count-card/count-card.vue</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;count-card&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;header&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;title&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> title <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>tooltip <span class="token operator">:</span>content<span class="token operator">=</span><span class="token string">&quot;tips&quot;</span> placement<span class="token operator">=</span><span class="token string">&quot;top-start&quot;</span> effect<span class="token operator">=</span><span class="token string">&quot;dark&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>el<span class="token operator">-</span>icon<span class="token operator">&gt;</span><span class="token operator">&lt;</span>Warning <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>icon<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>tooltip<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;content&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;count&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> number1 <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;footer&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> subtitle <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> number2 <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">interface</span> <span class="token class-name">IProps</span> <span class="token punctuation">{</span>
    title<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
    tips<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
    number1<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span>
    number2<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span>
    subtitle<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token comment">// withDefaults默认值</span>
<span class="token function">withDefaults</span><span class="token punctuation">(</span><span class="token generic-function"><span class="token function">defineProps</span><span class="token generic class-name"><span class="token operator">&lt;</span>IProps<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    title<span class="token operator">:</span> <span class="token string">&#39;商品总销量&#39;</span><span class="token punctuation">,</span>
    tips<span class="token operator">:</span> <span class="token string">&#39;所有商品的总销量&#39;</span><span class="token punctuation">,</span>
    number1<span class="token operator">:</span> <span class="token number">509989</span><span class="token punctuation">,</span>
    number2<span class="token operator">:</span> <span class="token number">509989</span><span class="token punctuation">,</span>
    subtitle<span class="token operator">:</span> <span class="token string">&#39;商品总销量&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style lang<span class="token operator">=</span><span class="token string">&quot;less&quot;</span> scoped<span class="token operator">&gt;</span>
<span class="token punctuation">.</span>count<span class="token operator">-</span>card <span class="token punctuation">{</span>
    display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
    flex<span class="token operator">-</span>direction<span class="token operator">:</span> column<span class="token punctuation">;</span>
    padding<span class="token operator">:</span> <span class="token number">0</span> 20px<span class="token punctuation">;</span>
    height<span class="token operator">:</span> 130px<span class="token punctuation">;</span>
    background<span class="token operator">:</span> white<span class="token punctuation">;</span>
    box<span class="token operator">-</span>shadow<span class="token operator">:</span> <span class="token number">0</span> <span class="token number">0</span> 10px <span class="token function">rgba</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">.</span>header <span class="token punctuation">{</span>
        display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
        height<span class="token operator">:</span> 38px<span class="token punctuation">;</span>
        font<span class="token operator">-</span>size<span class="token operator">:</span> 14px<span class="token punctuation">;</span>
        color<span class="token operator">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.45</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        justify<span class="token operator">-</span>content<span class="token operator">:</span> space<span class="token operator">-</span>between<span class="token punctuation">;</span>
        align<span class="token operator">-</span>items<span class="token operator">:</span> flex<span class="token operator">-</span>end
    <span class="token punctuation">}</span>

    <span class="token punctuation">.</span>content <span class="token punctuation">{</span>
        display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
        flex<span class="token operator">-</span>direction<span class="token operator">:</span> column<span class="token punctuation">;</span>
        justify<span class="token operator">-</span>content<span class="token operator">:</span> center<span class="token punctuation">;</span>
        align<span class="token operator">-</span>items<span class="token operator">:</span> flex<span class="token operator">-</span>start<span class="token punctuation">;</span>
        flex<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
        margin<span class="token operator">-</span>left<span class="token operator">:</span> 0px<span class="token punctuation">;</span>
        font<span class="token operator">-</span>size<span class="token operator">:</span> 26px<span class="token punctuation">;</span>
        color<span class="token operator">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.85</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token punctuation">.</span>footer <span class="token punctuation">{</span>
        display<span class="token operator">:</span> flex<span class="token punctuation">;</span>
        height<span class="token operator">:</span> 38px<span class="token punctuation">;</span>
        line<span class="token operator">-</span>height<span class="token operator">:</span> 38px<span class="token punctuation">;</span>
        letter<span class="token operator">-</span>spacing<span class="token operator">:</span> 1px<span class="token punctuation">;</span>
        color<span class="token operator">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.85</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        border<span class="token operator">-</span>top<span class="token operator">:</span> 1px solid #f0f0f0<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="封装网络请求实现动态页面" tabindex="-1"><a class="header-anchor" href="#封装网络请求实现动态页面" aria-hidden="true">#</a> 封装网络请求实现动态页面</h4><p>使用<code>hyRequest</code>和<code>pinia</code>封装网络请求以及数据。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// service/main/analysis.ts</span>
<span class="token keyword">import</span> hyRequest <span class="token keyword">from</span> <span class="token string">&quot;@/service&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getAmountListData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> hyRequest<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token operator">:</span> <span class="token string">&#39;/goods/amount/list&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> getAmountListData <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/service/main/analysis/analysis&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;pinia&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">IAnalysisState</span> <span class="token punctuation">{</span>
    amountList<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> useAnalysisStore <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token string">&#39;analysis&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    state<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> IAnalysisState <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
        amountList<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    actions<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token keyword">async</span> <span class="token function">fetchAnalysisDataAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> amountResult <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getAmountListData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>amountList <span class="token operator">=</span> amountResult<span class="token punctuation">.</span>data
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> useAnalysisStore
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="父组件获取请求数据并传递给子组件" tabindex="-1"><a class="header-anchor" href="#父组件获取请求数据并传递给子组件" aria-hidden="true">#</a> 父组件获取请求数据并传递给子组件</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// views/main/analysis.vue</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;dashboard&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>el<span class="token operator">-</span>row <span class="token operator">:</span>gutter<span class="token operator">=</span><span class="token string">&quot;10&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>template v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;item in amountList&quot;</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">&quot;item.amount&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>col <span class="token operator">:</span>span<span class="token operator">=</span><span class="token string">&quot;6&quot;</span> <span class="token operator">:</span>xs<span class="token operator">=</span><span class="token string">&quot;24&quot;</span> <span class="token operator">:</span>sm<span class="token operator">=</span><span class="token string">&quot;12&quot;</span> <span class="token operator">:</span>md<span class="token operator">=</span><span class="token string">&quot;8&quot;</span> <span class="token operator">:</span>lg<span class="token operator">=</span><span class="token string">&quot;6&quot;</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>count<span class="token operator">-</span>card v<span class="token operator">-</span>bind<span class="token operator">=</span><span class="token string">&quot;item&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>col<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>row<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> countCard <span class="token keyword">from</span> <span class="token string">&quot;./cpns/count-card/count-card.vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> useAnalysisStore <span class="token keyword">from</span> <span class="token string">&#39;@/store/main/analysis/analysis&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> storeToRefs <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;pinia&#39;</span>

<span class="token comment">// 发起actions封装的网络请求</span>
<span class="token keyword">const</span> analysisStore <span class="token operator">=</span> <span class="token function">useAnalysisStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
analysisStore<span class="token punctuation">.</span><span class="token function">fetchAnalysisDataAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 获取数据</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> amountList <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">storeToRefs</span><span class="token punctuation">(</span>analysisStore<span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="顶部卡片中的数据递增动画实现" tabindex="-1"><a class="header-anchor" href="#顶部卡片中的数据递增动画实现" aria-hidden="true">#</a> 顶部卡片中的数据递增动画实现</h3><p>安装<code>npm install countup.js</code></p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token comment">// ...</span>
  <span class="token operator">&lt;</span>span ref<span class="token operator">=</span><span class="token string">&quot;count1Ref&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> number1 <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>span ref<span class="token operator">=</span><span class="token string">&quot;count2Ref&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> number2 <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span><span class="token operator">&gt;</span>
<span class="token comment">// 数字递增动画</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CountUp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;countup.js&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> onMounted<span class="token punctuation">,</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">IProps</span> <span class="token punctuation">{</span>
    amount<span class="token operator">?</span> <span class="token operator">:</span><span class="token builtin">string</span><span class="token punctuation">,</span>
    title<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
    tips<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
    number1<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span>
    number2<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span>
    subtitle<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token comment">// withDefaults默认值</span>
<span class="token keyword">const</span> props <span class="token operator">=</span> <span class="token function">withDefaults</span><span class="token punctuation">(</span><span class="token generic-function"><span class="token function">defineProps</span><span class="token generic class-name"><span class="token operator">&lt;</span>IProps<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    title<span class="token operator">:</span> <span class="token string">&#39;商品总销量&#39;</span><span class="token punctuation">,</span>
    tips<span class="token operator">:</span> <span class="token string">&#39;所有商品的总销量&#39;</span><span class="token punctuation">,</span>
    number1<span class="token operator">:</span> <span class="token number">509989</span><span class="token punctuation">,</span>
    number2<span class="token operator">:</span> <span class="token number">509989</span><span class="token punctuation">,</span>
    subtitle<span class="token operator">:</span> <span class="token string">&#39;商品总销量&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 给数字前面加前缀¥</span>
<span class="token keyword">const</span> countOption <span class="token operator">=</span> <span class="token punctuation">{</span>
    prefix<span class="token operator">:</span> props<span class="token punctuation">.</span>amount <span class="token operator">==</span> <span class="token string">&#39;sale&#39;</span> <span class="token operator">?</span> <span class="token string">&#39;¥&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;&#39;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 创建CountUp的实例对象</span>
<span class="token keyword">const</span> count1Ref <span class="token operator">=</span> <span class="token generic-function"><span class="token function">ref</span><span class="token generic class-name"><span class="token operator">&lt;</span>HTMLElement<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> count2Ref <span class="token operator">=</span> <span class="token generic-function"><span class="token function">ref</span><span class="token generic class-name"><span class="token operator">&lt;</span>HTMLElement<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 参数1: 数字动画的元素</span>
<span class="token comment">// 参数2: 数字增加到多少</span>
<span class="token comment">// 参数3: 给参数1前面加个前缀，如¥</span>
<span class="token comment">// 这里使用onMounted是因为setup的时候还没挂载到ref,就会报错</span>
<span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> countup1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CountUp</span><span class="token punctuation">(</span>count1Ref<span class="token punctuation">.</span>value<span class="token operator">!</span><span class="token punctuation">,</span> props<span class="token punctuation">.</span>number1<span class="token punctuation">,</span> countOption<span class="token punctuation">)</span>
    <span class="token keyword">const</span> countup2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CountUp</span><span class="token punctuation">(</span>count2Ref<span class="token punctuation">.</span>value<span class="token operator">!</span><span class="token punctuation">,</span> props<span class="token punctuation">.</span>number2<span class="token punctuation">,</span> countOption<span class="token punctuation">)</span>

    countup1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    countup2<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="实现顶部卡片响应式布局" tabindex="-1"><a class="header-anchor" href="#实现顶部卡片响应式布局" aria-hidden="true">#</a> 实现顶部卡片响应式布局</h3><p>使用<code>el-col</code>的<code>xs</code>，<code>sm</code>，<code>md</code>，<code>lg</code>，<code>xl</code>实现。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token operator">&lt;</span>el<span class="token operator">-</span>col <span class="token operator">:</span>span<span class="token operator">=</span><span class="token string">&quot;6&quot;</span> <span class="token operator">:</span>xs<span class="token operator">=</span><span class="token string">&quot;24&quot;</span> <span class="token operator">:</span>sm<span class="token operator">=</span><span class="token string">&quot;12&quot;</span> <span class="token operator">:</span>md<span class="token operator">=</span><span class="token string">&quot;8&quot;</span> <span class="token operator">:</span>lg<span class="token operator">=</span><span class="token string">&quot;6&quot;</span><span class="token operator">&gt;</span>
  <span class="token comment">// ...</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>col<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="实现-echart-可视化" tabindex="-1"><a class="header-anchor" href="#实现-echart-可视化" aria-hidden="true">#</a> 实现 echart 可视化</h2><p>安装：<a href="https://echarts.apache.org/handbook/zh/get-started/" target="_blank" rel="noopener noreferrer"><code>npm install echarts --save</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="初步搭建可视化页面" tabindex="-1"><a class="header-anchor" href="#初步搭建可视化页面" aria-hidden="true">#</a> 初步搭建可视化页面</h3><h4 id="使用-element-封装卡片组件" tabindex="-1"><a class="header-anchor" href="#使用-element-封装卡片组件" aria-hidden="true">#</a> 使用 element 封装卡片组件</h4><p>使用<code>el-card</code>卡片，将<code>echart</code>可视化图形聚合在卡片容器中展示。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// chart-card.vue</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;chart-card&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>el<span class="token operator">-</span>card <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;box-card&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>template #header<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;cart-header&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span><span class="token function">分类商品数量</span><span class="token punctuation">(</span>饼图<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

        <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;content&quot;</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>slot<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>slot<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>card<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>style lang<span class="token operator">=</span><span class="token string">&quot;less&quot;</span> scoped<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="引入-echarts-的饼图" tabindex="-1"><a class="header-anchor" href="#引入-echarts-的饼图" aria-hidden="true">#</a> 引入 ECharts 的饼图</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// dashboard.vue</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;dashboard&quot;</span><span class="token operator">&gt;</span>
    <span class="token comment">// 顶部卡片组件</span>
    <span class="token operator">&lt;</span>el<span class="token operator">-</span>row <span class="token operator">:</span>gutter<span class="token operator">=</span><span class="token string">&quot;10&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>template v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;item in amountList&quot;</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">&quot;item.amount&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>col <span class="token operator">:</span>span<span class="token operator">=</span><span class="token string">&quot;6&quot;</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>count<span class="token operator">-</span>card v<span class="token operator">-</span>bind<span class="token operator">=</span><span class="token string">&quot;item&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>col<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>row<span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span>el<span class="token operator">-</span>row <span class="token operator">:</span>gutter<span class="token operator">=</span><span class="token string">&quot;10&quot;</span><span class="token operator">&gt;</span>
      <span class="token comment">// echart饼图</span>
      <span class="token operator">&lt;</span>el<span class="token operator">-</span>col <span class="token operator">:</span>span<span class="token operator">=</span><span class="token string">&quot;7&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>chart<span class="token operator">-</span>card<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;echart&quot;</span> ref<span class="token operator">=</span><span class="token string">&quot;echartRef&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>chart<span class="token operator">-</span>card<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>col<span class="token operator">&gt;</span>

      <span class="token operator">&lt;</span>el<span class="token operator">-</span>col <span class="token operator">:</span>span<span class="token operator">=</span><span class="token string">&quot;10&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>chart<span class="token operator">-</span>card<span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>col<span class="token operator">&gt;</span>

      <span class="token operator">&lt;</span>el<span class="token operator">-</span>col <span class="token operator">:</span>span<span class="token operator">=</span><span class="token string">&quot;7&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>chart<span class="token operator">-</span>card<span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>col<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>row<span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span>el<span class="token operator">-</span>row <span class="token operator">:</span>gutter<span class="token operator">=</span><span class="token string">&quot;10&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>el<span class="token operator">-</span>col <span class="token operator">:</span>span<span class="token operator">=</span><span class="token string">&quot;12&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>chart<span class="token operator">-</span>card<span class="token operator">&gt;</span>折线图<span class="token operator">&lt;</span><span class="token operator">/</span>chart<span class="token operator">-</span>card<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>col<span class="token operator">&gt;</span>

      <span class="token operator">&lt;</span>el<span class="token operator">-</span>col <span class="token operator">:</span>span<span class="token operator">=</span><span class="token string">&quot;12&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>chart<span class="token operator">-</span>card<span class="token operator">&gt;</span>柱状图<span class="token operator">&lt;</span><span class="token operator">/</span>chart<span class="token operator">-</span>card<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>col<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>row<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span><span class="token operator">&gt;</span>
<span class="token comment">// ...</span>
<span class="token keyword">import</span> chartCard <span class="token keyword">from</span> <span class="token string">&quot;./cpns/chart-card/chart-card.vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> onMounted<span class="token punctuation">,</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> echarts <span class="token keyword">from</span> <span class="token string">&#39;echarts&#39;</span>

<span class="token comment">// 发起actions封装的网络请求...</span>
<span class="token comment">// 获取数据...</span>

<span class="token comment">// 1. 引用dom实例</span>
<span class="token keyword">const</span> echartRef <span class="token operator">=</span> <span class="token generic-function"><span class="token function">ref</span><span class="token generic class-name"><span class="token operator">&lt;</span>HTMLElement<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 2. 基于准备好的dom，初始化echart实例</span>
  <span class="token keyword">const</span> echartInstance <span class="token operator">=</span> echarts<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>echartRef<span class="token punctuation">.</span>value<span class="token operator">!</span><span class="token punctuation">,</span> <span class="token string">&quot;light&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    renderer<span class="token operator">:</span> <span class="token string">&#39;canvas&#39;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token comment">// 3.设置options(配置)</span>
  echartInstance<span class="token punctuation">.</span><span class="token function">setOption</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    title<span class="token operator">:</span> <span class="token punctuation">{</span>
      text<span class="token operator">:</span> <span class="token string">&#39;Referer of a Website&#39;</span><span class="token punctuation">,</span>
      subtext<span class="token operator">:</span> <span class="token string">&#39;Fake Data&#39;</span><span class="token punctuation">,</span>
      left<span class="token operator">:</span> <span class="token string">&#39;center&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    tooltip<span class="token operator">:</span> <span class="token punctuation">{</span>
      trigger<span class="token operator">:</span> <span class="token string">&#39;item&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    legend<span class="token operator">:</span> <span class="token punctuation">{</span>
      orient<span class="token operator">:</span> <span class="token string">&#39;vertical&#39;</span><span class="token punctuation">,</span>
      left<span class="token operator">:</span> <span class="token string">&#39;left&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    series<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        name<span class="token operator">:</span> <span class="token string">&#39;Access From&#39;</span><span class="token punctuation">,</span>
        type<span class="token operator">:</span> <span class="token string">&#39;pie&#39;</span><span class="token punctuation">,</span>
        radius<span class="token operator">:</span> <span class="token string">&#39;50%&#39;</span><span class="token punctuation">,</span>
        data<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token number">1048</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&#39;Search Engine&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token number">735</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&#39;Direct&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token number">580</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&#39;Email&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token number">484</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&#39;Union Ads&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token number">300</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&#39;Video Ads&#39;</span> <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        emphasis<span class="token operator">:</span> <span class="token punctuation">{</span>
          itemStyle<span class="token operator">:</span> <span class="token punctuation">{</span>
            shadowBlur<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
            shadowOffsetX<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            shadowColor<span class="token operator">:</span> <span class="token string">&#39;rgba(0, 0, 0, 0.5)&#39;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style lang<span class="token operator">=</span><span class="token string">&quot;less&quot;</span> scoped<span class="token operator">&gt;</span>
<span class="token punctuation">.</span>el<span class="token operator">-</span>row <span class="token punctuation">{</span>
  margin<span class="token operator">-</span>bottom<span class="token operator">:</span> 15px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">.</span>echart <span class="token punctuation">{</span>
  height<span class="token operator">:</span> 250px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="三层组件封装-echart" tabindex="-1"><a class="header-anchor" href="#三层组件封装-echart" aria-hidden="true">#</a> 三层组件封装 echart</h3><h4 id="封装-base-echart-组件" tabindex="-1"><a class="header-anchor" href="#封装-base-echart-组件" aria-hidden="true">#</a> 封装 Base-echart 组件</h4><p><code>base-echart</code>做初始化（基于准备好的<code>dom</code>，初始化<code>echart</code>实例），用于接收不同<code>echart</code>图形的<code>option</code>配置。监听<code>window</code>的<code>resize</code>属性设置<code>echartInstance.resize()</code>可以实现<code>echart</code>的响应式。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// base-echart.vue</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;base-echart&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;echart&quot;</span> ref<span class="token operator">=</span><span class="token string">&quot;echartRef&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> echarts <span class="token keyword">from</span> <span class="token string">&#39;echarts&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> onMounted<span class="token punctuation">,</span> ref<span class="token punctuation">,</span> watchEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token comment">// 获取echart的option类型</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> EChartsOption <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;echarts&#39;</span>

<span class="token comment">// 接收每个echart不同配置</span>
<span class="token keyword">interface</span> <span class="token class-name">IProps</span> <span class="token punctuation">{</span>
    option<span class="token operator">:</span> EChartsOption
<span class="token punctuation">}</span>
<span class="token keyword">const</span> props <span class="token operator">=</span> <span class="token generic-function"><span class="token function">defineProps</span><span class="token generic class-name"><span class="token operator">&lt;</span>IProps<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 1. 引用dom实例</span>
<span class="token keyword">const</span> echartRef <span class="token operator">=</span> <span class="token generic-function"><span class="token function">ref</span><span class="token generic class-name"><span class="token operator">&lt;</span>HTMLElement<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 2. 基于准备好的dom，初始化echart实例</span>
  <span class="token keyword">const</span> echartInstance <span class="token operator">=</span> echarts<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>echartRef<span class="token punctuation">.</span>value<span class="token operator">!</span><span class="token punctuation">,</span> <span class="token string">&quot;light&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    renderer<span class="token operator">:</span> <span class="token string">&#39;canvas&#39;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token comment">// 3.第一次options(配置),动态传入每个图的option</span>
  <span class="token comment">// watchEffect监听option变化，重新执行</span>
  <span class="token function">watchEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> echartInstance<span class="token punctuation">.</span><span class="token function">setOption</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>option<span class="token punctuation">)</span><span class="token punctuation">)</span>

  <span class="token comment">// 4.监听window缩放实现echart响应式布局</span>
  window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;resize&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    echartInstance<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style lang<span class="token operator">=</span><span class="token string">&quot;less&quot;</span> scoped<span class="token operator">&gt;</span>
<span class="token punctuation">.</span>echart <span class="token punctuation">{</span>
  height<span class="token operator">:</span> 250px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="绘制-echarts-图形" tabindex="-1"><a class="header-anchor" href="#绘制-echarts-图形" aria-hidden="true">#</a> 绘制 ECharts 图形</h4><p>编写<code>option</code>配置，将<code>option</code>传入子组件<code>base-echart.vue</code>，使用<code>:option</code>接收。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// pie-echart.vue</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;pie-echart&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>base<span class="token operator">-</span>echart <span class="token operator">:</span>option<span class="token operator">=</span><span class="token string">&quot;option&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> BaseEchart <span class="token keyword">from</span> <span class="token string">&#39;./base-echart.vue&#39;</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> EChartsOption <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;echarts&#39;</span>

<span class="token comment">// 只负责传入饼图的option</span>
<span class="token keyword">const</span> option<span class="token operator">:</span> EChartsOption <span class="token operator">=</span> <span class="token punctuation">{</span>
    title<span class="token operator">:</span> <span class="token punctuation">{</span>
      text<span class="token operator">:</span> <span class="token string">&#39;Referer of a Website&#39;</span><span class="token punctuation">,</span>
      subtext<span class="token operator">:</span> <span class="token string">&#39;Fake Data&#39;</span><span class="token punctuation">,</span>
      left<span class="token operator">:</span> <span class="token string">&#39;center&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    tooltip<span class="token operator">:</span> <span class="token punctuation">{</span>
      trigger<span class="token operator">:</span> <span class="token string">&#39;item&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    legend<span class="token operator">:</span> <span class="token punctuation">{</span>
      orient<span class="token operator">:</span> <span class="token string">&#39;vertical&#39;</span><span class="token punctuation">,</span>
      left<span class="token operator">:</span> <span class="token string">&#39;left&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    series<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        name<span class="token operator">:</span> <span class="token string">&#39;Access From&#39;</span><span class="token punctuation">,</span>
        type<span class="token operator">:</span> <span class="token string">&#39;pie&#39;</span><span class="token punctuation">,</span>
        radius<span class="token operator">:</span> <span class="token string">&#39;50%&#39;</span><span class="token punctuation">,</span>
        data<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token number">1048</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&#39;Search Engine&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token number">735</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&#39;Direct&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token number">580</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&#39;Email&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token number">484</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&#39;Union Ads&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token number">300</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">&#39;Video Ads&#39;</span> <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        emphasis<span class="token operator">:</span> <span class="token punctuation">{</span>
          itemStyle<span class="token operator">:</span> <span class="token punctuation">{</span>
            shadowBlur<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
            shadowOffsetX<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            shadowColor<span class="token operator">:</span> <span class="token string">&#39;rgba(0, 0, 0, 0.5)&#39;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style lang<span class="token operator">=</span><span class="token string">&quot;less&quot;</span> scoped<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="统一导出" tabindex="-1"><a class="header-anchor" href="#统一导出" aria-hidden="true">#</a> 统一导出</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// index.ts</span>
<span class="token keyword">import</span> BaseEchart <span class="token keyword">from</span> <span class="token string">&#39;./src/base-echart.vue&#39;</span>
<span class="token keyword">import</span> PieEchart <span class="token keyword">from</span> <span class="token string">&#39;./src/pie-echart.vue&#39;</span>
<span class="token keyword">import</span> LineEchart <span class="token keyword">from</span> <span class="token string">&#39;./src/line-echart.vue&#39;</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span> PieEchart<span class="token punctuation">,</span> LineEchart <span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> BaseEchart
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="引入-echarts-图形" tabindex="-1"><a class="header-anchor" href="#引入-echarts-图形" aria-hidden="true">#</a> 引入 ECharts 图形</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// dashboard,vue</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;dashboard&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>顶部卡片组件 <span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>el<span class="token operator">-</span>row <span class="token operator">:</span>gutter<span class="token operator">=</span><span class="token string">&quot;10&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>template v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;item in amountList&quot;</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">&quot;item.amount&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>col <span class="token operator">:</span>span<span class="token operator">=</span><span class="token string">&quot;6&quot;</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>count<span class="token operator">-</span>card v<span class="token operator">-</span>bind<span class="token operator">=</span><span class="token string">&quot;item&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>col<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>row<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>el<span class="token operator">-</span>row <span class="token operator">:</span>gutter<span class="token operator">=</span><span class="token string">&quot;10&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>el<span class="token operator">-</span>col <span class="token operator">:</span>span<span class="token operator">=</span><span class="token string">&quot;7&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>chart<span class="token operator">-</span>card<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>pie<span class="token operator">-</span>echart<span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>chart<span class="token operator">-</span>card<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>col<span class="token operator">&gt;</span>

      <span class="token operator">&lt;</span>el<span class="token operator">-</span>col <span class="token operator">:</span>span<span class="token operator">=</span><span class="token string">&quot;10&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>chart<span class="token operator">-</span>card<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>line<span class="token operator">-</span>echart<span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>chart<span class="token operator">-</span>card<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>col<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>row<span class="token operator">&gt;</span>
    <span class="token comment">// ...</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span><span class="token operator">&gt;</span>
<span class="token comment">// ...</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="获取请求数据用于-echarts-显示" tabindex="-1"><a class="header-anchor" href="#获取请求数据用于-echarts-显示" aria-hidden="true">#</a> 获取请求数据用于 ECharts 显示</h3><h4 id="封装-service-请求接口" tabindex="-1"><a class="header-anchor" href="#封装-service-请求接口" aria-hidden="true">#</a> 封装 service 请求接口</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// service/analysis.ts</span>
<span class="token comment">// 获取饼图分类商品数量</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getGoodsCategoryCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> hyRequest<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token operator">:</span> <span class="token string">&#39;/goods/category/count&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="封装-pinia-请求数据" tabindex="-1"><a class="header-anchor" href="#封装-pinia-请求数据" aria-hidden="true">#</a> 封装 pinia 请求数据</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// store/analysis.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> getAmountListData<span class="token punctuation">,</span> getGoodsCategoryCount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/service/main/analysis/analysis&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;pinia&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">IAnalysisState</span> <span class="token punctuation">{</span>
    amountList<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    goodsCategoryCount<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> useAnalysisStore <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token string">&#39;analysis&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    state<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> IAnalysisState <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
        amountList<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        goodsCategoryCount<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    actions<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token keyword">async</span> <span class="token function">fetchAnalysisDataAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 顶部卡片数据</span>
            <span class="token keyword">const</span> amountResult <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getAmountListData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>amountList <span class="token operator">=</span> amountResult<span class="token punctuation">.</span>data

            <span class="token comment">// 获取饼图数据</span>
            <span class="token keyword">const</span> goodsResult <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getGoodsCategoryCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>goodsCategoryCount <span class="token operator">=</span> goodsResult<span class="token punctuation">.</span>data
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> useAnalysisStore
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="父组件调用-pinia-中的-actions-发起请求" tabindex="-1"><a class="header-anchor" href="#父组件调用-pinia-中的-actions-发起请求" aria-hidden="true">#</a> 父组件调用 pinia 中的 actions 发起请求</h4><p>父组件<code>dashboard.vue</code>发起请求获取饼图数据，将数据（<code>name</code>，<code>goodsCount</code>）通过<code>map</code>映射成饼图需要的数据（<code>name</code>，<code>value</code>），通过<code>:pie-data=&quot;showGoodsCategoryCount</code>传递给子组件<code>pie-echart.vue</code>。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// dashboard.vue</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;dashboard&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>顶部卡片组件 <span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token comment">// ...</span>
    <span class="token comment">// 饼图</span>
    <span class="token operator">&lt;</span>el<span class="token operator">-</span>row <span class="token operator">:</span>gutter<span class="token operator">=</span><span class="token string">&quot;10&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>el<span class="token operator">-</span>col <span class="token operator">:</span>span<span class="token operator">=</span><span class="token string">&quot;7&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>chart<span class="token operator">-</span>card<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>pie<span class="token operator">-</span>echart <span class="token operator">:</span>pie<span class="token operator">-</span>data<span class="token operator">=</span><span class="token string">&quot;showGoodsCategoryCount&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>chart<span class="token operator">-</span>card<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>col<span class="token operator">&gt;</span>
     <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>row<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> storeToRefs <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;pinia&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> computed <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> countCard <span class="token keyword">from</span> <span class="token string">&quot;./cpns/count-card/count-card.vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> chartCard <span class="token keyword">from</span> <span class="token string">&quot;./cpns/chart-card/chart-card.vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> useAnalysisStore <span class="token keyword">from</span> <span class="token string">&#39;@/store/main/analysis/analysis&#39;</span>

<span class="token comment">// 发起actions封装的网络请求</span>
<span class="token keyword">const</span> analysisStore <span class="token operator">=</span> <span class="token function">useAnalysisStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
analysisStore<span class="token punctuation">.</span><span class="token function">fetchAnalysisDataAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 获取数据</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> amountList<span class="token punctuation">,</span> goodsCategoryCount <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">storeToRefs</span><span class="token punctuation">(</span>analysisStore<span class="token punctuation">)</span>

<span class="token comment">// 获取echart饼图数据</span>
<span class="token keyword">const</span> showGoodsCategoryCount <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> goodsCategoryCount<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    name<span class="token operator">:</span> item<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
    value<span class="token operator">:</span> item<span class="token punctuation">.</span>goodsCount
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="子组件动态接收饼图-option-数据" tabindex="-1"><a class="header-anchor" href="#子组件动态接收饼图-option-数据" aria-hidden="true">#</a> 子组件动态接收饼图 option 数据</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;pie-echart&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>base<span class="token operator">-</span>echart <span class="token operator">:</span>option<span class="token operator">=</span><span class="token string">&quot;option&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> BaseEchart <span class="token keyword">from</span> <span class="token string">&#39;./base-echart.vue&#39;</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> EChartsOption <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;echarts&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> computed <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>

<span class="token keyword">interface</span> <span class="token class-name">IEchartValueType</span> <span class="token punctuation">{</span>
  value<span class="token operator">:</span> <span class="token builtin">number</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">IProps</span> <span class="token punctuation">{</span>
  pieData<span class="token operator">:</span> IEchartValueType<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> props <span class="token operator">=</span> <span class="token generic-function"><span class="token function">defineProps</span><span class="token generic class-name"><span class="token operator">&lt;</span>IProps<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 只负责传入饼图的option</span>
<span class="token keyword">const</span> option <span class="token operator">=</span> <span class="token generic-function"><span class="token function">computed</span><span class="token generic class-name"><span class="token operator">&lt;</span>EChartsOption<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      tooltip<span class="token operator">:</span> <span class="token punctuation">{</span>
        trigger<span class="token operator">:</span> <span class="token string">&#39;item&#39;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      legend<span class="token operator">:</span> <span class="token punctuation">{</span>
        orient<span class="token operator">:</span> <span class="token string">&#39;horizontal&#39;</span><span class="token punctuation">,</span>
        left<span class="token operator">:</span> <span class="token string">&#39;left&#39;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      series<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          name<span class="token operator">:</span> <span class="token string">&#39;访问来问&#39;</span><span class="token punctuation">,</span>
          type<span class="token operator">:</span> <span class="token string">&#39;pie&#39;</span><span class="token punctuation">,</span>
          radius<span class="token operator">:</span> <span class="token string">&#39;50%&#39;</span><span class="token punctuation">,</span>
          bottom<span class="token operator">:</span> <span class="token string">&#39;-10%&#39;</span><span class="token punctuation">,</span>
          data<span class="token operator">:</span> props<span class="token punctuation">.</span>pieData<span class="token punctuation">,</span>
          emphasis<span class="token operator">:</span> <span class="token punctuation">{</span>
            itemStyle<span class="token operator">:</span> <span class="token punctuation">{</span>
              shadowBlur<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
              shadowOffsetX<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
              shadowColor<span class="token operator">:</span> <span class="token string">&#39;rgba(0, 0, 0, 0.5)&#39;</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="实现各种-echart-图动态数据展示" tabindex="-1"><a class="header-anchor" href="#实现各种-echart-图动态数据展示" aria-hidden="true">#</a> 实现各种 Echart 图动态数据展示</h3><h4 id="封装请求接口的动态数据" tabindex="-1"><a class="header-anchor" href="#封装请求接口的动态数据" aria-hidden="true">#</a> 封装请求接口的动态数据</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// service/analysis.ts</span>
<span class="token comment">// 获取饼图、玫瑰图分类商品数量</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getGoodsCategoryCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> hyRequest<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token operator">:</span> <span class="token string">&#39;/goods/category/count&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 获取折线图商品销量</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getGoodsCategorySale</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> hyRequest<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token operator">:</span> <span class="token string">&#39;/goods/category/sale&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 获取柱状图商品收藏数量</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getGoodsCategoryFavor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> hyRequest<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token operator">:</span> <span class="token string">&#39;/goods/category/favor&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// store/analysis.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> getAmountListData<span class="token punctuation">,</span> getGoodsCategoryCount<span class="token punctuation">,</span> getGoodsCategoryFavor<span class="token punctuation">,</span> getGoodsCategorySale <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/service/main/analysis/analysis&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;pinia&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">IAnalysisState</span> <span class="token punctuation">{</span>
    amountList<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    goodsCategoryCount<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    goodsCategorySale<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    goodsCategoryFavor<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> useAnalysisStore <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token string">&#39;analysis&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    state<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> IAnalysisState <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
        amountList<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        goodsCategoryCount<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        goodsCategorySale<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        goodsCategoryFavor<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    actions<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token keyword">async</span> <span class="token function">fetchAnalysisDataAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 顶部卡片数据</span>
            <span class="token keyword">const</span> amountResult <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getAmountListData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>amountList <span class="token operator">=</span> amountResult<span class="token punctuation">.</span>data

            <span class="token comment">// 获取饼图、玫瑰图数据</span>
            <span class="token keyword">const</span> goodsCountResult <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getGoodsCategoryCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>goodsCategoryCount <span class="token operator">=</span> goodsCountResult<span class="token punctuation">.</span>data

            <span class="token comment">// 获取折线图数据</span>
            <span class="token keyword">const</span> goodsSaleResult <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getGoodsCategorySale</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>goodsCategorySale <span class="token operator">=</span> goodsSaleResult<span class="token punctuation">.</span>data

            <span class="token comment">// 获取柱状图数据</span>
            <span class="token keyword">const</span> goodsFavorResult <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getGoodsCategoryFavor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>goodsCategoryFavor <span class="token operator">=</span> goodsFavorResult<span class="token punctuation">.</span>data
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> useAnalysisStore
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="封装-type-类型接口" tabindex="-1"><a class="header-anchor" href="#封装-type-类型接口" aria-hidden="true">#</a> 封装 Type 类型接口</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// types/index.ts</span>
<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">IEchartValueType</span> <span class="token punctuation">{</span>
    value<span class="token operator">:</span> <span class="token builtin">number</span>
    name<span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="实现玫瑰图数据展示" tabindex="-1"><a class="header-anchor" href="#实现玫瑰图数据展示" aria-hidden="true">#</a> 实现玫瑰图数据展示</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// page-echarts/src/rose-echart.vue</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;pie-echart&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>base<span class="token operator">-</span>echart <span class="token operator">:</span>option<span class="token operator">=</span><span class="token string">&quot;option&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> BaseEchart <span class="token keyword">from</span> <span class="token string">&#39;./base-echart.vue&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> computed <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> IEchartValueType <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;../types&#39;</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> EChartsOption <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;echarts&#39;</span>

<span class="token keyword">interface</span> <span class="token class-name">IProps</span> <span class="token punctuation">{</span>
  roseData<span class="token operator">:</span> IEchartValueType<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> props <span class="token operator">=</span> <span class="token generic-function"><span class="token function">defineProps</span><span class="token generic class-name"><span class="token operator">&lt;</span>IProps<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 玫瑰图</span>
<span class="token keyword">const</span> option <span class="token operator">=</span> <span class="token generic-function"><span class="token function">computed</span><span class="token generic class-name"><span class="token operator">&lt;</span>EChartsOption<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    tooltip<span class="token operator">:</span> <span class="token punctuation">{</span>
      trigger<span class="token operator">:</span> <span class="token string">&#39;item&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    toolbox<span class="token operator">:</span> <span class="token punctuation">{</span>
      show<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      feature<span class="token operator">:</span> <span class="token punctuation">{</span>
        mark<span class="token operator">:</span> <span class="token punctuation">{</span> show<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        dataView<span class="token operator">:</span> <span class="token punctuation">{</span> show<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> readOnly<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        restore<span class="token operator">:</span> <span class="token punctuation">{</span> show<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        saveAsImage<span class="token operator">:</span> <span class="token punctuation">{</span> show<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    series<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        name<span class="token operator">:</span> <span class="token string">&#39;访问来源&#39;</span><span class="token punctuation">,</span>
        type<span class="token operator">:</span> <span class="token string">&#39;pie&#39;</span><span class="token punctuation">,</span>
        radius<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">160</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        center<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;50%&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;50%&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        roseType<span class="token operator">:</span> <span class="token string">&#39;area&#39;</span><span class="token punctuation">,</span>
        itemStyle<span class="token operator">:</span> <span class="token punctuation">{</span>
          borderRadius<span class="token operator">:</span> <span class="token number">8</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        bottom<span class="token operator">:</span> <span class="token string">&#39;-25%&#39;</span><span class="token punctuation">,</span>
        data<span class="token operator">:</span> props<span class="token punctuation">.</span>roseData<span class="token punctuation">,</span>
        label<span class="token operator">:</span> <span class="token punctuation">{</span>
            show<span class="token operator">:</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>style lang<span class="token operator">=</span><span class="token string">&quot;less&quot;</span> scoped<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="实现折线图数据展示" tabindex="-1"><a class="header-anchor" href="#实现折线图数据展示" aria-hidden="true">#</a> 实现折线图数据展示</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// page-echarts/src/line-echart.vue</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;line-echart&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>base<span class="token operator">-</span>echart <span class="token operator">:</span>option<span class="token operator">=</span><span class="token string">&quot;option&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> BaseEchart <span class="token keyword">from</span> <span class="token string">&#39;./base-echart.vue&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> computed <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> EChartsOption <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;echarts&#39;</span>

<span class="token keyword">interface</span> <span class="token class-name">IProps</span> <span class="token punctuation">{</span>
  labels<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  values<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> props <span class="token operator">=</span> <span class="token generic-function"><span class="token function">defineProps</span><span class="token generic class-name"><span class="token operator">&lt;</span>IProps<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 玫瑰图</span>
<span class="token keyword">const</span> option <span class="token operator">=</span> <span class="token generic-function"><span class="token function">computed</span><span class="token generic class-name"><span class="token operator">&lt;</span>EChartsOption<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    grid<span class="token operator">:</span> <span class="token punctuation">{</span>
      left<span class="token operator">:</span> <span class="token string">&#39;3%&#39;</span><span class="token punctuation">,</span>
      right<span class="token operator">:</span> <span class="token string">&#39;4%&#39;</span><span class="token punctuation">,</span>
      bottom<span class="token operator">:</span> <span class="token string">&#39;3%&#39;</span><span class="token punctuation">,</span>
      containLabel<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    xAxis<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> <span class="token string">&#39;category&#39;</span><span class="token punctuation">,</span>
      boundaryGap<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      data<span class="token operator">:</span> props<span class="token punctuation">.</span>labels
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    yAxis<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> <span class="token string">&#39;value&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    series<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        name<span class="token operator">:</span> <span class="token string">&#39;分类销量统计&#39;</span><span class="token punctuation">,</span>
        type<span class="token operator">:</span> <span class="token string">&#39;line&#39;</span><span class="token punctuation">,</span>
        stack<span class="token operator">:</span> <span class="token string">&#39;总量&#39;</span><span class="token punctuation">,</span>
        areaStyle<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        emphasis<span class="token operator">:</span> <span class="token punctuation">{</span>
          focus<span class="token operator">:</span> <span class="token string">&#39;series&#39;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        data<span class="token operator">:</span> props<span class="token punctuation">.</span>values
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style lang<span class="token operator">=</span><span class="token string">&quot;less&quot;</span> scoped<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="实现柱状图数据展示" tabindex="-1"><a class="header-anchor" href="#实现柱状图数据展示" aria-hidden="true">#</a> 实现柱状图数据展示</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// // page-echarts/src/bar-echart.vue</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;bar-echart&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>base<span class="token operator">-</span>echart <span class="token operator">:</span>option<span class="token operator">=</span><span class="token string">&quot;option&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> BaseEchart <span class="token keyword">from</span> <span class="token string">&#39;./base-echart.vue&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> computed <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> EChartsOption <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;echarts&#39;</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> echarts <span class="token keyword">from</span> <span class="token string">&#39;echarts&#39;</span>

<span class="token keyword">interface</span> <span class="token class-name">IProps</span> <span class="token punctuation">{</span>
  labels<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
  values<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> props <span class="token operator">=</span> <span class="token generic-function"><span class="token function">defineProps</span><span class="token generic class-name"><span class="token operator">&lt;</span>IProps<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 玫瑰图</span>
<span class="token keyword">const</span> option <span class="token operator">=</span> <span class="token generic-function"><span class="token function">computed</span><span class="token generic class-name"><span class="token operator">&lt;</span>EChartsOption<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    title<span class="token operator">:</span> <span class="token punctuation">{</span>
      text<span class="token operator">:</span> <span class="token string">&#39;支持鼠标滚动缩放&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    grid<span class="token operator">:</span> <span class="token punctuation">{</span>
      bottom<span class="token operator">:</span> <span class="token string">&#39;5%&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    xAxis<span class="token operator">:</span> <span class="token punctuation">{</span>
      data<span class="token operator">:</span> props<span class="token punctuation">.</span>labels<span class="token punctuation">,</span>
      axisLabel<span class="token operator">:</span> <span class="token punctuation">{</span>
        inside<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        color<span class="token operator">:</span> <span class="token string">&#39;#fff&#39;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      z<span class="token operator">:</span> <span class="token number">10</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    yAxis<span class="token operator">:</span> <span class="token punctuation">{</span>
      axisLabel<span class="token operator">:</span> <span class="token punctuation">{</span>
        color<span class="token operator">:</span> <span class="token string">&#39;#999&#39;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    series<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        type<span class="token operator">:</span> <span class="token string">&#39;bar&#39;</span><span class="token punctuation">,</span>
        showBackground<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        data<span class="token operator">:</span> props<span class="token punctuation">.</span>values<span class="token punctuation">,</span>
        itemStyle<span class="token operator">:</span> <span class="token punctuation">{</span>
          color<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">echarts</span><span class="token punctuation">.</span>graphic<span class="token punctuation">.</span><span class="token function">LinearGradient</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span> offset<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> color<span class="token operator">:</span> <span class="token string">&#39;#2378f7&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span> offset<span class="token operator">:</span> <span class="token number">0.5</span><span class="token punctuation">,</span> color<span class="token operator">:</span> <span class="token string">&#39;#188df0&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span> offset<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> color<span class="token operator">:</span> <span class="token string">&#39;#188df0&#39;</span> <span class="token punctuation">}</span>
          <span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        emphasis<span class="token operator">:</span> <span class="token punctuation">{</span>
          itemStyle<span class="token operator">:</span> <span class="token punctuation">{</span>
            color<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">echarts</span><span class="token punctuation">.</span>graphic<span class="token punctuation">.</span><span class="token function">LinearGradient</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
              <span class="token punctuation">{</span> offset<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> color<span class="token operator">:</span> <span class="token string">&#39;#2378f7&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token punctuation">{</span> offset<span class="token operator">:</span> <span class="token number">0.7</span><span class="token punctuation">,</span> color<span class="token operator">:</span> <span class="token string">&#39;#2378f7&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token punctuation">{</span> offset<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> color<span class="token operator">:</span> <span class="token string">&#39;#83bff6&#39;</span> <span class="token punctuation">}</span>
            <span class="token punctuation">]</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style lang<span class="token operator">=</span><span class="token string">&quot;less&quot;</span> scoped<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="父组件将接口数据映射-echart-需要的数据进行传递使用" tabindex="-1"><a class="header-anchor" href="#父组件将接口数据映射-echart-需要的数据进行传递使用" aria-hidden="true">#</a> 父组件将接口数据映射 Echart 需要的数据进行传递使用</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// dashboard.vue</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;dashboard&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>顶部卡片组件 <span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>el<span class="token operator">-</span>row <span class="token operator">:</span>gutter<span class="token operator">=</span><span class="token string">&quot;10&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>template v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;item in amountList&quot;</span> <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">&quot;item.amount&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>col <span class="token operator">:</span>span<span class="token operator">=</span><span class="token string">&quot;6&quot;</span> <span class="token operator">:</span>xs<span class="token operator">=</span><span class="token string">&quot;24&quot;</span> <span class="token operator">:</span>sm<span class="token operator">=</span><span class="token string">&quot;12&quot;</span> <span class="token operator">:</span>md<span class="token operator">=</span><span class="token string">&quot;8&quot;</span> <span class="token operator">:</span>lg<span class="token operator">=</span><span class="token string">&quot;6&quot;</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>count<span class="token operator">-</span>card v<span class="token operator">-</span>bind<span class="token operator">=</span><span class="token string">&quot;item&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>col<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>row<span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span>el<span class="token operator">-</span>row <span class="token operator">:</span>gutter<span class="token operator">=</span><span class="token string">&quot;10&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>el<span class="token operator">-</span>col <span class="token operator">:</span>span<span class="token operator">=</span><span class="token string">&quot;7&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>chart<span class="token operator">-</span>card<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>pie<span class="token operator">-</span>echart <span class="token operator">:</span>pie<span class="token operator">-</span>data<span class="token operator">=</span><span class="token string">&quot;showGoodsCategoryCount&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>chart<span class="token operator">-</span>card<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>col<span class="token operator">&gt;</span>

      <span class="token operator">&lt;</span>el<span class="token operator">-</span>col <span class="token operator">:</span>span<span class="token operator">=</span><span class="token string">&quot;10&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>chart<span class="token operator">-</span>card<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>line<span class="token operator">-</span>echart<span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>chart<span class="token operator">-</span>card<span class="token operator">&gt;</span>

      <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>col<span class="token operator">&gt;</span>

      <span class="token operator">&lt;</span>el<span class="token operator">-</span>col <span class="token operator">:</span>span<span class="token operator">=</span><span class="token string">&quot;7&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>chart<span class="token operator">-</span>card<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>rose<span class="token operator">-</span>echart <span class="token operator">:</span>rose<span class="token operator">-</span>data<span class="token operator">=</span><span class="token string">&quot;showGoodsCategoryCount&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>chart<span class="token operator">-</span>card<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>col<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>row<span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span>el<span class="token operator">-</span>row <span class="token operator">:</span>gutter<span class="token operator">=</span><span class="token string">&quot;10&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>el<span class="token operator">-</span>col <span class="token operator">:</span>span<span class="token operator">=</span><span class="token string">&quot;12&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>chart<span class="token operator">-</span>card<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>line<span class="token operator">-</span>echart <span class="token operator">:</span>labels<span class="token operator">=</span><span class="token string">&quot;showGoodsCategorySale.labels&quot;</span> <span class="token operator">:</span>values<span class="token operator">=</span><span class="token string">&quot;showGoodsCategorySale.values&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>chart<span class="token operator">-</span>card<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>col<span class="token operator">&gt;</span>

      <span class="token operator">&lt;</span>el<span class="token operator">-</span>col <span class="token operator">:</span>span<span class="token operator">=</span><span class="token string">&quot;12&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>chart<span class="token operator">-</span>card<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>bar<span class="token operator">-</span>echart v<span class="token operator">-</span>bind<span class="token operator">=</span><span class="token string">&quot;showGoodsCategoryFavor&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>chart<span class="token operator">-</span>card<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>col<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>row<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> storeToRefs <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;pinia&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> computed <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> countCard <span class="token keyword">from</span> <span class="token string">&quot;./cpns/count-card/count-card.vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> chartCard <span class="token keyword">from</span> <span class="token string">&quot;./cpns/chart-card/chart-card.vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> useAnalysisStore <span class="token keyword">from</span> <span class="token string">&#39;@/store/main/analysis/analysis&#39;</span>

<span class="token comment">// 发起actions封装的网络请求</span>
<span class="token keyword">const</span> analysisStore <span class="token operator">=</span> <span class="token function">useAnalysisStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
analysisStore<span class="token punctuation">.</span><span class="token function">fetchAnalysisDataAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 获取数据</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> amountList<span class="token punctuation">,</span> goodsCategoryCount<span class="token punctuation">,</span> goodsCategorySale<span class="token punctuation">,</span> goodsCategoryFavor <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">storeToRefs</span><span class="token punctuation">(</span>analysisStore<span class="token punctuation">)</span>

<span class="token comment">// 获取echart饼图、玫瑰图数据(将接口数据映射成name, value)</span>
<span class="token keyword">const</span> showGoodsCategoryCount <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> goodsCategoryCount<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    name<span class="token operator">:</span> item<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
    value<span class="token operator">:</span> item<span class="token punctuation">.</span>goodsCount
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 获取echart折线图数据(将接口数据映射成labels、values)</span>
<span class="token keyword">const</span> showGoodsCategorySale <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> labels <span class="token operator">=</span> goodsCategorySale<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
  <span class="token keyword">const</span> values <span class="token operator">=</span> goodsCategorySale<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>goodsSale<span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span> labels<span class="token punctuation">,</span> values <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 获取echart柱状图数据</span>
<span class="token keyword">const</span> showGoodsCategoryFavor <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> labels <span class="token operator">=</span> goodsCategoryFavor<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
  <span class="token keyword">const</span> values <span class="token operator">=</span> goodsCategoryFavor<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>goodsFavor<span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span> labels<span class="token punctuation">,</span> values <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style lang<span class="token operator">=</span><span class="token string">&quot;less&quot;</span> scoped<span class="token operator">&gt;</span>
<span class="token punctuation">.</span>el<span class="token operator">-</span>row <span class="token punctuation">{</span>
  margin<span class="token operator">-</span>bottom<span class="token operator">:</span> 15px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="实现-echart-地图数据展示" tabindex="-1"><a class="header-anchor" href="#实现-echart-地图数据展示" aria-hidden="true">#</a> 实现 echart 地图数据展示</h3><h4 id="引入地图位置经纬度-json-数据" tabindex="-1"><a class="header-anchor" href="#引入地图位置经纬度-json-数据" aria-hidden="true">#</a> 引入地图位置经纬度 json 数据</h4><p><a href="https://datav.aliyun.com/portal/school/atlas/area_selector#&amp;lat=31.769817845138945&amp;lng=104.29901249999999&amp;zoom=4" target="_blank" rel="noopener noreferrer">阿里云地图 JSON API<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>：<a href="https://geo.datav.aliyun.com/areas_v3/bound/100000_full.json" target="_blank" rel="noopener noreferrer">https://geo.datav.aliyun.com/areas_v3/bound/100000_full.json<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h4 id="封装坐标信息" tabindex="-1"><a class="header-anchor" href="#封装坐标信息" aria-hidden="true">#</a> 封装坐标信息</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// utils/coordinate-data.ts</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> coordinateData<span class="token operator">:</span> <span class="token builtin">any</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  上海<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">121.487899486</span><span class="token punctuation">,</span> <span class="token number">31.24916171</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  临沧<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">100.092612914</span><span class="token punctuation">,</span> <span class="token number">23.8878061038</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  丽江<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">100.229628399</span><span class="token punctuation">,</span> <span class="token number">26.8753510895</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  保山<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">99.1779956133</span><span class="token punctuation">,</span> <span class="token number">25.1204891962</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  大理白族自治州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">100.223674789</span><span class="token punctuation">,</span> <span class="token number">25.5968996394</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  德宏傣族景颇族自治州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">98.5894342874</span><span class="token punctuation">,</span> <span class="token number">24.441239663</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  怒江傈僳族自治州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">98.8599320425</span><span class="token punctuation">,</span> <span class="token number">25.8606769782</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  文山壮族苗族自治州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">104.246294318</span><span class="token punctuation">,</span> <span class="token number">23.3740868504</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  昆明<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">102.714601139</span><span class="token punctuation">,</span> <span class="token number">25.0491531005</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  昭通<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">103.725020656</span><span class="token punctuation">,</span> <span class="token number">27.3406329636</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  普洱<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">100.98005773</span><span class="token punctuation">,</span> <span class="token number">22.7887777801</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  曲靖<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">103.782538888</span><span class="token punctuation">,</span> <span class="token number">25.5207581429</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  楚雄彝族自治州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">101.529382239</span><span class="token punctuation">,</span> <span class="token number">25.0663556742</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  玉溪<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">102.545067892</span><span class="token punctuation">,</span> <span class="token number">24.3704471344</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  红河哈尼族彝族自治州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">103.384064757</span><span class="token punctuation">,</span> <span class="token number">23.3677175165</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  西双版纳傣族自治州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">100.803038275</span><span class="token punctuation">,</span> <span class="token number">22.0094330022</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  迪庆藏族自治州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">99.7136815989</span><span class="token punctuation">,</span> <span class="token number">27.8310294612</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  乌兰察布<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">113.112846391</span><span class="token punctuation">,</span> <span class="token number">41.0223629468</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  乌海<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">106.831999097</span><span class="token punctuation">,</span> <span class="token number">39.6831770068</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  兴安盟<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">122.048166514</span><span class="token punctuation">,</span> <span class="token number">46.0837570652</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  包头<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">109.846238532</span><span class="token punctuation">,</span> <span class="token number">40.6471194257</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  呼伦贝尔<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">119.760821794</span><span class="token punctuation">,</span> <span class="token number">49.2016360546</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  呼和浩特<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">111.66035052</span><span class="token punctuation">,</span> <span class="token number">40.8283188731</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  巴彦淖尔<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">107.42380672</span><span class="token punctuation">,</span> <span class="token number">40.7691799024</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  赤峰<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">118.930761192</span><span class="token punctuation">,</span> <span class="token number">42.2971123203</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  通辽<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">122.260363263</span><span class="token punctuation">,</span> <span class="token number">43.633756073</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  鄂尔多斯<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">109.993706251</span><span class="token punctuation">,</span> <span class="token number">39.8164895606</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  锡林郭勒盟<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">116.027339689</span><span class="token punctuation">,</span> <span class="token number">43.9397048423</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  阿拉善盟<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">105.695682871</span><span class="token punctuation">,</span> <span class="token number">38.8430752644</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  北京<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">116.395645038</span><span class="token punctuation">,</span> <span class="token number">39.9299857781</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  台中<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">119.337634104</span><span class="token punctuation">,</span> <span class="token number">26.0911937119</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  台北<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">114.130474436</span><span class="token punctuation">,</span> <span class="token number">22.3748329286</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  台南<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">121.360525873</span><span class="token punctuation">,</span> <span class="token number">38.9658447898</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  嘉义<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">114.246701335</span><span class="token punctuation">,</span> <span class="token number">22.7288657203</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  高雄<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">111.590952812</span><span class="token punctuation">,</span> <span class="token number">21.9464822541</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  吉林<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">126.564543989</span><span class="token punctuation">,</span> <span class="token number">43.8719883344</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  四平<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">124.391382074</span><span class="token punctuation">,</span> <span class="token number">43.1755247011</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  延边朝鲜族自治州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">129.485901958</span><span class="token punctuation">,</span> <span class="token number">42.8964136037</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  松原<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">124.832994532</span><span class="token punctuation">,</span> <span class="token number">45.1360489701</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  白城<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">122.840776679</span><span class="token punctuation">,</span> <span class="token number">45.6210862752</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  白山<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">126.435797675</span><span class="token punctuation">,</span> <span class="token number">41.945859397</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  辽源<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">125.133686052</span><span class="token punctuation">,</span> <span class="token number">42.9233026191</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  通化<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">125.942650139</span><span class="token punctuation">,</span> <span class="token number">41.7363971299</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  长春<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">125.313642427</span><span class="token punctuation">,</span> <span class="token number">43.8983376071</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  乐山<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">103.760824239</span><span class="token punctuation">,</span> <span class="token number">29.6009576111</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  内江<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">105.073055992</span><span class="token punctuation">,</span> <span class="token number">29.5994615348</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  凉山彝族自治州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">102.259590803</span><span class="token punctuation">,</span> <span class="token number">27.8923929037</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  南充<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">106.105553984</span><span class="token punctuation">,</span> <span class="token number">30.8009651682</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  宜宾<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">104.633019062</span><span class="token punctuation">,</span> <span class="token number">28.7696747963</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  巴中<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">106.757915842</span><span class="token punctuation">,</span> <span class="token number">31.8691891592</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  广元<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">105.81968694</span><span class="token punctuation">,</span> <span class="token number">32.4410401584</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  广安<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">106.635720331</span><span class="token punctuation">,</span> <span class="token number">30.4639838879</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  德阳<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">104.402397818</span><span class="token punctuation">,</span> <span class="token number">31.1311396527</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  成都<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">104.067923463</span><span class="token punctuation">,</span> <span class="token number">30.6799428454</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  攀枝花<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">101.722423152</span><span class="token punctuation">,</span> <span class="token number">26.5875712571</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  泸州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">105.443970289</span><span class="token punctuation">,</span> <span class="token number">28.8959298039</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  甘孜藏族自治州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">101.969232063</span><span class="token punctuation">,</span> <span class="token number">30.0551441144</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  眉山<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">103.841429563</span><span class="token punctuation">,</span> <span class="token number">30.0611150799</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  绵阳<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">104.705518975</span><span class="token punctuation">,</span> <span class="token number">31.5047012581</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  自贡<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">104.776071339</span><span class="token punctuation">,</span> <span class="token number">29.3591568895</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  资阳<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">104.635930302</span><span class="token punctuation">,</span> <span class="token number">30.132191434</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  达州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">107.494973447</span><span class="token punctuation">,</span> <span class="token number">31.2141988589</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  遂宁<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">105.564887792</span><span class="token punctuation">,</span> <span class="token number">30.5574913504</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  阿坝藏族羌族自治州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">102.228564689</span><span class="token punctuation">,</span> <span class="token number">31.9057628583</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  雅安<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">103.009356466</span><span class="token punctuation">,</span> <span class="token number">29.9997163371</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  天津<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">117.210813092</span><span class="token punctuation">,</span> <span class="token number">39.1439299033</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  中卫<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">105.196754199</span><span class="token punctuation">,</span> <span class="token number">37.5211241916</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  吴忠<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">106.208254199</span><span class="token punctuation">,</span> <span class="token number">37.9935610029</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  固原<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">106.285267996</span><span class="token punctuation">,</span> <span class="token number">36.0215234807</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  石嘴山<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">106.379337202</span><span class="token punctuation">,</span> <span class="token number">39.0202232836</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  银川<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">106.206478608</span><span class="token punctuation">,</span> <span class="token number">38.5026210119</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  亳州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">115.787928245</span><span class="token punctuation">,</span> <span class="token number">33.8712105653</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  六安<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">116.505252683</span><span class="token punctuation">,</span> <span class="token number">31.7555583552</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  合肥<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">117.282699092</span><span class="token punctuation">,</span> <span class="token number">31.8669422607</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  安庆<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">117.058738772</span><span class="token punctuation">,</span> <span class="token number">30.5378978174</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  宣城<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">118.752096311</span><span class="token punctuation">,</span> <span class="token number">30.9516423543</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  宿州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">116.988692412</span><span class="token punctuation">,</span> <span class="token number">33.6367723858</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  池州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">117.494476772</span><span class="token punctuation">,</span> <span class="token number">30.6600192482</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  淮北<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">116.791447429</span><span class="token punctuation">,</span> <span class="token number">33.9600233054</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  淮南<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">117.018638863</span><span class="token punctuation">,</span> <span class="token number">32.6428118237</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  滁州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">118.324570351</span><span class="token punctuation">,</span> <span class="token number">32.3173505954</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  芜湖<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">118.384108423</span><span class="token punctuation">,</span> <span class="token number">31.3660197875</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  蚌埠<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">117.357079866</span><span class="token punctuation">,</span> <span class="token number">32.9294989067</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  铜陵<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">117.819428729</span><span class="token punctuation">,</span> <span class="token number">30.9409296947</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  阜阳<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">115.820932259</span><span class="token punctuation">,</span> <span class="token number">32.9012113306</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  马鞍山<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">118.515881847</span><span class="token punctuation">,</span> <span class="token number">31.6885281589</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  黄山<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">118.293569632</span><span class="token punctuation">,</span> <span class="token number">29.7344348562</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  东营<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">118.583926333</span><span class="token punctuation">,</span> <span class="token number">37.4871211553</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  临沂<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">118.340768237</span><span class="token punctuation">,</span> <span class="token number">35.0724090744</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  威海<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">122.093958366</span><span class="token punctuation">,</span> <span class="token number">37.5287870813</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  德州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">116.328161364</span><span class="token punctuation">,</span> <span class="token number">37.4608259263</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  日照<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">119.507179943</span><span class="token punctuation">,</span> <span class="token number">35.4202251931</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  枣庄<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">117.279305383</span><span class="token punctuation">,</span> <span class="token number">34.8078830784</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  泰安<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">117.089414917</span><span class="token punctuation">,</span> <span class="token number">36.1880777589</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  济南<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">117.024967066</span><span class="token punctuation">,</span> <span class="token number">36.6827847272</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  济宁<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">116.600797625</span><span class="token punctuation">,</span> <span class="token number">35.4021216643</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  淄博<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">118.059134278</span><span class="token punctuation">,</span> <span class="token number">36.8046848542</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  滨州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">117.968292415</span><span class="token punctuation">,</span> <span class="token number">37.4053139418</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  潍坊<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">119.142633823</span><span class="token punctuation">,</span> <span class="token number">36.7161148731</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  烟台<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">121.30955503</span><span class="token punctuation">,</span> <span class="token number">37.5365615629</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  聊城<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">115.986869139</span><span class="token punctuation">,</span> <span class="token number">36.4558285147</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  莱芜<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">117.684666912</span><span class="token punctuation">,</span> <span class="token number">36.2336541336</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  菏泽<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">115.463359775</span><span class="token punctuation">,</span> <span class="token number">35.2624404961</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  青岛<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">120.384428184</span><span class="token punctuation">,</span> <span class="token number">36.1052149013</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  临汾<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">111.538787596</span><span class="token punctuation">,</span> <span class="token number">36.0997454436</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  吕梁<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">111.143156602</span><span class="token punctuation">,</span> <span class="token number">37.527316097</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  大同<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">113.290508673</span><span class="token punctuation">,</span> <span class="token number">40.1137444997</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  太原<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">112.550863589</span><span class="token punctuation">,</span> <span class="token number">37.890277054</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  忻州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">112.727938829</span><span class="token punctuation">,</span> <span class="token number">38.461030573</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  晋中<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">112.7385144</span><span class="token punctuation">,</span> <span class="token number">37.6933615268</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  晋城<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">112.867332758</span><span class="token punctuation">,</span> <span class="token number">35.4998344672</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  朔州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">112.479927727</span><span class="token punctuation">,</span> <span class="token number">39.3376719662</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  运城<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">111.006853653</span><span class="token punctuation">,</span> <span class="token number">35.0388594798</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  长治<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">113.120292086</span><span class="token punctuation">,</span> <span class="token number">36.2016643857</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  阳泉<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">113.569237602</span><span class="token punctuation">,</span> <span class="token number">37.8695294932</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  东莞<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">113.763433991</span><span class="token punctuation">,</span> <span class="token number">23.0430238154</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  中山<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">113.422060021</span><span class="token punctuation">,</span> <span class="token number">22.5451775145</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  云浮<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">112.050945959</span><span class="token punctuation">,</span> <span class="token number">22.9379756855</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  佛山<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">113.134025635</span><span class="token punctuation">,</span> <span class="token number">23.0350948405</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  广州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">113.307649675</span><span class="token punctuation">,</span> <span class="token number">23.1200491021</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  惠州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">114.41065808</span><span class="token punctuation">,</span> <span class="token number">23.1135398524</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  揭阳<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">116.379500855</span><span class="token punctuation">,</span> <span class="token number">23.5479994669</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  梅州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">116.126403098</span><span class="token punctuation">,</span> <span class="token number">24.304570606</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  汕头<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">116.728650288</span><span class="token punctuation">,</span> <span class="token number">23.3839084533</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  汕尾<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">115.372924289</span><span class="token punctuation">,</span> <span class="token number">22.7787305002</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  江门<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">113.078125341</span><span class="token punctuation">,</span> <span class="token number">22.5751167835</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  河源<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">114.713721476</span><span class="token punctuation">,</span> <span class="token number">23.7572508505</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  深圳<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">114.025973657</span><span class="token punctuation">,</span> <span class="token number">22.5460535462</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  清远<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">113.040773349</span><span class="token punctuation">,</span> <span class="token number">23.6984685504</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  湛江<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">110.365067263</span><span class="token punctuation">,</span> <span class="token number">21.2574631038</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  潮州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">116.630075991</span><span class="token punctuation">,</span> <span class="token number">23.6618116765</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  珠海<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">113.562447026</span><span class="token punctuation">,</span> <span class="token number">22.2569146461</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  肇庆<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">112.47965337</span><span class="token punctuation">,</span> <span class="token number">23.0786632829</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  茂名<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">110.931245331</span><span class="token punctuation">,</span> <span class="token number">21.6682257188</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  阳江<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">111.977009756</span><span class="token punctuation">,</span> <span class="token number">21.8715173045</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  韶关<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">113.594461107</span><span class="token punctuation">,</span> <span class="token number">24.8029603119</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  北海<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">109.122627919</span><span class="token punctuation">,</span> <span class="token number">21.472718235</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  南宁<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">108.297233556</span><span class="token punctuation">,</span> <span class="token number">22.8064929356</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  崇左<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">107.357322038</span><span class="token punctuation">,</span> <span class="token number">22.4154552965</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  来宾<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">109.231816505</span><span class="token punctuation">,</span> <span class="token number">23.7411659265</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  柳州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">109.42240181</span><span class="token punctuation">,</span> <span class="token number">24.3290533525</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  桂林<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">110.260920147</span><span class="token punctuation">,</span> <span class="token number">25.262901246</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  梧州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">111.30547195</span><span class="token punctuation">,</span> <span class="token number">23.4853946367</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  河池<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">108.069947709</span><span class="token punctuation">,</span> <span class="token number">24.6995207829</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  玉林<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">110.151676316</span><span class="token punctuation">,</span> <span class="token number">22.6439736084</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  百色<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">106.631821404</span><span class="token punctuation">,</span> <span class="token number">23.9015123679</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  贵港<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">109.613707557</span><span class="token punctuation">,</span> <span class="token number">23.1033731644</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  贺州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">111.552594179</span><span class="token punctuation">,</span> <span class="token number">24.4110535471</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  钦州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">108.638798056</span><span class="token punctuation">,</span> <span class="token number">21.9733504653</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  防城港<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">108.351791153</span><span class="token punctuation">,</span> <span class="token number">21.6173984705</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  乌鲁木齐<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">87.5649877411</span><span class="token punctuation">,</span> <span class="token number">43.8403803472</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  伊犁哈萨克自治州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">81.2978535304</span><span class="token punctuation">,</span> <span class="token number">43.9222480963</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  克孜勒苏柯尔克孜自治州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">76.1375644775</span><span class="token punctuation">,</span> <span class="token number">39.7503455778</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  克拉玛依<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">84.8811801861</span><span class="token punctuation">,</span> <span class="token number">45.5943310667</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  博尔塔拉蒙古自治州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">82.0524362672</span><span class="token punctuation">,</span> <span class="token number">44.9136513743</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  吐鲁番地区<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">89.1815948657</span><span class="token punctuation">,</span> <span class="token number">42.9604700169</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  和田地区<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">79.9302386372</span><span class="token punctuation">,</span> <span class="token number">37.1167744927</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  哈密地区<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">93.5283550928</span><span class="token punctuation">,</span> <span class="token number">42.8585963324</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  喀什地区<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">75.9929732675</span><span class="token punctuation">,</span> <span class="token number">39.4706271887</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  塔城地区<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">82.9748805837</span><span class="token punctuation">,</span> <span class="token number">46.7586836297</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  昌吉回族自治州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">87.2960381257</span><span class="token punctuation">,</span> <span class="token number">44.0070578985</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  自治区直辖<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">85.6148993383</span><span class="token punctuation">,</span> <span class="token number">42.1270009576</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  阿克苏地区<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">80.2698461793</span><span class="token punctuation">,</span> <span class="token number">41.1717309015</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  阿勒泰地区<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">88.1379154871</span><span class="token punctuation">,</span> <span class="token number">47.8397444862</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  南京<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">118.778074408</span><span class="token punctuation">,</span> <span class="token number">32.0572355018</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  南通<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">120.873800951</span><span class="token punctuation">,</span> <span class="token number">32.0146645408</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  宿迁<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">118.296893379</span><span class="token punctuation">,</span> <span class="token number">33.9520497337</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  常州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">119.981861013</span><span class="token punctuation">,</span> <span class="token number">31.7713967447</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  徐州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">117.188106623</span><span class="token punctuation">,</span> <span class="token number">34.2715534311</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  扬州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">119.427777551</span><span class="token punctuation">,</span> <span class="token number">32.4085052546</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  无锡<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">120.305455901</span><span class="token punctuation">,</span> <span class="token number">31.5700374519</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  泰州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">119.919606016</span><span class="token punctuation">,</span> <span class="token number">32.4760532748</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  淮安<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">119.030186365</span><span class="token punctuation">,</span> <span class="token number">33.6065127393</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  盐城<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">120.148871818</span><span class="token punctuation">,</span> <span class="token number">33.3798618771</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  苏州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">120.619907115</span><span class="token punctuation">,</span> <span class="token number">31.317987368</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  连云港<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">119.173872217</span><span class="token punctuation">,</span> <span class="token number">34.601548967</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  镇江<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">119.455835405</span><span class="token punctuation">,</span> <span class="token number">32.2044094436</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  上饶<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">117.955463877</span><span class="token punctuation">,</span> <span class="token number">28.4576225539</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  九江<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">115.999848022</span><span class="token punctuation">,</span> <span class="token number">29.7196395261</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  南昌<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">115.893527546</span><span class="token punctuation">,</span> <span class="token number">28.6895780001</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  吉安<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">114.992038711</span><span class="token punctuation">,</span> <span class="token number">27.1138476502</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  宜春<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">114.400038672</span><span class="token punctuation">,</span> <span class="token number">27.8111298958</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  抚州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">116.360918867</span><span class="token punctuation">,</span> <span class="token number">27.9545451703</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  新余<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">114.947117417</span><span class="token punctuation">,</span> <span class="token number">27.8223215586</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  景德镇<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">117.186522625</span><span class="token punctuation">,</span> <span class="token number">29.3035627684</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  萍乡<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">113.859917033</span><span class="token punctuation">,</span> <span class="token number">27.639544223</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  赣州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">114.935909079</span><span class="token punctuation">,</span> <span class="token number">25.8452955363</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  鹰潭<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">117.035450186</span><span class="token punctuation">,</span> <span class="token number">28.2413095972</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  保定<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">115.494810169</span><span class="token punctuation">,</span> <span class="token number">38.886564548</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  唐山<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">118.183450598</span><span class="token punctuation">,</span> <span class="token number">39.6505309225</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  廊坊<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">116.703602223</span><span class="token punctuation">,</span> <span class="token number">39.5186106251</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  张家口<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">114.89378153</span><span class="token punctuation">,</span> <span class="token number">40.8111884911</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  承德<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">117.933822456</span><span class="token punctuation">,</span> <span class="token number">40.9925210525</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  沧州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">116.863806476</span><span class="token punctuation">,</span> <span class="token number">38.2976153503</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  石家庄<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">114.522081844</span><span class="token punctuation">,</span> <span class="token number">38.0489583146</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  秦皇岛<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">119.604367616</span><span class="token punctuation">,</span> <span class="token number">39.9454615659</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  衡水<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">115.686228653</span><span class="token punctuation">,</span> <span class="token number">37.7469290459</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  邢台<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">114.520486813</span><span class="token punctuation">,</span> <span class="token number">37.0695311969</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  邯郸<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">114.482693932</span><span class="token punctuation">,</span> <span class="token number">36.6093079285</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  三门峡<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">111.181262093</span><span class="token punctuation">,</span> <span class="token number">34.7833199411</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  信阳<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">114.085490993</span><span class="token punctuation">,</span> <span class="token number">32.1285823075</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  南阳<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">112.542841901</span><span class="token punctuation">,</span> <span class="token number">33.0114195691</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  周口<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">114.654101942</span><span class="token punctuation">,</span> <span class="token number">33.6237408181</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  商丘<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">115.641885688</span><span class="token punctuation">,</span> <span class="token number">34.4385886402</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  安阳<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">114.351806508</span><span class="token punctuation">,</span> <span class="token number">36.1102667222</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  平顶山<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">113.300848978</span><span class="token punctuation">,</span> <span class="token number">33.7453014565</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  开封<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">114.351642118</span><span class="token punctuation">,</span> <span class="token number">34.8018541758</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  新乡<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">113.912690161</span><span class="token punctuation">,</span> <span class="token number">35.3072575577</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  洛阳<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">112.447524769</span><span class="token punctuation">,</span> <span class="token number">34.6573678177</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  漯河<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">114.0460614</span><span class="token punctuation">,</span> <span class="token number">33.5762786885</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  濮阳<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">115.026627441</span><span class="token punctuation">,</span> <span class="token number">35.7532978882</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  焦作<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">113.211835885</span><span class="token punctuation">,</span> <span class="token number">35.234607555</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  许昌<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">113.83531246</span><span class="token punctuation">,</span> <span class="token number">34.0267395887</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  郑州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">113.64964385</span><span class="token punctuation">,</span> <span class="token number">34.7566100641</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  驻马店<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">114.049153547</span><span class="token punctuation">,</span> <span class="token number">32.9831581541</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  鹤壁<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">114.297769838</span><span class="token punctuation">,</span> <span class="token number">35.7554258742</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  丽水<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">119.929575843</span><span class="token punctuation">,</span> <span class="token number">28.4562995521</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  台州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">121.440612936</span><span class="token punctuation">,</span> <span class="token number">28.6682832857</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  嘉兴<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">120.760427699</span><span class="token punctuation">,</span> <span class="token number">30.7739922396</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  宁波<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">121.579005973</span><span class="token punctuation">,</span> <span class="token number">29.8852589659</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  杭州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">120.219375416</span><span class="token punctuation">,</span> <span class="token number">30.2592444615</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  温州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">120.690634734</span><span class="token punctuation">,</span> <span class="token number">28.002837594</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  湖州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">120.137243163</span><span class="token punctuation">,</span> <span class="token number">30.8779251557</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  绍兴<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">120.592467386</span><span class="token punctuation">,</span> <span class="token number">30.0023645805</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  舟山<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">122.169872098</span><span class="token punctuation">,</span> <span class="token number">30.0360103026</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  衢州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">118.875841652</span><span class="token punctuation">,</span> <span class="token number">28.9569104475</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  金华<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">119.652575704</span><span class="token punctuation">,</span> <span class="token number">29.1028991054</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  三亚<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">109.522771281</span><span class="token punctuation">,</span> <span class="token number">18.2577759149</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  三沙<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">112.350383075</span><span class="token punctuation">,</span> <span class="token number">16.840062894</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  海口<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">110.330801848</span><span class="token punctuation">,</span> <span class="token number">20.022071277</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  十堰<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">110.801228917</span><span class="token punctuation">,</span> <span class="token number">32.6369943395</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  咸宁<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">114.300060592</span><span class="token punctuation">,</span> <span class="token number">29.8806567577</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  孝感<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">113.935734392</span><span class="token punctuation">,</span> <span class="token number">30.9279547842</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  宜昌<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">111.310981092</span><span class="token punctuation">,</span> <span class="token number">30.732757818</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  恩施土家族苗族自治州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">109.491923304</span><span class="token punctuation">,</span> <span class="token number">30.2858883166</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  武汉<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">114.316200103</span><span class="token punctuation">,</span> <span class="token number">30.5810841269</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  省直辖<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">112.410562192</span><span class="token punctuation">,</span> <span class="token number">31.2093162501</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  荆州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">112.241865807</span><span class="token punctuation">,</span> <span class="token number">30.332590523</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  荆门<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">112.217330299</span><span class="token punctuation">,</span> <span class="token number">31.0426112029</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  襄阳<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">112.250092848</span><span class="token punctuation">,</span> <span class="token number">32.2291685915</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  鄂州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">114.895594041</span><span class="token punctuation">,</span> <span class="token number">30.3844393228</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  随州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">113.379358364</span><span class="token punctuation">,</span> <span class="token number">31.7178576082</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  黄冈<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">114.906618047</span><span class="token punctuation">,</span> <span class="token number">30.4461089379</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  黄石<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">115.050683164</span><span class="token punctuation">,</span> <span class="token number">30.2161271277</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  娄底<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">111.996396357</span><span class="token punctuation">,</span> <span class="token number">27.7410733023</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  岳阳<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">113.146195519</span><span class="token punctuation">,</span> <span class="token number">29.3780070755</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  常德<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">111.653718137</span><span class="token punctuation">,</span> <span class="token number">29.0121488552</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  张家界<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">110.481620157</span><span class="token punctuation">,</span> <span class="token number">29.1248893532</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  怀化<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">109.986958796</span><span class="token punctuation">,</span> <span class="token number">27.5574829012</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  株洲<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">113.131695341</span><span class="token punctuation">,</span> <span class="token number">27.8274329277</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  永州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">111.614647686</span><span class="token punctuation">,</span> <span class="token number">26.4359716468</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  湘潭<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">112.935555633</span><span class="token punctuation">,</span> <span class="token number">27.835095053</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  湘西土家族苗族自治州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">109.7457458</span><span class="token punctuation">,</span> <span class="token number">28.3179507937</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  益阳<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">112.366546645</span><span class="token punctuation">,</span> <span class="token number">28.5880877799</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  衡阳<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">112.583818811</span><span class="token punctuation">,</span> <span class="token number">26.8981644154</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  邵阳<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">111.461525404</span><span class="token punctuation">,</span> <span class="token number">27.2368112449</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  郴州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">113.037704468</span><span class="token punctuation">,</span> <span class="token number">25.7822639757</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  长沙<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">112.979352788</span><span class="token punctuation">,</span> <span class="token number">28.2134782309</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  无堂区划分区域<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">113.557519102</span><span class="token punctuation">,</span> <span class="token number">22.2041179884</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  澳门半岛<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">113.566432335</span><span class="token punctuation">,</span> <span class="token number">22.1950041592</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  澳门离岛<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">113.557519102</span><span class="token punctuation">,</span> <span class="token number">22.2041179884</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  临夏回族自治州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">103.215249178</span><span class="token punctuation">,</span> <span class="token number">35.5985143488</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  兰州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">103.823305441</span><span class="token punctuation">,</span> <span class="token number">36.064225525</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  嘉峪关<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">98.2816345853</span><span class="token punctuation">,</span> <span class="token number">39.8023973267</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  天水<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">105.736931623</span><span class="token punctuation">,</span> <span class="token number">34.5843194189</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  定西<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">104.626637601</span><span class="token punctuation">,</span> <span class="token number">35.5860562418</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  平凉<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">106.688911157</span><span class="token punctuation">,</span> <span class="token number">35.55011019</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  庆阳<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">107.644227087</span><span class="token punctuation">,</span> <span class="token number">35.7268007545</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  张掖<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">100.459891869</span><span class="token punctuation">,</span> <span class="token number">38.939320297</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  武威<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">102.640147343</span><span class="token punctuation">,</span> <span class="token number">37.9331721429</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  甘南藏族自治州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">102.917442486</span><span class="token punctuation">,</span> <span class="token number">34.9922111784</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  白银<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">104.171240904</span><span class="token punctuation">,</span> <span class="token number">36.5466817062</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  酒泉<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">98.5084145062</span><span class="token punctuation">,</span> <span class="token number">39.7414737682</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  金昌<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">102.208126263</span><span class="token punctuation">,</span> <span class="token number">38.5160717995</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  陇南<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">104.934573406</span><span class="token punctuation">,</span> <span class="token number">33.3944799729</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  三明<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">117.642193934</span><span class="token punctuation">,</span> <span class="token number">26.2708352794</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  南平<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">118.181882949</span><span class="token punctuation">,</span> <span class="token number">26.6436264742</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  厦门<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">118.103886046</span><span class="token punctuation">,</span> <span class="token number">24.4892306125</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  宁德<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">119.54208215</span><span class="token punctuation">,</span> <span class="token number">26.6565274192</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  泉州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">118.600362343</span><span class="token punctuation">,</span> <span class="token number">24.901652384</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  漳州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">117.676204679</span><span class="token punctuation">,</span> <span class="token number">24.5170647798</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  福州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">119.330221107</span><span class="token punctuation">,</span> <span class="token number">26.0471254966</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  莆田<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">119.077730964</span><span class="token punctuation">,</span> <span class="token number">25.4484501367</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  龙岩<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">117.017996739</span><span class="token punctuation">,</span> <span class="token number">25.0786854335</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  山南地区<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">91.7506438744</span><span class="token punctuation">,</span> <span class="token number">29.2290269317</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  拉萨<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">91.111890896</span><span class="token punctuation">,</span> <span class="token number">29.6625570621</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  日喀则地区<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">88.8914855677</span><span class="token punctuation">,</span> <span class="token number">29.2690232039</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  昌都地区<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">97.18558158</span><span class="token punctuation">,</span> <span class="token number">31.1405756319</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  林芝地区<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">94.3499854582</span><span class="token punctuation">,</span> <span class="token number">29.6669406258</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  那曲地区<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">92.0670183689</span><span class="token punctuation">,</span> <span class="token number">31.4806798301</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  阿里地区<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">81.1076686895</span><span class="token punctuation">,</span> <span class="token number">30.4045565883</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  六盘水<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">104.85208676</span><span class="token punctuation">,</span> <span class="token number">26.5918660603</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  安顺<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">105.928269966</span><span class="token punctuation">,</span> <span class="token number">26.2285945777</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  毕节<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">105.333323371</span><span class="token punctuation">,</span> <span class="token number">27.4085621313</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  贵阳<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">106.709177096</span><span class="token punctuation">,</span> <span class="token number">26.6299067414</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  遵义<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">106.931260316</span><span class="token punctuation">,</span> <span class="token number">27.6999613771</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  铜仁<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">109.168558028</span><span class="token punctuation">,</span> <span class="token number">27.6749026906</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  黔东南苗族侗族自治州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">107.985352573</span><span class="token punctuation">,</span> <span class="token number">26.5839917665</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  黔南布依族苗族自治州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">107.52320511</span><span class="token punctuation">,</span> <span class="token number">26.2645359974</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  黔西南布依族苗族自治州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">104.900557798</span><span class="token punctuation">,</span> <span class="token number">25.0951480559</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  丹东<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">124.338543115</span><span class="token punctuation">,</span> <span class="token number">40.1290228266</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  大连<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">121.593477781</span><span class="token punctuation">,</span> <span class="token number">38.9487099383</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  抚顺<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">123.929819767</span><span class="token punctuation">,</span> <span class="token number">41.8773038296</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  朝阳<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">120.446162703</span><span class="token punctuation">,</span> <span class="token number">41.5718276679</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  本溪<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">123.77806237</span><span class="token punctuation">,</span> <span class="token number">41.3258376266</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  沈阳<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">123.432790922</span><span class="token punctuation">,</span> <span class="token number">41.8086447835</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  盘锦<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">122.07322781</span><span class="token punctuation">,</span> <span class="token number">41.141248023</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  营口<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">122.233391371</span><span class="token punctuation">,</span> <span class="token number">40.6686510665</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  葫芦岛<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">120.860757645</span><span class="token punctuation">,</span> <span class="token number">40.7430298813</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  辽阳<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">123.172451205</span><span class="token punctuation">,</span> <span class="token number">41.2733392656</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  铁岭<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">123.854849615</span><span class="token punctuation">,</span> <span class="token number">42.2997570121</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  锦州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">121.147748738</span><span class="token punctuation">,</span> <span class="token number">41.1308788759</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  阜新<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">121.660822129</span><span class="token punctuation">,</span> <span class="token number">42.0192501071</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  鞍山<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">123.007763329</span><span class="token punctuation">,</span> <span class="token number">41.1187436822</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  重庆<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">106.530635013</span><span class="token punctuation">,</span> <span class="token number">29.5446061089</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  咸阳<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">108.707509278</span><span class="token punctuation">,</span> <span class="token number">34.345372996</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  商洛<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">109.934208154</span><span class="token punctuation">,</span> <span class="token number">33.8739073951</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  安康<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">109.038044563</span><span class="token punctuation">,</span> <span class="token number">32.70437045</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  宝鸡<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">107.170645452</span><span class="token punctuation">,</span> <span class="token number">34.3640808097</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  延安<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">109.500509757</span><span class="token punctuation">,</span> <span class="token number">36.6033203523</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  榆林<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">109.745925744</span><span class="token punctuation">,</span> <span class="token number">38.2794392401</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  汉中<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">107.045477629</span><span class="token punctuation">,</span> <span class="token number">33.0815689782</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  渭南<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">109.483932697</span><span class="token punctuation">,</span> <span class="token number">34.5023579758</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  西安<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">108.953098279</span><span class="token punctuation">,</span> <span class="token number">34.2777998978</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  铜川<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">108.968067013</span><span class="token punctuation">,</span> <span class="token number">34.9083676964</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  果洛藏族自治州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">100.223722769</span><span class="token punctuation">,</span> <span class="token number">34.4804845846</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  海东地区<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">102.085206987</span><span class="token punctuation">,</span> <span class="token number">36.5176101677</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  海北藏族自治州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">100.879802174</span><span class="token punctuation">,</span> <span class="token number">36.9606541011</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  海南藏族自治州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">100.624066094</span><span class="token punctuation">,</span> <span class="token number">36.2843638038</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  海西蒙古族藏族自治州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">97.3426254153</span><span class="token punctuation">,</span> <span class="token number">37.3737990706</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  玉树藏族自治州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">97.0133161374</span><span class="token punctuation">,</span> <span class="token number">33.0062399097</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  西宁<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">101.76792099</span><span class="token punctuation">,</span> <span class="token number">36.640738612</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  黄南藏族自治州<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">102.007600308</span><span class="token punctuation">,</span> <span class="token number">35.5228515517</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  九龙<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">114.173291988</span><span class="token punctuation">,</span> <span class="token number">22.3072458588</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  新界<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">114.146701965</span><span class="token punctuation">,</span> <span class="token number">22.4274312754</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  香港岛<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">114.183870524</span><span class="token punctuation">,</span> <span class="token number">22.2721034276</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  七台河<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">131.019048047</span><span class="token punctuation">,</span> <span class="token number">45.7750053686</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  伊春<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">128.910765978</span><span class="token punctuation">,</span> <span class="token number">47.7346850751</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  佳木斯<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">130.284734586</span><span class="token punctuation">,</span> <span class="token number">46.8137796047</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  双鸭山<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">131.17140174</span><span class="token punctuation">,</span> <span class="token number">46.6551020625</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  哈尔滨<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">126.657716855</span><span class="token punctuation">,</span> <span class="token number">45.7732246332</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  大兴安岭地区<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">124.19610419</span><span class="token punctuation">,</span> <span class="token number">51.991788968</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  大庆<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">125.02183973</span><span class="token punctuation">,</span> <span class="token number">46.59670902</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  牡丹江<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">129.608035396</span><span class="token punctuation">,</span> <span class="token number">44.5885211528</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  绥化<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">126.989094572</span><span class="token punctuation">,</span> <span class="token number">46.646063927</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  鸡西<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">130.941767273</span><span class="token punctuation">,</span> <span class="token number">45.3215398866</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  鹤岗<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">130.292472051</span><span class="token punctuation">,</span> <span class="token number">47.3386659037</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  黑河<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">127.500830295</span><span class="token punctuation">,</span> <span class="token number">50.2506900907</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  齐齐哈尔<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">123.987288942</span><span class="token punctuation">,</span> <span class="token number">47.3476998134</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="封装转化坐标信息属性为-echart-地图所需属性工具" tabindex="-1"><a class="header-anchor" href="#封装转化坐标信息属性为-echart-地图所需属性工具" aria-hidden="true">#</a> 封装转化坐标信息属性为 echart 地图所需属性工具</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// utils/convert-data.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> coordinateData <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./coordinate-data&quot;</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">convertData</span><span class="token punctuation">(</span>data<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> data<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> geoCoord <span class="token operator">=</span> coordinateData<span class="token punctuation">[</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">]</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>geoCoord<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            res<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                name<span class="token operator">:</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span>
                value<span class="token operator">:</span> geoCoord<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> res
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="echart-注册地图" tabindex="-1"><a class="header-anchor" href="#echart-注册地图" aria-hidden="true">#</a> echart 注册地图</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// base-echart.vue</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;base-echart&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;echart&quot;</span> ref<span class="token operator">=</span><span class="token string">&quot;echartRef&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> echarts <span class="token keyword">from</span> <span class="token string">&#39;echarts&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> onMounted<span class="token punctuation">,</span> ref<span class="token punctuation">,</span> watchEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token comment">// 获取echart的option类型</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> EChartsOption <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;echarts&#39;</span>
<span class="token keyword">import</span> ChinaJSON <span class="token keyword">from</span> <span class="token string">&#39;../data/china.json&#39;</span>

<span class="token comment">// echart注册地图</span>
echarts<span class="token punctuation">.</span><span class="token function">registerMap</span><span class="token punctuation">(</span><span class="token string">&#39;china&#39;</span><span class="token punctuation">,</span> ChinaJSON <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">)</span>

<span class="token comment">// 接收每个echart不同配置</span>
<span class="token keyword">interface</span> <span class="token class-name">IProps</span> <span class="token punctuation">{</span>
    option<span class="token operator">:</span> EChartsOption
<span class="token punctuation">}</span>
<span class="token keyword">const</span> props <span class="token operator">=</span> <span class="token generic-function"><span class="token function">defineProps</span><span class="token generic class-name"><span class="token operator">&lt;</span>IProps<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 1. 引用dom实例</span>
<span class="token keyword">const</span> echartRef <span class="token operator">=</span> <span class="token generic-function"><span class="token function">ref</span><span class="token generic class-name"><span class="token operator">&lt;</span>HTMLElement<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 2. 基于准备好的dom，初始化echart实例</span>
  <span class="token keyword">const</span> echartInstance <span class="token operator">=</span> echarts<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>echartRef<span class="token punctuation">.</span>value<span class="token operator">!</span><span class="token punctuation">,</span> <span class="token string">&quot;light&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    renderer<span class="token operator">:</span> <span class="token string">&#39;canvas&#39;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token comment">// 3.第一次options(配置),动态传入每个图的option</span>
  <span class="token comment">// watchEffect监听option变化，重新执行</span>
  <span class="token function">watchEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> echartInstance<span class="token punctuation">.</span><span class="token function">setOption</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>option<span class="token punctuation">)</span><span class="token punctuation">)</span>

  <span class="token comment">// 4.监听window缩放实现echart响应式布局</span>
  window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;resize&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    echartInstance<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style lang<span class="token operator">=</span><span class="token string">&quot;less&quot;</span> scoped<span class="token operator">&gt;</span>
<span class="token punctuation">.</span>echart <span class="token punctuation">{</span>
  height<span class="token operator">:</span> 250px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="编写-echart-地图组件" tabindex="-1"><a class="header-anchor" href="#编写-echart-地图组件" aria-hidden="true">#</a> 编写 echart 地图组件</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// map-echart.vue</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;map-echart&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>base<span class="token operator">-</span>echart <span class="token operator">:</span>option<span class="token operator">=</span><span class="token string">&quot;option&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> computed <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token keyword">import</span> BaseEchart <span class="token keyword">from</span> <span class="token string">&#39;./base-echart.vue&#39;</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> EChartsOption <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;echarts&#39;</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> IEchartValueType <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;../types&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> convertData <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;../utils/convert-data&#39;</span>

<span class="token keyword">const</span> props <span class="token operator">=</span> <span class="token generic-function"><span class="token function">defineProps</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token punctuation">{</span>
    mapData<span class="token operator">:</span> IEchartValueType<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 只负责传入饼图的option</span>
<span class="token keyword">const</span> option <span class="token operator">=</span> <span class="token generic-function"><span class="token function">computed</span><span class="token generic class-name"><span class="token operator">&lt;</span>EChartsOption<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    width<span class="token operator">:</span> <span class="token string">&#39;270px&#39;</span><span class="token punctuation">,</span>
    height<span class="token operator">:</span> <span class="token string">&#39;250px&#39;</span><span class="token punctuation">,</span>
    center<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    backgroundColor<span class="token operator">:</span> <span class="token string">&#39;#fff&#39;</span><span class="token punctuation">,</span>
    title<span class="token operator">:</span> <span class="token punctuation">{</span>
        text<span class="token operator">:</span> <span class="token string">&#39;全国销量统计&#39;</span><span class="token punctuation">,</span>
        left<span class="token operator">:</span> <span class="token string">&#39;center&#39;</span><span class="token punctuation">,</span>
        textStyle<span class="token operator">:</span> <span class="token punctuation">{</span>
            color<span class="token operator">:</span> <span class="token string">&#39;#fff&#39;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    tooltip<span class="token operator">:</span> <span class="token punctuation">{</span>
        trigger<span class="token operator">:</span> <span class="token string">&#39;item&#39;</span><span class="token punctuation">,</span>
        <span class="token function-variable function">formatter</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>params<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> params<span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">&#39; : &#39;</span> <span class="token operator">+</span> params<span class="token punctuation">.</span>value<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    visualMap<span class="token operator">:</span> <span class="token punctuation">{</span>
        min<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        max<span class="token operator">:</span> <span class="token number">60000</span><span class="token punctuation">,</span>
        left<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
        bottom<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
        calculable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        text<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;高&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;低&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        inRange<span class="token operator">:</span> <span class="token punctuation">{</span>
            color<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;rgb(70, 240, 252)&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;rgb(250, 220, 46)&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;rgb(245, 38, 186)&#39;</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        textStyle<span class="token operator">:</span> <span class="token punctuation">{</span>
            color<span class="token operator">:</span> <span class="token string">&#39;#fff&#39;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    geo<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// 设置使用的地图(注册过的china地址)</span>
        map<span class="token operator">:</span> <span class="token string">&#39;china&#39;</span><span class="token punctuation">,</span>
        <span class="token comment">// 支持鼠标缩放效果</span>
        <span class="token comment">// roam: &#39;scale&#39;,</span>
        emphasis<span class="token operator">:</span> <span class="token punctuation">{</span>
            areaColor<span class="token operator">:</span> <span class="token string">&#39;#f4cccc&#39;</span><span class="token punctuation">,</span>
            borderColor<span class="token operator">:</span> <span class="token string">&#39;rgb(9, 54, 95)&#39;</span><span class="token punctuation">,</span>
            itemStyle<span class="token operator">:</span> <span class="token punctuation">{</span>
                areaColor<span class="token operator">:</span> <span class="token string">&#39;#f4cccc&#39;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    series<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            name<span class="token operator">:</span> <span class="token string">&#39;销量&#39;</span><span class="token punctuation">,</span>
            <span class="token comment">// 散点图在地图上展示数据</span>
            type<span class="token operator">:</span> <span class="token string">&#39;scatter&#39;</span><span class="token punctuation">,</span>
            coordinateSystem<span class="token operator">:</span> <span class="token string">&#39;geo&#39;</span><span class="token punctuation">,</span>
            data<span class="token operator">:</span> <span class="token function">convertData</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>mapData<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token comment">// 散点的大小（可以根据数据不同显示不同的大小，设置为一个函数）</span>
            symbolSize<span class="token operator">:</span> <span class="token number">11</span><span class="token punctuation">,</span>
            emphasis<span class="token operator">:</span> <span class="token punctuation">{</span>
                itemStyle<span class="token operator">:</span> <span class="token punctuation">{</span>
                    borderCap<span class="token operator">:</span> <span class="token string">&#39;#fff&#39;</span><span class="token punctuation">,</span>
                    borderWidth<span class="token operator">:</span> <span class="token number">1</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token comment">// 会自动生成geo地理坐标系统</span>
            type<span class="token operator">:</span> <span class="token string">&#39;map&#39;</span><span class="token punctuation">,</span>
            <span class="token comment">// 设置使用的地图名称，复用的是第0个坐标系统</span>
            map<span class="token operator">:</span> <span class="token string">&#39;china&#39;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style lang<span class="token operator">=</span><span class="token string">&quot;less&quot;</span> scoped<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="封装地图商品销量请求数据" tabindex="-1"><a class="header-anchor" href="#封装地图商品销量请求数据" aria-hidden="true">#</a> 封装地图商品销量请求数据</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// service/analysis.ts</span>
<span class="token comment">// 获取地图数据</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getGoodsAddressSale</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> hyRequest<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token operator">:</span> <span class="token string">&#39;/goods/address/sale&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> getAmountListData<span class="token punctuation">,</span> getGoodsAddressSale<span class="token punctuation">,</span> getGoodsCategoryCount<span class="token punctuation">,</span> getGoodsCategoryFavor<span class="token punctuation">,</span> getGoodsCategorySale <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/service/main/analysis/analysis&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;pinia&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">IAnalysisState</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    goodsAddressSale<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> useAnalysisStore <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token string">&#39;analysis&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    state<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> IAnalysisState <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token comment">// ....</span>
        goodsAddressSale<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    actions<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token keyword">async</span> <span class="token function">fetchAnalysisDataAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 顶部卡片数据...</span>
            <span class="token comment">// 获取饼图、玫瑰图数据...</span>
            <span class="token comment">// 获取折线图数据...</span>
            <span class="token comment">// 获取柱状图数据...</span>

            <span class="token comment">// 获取地图数据</span>
            <span class="token keyword">const</span> goodsAddressSaleResult <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getGoodsAddressSale</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>goodsAddressSale <span class="token operator">=</span> goodsAddressSaleResult<span class="token punctuation">.</span>data
            <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>goodsAddressSale<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> useAnalysisStore
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="父组件传递数据给地图组件" tabindex="-1"><a class="header-anchor" href="#父组件传递数据给地图组件" aria-hidden="true">#</a> 父组件传递数据给地图组件</h4><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// dashboard.vue</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;dashboard&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>顶部卡片组件 <span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token comment">// ...</span>
    <span class="token operator">&lt;</span>el<span class="token operator">-</span>row <span class="token operator">:</span>gutter<span class="token operator">=</span><span class="token string">&quot;10&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>el<span class="token operator">-</span>col <span class="token operator">:</span>span<span class="token operator">=</span><span class="token string">&quot;10&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>chart<span class="token operator">-</span>card<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>map<span class="token operator">-</span>echart <span class="token operator">:</span>map<span class="token operator">-</span>data<span class="token operator">=</span><span class="token string">&quot;showGoodsAddressSale&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>chart<span class="token operator">-</span>card<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>col<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>row<span class="token operator">&gt;</span>
    <span class="token comment">// ....</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> useAnalysisStore <span class="token keyword">from</span> <span class="token string">&#39;@/store/main/analysis/analysis&#39;</span>
<span class="token comment">// ...</span>

<span class="token comment">// 发起actions封装的网络请求</span>
<span class="token keyword">const</span> analysisStore <span class="token operator">=</span> <span class="token function">useAnalysisStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
analysisStore<span class="token punctuation">.</span><span class="token function">fetchAnalysisDataAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 获取数据</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> amountList<span class="token punctuation">,</span> goodsCategoryCount<span class="token punctuation">,</span> goodsCategorySale<span class="token punctuation">,</span> goodsCategoryFavor<span class="token punctuation">,</span> goodsAddressSale <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">storeToRefs</span><span class="token punctuation">(</span>analysisStore<span class="token punctuation">)</span>

<span class="token comment">// 获取echart饼图数据...</span>
<span class="token comment">// 获取echart折线图数据...</span>
<span class="token comment">// 获取echart柱状图数据...</span>

<span class="token comment">// 获取echart地图数据</span>
<span class="token keyword">const</span> showGoodsAddressSale <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> goodsAddressSale<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    name<span class="token operator">:</span> item<span class="token punctuation">.</span>address<span class="token punctuation">,</span>
    value<span class="token operator">:</span> item<span class="token punctuation">.</span>count
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/xumingyu2018/xumingyu2018.github.io/edit/main/vuepress-blog/projects/vue/cms.md" rel="noopener noreferrer" target="_blank" aria-label="编辑此页" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">上次编辑于: </span><span class="info">2024/2/3 10:10:12</span></div><div class="meta-item contributors"><span class="label">贡献者: </span><!--[--><!--[--><span class="contributor" title="email: xmy981022@163.com">Nevermore</span>,<!--]--><!--[--><span class="contributor" title="email: 260602448@qq.com">xumingyu2018</span><!--]--><!--]--></div></footer><!----><div class="giscus-wrapper input-top" style="display:block;"><div style="text-align:center">Loading...</div></div><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">MIT Licensed | Copyright © 2022-present Nevermore毓</div><div class="copyright">Copyright © 2024 Nevermore毓</div></footer><!--]--></div><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app.4445a247.js" defer></script>
  </body>
</html>
