<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.51" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://github.com/xumingyu2018/projects/vue/cms.html"><meta property="og:site_name" content="Nevermoreæ¯“ çš„å­¦ä¹ ç¬”è®°"><meta property="og:title" content="åå°ç®¡ç†é¡¹ç›®"><meta property="og:type" content="article"><meta property="og:updated_time" content="2023-08-22T15:12:26.000Z"><meta property="og:locale" content="zh-CN"><meta property="article:tag" content="å‰ç«¯é¡¹ç›®"><meta property="article:tag" content="Vueé¡¹ç›®"><meta property="article:modified_time" content="2023-08-22T15:12:26.000Z"><link rel="icon" href="/favicon.svg"><title>åå°ç®¡ç†é¡¹ç›® | Nevermoreæ¯“ çš„å­¦ä¹ ç¬”è®°</title><meta name="description" content="">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background-color: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="stylesheet" href="/assets/style.b2b1ec9b.css">
    <link rel="modulepreload" href="/assets/app.8c0e81d7.js"><link rel="modulepreload" href="/assets/cms.html.6acf1298.js"><link rel="modulepreload" href="/assets/_plugin-vue_export-helper.cdc0426e.js"><link rel="modulepreload" href="/assets/cms.html.4d75d971.js"><link rel="prefetch" href="/assets/index.html.9dde4bd2.js"><link rel="prefetch" href="/assets/about.html.5a0f50be.js"><link rel="prefetch" href="/assets/Java-basic.html.0164d0b8.js"><link rel="prefetch" href="/assets/Java-collection.html.309cb236.js"><link rel="prefetch" href="/assets/Java-thread.html.cbc6a6e0.js"><link rel="prefetch" href="/assets/Java8-new-features.html.66204cc9.js"><link rel="prefetch" href="/assets/photoSql.html.7d37c784.js"><link rel="prefetch" href="/assets/mysql.html.a945b3c3.js"><link rel="prefetch" href="/assets/vite.html.5030f75a.js"><link rel="prefetch" href="/assets/webpack.html.5f12a7c6.js"><link rel="prefetch" href="/assets/OOP.html.395cce12.js"><link rel="prefetch" href="/assets/index.html.a8391e16.js"><link rel="prefetch" href="/assets/arrow-function.html.0138f0ab.js"><link rel="prefetch" href="/assets/async-await.html.9cafbd5f.js"><link rel="prefetch" href="/assets/closure.html.c64e056c.js"><link rel="prefetch" href="/assets/deepClone.html.89a81437.js"><link rel="prefetch" href="/assets/es6.html.3f714dc6.js"><link rel="prefetch" href="/assets/eventLoop.html.260b5440.js"><link rel="prefetch" href="/assets/executing-principle.html.86e74f70.js"><link rel="prefetch" href="/assets/executing-process.html.4459ddee.js"><link rel="prefetch" href="/assets/extend.html.af8d544d.js"><link rel="prefetch" href="/assets/functional-programming.html.717ff7df.js"><link rel="prefetch" href="/assets/intro.html.7565a10e.js"><link rel="prefetch" href="/assets/iterator-generator.html.b1c6950f.js"><link rel="prefetch" href="/assets/promise-implement.html.fceadaf6.js"><link rel="prefetch" href="/assets/promise.html.09ba9755.js"><link rel="prefetch" href="/assets/prototype.html.68ccaf7b.js"><link rel="prefetch" href="/assets/this.html.210b88d8.js"><link rel="prefetch" href="/assets/with-eval-strict.html.2441d651.js"><link rel="prefetch" href="/assets/express.html.bc7f1238.js"><link rel="prefetch" href="/assets/koa.html.a8ee489d.js"><link rel="prefetch" href="/assets/node-basic.html.961273b0.js"><link rel="prefetch" href="/assets/node-other.html.151eccdc.js"><link rel="prefetch" href="/assets/node-sql.html.eb28900f.js"><link rel="prefetch" href="/assets/index.html.3cb4aa07.js"><link rel="prefetch" href="/assets/class.html.7d1cf5d5.js"><link rel="prefetch" href="/assets/dataType.html.d30ede64.js"><link rel="prefetch" href="/assets/demo.html.b41c6ca5.js"><link rel="prefetch" href="/assets/function.html.fb71326b.js"><link rel="prefetch" href="/assets/generics.html.0a578b34.js"><link rel="prefetch" href="/assets/interface.html.ca442670.js"><link rel="prefetch" href="/assets/variable.html.edbcdd6e.js"><link rel="prefetch" href="/assets/index.html.8696e0b0.js"><link rel="prefetch" href="/assets/TabBar-demo.html.0844564d.js"><link rel="prefetch" href="/assets/componentized.html.544a354a.js"><link rel="prefetch" href="/assets/pinia.html.409c254b.js"><link rel="prefetch" href="/assets/slot.html.2d679c77.js"><link rel="prefetch" href="/assets/vue-cli.html.a2a31bf5.js"><link rel="prefetch" href="/assets/vue-router.html.c879ebec.js"><link rel="prefetch" href="/assets/vue2-advanced.html.a8389b87.js"><link rel="prefetch" href="/assets/vue2-basic.html.1f35d7e9.js"><link rel="prefetch" href="/assets/vue3-basic.html.a7687cf4.js"><link rel="prefetch" href="/assets/vuex.html.f997a7b5.js"><link rel="prefetch" href="/assets/index.html.f81ebb3d.js"><link rel="prefetch" href="/assets/gulimall-demo.html.c39bdc23.js"><link rel="prefetch" href="/assets/nowcoder.html.45bed2ff.js"><link rel="prefetch" href="/assets/coderhub.html.d17adb3b.js"><link rel="prefetch" href="/assets/trip-site.html.dedffa11.js"><link rel="prefetch" href="/assets/browser-render.html.69c4a6eb.js"><link rel="prefetch" href="/assets/BFC.html.039ce767.js"><link rel="prefetch" href="/assets/align-center.html.60458cdc.js"><link rel="prefetch" href="/assets/basic.html.ad03494e.js"><link rel="prefetch" href="/assets/box.html.061f50fb.js"><link rel="prefetch" href="/assets/css-priority.html.66dfebf5.js"><link rel="prefetch" href="/assets/css-triangle.html.782d5ac5.js"><link rel="prefetch" href="/assets/flex.html.3199230b.js"><link rel="prefetch" href="/assets/intro.html.720112a2.js"><link rel="prefetch" href="/assets/less.html.c1145826.js"><link rel="prefetch" href="/assets/responsive.html.b4ac3faf.js"><link rel="prefetch" href="/assets/html5.html.637e9c1a.js"><link rel="prefetch" href="/assets/intro.html.d66b0f0d.js"><link rel="prefetch" href="/assets/tag.html.e8c082ed.js"><link rel="prefetch" href="/assets/cookie-session.html.5be16140.js"><link rel="prefetch" href="/assets/http-cache.html.8f0da6eb.js"><link rel="prefetch" href="/assets/http.html.f150f8e8.js"><link rel="prefetch" href="/assets/same-origin-policy.html.97090126.js"><link rel="prefetch" href="/assets/tcp.html.e16cf5f7.js"><link rel="prefetch" href="/assets/404.html.ecbcb5e7.js"><link rel="prefetch" href="/assets/index.html.6d697fae.js"><link rel="prefetch" href="/assets/index.html.36893461.js"><link rel="prefetch" href="/assets/index.html.4cc6530c.js"><link rel="prefetch" href="/assets/index.html.7062aee5.js"><link rel="prefetch" href="/assets/index.html.bd64629d.js"><link rel="prefetch" href="/assets/index.html.a8054ecf.js"><link rel="prefetch" href="/assets/index.html.58c2d96e.js"><link rel="prefetch" href="/assets/index.html.1a4f3a30.js"><link rel="prefetch" href="/assets/index.html.0eb7bc03.js"><link rel="prefetch" href="/assets/index.html.916b1fb1.js"><link rel="prefetch" href="/assets/index.html.69ad796c.js"><link rel="prefetch" href="/assets/index.html.822e2c3b.js"><link rel="prefetch" href="/assets/index.html.98d4bbf1.js"><link rel="prefetch" href="/assets/index.html.f93d2dfa.js"><link rel="prefetch" href="/assets/index.html.3c380501.js"><link rel="prefetch" href="/assets/index.html.e8cda796.js"><link rel="prefetch" href="/assets/index.html.cd08bdd6.js"><link rel="prefetch" href="/assets/index.html.a04d4857.js"><link rel="prefetch" href="/assets/index.html.138680c2.js"><link rel="prefetch" href="/assets/index.html.a01b29dd.js"><link rel="prefetch" href="/assets/index.html.1c91f667.js"><link rel="prefetch" href="/assets/index.html.82944efe.js"><link rel="prefetch" href="/assets/index.html.5abe7a12.js"><link rel="prefetch" href="/assets/index.html.9e4878f3.js"><link rel="prefetch" href="/assets/index.html.50513093.js"><link rel="prefetch" href="/assets/index.html.8025e42b.js"><link rel="prefetch" href="/assets/index.html.6be6938b.js"><link rel="prefetch" href="/assets/index.html.046fde74.js"><link rel="prefetch" href="/assets/index.html.edbba14a.js"><link rel="prefetch" href="/assets/index.html.e0b0475d.js"><link rel="prefetch" href="/assets/index.html.c8934920.js"><link rel="prefetch" href="/assets/about.html.301f6e7f.js"><link rel="prefetch" href="/assets/Java-basic.html.870a6e79.js"><link rel="prefetch" href="/assets/Java-collection.html.da7cb481.js"><link rel="prefetch" href="/assets/Java-thread.html.370151d5.js"><link rel="prefetch" href="/assets/Java8-new-features.html.6482e1bc.js"><link rel="prefetch" href="/assets/photoSql.html.fade0ae6.js"><link rel="prefetch" href="/assets/mysql.html.c04de8f4.js"><link rel="prefetch" href="/assets/vite.html.ace14501.js"><link rel="prefetch" href="/assets/webpack.html.ac033bb0.js"><link rel="prefetch" href="/assets/OOP.html.d688d356.js"><link rel="prefetch" href="/assets/index.html.4455612d.js"><link rel="prefetch" href="/assets/arrow-function.html.a6e19609.js"><link rel="prefetch" href="/assets/async-await.html.318ec109.js"><link rel="prefetch" href="/assets/closure.html.55eab928.js"><link rel="prefetch" href="/assets/deepClone.html.13dacc25.js"><link rel="prefetch" href="/assets/es6.html.ff3ac647.js"><link rel="prefetch" href="/assets/eventLoop.html.25512de0.js"><link rel="prefetch" href="/assets/executing-principle.html.0f474f9f.js"><link rel="prefetch" href="/assets/executing-process.html.91b0de49.js"><link rel="prefetch" href="/assets/extend.html.1a0697aa.js"><link rel="prefetch" href="/assets/functional-programming.html.ddcebc2c.js"><link rel="prefetch" href="/assets/intro.html.9a7c5bda.js"><link rel="prefetch" href="/assets/iterator-generator.html.4bec3c37.js"><link rel="prefetch" href="/assets/promise-implement.html.b61fc15c.js"><link rel="prefetch" href="/assets/promise.html.874422f2.js"><link rel="prefetch" href="/assets/prototype.html.37160d13.js"><link rel="prefetch" href="/assets/this.html.f4611507.js"><link rel="prefetch" href="/assets/with-eval-strict.html.4d8f2e30.js"><link rel="prefetch" href="/assets/express.html.017de4dd.js"><link rel="prefetch" href="/assets/koa.html.40d7d862.js"><link rel="prefetch" href="/assets/node-basic.html.5f6461e1.js"><link rel="prefetch" href="/assets/node-other.html.d5b691c9.js"><link rel="prefetch" href="/assets/node-sql.html.a8d19a2d.js"><link rel="prefetch" href="/assets/index.html.25fe28d2.js"><link rel="prefetch" href="/assets/class.html.332caac3.js"><link rel="prefetch" href="/assets/dataType.html.69eaa265.js"><link rel="prefetch" href="/assets/demo.html.88893bbf.js"><link rel="prefetch" href="/assets/function.html.08135e98.js"><link rel="prefetch" href="/assets/generics.html.e809c679.js"><link rel="prefetch" href="/assets/interface.html.cfd387c1.js"><link rel="prefetch" href="/assets/variable.html.9e840687.js"><link rel="prefetch" href="/assets/index.html.bb4651b2.js"><link rel="prefetch" href="/assets/TabBar-demo.html.eaf4697b.js"><link rel="prefetch" href="/assets/componentized.html.4b717a09.js"><link rel="prefetch" href="/assets/pinia.html.a215a38e.js"><link rel="prefetch" href="/assets/slot.html.bca0129e.js"><link rel="prefetch" href="/assets/vue-cli.html.c315d057.js"><link rel="prefetch" href="/assets/vue-router.html.e6f0e53b.js"><link rel="prefetch" href="/assets/vue2-advanced.html.563ad2be.js"><link rel="prefetch" href="/assets/vue2-basic.html.843dc44e.js"><link rel="prefetch" href="/assets/vue3-basic.html.aa5d3065.js"><link rel="prefetch" href="/assets/vuex.html.f36199a3.js"><link rel="prefetch" href="/assets/index.html.ee6948ad.js"><link rel="prefetch" href="/assets/gulimall-demo.html.3ac3b14d.js"><link rel="prefetch" href="/assets/nowcoder.html.93cbd450.js"><link rel="prefetch" href="/assets/coderhub.html.b24132ea.js"><link rel="prefetch" href="/assets/trip-site.html.bf9db1c3.js"><link rel="prefetch" href="/assets/browser-render.html.85cd5970.js"><link rel="prefetch" href="/assets/BFC.html.e677ffaa.js"><link rel="prefetch" href="/assets/align-center.html.214f15f1.js"><link rel="prefetch" href="/assets/basic.html.4d4fe7fa.js"><link rel="prefetch" href="/assets/box.html.52aef087.js"><link rel="prefetch" href="/assets/css-priority.html.3ed419de.js"><link rel="prefetch" href="/assets/css-triangle.html.180c4b41.js"><link rel="prefetch" href="/assets/flex.html.90d4e62e.js"><link rel="prefetch" href="/assets/intro.html.a61d5264.js"><link rel="prefetch" href="/assets/less.html.fd62915c.js"><link rel="prefetch" href="/assets/responsive.html.4f4d0a5f.js"><link rel="prefetch" href="/assets/html5.html.1fa654dd.js"><link rel="prefetch" href="/assets/intro.html.4b646c4e.js"><link rel="prefetch" href="/assets/tag.html.cc1ab65e.js"><link rel="prefetch" href="/assets/cookie-session.html.272dacd3.js"><link rel="prefetch" href="/assets/http-cache.html.0fa21a07.js"><link rel="prefetch" href="/assets/http.html.2dd8c15e.js"><link rel="prefetch" href="/assets/same-origin-policy.html.9a7a091f.js"><link rel="prefetch" href="/assets/tcp.html.449eb68e.js"><link rel="prefetch" href="/assets/404.html.a5a1c351.js"><link rel="prefetch" href="/assets/index.html.271482bf.js"><link rel="prefetch" href="/assets/index.html.6dd2c7dd.js"><link rel="prefetch" href="/assets/index.html.506c8bec.js"><link rel="prefetch" href="/assets/index.html.5a2430ec.js"><link rel="prefetch" href="/assets/index.html.328fe220.js"><link rel="prefetch" href="/assets/index.html.d09d3328.js"><link rel="prefetch" href="/assets/index.html.7a50f152.js"><link rel="prefetch" href="/assets/index.html.416c9ed4.js"><link rel="prefetch" href="/assets/index.html.e51d2ea6.js"><link rel="prefetch" href="/assets/index.html.f96b348a.js"><link rel="prefetch" href="/assets/index.html.8a9326e5.js"><link rel="prefetch" href="/assets/index.html.e6dd3b46.js"><link rel="prefetch" href="/assets/index.html.2acf6a77.js"><link rel="prefetch" href="/assets/index.html.92031ea7.js"><link rel="prefetch" href="/assets/index.html.2db527e4.js"><link rel="prefetch" href="/assets/index.html.67fdafa0.js"><link rel="prefetch" href="/assets/index.html.9ec9b51b.js"><link rel="prefetch" href="/assets/index.html.6a77b65b.js"><link rel="prefetch" href="/assets/index.html.c7bd63b7.js"><link rel="prefetch" href="/assets/index.html.4d191c5a.js"><link rel="prefetch" href="/assets/index.html.ec7e38ef.js"><link rel="prefetch" href="/assets/index.html.e1eef949.js"><link rel="prefetch" href="/assets/index.html.e11b427a.js"><link rel="prefetch" href="/assets/index.html.24358f2c.js"><link rel="prefetch" href="/assets/index.html.fa1570ac.js"><link rel="prefetch" href="/assets/index.html.75fe2a2d.js"><link rel="prefetch" href="/assets/index.html.2fafefdc.js"><link rel="prefetch" href="/assets/index.html.af74342c.js"><link rel="prefetch" href="/assets/index.html.f6294095.js"><link rel="prefetch" href="/assets/index.html.fa42bcdb.js"><link rel="prefetch" href="/assets/giscus.15440425.js"><link rel="prefetch" href="/assets/highlight.esm.d982e650.js"><link rel="prefetch" href="/assets/markdown.esm.832a189d.js"><link rel="prefetch" href="/assets/math.esm.a3f84b6f.js"><link rel="prefetch" href="/assets/notes.esm.3c361cb7.js"><link rel="prefetch" href="/assets/reveal.esm.b96f05d8.js"><link rel="prefetch" href="/assets/search.esm.80da4a02.js"><link rel="prefetch" href="/assets/zoom.esm.8514a202.js"><link rel="prefetch" href="/assets/photoswipe.esm.382b1873.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container no-sidebar has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><a href="/" class="brand"><img class="logo" src="/favicon.svg" alt="Nevermoreæ¯“ çš„å­¦ä¹ ç¬”è®°"><!----><span class="site-name hide-in-pad">Nevermoreæ¯“ çš„å­¦ä¹ ç¬”è®°</span></a><!----></div><div class="navbar-center"><!----><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/" class="nav-link" aria-label="ä¸»é¡µ"><span class="icon iconfont icon-home"></span>ä¸»é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><a href="/back-end/Java-basic.html" class="nav-link" aria-label="åç«¯å¼€å‘"><span class="icon iconfont icon-note"></span>åç«¯å¼€å‘<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="å‰ç«¯å¼€å‘"><span class="title"><span class="icon iconfont icon-flow"></span>å‰ç«¯å¼€å‘</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/front-end/webpage/html/intro.html" class="nav-link" aria-label="ç½‘é¡µ"><span class="icon iconfont icon-html"></span>ç½‘é¡µ<!----></a></li><li class="dropdown-item"><a href="/front-end/javascript/intro.html" class="nav-link" aria-label="JavaScript"><span class="icon iconfont icon-javascript"></span>JavaScript<!----></a></li><li class="dropdown-item"><a href="/front-end/typescript/demo.html" class="nav-link" aria-label="TypeScript"><span class="icon iconfont icon-typescript"></span>TypeScript<!----></a></li><li class="dropdown-item"><a href="/front-end/node/node-basic.html" class="nav-link" aria-label="Node"><span class="icon iconfont icon-javascript"></span>Node<!----></a></li><li class="dropdown-item"><a href="/front-end/vue/vue2-basic.html" class="nav-link" aria-label="Vue"><span class="icon iconfont icon-vue"></span>Vue<!----></a></li><li class="dropdown-item"><a href="/front-end/builder/webpack.html" class="nav-link" aria-label="æ„å»ºå·¥å…·"><span class="icon iconfont icon-build"></span>æ„å»ºå·¥å…·<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="é¡¹ç›®æºç "><span class="title"><span class="icon iconfont icon-proposal"></span>é¡¹ç›®æºç </span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Javaé¡¹ç›®</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/projects/java/nowcoder.html" class="nav-link" aria-label="ä»¿ç‰›å®¢ç½‘é¡¹ç›®"><span class="icon iconfont icon-java"></span>ä»¿ç‰›å®¢ç½‘é¡¹ç›®<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Vueé¡¹ç›®</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/projects/vue/trip-site.html" class="nav-link" aria-label="ç§»åŠ¨ç«¯æ—…æ¸¸é¡¹ç›®"><span class="icon iconfont icon-vue"></span>ç§»åŠ¨ç«¯æ—…æ¸¸é¡¹ç›®<!----></a></li><li class="dropdown-subitem"><a aria-current="page" href="/projects/vue/cms.html" class="router-link-active router-link-exact-active nav-link active" aria-label="åå°ç®¡ç†é¡¹ç›®"><span class="icon iconfont icon-vue"></span>åå°ç®¡ç†é¡¹ç›®<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Nodeé¡¹ç›®</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/projects/node/coderhub.html" class="nav-link" aria-label="coderhubé¡¹ç›®"><span class="icon iconfont icon-javascript"></span>coderhubé¡¹ç›®<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="é¡¹ç›®èµ„æº"><span class="title"><span class="icon iconfont icon-proposal"></span>é¡¹ç›®èµ„æº</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/sql/photoSql.html" class="nav-link" aria-label="æ‘„å½±çº¦æ‹sql"><span class="icon iconfont icon-edit"></span>æ‘„å½±çº¦æ‹sql<!----></a></li></ul></button></div></div></nav><!----></div><div class="navbar-right"><!----><!----><div class="nav-item"><a class="repo-link" href="https://github.com/xumingyu2018/xumingyu2018.github.io" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!----><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><span class="icon iconfont icon-edit"></span>åå°ç®¡ç†é¡¹ç›®</h1><div class="page-info"><span class="author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down" localizeddate="2023å¹´8æœˆ22æ—¥" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="author-item" href="https://github.com/xumingyu2018" target="_blank" rel="noopener noreferrer">Nevermoreæ¯“</a></span><span property="author" content="Nevermoreæ¯“"></span></span><!----><span class="date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span>2023å¹´8æœˆ22æ—¥</span><meta property="datePublished" content="2023-08-22T15:12:26.000Z"></span><span class="category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="down" localizeddate="2023å¹´8æœˆ22æ—¥" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><ul class="categories-wrapper"><li class="category category2 clickable" role="navigation">Vue</li><meta property="articleSection" content="Vue"></ul></span><span aria-label="æ ‡ç­¾ğŸ·" data-balloon-pos="down" localizeddate="2023å¹´8æœˆ22æ—¥" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><ul class="tags-wrapper"><li class="tag tag7 clickable" role="navigation">å‰ç«¯é¡¹ç›®</li><li class="tag tag7 clickable" role="navigation">Vueé¡¹ç›®</li></ul><meta property="keywords" content="å‰ç«¯é¡¹ç›®,Vueé¡¹ç›®"></span><span class="reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down" localizeddate="2023å¹´8æœˆ22æ—¥" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 74 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT74M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">æ­¤é¡µå†…å®¹</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#é¡¹ç›®åˆå§‹åŒ–" class="router-link-active router-link-exact-active toc-link level2">é¡¹ç›®åˆå§‹åŒ–</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#æŒ‰éœ€å¼•å…¥-element-plus" class="router-link-active router-link-exact-active toc-link level2">æŒ‰éœ€å¼•å…¥ Element-Plus</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å®ç°ç™»å½•é¡µé¢" class="router-link-active router-link-exact-active toc-link level2">å®ç°ç™»å½•é¡µé¢</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#è®¾ç½®-app-å®½é«˜é“ºæ»¡å±å¹•" class="router-link-active router-link-exact-active toc-link level3">è®¾ç½® App å®½é«˜é“ºæ»¡å±å¹•</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#æ­å»ºåå°ç®¡ç†å¸å·ç™»å½•é¡µé¢" class="router-link-active router-link-exact-active toc-link level3">æ­å»ºåå°ç®¡ç†å¸å·ç™»å½•é¡µé¢</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å®ç°ç‚¹å‡»ç™»å½•æŒ‰é’®é€»è¾‘" class="router-link-active router-link-exact-active toc-link level3">å®ç°ç‚¹å‡»ç™»å½•æŒ‰é’®é€»è¾‘</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å®ç°è®°ä½å¯†ç " class="router-link-active router-link-exact-active toc-link level3">å®ç°è®°ä½å¯†ç </a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å®ç°è·å–ç™»å½•ç”¨æˆ·è¯¦ç»†ä¿¡æ¯-åŒ…æ‹¬è§’è‰²æƒé™èœå•" class="router-link-active router-link-exact-active toc-link level3">å®ç°è·å–ç™»å½•ç”¨æˆ·è¯¦ç»†ä¿¡æ¯ï¼ˆåŒ…æ‹¬è§’è‰²æƒé™èœå•ï¼‰</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å®ç°ä¸»é¡µå·¦ä¾§å¯¼èˆªæ " class="router-link-active router-link-exact-active toc-link level2">å®ç°ä¸»é¡µå·¦ä¾§å¯¼èˆªæ </a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#æ•´ä½“å®¹å™¨å¸ƒå±€" class="router-link-active router-link-exact-active toc-link level3">æ•´ä½“å®¹å™¨å¸ƒå±€</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å®ç°å·¦ä¾§å¯¼èˆªæ é™æ€å¸ƒå±€" class="router-link-active router-link-exact-active toc-link level3">å®ç°å·¦ä¾§å¯¼èˆªæ é™æ€å¸ƒå±€</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å®ç°å·¦ä¾§å¯¼èˆªæ åŠ¨æ€å±•ç¤ºæ•ˆæœ" class="router-link-active router-link-exact-active toc-link level3">å®ç°å·¦ä¾§å¯¼èˆªæ åŠ¨æ€å±•ç¤ºæ•ˆæœ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å¯¼èˆªæ å›¾æ ‡çš„åŠ¨æ€ç»„ä»¶-ç»†èŠ‚å¤„ç†" class="router-link-active router-link-exact-active toc-link level3">å¯¼èˆªæ å›¾æ ‡çš„åŠ¨æ€ç»„ä»¶ï¼ˆç»†èŠ‚å¤„ç†ï¼‰</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å¯¼èˆªæ æ³¨å†Œæ‰€æœ‰é™æ€è·¯ç”±-æœ‰ç¼ºé™·" class="router-link-active router-link-exact-active toc-link level3">å¯¼èˆªæ æ³¨å†Œæ‰€æœ‰é™æ€è·¯ç”±ï¼ˆæœ‰ç¼ºé™·ï¼‰</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å®ç°ä¸»é¡µå¤´éƒ¨é¢åŒ…å±‘" class="router-link-active router-link-exact-active toc-link level2">å®ç°ä¸»é¡µå¤´éƒ¨é¢åŒ…å±‘</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#æ­å»ºæ•´ä½“å¸ƒå±€" class="router-link-active router-link-exact-active toc-link level3">æ­å»ºæ•´ä½“å¸ƒå±€</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å®ç°å¤´éƒ¨å·¦ä¾§å›¾æ ‡ç‚¹å‡»æŠ˜å åŠŸèƒ½" class="router-link-active router-link-exact-active toc-link level3">å®ç°å¤´éƒ¨å·¦ä¾§å›¾æ ‡ç‚¹å‡»æŠ˜å åŠŸèƒ½</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å®ç°å¤´éƒ¨å³ä¾§ä¸ªäººä¿¡æ¯åŠŸèƒ½" class="router-link-active router-link-exact-active toc-link level3">å®ç°å¤´éƒ¨å³ä¾§ä¸ªäººä¿¡æ¯åŠŸèƒ½</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#åŠ¨æ€è·¯ç”±" class="router-link-active router-link-exact-active toc-link level2">åŠ¨æ€è·¯ç”±</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å®‰è£…è‡ªåŠ¨åŒ–ç”Ÿæˆè·¯ç”±é…ç½®ä¿¡æ¯å’Œ-vue-é¡µé¢çš„å·¥å…·" class="router-link-active router-link-exact-active toc-link level3">å®‰è£…è‡ªåŠ¨åŒ–ç”Ÿæˆè·¯ç”±é…ç½®ä¿¡æ¯å’Œ vue é¡µé¢çš„å·¥å…·</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#ä½¿ç”¨-coderwhy-å·¥å…·" class="router-link-active router-link-exact-active toc-link level3">ä½¿ç”¨ coderwhy å·¥å…·</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#ç¼–å†™èœå•æ˜ å°„è·¯ç”±å·¥å…·ç±»" class="router-link-active router-link-exact-active toc-link level3">ç¼–å†™èœå•æ˜ å°„è·¯ç”±å·¥å…·ç±»</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#æœ‰å¼Šç«¯-ç™»å½•æ—¶è°ƒç”¨å·¥å…·ç±»" class="router-link-active router-link-exact-active toc-link level3">(æœ‰å¼Šç«¯)ç™»å½•æ—¶è°ƒç”¨å·¥å…·ç±»</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#æ”¹è¿›-ä½¿ç”¨å…¨å±€åŠ è½½æ•°æ®æ–¹æ³•" class="router-link-active router-link-exact-active toc-link level3">(æ”¹è¿›)ä½¿ç”¨å…¨å±€åŠ è½½æ•°æ®æ–¹æ³•</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#è¿›å…¥ä¸»é¡µæ—¶åŒ¹é…ç¬¬ä¸€ä¸ªèœå•" class="router-link-active router-link-exact-active toc-link level3">è¿›å…¥ä¸»é¡µæ—¶åŒ¹é…ç¬¬ä¸€ä¸ªèœå•</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#åˆ·æ–°é¡µé¢æ—¶-èœå•é»˜è®¤å€¼é—®é¢˜" class="router-link-active router-link-exact-active toc-link level3">åˆ·æ–°é¡µé¢æ—¶ï¼Œèœå•é»˜è®¤å€¼é—®é¢˜</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å®ç°é¢åŒ…å±‘åŠŸèƒ½" class="router-link-active router-link-exact-active toc-link level2">å®ç°é¢åŒ…å±‘åŠŸèƒ½</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#æ­å»ºé¢åŒ…å±‘é¡µé¢" class="router-link-active router-link-exact-active toc-link level3">æ­å»ºé¢åŒ…å±‘é¡µé¢</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#è·¯ç”±æ˜ å°„é¢åŒ…å±‘å·¥å…·ç±»" class="router-link-active router-link-exact-active toc-link level3">è·¯ç”±æ˜ å°„é¢åŒ…å±‘å·¥å…·ç±»</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#è§£å†³ç‚¹å‡»é¢åŒ…å±‘è·³åˆ°ç›®å½•ä¸‹çš„ç¬¬ä¸€ä¸ªå­ç›®å½•é—®é¢˜" class="router-link-active router-link-exact-active toc-link level3">è§£å†³ç‚¹å‡»é¢åŒ…å±‘è·³åˆ°ç›®å½•ä¸‹çš„ç¬¬ä¸€ä¸ªå­ç›®å½•é—®é¢˜</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å®ç°ä¸»é¡µä¸­éƒ¨-main-é¡µé¢" class="router-link-active router-link-exact-active toc-link level2">å®ç°ä¸»é¡µä¸­éƒ¨ main é¡µé¢</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å®ç°-search-è¡¨å•æœç´¢æ¡†ç•Œé¢" class="router-link-active router-link-exact-active toc-link level3">å®ç° search è¡¨å•æœç´¢æ¡†ç•Œé¢</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å®ç°å±•ç¤ºç”¨æˆ·åˆ—è¡¨åŠŸèƒ½" class="router-link-active router-link-exact-active toc-link level3">å®ç°å±•ç¤ºç”¨æˆ·åˆ—è¡¨åŠŸèƒ½</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å®ç°åˆ†é¡µåŠŸèƒ½" class="router-link-active router-link-exact-active toc-link level3">å®ç°åˆ†é¡µåŠŸèƒ½</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å®ç°æŸ¥è¯¢ç”¨æˆ·åŠŸèƒ½" class="router-link-active router-link-exact-active toc-link level3">å®ç°æŸ¥è¯¢ç”¨æˆ·åŠŸèƒ½</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å®ç°åˆ é™¤ç”¨æˆ·åŠŸèƒ½" class="router-link-active router-link-exact-active toc-link level3">å®ç°åˆ é™¤ç”¨æˆ·åŠŸèƒ½</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å®ç°æ–°å¢ç”¨æˆ·åŠŸèƒ½" class="router-link-active router-link-exact-active toc-link level3">å®ç°æ–°å¢ç”¨æˆ·åŠŸèƒ½</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å®ç°ç¼–è¾‘ç”¨æˆ·åŠŸèƒ½" class="router-link-active router-link-exact-active toc-link level3">å®ç°ç¼–è¾‘ç”¨æˆ·åŠŸèƒ½</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#é«˜çº§å¤ç”¨æ€§ä»£ç æŠ½å–" class="router-link-active router-link-exact-active toc-link level2">é«˜çº§å¤ç”¨æ€§ä»£ç æŠ½å–</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å°è£…ç½‘ç»œè¯·æ±‚" class="router-link-active router-link-exact-active toc-link level3">å°è£…ç½‘ç»œè¯·æ±‚</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å°è£…è¡¨å•æœç´¢ç»„ä»¶" class="router-link-active router-link-exact-active toc-link level3">å°è£…è¡¨å•æœç´¢ç»„ä»¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å°è£…è¡¨æ ¼å†…å®¹ç»„ä»¶" class="router-link-active router-link-exact-active toc-link level3">å°è£…è¡¨æ ¼å†…å®¹ç»„ä»¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å°è£…æ¨¡æ€æ¡†ç»„ä»¶" class="router-link-active router-link-exact-active toc-link level3">å°è£…æ¨¡æ€æ¡†ç»„ä»¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#é¡µé¢å…¬å…±é€»è¾‘çš„-hooks-æŠ½å–" class="router-link-active router-link-exact-active toc-link level3">é¡µé¢å…¬å…±é€»è¾‘çš„ hooks æŠ½å–</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å®ç°èœå•ç®¡ç†åŠŸèƒ½" class="router-link-active router-link-exact-active toc-link level2">å®ç°èœå•ç®¡ç†åŠŸèƒ½</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å®ç°æ ‘å½¢å­æ ‘çš„å±•ç¤º" class="router-link-active router-link-exact-active toc-link level3">å®ç°æ ‘å½¢å­æ ‘çš„å±•ç¤º</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å®ç°æ–°å¢ã€ç¼–è¾‘æ¨¡æ€æ¡†åŠŸèƒ½ä»¥åŠåˆ é™¤åŠŸèƒ½" class="router-link-active router-link-exact-active toc-link level3">å®ç°æ–°å¢ã€ç¼–è¾‘æ¨¡æ€æ¡†åŠŸèƒ½ä»¥åŠåˆ é™¤åŠŸèƒ½</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å®ç°è§’è‰²ç®¡ç†ä¸­çš„æƒé™åˆ†é…-éš¾ç‚¹" class="router-link-active router-link-exact-active toc-link level2">å®ç°è§’è‰²ç®¡ç†ä¸­çš„æƒé™åˆ†é…ï¼ˆéš¾ç‚¹ï¼‰</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#åˆ›å»ºè§’è‰²çš„èœå•æ ‘å±•ç¤º" class="router-link-active router-link-exact-active toc-link level3">åˆ›å»ºè§’è‰²çš„èœå•æ ‘å±•ç¤º</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#åˆ›å»ºè§’è‰²æºå¸¦èœå•æ ‘çš„æƒé™æ•°æ®" class="router-link-active router-link-exact-active toc-link level3">åˆ›å»ºè§’è‰²æºå¸¦èœå•æ ‘çš„æƒé™æ•°æ®</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#ç¼–è¾‘æ—¶è§’è‰²èœå•æƒé™å›æ˜¾" class="router-link-active router-link-exact-active toc-link level3">ç¼–è¾‘æ—¶è§’è‰²èœå•æƒé™å›æ˜¾</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#æ–°å¢æ—¶è§’è‰²èœå•æƒé™å›æ˜¾é‡ç½®" class="router-link-active router-link-exact-active toc-link level3">æ–°å¢æ—¶è§’è‰²èœå•æƒé™å›æ˜¾é‡ç½®</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å®ç°ç™»å½•ç”¨æˆ·çš„æƒé™åŠŸèƒ½" class="router-link-active router-link-exact-active toc-link level2">å®ç°ç™»å½•ç”¨æˆ·çš„æƒé™åŠŸèƒ½</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å°è£…èœå•æ˜ å°„æŒ‰é’®æƒé™å·¥å…·" class="router-link-active router-link-exact-active toc-link level3">å°è£…èœå•æ˜ å°„æŒ‰é’®æƒé™å·¥å…·</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#è·å–ç™»å½•ç”¨æˆ·çš„æ‰€æœ‰æŒ‰é’®æƒé™" class="router-link-active router-link-exact-active toc-link level3">è·å–ç™»å½•ç”¨æˆ·çš„æ‰€æœ‰æŒ‰é’®æƒé™</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å°è£…æƒé™-hooks" class="router-link-active router-link-exact-active toc-link level3">å°è£…æƒé™ hooks</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#ç¼–å†™-page-content-ç»„ä»¶" class="router-link-active router-link-exact-active toc-link level3">ç¼–å†™ Page-content ç»„ä»¶</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#ç»†èŠ‚å¤„ç†-æ–°å¢ç¼–è¾‘åˆ é™¤æ“ä½œé‡ç½®-current-åˆ†é¡µ" class="router-link-active router-link-exact-active toc-link level2">(ç»†èŠ‚å¤„ç†)æ–°å¢ç¼–è¾‘åˆ é™¤æ“ä½œé‡ç½® current åˆ†é¡µ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å®ç°æ•°æ®ç»Ÿè®¡é¡µé¢" class="router-link-active router-link-exact-active toc-link level2">å®ç°æ•°æ®ç»Ÿè®¡é¡µé¢</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å®ç°é¡¶éƒ¨å¡ç‰‡ç»„ä»¶é¡µé¢" class="router-link-active router-link-exact-active toc-link level3">å®ç°é¡¶éƒ¨å¡ç‰‡ç»„ä»¶é¡µé¢</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#é¡¶éƒ¨å¡ç‰‡ä¸­çš„æ•°æ®é€’å¢åŠ¨ç”»å®ç°" class="router-link-active router-link-exact-active toc-link level3">é¡¶éƒ¨å¡ç‰‡ä¸­çš„æ•°æ®é€’å¢åŠ¨ç”»å®ç°</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å®ç°é¡¶éƒ¨å¡ç‰‡å“åº”å¼å¸ƒå±€" class="router-link-active router-link-exact-active toc-link level3">å®ç°é¡¶éƒ¨å¡ç‰‡å“åº”å¼å¸ƒå±€</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å®ç°-echart-å¯è§†åŒ–" class="router-link-active router-link-exact-active toc-link level2">å®ç° echart å¯è§†åŒ–</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#åˆæ­¥æ­å»ºå¯è§†åŒ–é¡µé¢" class="router-link-active router-link-exact-active toc-link level3">åˆæ­¥æ­å»ºå¯è§†åŒ–é¡µé¢</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#ä¸‰å±‚ç»„ä»¶å°è£…-echart" class="router-link-active router-link-exact-active toc-link level3">ä¸‰å±‚ç»„ä»¶å°è£… echart</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#è·å–è¯·æ±‚æ•°æ®ç”¨äº-echarts-æ˜¾ç¤º" class="router-link-active router-link-exact-active toc-link level3">è·å–è¯·æ±‚æ•°æ®ç”¨äº ECharts æ˜¾ç¤º</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å®ç°å„ç§-echart-å›¾åŠ¨æ€æ•°æ®å±•ç¤º" class="router-link-active router-link-exact-active toc-link level3">å®ç°å„ç§ Echart å›¾åŠ¨æ€æ•°æ®å±•ç¤º</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/projects/vue/cms.html#å®ç°-echart-åœ°å›¾æ•°æ®å±•ç¤º" class="router-link-active router-link-exact-active toc-link level3">å®ç° echart åœ°å›¾æ•°æ®å±•ç¤º</a></li><!----><!--]--></ul><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h2 id="é¡¹ç›®åˆå§‹åŒ–" tabindex="-1"><a class="header-anchor" href="#é¡¹ç›®åˆå§‹åŒ–" aria-hidden="true">#</a> é¡¹ç›®åˆå§‹åŒ–</h2><p>æ­å»º vue3 è„šæ‰‹æ¶</p><p><code>npm init vue@latest</code></p><p>å®‰è£…ä¾èµ–</p><p><code>npm install</code></p><p>css æ ·å¼é‡ç½®ï¼ˆç•¥ï¼‰</p><p>é…ç½®è·¯ç”±ï¼ˆç•¥ï¼‰</p><p>é…ç½® pinia çŠ¶æ€ç®¡ç†ï¼ˆç•¥ï¼‰</p><p>é…ç½® axios ç½‘ç»œè¯·æ±‚ ts å†™æ³•</p><div class="language-TypeScript ext-TypeScript line-numbers-mode"><pre class="language-TypeScript"><code>// service/request/index.ts
import axios from &#39;axios&#39;
import type { AxiosInstance, AxiosRequestConfig, AxiosResponse } from &#39;axios&#39;

interface HYInstanceInterceptors&lt;T = AxiosResponse&gt; {
  requestInterceptor?: (config: AxiosRequestConfig) =&gt; AxiosRequestConfig
  requestInterceptorCatch?: (err: any) =&gt; any
  responseInterceptor?: (res: T) =&gt; T
  responseInterceptorCatch?: (err: any) =&gt; any
}

interface HYRequestConfig&lt;T = AxiosResponse&gt; extends AxiosRequestConfig {
  interceptors?: HYInstanceInterceptors&lt;T&gt;
}

class HYRequest {
  instance: AxiosInstance

  constructor(config: HYRequestConfig) {
    this.instance = axios.create(config)

    // å…¨å±€çš„æ‹¦æˆªå™¨
    this.instance.interceptors.request.use(
      (config) =&gt; {
        return config
      },
      (err) =&gt; {
        return err
      }
    )

    this.instance.interceptors.response.use(
      (res) =&gt; {
        return res.data
      },
      (err) =&gt; {
        return err
      }
    )

    // å®ä¾‹çš„æ‹¦æˆªå™¨
    this.instance.interceptors.request.use(
      config.interceptors?.requestInterceptor,
      config.interceptors?.requestInterceptorCatch
    )
    this.instance.interceptors.response.use(
      config.interceptors?.responseInterceptor,
      config.interceptors?.responseInterceptorCatch
    )
  }

  request&lt;T = any&gt;(config: HYRequestConfig&lt;T&gt;) {
    if (config.interceptors?.requestInterceptor) {
      config = config.interceptors.requestInterceptor(config)
    }

    return new Promise&lt;T&gt;((resolve, reject) =&gt; {
      this.instance
        .request&lt;any, T&gt;(config)
        .then((res) =&gt; {
          if (config.interceptors?.responseInterceptor) {
            res = config.interceptors.responseInterceptor(res)
          }
          resolve(res)
        })
        .catch((err: any) =&gt; {
          if (config.interceptors?.responseInterceptorCatch) {
            err = config.interceptors.responseInterceptorCatch(err)
          }
          reject(err)
        })
    })
  }

  get&lt;T = any&gt;(config: HYRequestConfig&lt;T&gt;) {
    return this.request&lt;T&gt;({ ...config, method: &#39;GET&#39; })
  }

  post&lt;T = any&gt;(config: HYRequestConfig&lt;T&gt;) {
    return this.request&lt;T&gt;({ ...config, method: &#39;POST&#39; })
  }

  delete&lt;T = any&gt;(config: HYRequestConfig&lt;T&gt;) {
    return this.request&lt;T&gt;({ ...config, method: &#39;DELETE&#39; })
  }

  patch&lt;T = any&gt;(config: HYRequestConfig&lt;T&gt;) {
    return this.request&lt;T&gt;({ ...config, method: &#39;PATCH&#39; })
  }
}

export default HYRequest

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-TypeScript ext-TypeScript line-numbers-mode"><pre class="language-TypeScript"><code>// service/index.ts
import HYRequest from &#39;./request&#39;
import { BASE_URL1, TIME_OUT1 } from &#39;./config&#39;
import { localCache } from &#39;@/utils/cache&#39;

const hyRequest = new HYRequest({
  baseURL: BASE_URL1,
  timeout: TIME_OUT1,
  interceptors: {
    requestInterceptor: (config) =&gt; {
      const token = localCache.getCache(&#39;token&#39;)
      if (token &amp;&amp; config.headers) {
        config.headers.Authorization = `Bearer ${token}`
      }
      return config
    },
    requestInterceptorCatch: (err) =&gt; {
      return err
    },
    responseInterceptor: (res) =&gt; {
      return res
    },
    responseInterceptorCatch: (err) =&gt; {
      return err
    }
  }
})

export default hyRequest

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-TypeScript ext-TypeScript line-numbers-mode"><pre class="language-TypeScript"><code>// service/config/index.ts
export const BASE_URL1 = &#39;http://152.136.185.210:5000&#39;
export const TIME_OUT1 = 10000
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é…ç½®ç”Ÿäº§ç¯å¢ƒå’Œå¼€å‘ç¯å¢ƒï¼ˆç•¥ï¼‰</p><h2 id="æŒ‰éœ€å¼•å…¥-element-plus" tabindex="-1"><a class="header-anchor" href="#æŒ‰éœ€å¼•å…¥-element-plus" aria-hidden="true">#</a> æŒ‰éœ€å¼•å…¥ Element-Plus</h2><p>å®‰è£…æ’ä»¶<code>npm install -D unplugin-vue-components unplugin-auto-import</code></p><p>ç„¶åæŠŠä¸‹åˆ—ä»£ç æ’å…¥åˆ°ä½ çš„ Vite æˆ– Webpack çš„é…ç½®æ–‡ä»¶ä¸­</p><p><strong>Vite</strong></p><div class="language-TypeScript ext-TypeScript line-numbers-mode"><pre class="language-TypeScript"><code>// vite.config.ts
import { defineConfig } from &#39;vite&#39;
import AutoImport from &#39;unplugin-auto-import/vite&#39;
import Components from &#39;unplugin-vue-components/vite&#39;
import { ElementPlusResolver } from &#39;unplugin-vue-components/resolvers&#39;

export default defineConfig({
  // ...
  plugins: [
    // ...
    AutoImport({
      resolvers: [ElementPlusResolver()],
    }),
    Components({
      resolvers: [ElementPlusResolver()],
    }),
  ],
})
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Webpack</strong></p><div class="language-TypeScript ext-TypeScript line-numbers-mode"><pre class="language-TypeScript"><code>// webpack.config.js
const AutoImport = require(&#39;unplugin-auto-import/webpack&#39;)
const Components = require(&#39;unplugin-vue-components/webpack&#39;)
const { ElementPlusResolver } = require(&#39;unplugin-vue-components/resolvers&#39;)

module.exports = {
  // ...
  plugins: [
    AutoImport({
      resolvers: [ElementPlusResolver()],
    }),
    Components({
      resolvers: [ElementPlusResolver()],
    }),
  ],
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="å®ç°ç™»å½•é¡µé¢" tabindex="-1"><a class="header-anchor" href="#å®ç°ç™»å½•é¡µé¢" aria-hidden="true">#</a> å®ç°ç™»å½•é¡µé¢</h2><p><img src="https://secure2.wostatic.cn/static/hEmsB97qM1Pqq5HXqCahJc/image.png?auth_key=1692714182-myJuyHE6qti9wzkRprRRBu-0-fd1929b0a826ccee7cdac4d32098762e" alt=""></p><h3 id="è®¾ç½®-app-å®½é«˜é“ºæ»¡å±å¹•" tabindex="-1"><a class="header-anchor" href="#è®¾ç½®-app-å®½é«˜é“ºæ»¡å±å¹•" aria-hidden="true">#</a> è®¾ç½® App å®½é«˜é“ºæ»¡å±å¹•</h3><p>æ³¨æ„è¿™é‡Œä¸èƒ½ç”¨%å·</p><div class="language-Vue ext-Vue line-numbers-mode"><pre class="language-Vue"><code>&lt;style scoped&gt;
.app {
  /* ä¸èƒ½ä½¿ç”¨%ï¼Œå› ä¸ºç›¸å¯¹äºçˆ¶å…ƒç´ ï¼›vhç›¸å¯¹äºè§†å£ */
  width: 100vw;
  height: 100vh;
  background-color: skyblue;
}
&lt;/style&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ­å»ºåå°ç®¡ç†å¸å·ç™»å½•é¡µé¢" tabindex="-1"><a class="header-anchor" href="#æ­å»ºåå°ç®¡ç†å¸å·ç™»å½•é¡µé¢" aria-hidden="true">#</a> æ­å»ºåå°ç®¡ç†å¸å·ç™»å½•é¡µé¢</h3><h4 id="login-çˆ¶ç»„ä»¶è®¾ç½®èƒŒæ™¯åŠä½ç½®" tabindex="-1"><a class="header-anchor" href="#login-çˆ¶ç»„ä»¶è®¾ç½®èƒŒæ™¯åŠä½ç½®" aria-hidden="true">#</a> Login çˆ¶ç»„ä»¶è®¾ç½®èƒŒæ™¯åŠä½ç½®</h4><div class="language-Vue ext-Vue line-numbers-mode"><pre class="language-Vue"><code>&lt;!-- Login.vue --&gt;
&lt;template&gt;
  &lt;div class=&quot;login&quot;&gt;
    &lt;login-panel /&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import loginPanel from &#39;./cpns/login-panel.vue&#39;
&lt;/script&gt;

&lt;style lang=&quot;less&quot; scoped&gt;
.login {
  display: flex;
  justify-content: center;
  align-items: center;

  width: 100%;
  height: 100%;

  background: url(../../assets/img/login-bg.svg);
}
&lt;/style&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å…¨å±€å›¾æ ‡åŠ-elmessage-ç»„ä»¶ç­‰æ ·å¼å¼•å…¥" tabindex="-1"><a class="header-anchor" href="#å…¨å±€å›¾æ ‡åŠ-elmessage-ç»„ä»¶ç­‰æ ·å¼å¼•å…¥" aria-hidden="true">#</a> å…¨å±€å›¾æ ‡åŠ ElMessage ç»„ä»¶ç­‰æ ·å¼å¼•å…¥</h4><p>å›¾æ ‡å¼•å…¥å®‰è£…ï¼š<code>npm install @element-plus/icons-vue</code></p><p>ElMessage ç»„ä»¶ç­‰æ ·å¼å¼•å…¥å®‰è£…ï¼š</p><div class="language-TypeScript ext-TypeScript line-numbers-mode"><pre class="language-TypeScript"><code>// å›¾æ ‡çš„å…¨å±€æ³¨å†Œ
// global/register-icons.ts
import * as ElementPlusIconsVue from &#39;@element-plus/icons-vue&#39;
import type { App } from &#39;vue&#39;

function registerIcons(app: App) {
  for (const [key, component] of Object.entries(ElementPlusIconsVue)) {
    app.component(key, component)
  }
}

export default registerIcons

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>main.ts ä¸­è¿›è¡Œæ³¨å†Œ</p><div class="language-TypeScript ext-TypeScript line-numbers-mode"><pre class="language-TypeScript"><code>import { createApp } from &#39;vue&#39;
import App from &#39;./App.vue&#39;
import &#39;normalize.css&#39;
import router from &#39;./router&#39;
import pinia from &#39;./store&#39;
import registerIcons from &#39;./global/register-icons&#39;

// é’ˆå¯¹ElMessageå’ŒElLoadingç­‰ç»„ä»¶å¼•å…¥æ ·å¼(æ‰‹åŠ¨æŒ‰éœ€å¼•å…¥)
import &#39;element-plus/theme-chalk/el-message.css&#39;

// å…¨å±€æ³¨å†Œelement-plus
// import ElementPlus from &#39;element-plus&#39;
// import &#39;element-plus/dist/index.css&#39;

// å®‰è£…vite-plugin-style-import/consolaå¹¶é…ç½®vite.config.tsï¼ˆè‡ªåŠ¨æŒ‰éœ€å¼•å…¥æ ·å¼ï¼‰

createApp(App).use(router).use(pinia).use(registerIcons).mount(&#39;#app&#39;)

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å®ç°ç™»å½•é¢æ¿çˆ¶ç»„ä»¶" tabindex="-1"><a class="header-anchor" href="#å®ç°ç™»å½•é¢æ¿çˆ¶ç»„ä»¶" aria-hidden="true">#</a> å®ç°ç™»å½•é¢æ¿çˆ¶ç»„ä»¶</h4><p>æ¶‰åŠåˆ°çš„ Element-Plus ç»„ä»¶æœ‰<code>el-tabs(é€‰é¡¹å¡)</code>ã€<code>el-check(è®°ä½å¯†ç å‹¾é€‰æ¡†)</code>ã€<code>el-button(ç«‹å³ç™»å½•)</code>ã€<code>el-link(è®°ä½å¯†ç /å¿˜è®°å¯†ç )</code>ã€<code>el-icon(é€‰é¡¹å¡å›¾æ ‡)</code></p><p>tabs ä¸­æ’å…¥å›¾æ ‡éœ€è¦ç”¨åˆ°<code>label</code>æ’æ§½<code>&lt;template #label&gt;...&lt;/template&gt;</code></p><p>tabs ä¸­é€šè¿‡ v-model ç»‘å®šé€‰é¡¹å¡çš„ name</p><div class="language-Vue ext-Vue line-numbers-mode"><pre class="language-Vue"><code>&lt;!-- login-panel.vue --&gt;
&lt;template&gt;
  &lt;div class=&quot;login-panel&quot;&gt;
    &lt;!-- é¡¶éƒ¨æ ‡é¢˜ --&gt;
    &lt;h1 class=&quot;title&quot;&gt;åå°ç®¡ç†ç³»ç»Ÿ&lt;/h1&gt;

    &lt;!-- tabsæ ‡ç­¾é¡µ --&gt;
    &lt;div class=&quot;tabs&quot;&gt;
      &lt;el-tabs v-model=&quot;activeName&quot; type=&quot;border-card&quot; stretch=&quot;true&quot;&gt;
        &lt;el-tab-pane label=&quot;å¸å·ç™»å½•&quot; name=&quot;account&quot;&gt;

          &lt;!-- å›¾æ ‡æ’æ§½ --&gt;
          &lt;template #label&gt;
            &lt;div class=&quot;label&quot;&gt;
              &lt;el-icon&gt;&lt;UserFilled /&gt;&lt;/el-icon&gt;
              &lt;span class=&quot;text&quot;&gt;å¸å·ç™»å½•&lt;/span&gt;
            &lt;/div&gt;
          &lt;/template&gt;

          &lt;!-- pane-accountå­ç»„ä»¶ --&gt;
          &lt;pane-account ref=&quot;accountRef&quot;/&gt;
        &lt;/el-tab-pane&gt;

        &lt;el-tab-pane label=&quot;æ‰‹æœºç™»å½•&quot; name=&quot;phone&quot;&gt;
          &lt;!-- å›¾æ ‡æ’æ§½ --&gt;
          &lt;template #label&gt;
            &lt;div class=&quot;label&quot;&gt;
              &lt;el-icon&gt;&lt;Cellphone /&gt;&lt;/el-icon&gt;
              &lt;div class=&quot;text&quot;&gt;æ‰‹æœºç™»å½•&lt;/div&gt;
            &lt;/div&gt;
          &lt;/template&gt;
          &lt;div&gt;æ‰‹æœºç™»å½•&lt;/div&gt;
          &lt;div&gt;éªŒè¯ç &lt;/div&gt;
        &lt;/el-tab-pane&gt;
      &lt;/el-tabs&gt;
    &lt;/div&gt;

    &lt;!-- åº•éƒ¨åŒºåŸŸ --&gt;
    &lt;div class=&quot;controls&quot;&gt;
      &lt;el-checkbox v-model=&quot;isRemPwd&quot; label=&quot;è®°ä½å¯†ç &quot; size=&quot;large&quot;&gt;&lt;/el-checkbox&gt;
      &lt;el-link type=&quot;primary&quot; href=&quot;&quot;&gt;å¿˜è®°å¯†ç &lt;/el-link&gt;
    &lt;/div&gt;

    &lt;el-button class=&quot;login-btn&quot; type=&quot;primary&quot; size=&quot;large&quot; @click=&quot;handleLoginBtnClick&quot;&gt;
      ç«‹å³ç™»å½•
    &lt;/el-button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import { ref } from &#39;vue&#39;
import paneAccount from &#39;./pane-account.vue&#39;

const activeName = ref(&#39;account&#39;)
const isRemPwd = ref(false)
const accountRef = ref&lt;InstanceType&lt;typeof paneAccount&gt;&gt;()

// æŒ‰é’®ç›‘å¬
const handleLoginBtnClick = () =&gt; {
  if (activeName.value === &#39;account&#39;) {
    // çˆ¶ç»„ä»¶è°ƒç”¨å­ç»„ä»¶æ–¹æ³•
    accountRef.value?.loginAction()
  } else {
    console.log(&#39;æ‰‹æœºç™»å½•&#39;)
  }
}
&lt;/script&gt;

&lt;style lang=&quot;less&quot; scoped&gt;
.login-panel {
  width: 330px;

  .title {
    text-align: center;
  }

  .label {
    display: flex;

    .text {
      margin-left: 5px;
    }
  }

  .controls {
    display: flex;
    justify-content: space-between;
  }

  .login-btn {
    margin-top: 10px;
    width: 100%;
  }
}
&lt;/style&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å°è£…é¢æ¿ä¸­ç™»å½•è¡¨å•å­ç»„ä»¶" tabindex="-1"><a class="header-anchor" href="#å°è£…é¢æ¿ä¸­ç™»å½•è¡¨å•å­ç»„ä»¶" aria-hidden="true">#</a> å°è£…é¢æ¿ä¸­ç™»å½•è¡¨å•å­ç»„ä»¶</h4><p>æ¶‰åŠåˆ°çš„ Element-Plus ç»„ä»¶æœ‰<code>el-form</code>ã€<code>el-input</code>ã€<code>el-message</code></p><p><code>form</code>çš„æ ¡éªŒè§„åˆ™éœ€è¦ä½¿ç”¨åˆ°<code>FormRules</code></p><p><code>form</code>çš„é€šè¿‡éªŒè¯éœ€è¦ä½¿ç”¨<code>formRef.value.validate()</code></p><p><code>defineExpose</code>å°†å­ç»„ä»¶çš„ç”¨æˆ·å/å¯†ç æš´éœ²ç»™çˆ¶ç»„ä»¶ï¼Œä»è€Œå®ç°ç™»å½•é€»è¾‘ï¼ˆæ¶‰åŠ piniaã€axiosï¼‰</p><div class="language-TypeScript ext-TypeScript line-numbers-mode"><pre class="language-TypeScript"><code>&lt;!-- pane-account.vue --&gt;
&lt;template&gt;
  &lt;div class=&quot;account&quot;&gt;
    &lt;el-form :model=&quot;account&quot; label-width=&quot;60px&quot; size=&quot;large&quot; :rules=&quot;accountRules&quot; status-icon ref=&quot;formRef&quot;&gt;
        &lt;el-form-item label=&quot;å¸å·&quot; prop=&quot;username&quot;&gt;
            &lt;el-input v-model=&quot;account.username&quot; placeholder=&quot;è¯·è¾“å…¥å¸å·&quot;&gt;&lt;/el-input&gt;
        &lt;/el-form-item&gt;
        &lt;el-form-item label=&quot;å¯†ç &quot; prop=&quot;password&quot;&gt;
            &lt;el-input v-model=&quot;account.password&quot; placeholder=&quot;è¯·è¾“å…¥å¯†ç &quot; show-password&gt;&lt;/el-input&gt;
        &lt;/el-form-item&gt;
    &lt;/el-form&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import { reactive, ref } from &quot;vue&quot;
import type { ElForm, FormRules } from &#39;element-plus&#39;
import { ElMessage } from &#39;element-plus&#39;
import useLoginStore from &#39;@/store/login/login&#39;
import type { IAccount } from &#39;@/types&#39;

// å®šä¹‰accountæ•°æ®
const account = reactive&lt;IAccount&gt;({
  username: &#39;&#39;,
  password: &#39;&#39;
})

// å®šä¹‰æ ¡éªŒè§„åˆ™
const accountRules: FormRules = {
  username: [
    { required: true, message: &#39;å¿…é¡»è¾“å…¥ç”¨æˆ·å&#39;, trigger: &#39;blur&#39; },
    { pattern: /^[a-z0-9]{6,20}$/, message: &#39;å¿…é¡»æ˜¯6ï½20ä½ä»¥å°å†™å­—æ¯æˆ–æ•°å­—å¼€å¤´&#39;, trigger: &#39;blur&#39; },
  ],
  password: [
    { required: true, message: &#39;å¿…é¡»è¾“å…¥å¯†ç &#39;, trigger: &#39;blur&#39;},
    { min: 3, max: 11, message: &#39;é•¿åº¦å¿…é¡»åœ¨3~11ä¸ªå­—ç¬¦&#39;, trigger: &#39;blur&#39;}
  ]
}

// æ‰§è¡Œå¸å·ç™»å½•é€»è¾‘
const formRef = ref&lt;InstanceType&lt;typeof ElForm&gt;&gt;()
const loginStore = useLoginStore()
function loginAction() {
  formRef.value?.validate((valid: any) =&gt; {
    if(valid) {
        const username = account.username
        const password = account.password

        loginStore.loginAccountAction({ username, password })
    } else {
        ElMessage.error(&#39;Oops, è¯·è¾“å…¥æ­£ç¡®çš„æ ¼å¼.&#39;)
    }
  })
}
// æš´éœ²ç»™çˆ¶ç»„ä»¶
defineExpose({
    loginAction
})

&lt;/script&gt;

&lt;style lang=&quot;less&quot; scoped&gt;

&lt;/style&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®ç°ç‚¹å‡»ç™»å½•æŒ‰é’®é€»è¾‘" tabindex="-1"><a class="header-anchor" href="#å®ç°ç‚¹å‡»ç™»å½•æŒ‰é’®é€»è¾‘" aria-hidden="true">#</a> å®ç°ç‚¹å‡»ç™»å½•æŒ‰é’®é€»è¾‘</h3><h4 id="å°è£…-iaccount-å¯¹è±¡ç±»å‹" tabindex="-1"><a class="header-anchor" href="#å°è£…-iaccount-å¯¹è±¡ç±»å‹" aria-hidden="true">#</a> å°è£… IAccount å¯¹è±¡ç±»å‹</h4><div class="language-TypeScript ext-TypeScript line-numbers-mode"><pre class="language-TypeScript"><code>// types/login.ts
export interface IAccount {
    username: string,
    password: string
}

// types/index.ts(ç»Ÿä¸€å¯¼å‡º)
export * from &#39;./login&#39;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å°è£…-axios-ç™»å½•è¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#å°è£…-axios-ç™»å½•è¯·æ±‚" aria-hidden="true">#</a> å°è£… axios ç™»å½•è¯·æ±‚</h4><div class="language-TypeScript ext-TypeScript line-numbers-mode"><pre class="language-TypeScript"><code>import hyRequest from &quot;..&quot;
import type { IAccount } from &quot;@/types&quot;

export function accountLoginRequest(account: IAccount) {
    return hyRequest.post({
        url: &#39;/login&#39;,
        data: account
    })
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ä½¿ç”¨-pinia-å­˜å‚¨è¯·æ±‚æ•°æ®-åœ¨pane-accountç»„ä»¶ä¸­è°ƒç”¨" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-pinia-å­˜å‚¨è¯·æ±‚æ•°æ®-åœ¨pane-accountç»„ä»¶ä¸­è°ƒç”¨" aria-hidden="true">#</a> ä½¿ç”¨ pinia å­˜å‚¨è¯·æ±‚æ•°æ®(åœ¨<code>pane-account</code>ç»„ä»¶ä¸­è°ƒç”¨)</h4><div class="language-TypeScript ext-TypeScript line-numbers-mode"><pre class="language-TypeScript"><code>// store/index.ts
// åˆå§‹åŒ–pinia
import { createPinia } from &quot;pinia&quot;;

const pinia = createPinia()

export default pinia
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-TypeScript ext-TypeScript line-numbers-mode"><pre class="language-TypeScript"><code>// store/login/login.ts
import { defineStore } from &quot;pinia&quot;;
import { accountLoginRequest } from &#39;@/service/login/login&#39;
import type { IAccount } from &quot;@/types&quot;;
import { localCache } from &quot;@/utils/cache&quot;;

const useLoginStore = defineStore(&#39;login&#39;, {
    state: () =&gt; ({
        id: &#39;&#39;,
        // token: localStorage.getItem(&#39;token&#39;) ?? &#39;&#39;,
        token: localCache.getCache(&#39;token&#39;) ?? &#39;&#39;,
        username: &#39;&#39;
    }),

    actions: {
        async loginAccountAction(account: IAccount) {
            const loginResult = await accountLoginRequest(account)
            console.log(&quot;ç™»å½•æˆåŠŸ&quot;);
            this.id = loginResult.data.id
            this.token = loginResult.data.token
            this.username = loginResult.data.username

            // è¿›è¡Œæœ¬åœ°ç¼“å­˜
            // localStorage.setItem(&#39;token&#39;, this.token)
            localCache.setCache(&#39;token&#39;, this.token)
        }
    }
})

export default useLoginStore
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å°è£…æœ¬åœ°ç¼“å­˜-token-å·¥å…·-localstorageã€sessionstorage" tabindex="-1"><a class="header-anchor" href="#å°è£…æœ¬åœ°ç¼“å­˜-token-å·¥å…·-localstorageã€sessionstorage" aria-hidden="true">#</a> å°è£…æœ¬åœ°ç¼“å­˜ token å·¥å…·ï¼ˆlocalStorageã€sessionStorageï¼‰</h4><div class="language-TypeScript ext-TypeScript line-numbers-mode"><pre class="language-TypeScript"><code>// utils/cache.ts
enum CacheType {
  local = &#39;local&#39;,
  session = &#39;session&#39;
}

class MyCache {
  storage: Storage

  // åˆ¤æ–­æ˜¯localStorageè¿˜æ˜¯sessionStorage
  constructor(type: CacheType) {
    this.storage = type === CacheType.local ? localStorage : sessionStorage
  }

  setCache(key: string, value: any) {
    this.storage.setItem(key, JSON.stringify(value))
  }

  getCache(key: string) {
    const value = this.storage.getItem(key)
    if (value) {
      return JSON.parse(value)
    }
  }

  deleteCache(key: string) {
    this.storage.removeItem(key)
  }

  clearCache() {
    this.storage.clear()
  }
}

const localCache = new MyCache(CacheType.local)
const sessionCache = new MyCache(CacheType.session)

export { localCache, sessionCache }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç™»å½•æ‹¦æˆª-è·¯ç”±å¯¼èˆªå®ˆå«" tabindex="-1"><a class="header-anchor" href="#ç™»å½•æ‹¦æˆª-è·¯ç”±å¯¼èˆªå®ˆå«" aria-hidden="true">#</a> ç™»å½•æ‹¦æˆªï¼ˆè·¯ç”±å¯¼èˆªå®ˆå«ï¼‰</h4><p><code>router.beforeEach(to, from)</code></p><div class="language-TypeScript ext-TypeScript line-numbers-mode"><pre class="language-TypeScript"><code>// router/index.ts
import { localCache } from &#39;@/utils/cache&#39;
import { createRouter, createWebHashHistory } from &#39;vue-router&#39;

const router = createRouter({
  // ...
})

router.beforeEach((to, from) =&gt; {
  const token = localCache.getCache(&#39;token&#39;)

  if(to.path === &#39;/main&#39; &amp;&amp; !token) {
      return &#39;/login&#39;
  }
})

export default router
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®ç°è®°ä½å¯†ç " tabindex="-1"><a class="header-anchor" href="#å®ç°è®°ä½å¯†ç " aria-hidden="true">#</a> å®ç°è®°ä½å¯†ç </h3><p>çˆ¶ç»„ä»¶å°†<code>isRemPwd</code>ä½œä¸ºå‚æ•°ä¼ å…¥å­ç»„ä»¶ç™»å½•é€»è¾‘ï¼Œåˆ¤æ–­<code>isRemPwd</code>çš„å¸ƒå°”å€¼ï¼Œæ¥é€‰æ‹©æ˜¯å¦å­˜å…¥æˆ–åˆ é™¤<code>LocalStore</code>æœ¬åœ°ç¼“å­˜ï¼Œå†è·å–æœ¬åœ°ç¼“å­˜å°†å€¼èµ‹å€¼ç»™åˆå§‹åŒ–çš„<code>username</code>å’Œ<code>password</code>è¿›è¡Œå›æ˜¾ã€‚å°†å‹¾é€‰æ¡†æ˜¯å¦é€‰ä¸­ä¹Ÿä½œä¸º<code>LocalStore</code>ç¼“å­˜å­˜å…¥ã€‚</p><div class="language-TypeScript ext-TypeScript line-numbers-mode"><pre class="language-TypeScript"><code>// çˆ¶ç»„ä»¶login-panel
// ...
const isRemPwd = ref&lt;boolean&gt;(localCache.getCache(&#39;isRemPwd&#39;) ?? false)
watch(isRemPwd, (newValue) =&gt; {
  localCache.setCache(&#39;isRemPwd&#39;, newValue)
})

// ...
// æŒ‰é’®ç›‘å¬
const handleLoginBtnClick = () =&gt; {
  if (activeName.value === &#39;account&#39;) {
    // çˆ¶ç»„ä»¶è°ƒç”¨å­ç»„ä»¶æ–¹æ³•
    accountRef.value?.loginAction(isRemPwd.value)
  } else {
    console.log(&#39;æ‰‹æœºç™»å½•&#39;)
  }
}
&lt;/script&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-TypeScript ext-TypeScript line-numbers-mode"><pre class="language-TypeScript"><code>
// å®šä¹‰accountæ•°æ®
const account = reactive&lt;IAccount&gt;({
  username: localCache.getCache(&#39;username&#39;) ?? &#39;&#39;,
  password: localCache.getCache(&#39;password&#39;) ?? &#39;&#39;
})

// æ‰§è¡Œå¸å·ç™»å½•é€»è¾‘
// ...
function loginAction(isRemPwd: boolean) {
  formRef.value?.validate((valid: any) =&gt; {
    if(valid) {
        const username = account.username
        const password = account.password

        // è°ƒç”¨storeä¸­çš„loginAccountAction(pinia)
        loginStore.loginAccountAction({ username, password }).then((res) =&gt; {
          // ç™»å½•æˆåŠŸåè®°ä½å¯†ç 
          if(isRemPwd) {
            localCache.setCache(&#39;username&#39;, username)
            localCache.setCache(&#39;password&#39;, password)
          } else {
            localCache.deleteCache(&#39;username&#39;)
            localCache.deleteCache(&#39;password&#39;)
          }
        })
    } else {
        ElMessage.error(&#39;é”™è¯¯, è¯·è¾“å…¥æ­£ç¡®çš„æ ¼å¼ï¼&#39;)
    }
  })
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®ç°è·å–ç™»å½•ç”¨æˆ·è¯¦ç»†ä¿¡æ¯-åŒ…æ‹¬è§’è‰²æƒé™èœå•" tabindex="-1"><a class="header-anchor" href="#å®ç°è·å–ç™»å½•ç”¨æˆ·è¯¦ç»†ä¿¡æ¯-åŒ…æ‹¬è§’è‰²æƒé™èœå•" aria-hidden="true">#</a> å®ç°è·å–ç™»å½•ç”¨æˆ·è¯¦ç»†ä¿¡æ¯ï¼ˆåŒ…æ‹¬è§’è‰²æƒé™èœå•ï¼‰</h3><h4 id="å°è£…-axios-æ¥å£è¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#å°è£…-axios-æ¥å£è¯·æ±‚" aria-hidden="true">#</a> å°è£… axios æ¥å£è¯·æ±‚</h4><div class="language-TypeScript ext-TypeScript line-numbers-mode"><pre class="language-TypeScript"><code>// è·å–ç”¨æˆ·è¯¦ç»†ä¿¡æ¯
export function getUserInfoById(id: number) {
    return hyRequest.get({
        url: `/users/${id}`,
        // headers: {
        //     Authorization: &#39;Bearer &#39; + localCache.getCache(&#39;token&#39;)
        // }
    })
}

// è·å–è§’è‰²æƒé™ä¿¡æ¯
export function getUserMenusByRoleId(id: number) {
    return hyRequest.get({
        url: `/role/${id}/menu`,
    })
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ä½¿ç”¨-pinia-å­˜å‚¨è¯·æ±‚æ•°æ®" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-pinia-å­˜å‚¨è¯·æ±‚æ•°æ®" aria-hidden="true">#</a> ä½¿ç”¨ pinia å­˜å‚¨è¯·æ±‚æ•°æ®</h4><div class="language-TypeScript ext-TypeScript line-numbers-mode"><pre class="language-TypeScript"><code>interface ILoginState {
    token: string,
    userInfo: any,
    userMenus: any
}

const useLoginStore = defineStore(&#39;login&#39;, {
    state: (): ILoginState =&gt; ({
        token: localCache.getCache(&#39;token&#39;) ?? &#39;&#39;,
        userInfo: {},
        userMenus: {}
    }),

    actions: {
        async loginAccountAction(account: IAccount) {
            // 1. å¸å·ç™»å½•ï¼Œaxiosè·å–tokenç­‰ä¿¡æ¯
            const loginResult = await accountLogin(account)
            const id = loginResult.data.id
            this.token = loginResult.data.token

            // 2. è¿›è¡Œæœ¬åœ°ç¼“å­˜ï¼ˆä½¿ç”¨å°è£…çš„cacheå·¥å…·ï¼‰
            localCache.setCache(&#39;token&#39;, this.token)

            // 3.è·å–ç™»å½•ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯ï¼ˆroleè§’è‰²ä¿¡æ¯ï¼‰
            const userInfoResult = await getUserInfoById(id)
            this.userInfo = userInfoResult.data

            // 4.æ ¹æ®è§’è‰²è¯·æ±‚ç”¨æˆ·çš„æƒé™ï¼ˆèœå•menusï¼‰
            const userMenusResult = await getUserMenusByRoleId(this.userInfo.role.id)
            this.userMenus = userMenusResult.data

            //  é¡µé¢è·³è½¬
            router.push(&#39;/main&#39;)
        }
    }
})

export default useLoginStore
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="å®ç°ä¸»é¡µå·¦ä¾§å¯¼èˆªæ " tabindex="-1"><a class="header-anchor" href="#å®ç°ä¸»é¡µå·¦ä¾§å¯¼èˆªæ " aria-hidden="true">#</a> å®ç°ä¸»é¡µå·¦ä¾§å¯¼èˆªæ </h2><p><img src="https://secure2.wostatic.cn/static/k1FTgme1ezTAH36tihiQ15/image.png?auth_key=1692714258-eBCxE2MWbDGHuwFKHMNuTS-0-d6c434ac984a7a4498961fa74809b3f0" alt=""></p><h3 id="æ•´ä½“å®¹å™¨å¸ƒå±€" tabindex="-1"><a class="header-anchor" href="#æ•´ä½“å®¹å™¨å¸ƒå±€" aria-hidden="true">#</a> æ•´ä½“å®¹å™¨å¸ƒå±€</h3><p>ä½¿ç”¨<code>el-container</code>åŒ…è£¹ä¾§è¾¹æ å®¹å™¨<code>el-aside</code>ä»¥åŠåŒ…è£¹<code>el-header</code>é¡¶æ å®¹å™¨å’Œ<code>el-main</code>ä¸»è¦åŒºåŸŸå®¹å™¨ã€‚</p><div class="language-Vue ext-Vue line-numbers-mode"><pre class="language-Vue"><code>&lt;template&gt;
  &lt;div class=&quot;main&quot;&gt;
    &lt;el-container class=&quot;main-content&quot;&gt;
      // å·¦ä¾§å¯¼èˆªæ 
      &lt;el-aside width=&quot;210px&quot;&gt;
        &lt;main-menu/&gt;
      &lt;/el-aside&gt;
      &lt;el-container&gt;
        &lt;el-header height=&quot;50px&quot;&gt;Header&lt;/el-header&gt;
        &lt;el-main&gt;
          // è·¯ç”±å ä½
          &lt;router-view/&gt;
        &lt;/el-main&gt;
      &lt;/el-container&gt;
    &lt;/el-container&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;style lang=&quot;less&quot; scoped&gt;
.main {
  color: red;
  height: 100%;

  .main-content {
    height: 100%;

    .el-aside {
      overflow-x: hidden;
      overflow-y: auto;
      line-height: 200px;
      text-align: left;
      cursor: pointer;
      background-color: #001529;
      transition: width 0.3s linear;
      scrollbar-width: none; /* firefox */
      -ms-overflow-style: none; /* IE 10+ */

      &amp;::-webkit-scrollbar {
        display: none;
      }
    }

    .el-main {
      background-color: #f0f2f5;
    }
  }
}
&lt;/style&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®ç°å·¦ä¾§å¯¼èˆªæ é™æ€å¸ƒå±€" tabindex="-1"><a class="header-anchor" href="#å®ç°å·¦ä¾§å¯¼èˆªæ é™æ€å¸ƒå±€" aria-hidden="true">#</a> å®ç°å·¦ä¾§å¯¼èˆªæ é™æ€å¸ƒå±€</h3><p>ä½¿ç”¨<code>elementUI</code>ä¸­èœå•<code>menu</code>ç»„ä»¶ç”±<code>el-menu</code>ã€<code>el-sub-menu</code>ï¼ˆéœ€è¦ä½¿ç”¨æ’æ§½ï¼‰ã€<code>el-menu-item</code>ç»„æˆã€‚</p><div class="language-Vue ext-Vue line-numbers-mode"><pre class="language-Vue"><code>&lt;template&gt;
  &lt;div class=&quot;main-menu&quot;&gt;
    &lt;div class=&quot;logo&quot;&gt;
      &lt;img class=&quot;img&quot; src=&quot;@/assets/img/logo.svg&quot; alt=&quot;å›¾æ ‡&quot; /&gt;
      &lt;h2 class=&quot;title&quot;&gt;åå°ç®¡ç†ç³»ç»Ÿ&lt;/h2&gt;
    &lt;/div&gt;
    &lt;div class=&quot;menu&quot;&gt;
      &lt;el-menu
        :default-active=&quot;defaultValue&quot;
        :collapse=&quot;isFold&quot;
        text-color=&quot;#b7bdc3&quot;
        active-text-color=&quot;#fff&quot;
        background-color=&quot;#001529&quot;
      &gt;
        &lt;el-sub-menu index=&quot;1&quot;&gt;
          &lt;!-- æ’æ§½ --&gt;
          &lt;template #title&gt;
            &lt;el-icon&gt;&lt;Monitor /&gt;&lt;/el-icon&gt;
            &lt;span&gt;ç³»ç»Ÿæ€»è§ˆ&lt;/span&gt;
          &lt;/template&gt;
          &lt;el-menu-item&gt;æ ¸å¿ƒæŠ€æœ¯&lt;/el-menu-item&gt;
          &lt;el-menu-item&gt;å•†å“ç»Ÿè®¡&lt;/el-menu-item&gt;
        &lt;/el-sub-menu&gt;

        &lt;el-sub-menu index=&quot;2&quot;&gt;
          &lt;template #title&gt;
            &lt;el-icon&gt;&lt;location /&gt;&lt;/el-icon&gt;
            &lt;span&gt;ç³»ç»Ÿç®¡ç†&lt;/span&gt;
          &lt;/template&gt;
          &lt;el-menu-item&gt;ç”¨æˆ·ç®¡ç†&lt;/el-menu-item&gt;
          &lt;el-menu-item&gt;éƒ¨é—¨ç®¡ç†&lt;/el-menu-item&gt;
          &lt;el-menu-item&gt;èœå•ç®¡ç†&lt;/el-menu-item&gt;
          &lt;el-menu-item&gt;è§’è‰²ç®¡ç†&lt;/el-menu-item&gt;
        &lt;/el-sub-menu&gt;
      &lt;/el-menu&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;&lt;/script&gt;

&lt;style lang=&quot;less&quot; scoped&gt;
.main-menu {
  height: 100%;
  background-color: #001529;

  .logo {
    display: flex;
    height: 28px;
    padding: 12px 10px 8px 10px;
    flex-direction: row;
    justify-content: flex-start;
    align-items: center;
    overflow: hidden;

    .img {
      height: 100%;
      margin: 0 10px;
    }

    .title {
      font-size: 16px;
      font-weight: 700;
      color: white;
      white-space: nowrap;
    }
  }
}

.el-menu {
  border-right: none;
  user-select: none;
}

.el-sub-menu {
  .el-menu-item {
    padding-left: 50px !important;
    background-color: #0c2135;
  }

  .el-menu-item:hover {
    color: #fff;
  }

  .el-menu-item.is-active {
    background-color: #0a60bd;
  }
}
&lt;/style&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®ç°å·¦ä¾§å¯¼èˆªæ åŠ¨æ€å±•ç¤ºæ•ˆæœ" tabindex="-1"><a class="header-anchor" href="#å®ç°å·¦ä¾§å¯¼èˆªæ åŠ¨æ€å±•ç¤ºæ•ˆæœ" aria-hidden="true">#</a> å®ç°å·¦ä¾§å¯¼èˆªæ åŠ¨æ€å±•ç¤ºæ•ˆæœ</h3><p>é¦–å…ˆå°†ç”¨æˆ·è¯¦ç»†ä¿¡æ¯ï¼Œæƒé™ä¿¡æ¯ç¼“å­˜å¤„ç†ï¼ˆåˆ·æ–°æ—¶ä¾ç„¶å­˜åœ¨ï¼‰ï¼Œç„¶åä½¿ç”¨<code>&lt;template v-for=&quot;&quot;&gt;</code>ã€<code>mustache</code>è¡¨è¾¾å¼åŠ¨æ€éå†å³å¯ã€‚</p><div class="language-Vue ext-Vue line-numbers-mode"><pre class="language-Vue"><code>// ç™»å½•æ—¶storeç¼“å­˜ç”¨æˆ·æƒé™ä¿¡æ¯
state: (): ILoginState =&gt; ({
    // ...
    userInfo: localCache.getCache(&#39;userInfo&#39;) ?? {},
    userMenus: localCache.getCache(&#39;userMenus&#39;) ?? []
}),
actions: {
    async loginAccountAction(account: IAccount) {
        // ....
        // è¿›è¡Œç”¨æˆ·æƒé™ä¿¡æ¯ç¼“å­˜
        localCache.setCache(&#39;userInfo&#39;, this.userInfo)
        localCache.setCache(&#39;userMenus&#39;, this.userMenus)

        //  é¡µé¢è·³è½¬
        router.push(&#39;/main&#39;)
    }
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-Vue ext-Vue line-numbers-mode"><pre class="language-Vue"><code>&lt;template&gt;
  &lt;div class=&quot;main-menu&quot;&gt;
    &lt;div class=&quot;logo&quot;&gt;
      &lt;img class=&quot;img&quot; src=&quot;@/assets/img/logo.svg&quot; alt=&quot;å›¾æ ‡&quot; /&gt;
      &lt;h2 class=&quot;title&quot;&gt;åå°ç®¡ç†ç³»ç»Ÿ&lt;/h2&gt;
    &lt;/div&gt;
    &lt;div class=&quot;menu&quot;&gt;
      &lt;el-menu
        :default-active=&quot;defaultValue&quot;
        :collapse=&quot;isFold&quot;
        text-color=&quot;#b7bdc3&quot;
        active-text-color=&quot;#fff&quot;
        background-color=&quot;#001529&quot;
      &gt;
        &lt;template v-for=&quot;item in userMenus&quot; :key=&quot;item.id&quot;&gt;
          &lt;!-- å­èœå• --&gt;
          &lt;el-sub-menu :index=&quot;item.id + &#39;&#39;&quot;&gt;
            &lt;template #title&gt;
              &lt;span&gt;{{ item.name }}&lt;/span&gt;
            &lt;/template&gt;

            &lt;!-- å­èœå•çš„æ¯ä¸€é¡¹ --&gt;
            &lt;template v-for=&quot;subItem in item.children&quot; :key=&quot;subItem.id&quot;&gt;
              &lt;el-menu-item :index=&quot;subItem.id + &#39;&#39;&quot; @click=&quot;handleItemClick(subItem)&quot;&gt;{{ subItem.name }}&lt;/el-menu-item&gt;
            &lt;/template&gt;
          &lt;/el-sub-menu&gt;
        &lt;/template&gt;
      &lt;/el-menu&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import useLoginStore from &#39;@/store/login/login&#39;;

const loginStore = useLoginStore();
const userMenus = loginStore.userMenus

function handleItemClick(subItem: any) {
  const url = subItem.url
  router.push(url)
}
&lt;/script&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å¯¼èˆªæ å›¾æ ‡çš„åŠ¨æ€ç»„ä»¶-ç»†èŠ‚å¤„ç†" tabindex="-1"><a class="header-anchor" href="#å¯¼èˆªæ å›¾æ ‡çš„åŠ¨æ€ç»„ä»¶-ç»†èŠ‚å¤„ç†" aria-hidden="true">#</a> å¯¼èˆªæ å›¾æ ‡çš„åŠ¨æ€ç»„ä»¶ï¼ˆç»†èŠ‚å¤„ç†ï¼‰</h3><p>æœåŠ¡å™¨è¿”å›çš„æ˜¯å­—ç¬¦ä¸²<code>el-icon-monitor</code>ï¼Œéœ€è¦ä½¿ç”¨åŠ¨æ€ç»„ä»¶<code>componet</code>æ¥å¤„ç†å›¾æ ‡å­—ç¬¦ä¸²å¹¶ä¸”ä½¿ç”¨<code>split</code>å‡½æ•°åˆ†éš”å­—ç¬¦ä¸²ã€‚</p><div class="language-Vue ext-Vue line-numbers-mode"><pre class="language-Vue"><code>&lt;!-- å­èœå• --&gt;
&lt;el-sub-menu :index=&quot;item.id + &#39;&#39;&quot;&gt;
  &lt;template #title&gt;
    &lt;el-icon&gt;
      &lt;component :is=&quot;item.icon.split(&#39;-icon-&#39;)[1]&quot;/&gt;
    &lt;/el-icon&gt;
    &lt;span&gt;{{ item.name }}&lt;/span&gt;
  &lt;/template&gt;
  // .......
&lt;/el-sub-menu&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å¯¼èˆªæ æ³¨å†Œæ‰€æœ‰é™æ€è·¯ç”±-æœ‰ç¼ºé™·" tabindex="-1"><a class="header-anchor" href="#å¯¼èˆªæ æ³¨å†Œæ‰€æœ‰é™æ€è·¯ç”±-æœ‰ç¼ºé™·" aria-hidden="true">#</a> å¯¼èˆªæ æ³¨å†Œæ‰€æœ‰é™æ€è·¯ç”±ï¼ˆæœ‰ç¼ºé™·ï¼‰</h3><p>å½“ç”¨æˆ·æ²¡æœ‰æƒé™æ—¶ï¼Œå¯ä»¥æ‰‹åŠ¨åœ¨åœ°å€æ è¾“å…¥ url å»è®¿é—®æ²¡æœ‰æƒé™çš„é¡µé¢ã€‚åé¢ä½¿ç”¨åŠ¨æ€è·¯ç”±ã€‚</p><div class="language-Vue ext-Vue line-numbers-mode"><pre class="language-Vue"><code>{
  path: &#39;/main&#39;,
  component: () =&gt; import(&#39;../views/main/Main.vue&#39;),
  children: [
    {
      path: &#39;/main/analysis/overview&#39;,
      component: () =&gt; import(&#39;../views/main/analysis/overview/overview.vue&#39;)
    },
    {
      path: &#39;/main/analysis/dashboard&#39;,
      component: () =&gt; import(&#39;../views/main/analysis/dashboard/dashboard.vue&#39;)
    },
    {
      path: &#39;/main/system/role&#39;,
      component: () =&gt; import(&#39;../views/main/system/role/role.vue&#39;)
    },
    {
      path: &#39;/main/system/user&#39;,
      component: () =&gt; import(&#39;../views/main/system/user/user.vue&#39;)
    },
    // ...
  ]
},
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="å®ç°ä¸»é¡µå¤´éƒ¨é¢åŒ…å±‘" tabindex="-1"><a class="header-anchor" href="#å®ç°ä¸»é¡µå¤´éƒ¨é¢åŒ…å±‘" aria-hidden="true">#</a> å®ç°ä¸»é¡µå¤´éƒ¨é¢åŒ…å±‘</h2><p><img src="https://secure2.wostatic.cn/static/qtx8xmpZnWgke1ogQXaq5n/image.png" alt=""></p><h3 id="æ­å»ºæ•´ä½“å¸ƒå±€" tabindex="-1"><a class="header-anchor" href="#æ­å»ºæ•´ä½“å¸ƒå±€" aria-hidden="true">#</a> æ­å»ºæ•´ä½“å¸ƒå±€</h3><div class="language-Vue ext-Vue line-numbers-mode"><pre class="language-Vue"><code>&lt;template&gt;
  &lt;div class=&quot;main-header&quot;&gt;
    &lt;div class=&quot;menu-icon&quot; @click=&quot;handleMenuIconClick&quot;&gt;
      &lt;el-icon size=&quot;28px&quot;&gt;
        &lt;el-icon&gt;&lt;Fold /&gt;&lt;/el-icon&gt;
      &lt;/el-icon&gt;
    &lt;/div&gt;
    &lt;div class=&quot;content&quot;&gt;
      &lt;div class=&quot;breadcrumb&quot;&gt;é¢åŒ…å±‘&lt;/div&gt;
      &lt;div class=&quot;info&quot;&gt;ä¸ªäººä¿¡æ¯&lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;style lang=&quot;less&quot; scoped&gt;
.main-header {
  display: flex;
  align-items: center;
  flex: 1;
  height: 100%;

  .menu-icon {
    display: flex;
    align-items: center;
    cursor: pointer;
  }

  .content {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex: 1;
    padding: 0 18px;
  }
}
&lt;/style&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®ç°å¤´éƒ¨å·¦ä¾§å›¾æ ‡ç‚¹å‡»æŠ˜å åŠŸèƒ½" tabindex="-1"><a class="header-anchor" href="#å®ç°å¤´éƒ¨å·¦ä¾§å›¾æ ‡ç‚¹å‡»æŠ˜å åŠŸèƒ½" aria-hidden="true">#</a> å®ç°å¤´éƒ¨å·¦ä¾§å›¾æ ‡ç‚¹å‡»æŠ˜å åŠŸèƒ½</h3><p>ç”±<code>main-header</code>å­ç»„ä»¶é€šè¿‡<code>defineEmits</code>å°†æŠ˜å çŠ¶æ€<code>isFold</code>ä¼ å…¥ç»™çˆ¶ç»„ä»¶<code>main</code>ä¸­çš„<code>el-aside</code>ä»è€Œæ§åˆ¶å…¶å®½åº¦ã€‚</p><div class="language-Vue ext-Vue line-numbers-mode"><pre class="language-Vue"><code>// main-header.vue
&lt;template&gt;
  &lt;div class=&quot;main-header&quot;&gt;
    &lt;div class=&quot;menu-icon&quot; @click=&quot;handleMenuIconClick&quot;&gt;
      &lt;el-icon size=&quot;28px&quot;&gt;
        &lt;component :is=&quot;isFold ? &#39;Expand&#39; : &#39;Fold&#39;&quot;/&gt;
      &lt;/el-icon&gt;
    &lt;/div&gt;
    &lt;div class=&quot;content&quot;&gt;
      &lt;div class=&quot;breadcrumb&quot;&gt;é¢åŒ…å±‘&lt;/div&gt;
      &lt;div class=&quot;info&quot;&gt;ä¸ªäººä¿¡æ¯&lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import { ref } from &quot;vue&quot;;

// 1.å†…éƒ¨è‡ªå®šä¹‰äº‹ä»¶
const emit = defineEmits([&#39;foldChange&#39;])

// 2.è®°å½•æŠ˜å çŠ¶æ€
const isFold = ref(false)
function handleMenuIconClick() {
  // 3.å­ç»„ä»¶å†…éƒ¨æ”¹å˜çŠ¶æ€
  isFold.value = !isFold.value

  // 4.å°†äº‹ä»¶å’ŒçŠ¶æ€ä¼ é€’ç»™çˆ¶ç»„ä»¶
  emit(&#39;foldChange&#39;, isFold.value)
}
&lt;/script&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>çˆ¶ç»„ä»¶åœ¨å®šä¹‰<code>main-header</code>ä¸Šé€šè¿‡<code>@fold-change</code>æ¥æ”¶å­ç»„ä»¶ä¼ æ¥çš„<code>emit(&#39;foldChange&#39;, isFold.value)</code>ã€‚</p><div class="language-Vue ext-Vue line-numbers-mode"><pre class="language-Vue"><code>// main.vue
&lt;template&gt;
  &lt;div class=&quot;main&quot;&gt;
    &lt;el-container class=&quot;main-content&quot;&gt;
      &lt;el-aside :width=&quot;isFold ? &#39;60px&#39; : &#39;210px&#39;&quot;&gt;
        &lt;!-- çˆ¶ä¼ å­ï¼ˆdefinePropsï¼‰ --&gt;
        &lt;main-menu :is-fold=&quot;isFold&quot;/&gt;
      &lt;/el-aside&gt;

      &lt;el-container&gt;
        &lt;el-header height=&quot;50px&quot;&gt;
          &lt;!-- emitå­ä¼ çˆ¶ï¼ˆdefineEmitsï¼‰ --&gt;
          &lt;main-header @fold-change=&quot;handleFoldChange&quot;/&gt;
        &lt;/el-header&gt;
        &lt;el-main&gt;Main&lt;/el-main&gt;
      &lt;/el-container&gt;
    &lt;/el-container&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import { localCache } from &#39;@/utils/cache&#39;;
import { useRouter } from &#39;vue-router&#39;;
import MainMenu from &#39;@/components/main-menu/main-menu.vue&#39;
import MainHeader from &#39;@/components/main-header/main-header.vue&#39;
import { ref } from &#39;vue&#39;;

const isFold = ref(false)
function handleFoldChange(isFoldValue: boolean) {
  isFold.value = isFoldValue
}
&lt;/script&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>çˆ¶ç»„ä»¶é€šè¿‡å­ç»„ä»¶çš„<code>defineProps</code>å°†<code>:is-fold=&quot;isFold&quot;</code>æŠ˜å çŠ¶æ€ä¼ å…¥åˆ°<code>el-menu</code>çš„å±æ€§<code>:collapse</code>ä¸Šï¼Œä»è€Œæ§åˆ¶<code>menu</code>èœå•çš„æŠ˜å ã€‚</p><div class="language-Vue ext-Vue line-numbers-mode"><pre class="language-Vue"><code>// main-menu.vue
&lt;template&gt;
  &lt;div class=&quot;main-menu&quot;&gt;
    // ....
    &lt;div class=&quot;menu&quot;&gt;
      &lt;el-menu
        // ....
        :collapse=&quot;isFold&quot;
      &gt;
      // ....
      &lt;/el-menu&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;
&lt;script setup lang=&quot;ts&quot;&gt;
defineProps({
  isFold: {
    type: Boolean,
    default: false
  }
})
&lt;/script&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®ç°å¤´éƒ¨å³ä¾§ä¸ªäººä¿¡æ¯åŠŸèƒ½" tabindex="-1"><a class="header-anchor" href="#å®ç°å¤´éƒ¨å³ä¾§ä¸ªäººä¿¡æ¯åŠŸèƒ½" aria-hidden="true">#</a> å®ç°å¤´éƒ¨å³ä¾§ä¸ªäººä¿¡æ¯åŠŸèƒ½</h3><h4 id="é™æ€å¸ƒå±€æ­å»º-åŒ…å«æ³¨é”€åŠŸèƒ½" tabindex="-1"><a class="header-anchor" href="#é™æ€å¸ƒå±€æ­å»º-åŒ…å«æ³¨é”€åŠŸèƒ½" aria-hidden="true">#</a> é™æ€å¸ƒå±€æ­å»ºï¼ˆåŒ…å«æ³¨é”€åŠŸèƒ½ï¼‰</h4><p>ä½¿ç”¨<code>el-dropdown</code>ä¸‹æ‹‰èœå•ç»„ä»¶ï¼Œè¿™é‡Œè¦è°ƒèŠ‚ä¸‹æ‹‰æ¡†çš„æ ·å¼éœ€è¦åŠ <code>:global</code>ï¼ˆåŸå› ï¼šå®ƒä¸åœ¨ app çˆ¶ç»„ä»¶ä¸‹ï¼Œå®ƒåœ¨ä¸ app åŒçº§çš„ç»„ä»¶ el-popper-container ä¸‹ï¼‰</p><div class="language-Vue ext-Vue line-numbers-mode"><pre class="language-Vue"><code>&lt;template&gt;
  &lt;div class=&quot;header-info&quot;&gt;
    &lt;div class=&quot;operation&quot;&gt;
      &lt;span&gt;
        &lt;el-icon&gt;&lt;bell /&gt;&lt;/el-icon&gt;
      &lt;/span&gt;
      &lt;span&gt;
        &lt;el-icon&gt;&lt;ChatDotRound /&gt;&lt;/el-icon&gt;
      &lt;/span&gt;
      &lt;span&gt;
        &lt;span class=&quot;dot&quot;&gt;&lt;/span&gt;
        &lt;el-icon&gt;&lt;Postcard /&gt;&lt;/el-icon&gt;
      &lt;/span&gt;
    &lt;/div&gt;
    &lt;div class=&quot;info&quot;&gt;
      &lt;el-dropdown&gt;
        &lt;span class=&quot;user-info&quot;&gt;
          &lt;el-avatar :size=&quot;30&quot; class=&quot;avatar&quot; src=&quot;https://xumingyu2018.github.io/avatar.png&quot; /&gt;
          &lt;span class=&quot;name&quot;&gt;{{ loginStore.userInfo.name }}&lt;/span&gt;
        &lt;/span&gt;
        &lt;template #dropdown&gt;
          &lt;el-dropdown-menu&gt;
            &lt;el-dropdown-item @click=&quot;handleExitClick&quot;&gt;
              &lt;el-icon&gt;&lt;CircleCloseFilled /&gt;&lt;/el-icon&gt;
              æ³¨é”€
            &lt;/el-dropdown-item&gt;
            &lt;el-dropdown-item divided&gt;
              &lt;el-icon&gt;&lt;InfoFilled /&gt;&lt;/el-icon&gt;
              ä¸ªäººä¿¡æ¯
            &lt;/el-dropdown-item&gt;
            &lt;el-dropdown-item&gt;
              &lt;el-icon&gt;&lt;Unlock /&gt;&lt;/el-icon&gt;
              ä¿®æ”¹å¯†ç 
            &lt;/el-dropdown-item&gt;
          &lt;/el-dropdown-menu&gt;
        &lt;/template&gt;
      &lt;/el-dropdown&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { useRouter } from &#39;vue-router&#39;
import { localCache } from &#39;@/utils/cache&#39;
import useLoginStore from &#39;@/store/login/login&#39;

const router = useRouter()
function handleExitClick() {
  localCache.deleteCache(&#39;token&#39;)
  localCache.deleteCache(&#39;userInfo&#39;)
  localCache.deleteCache(&#39;userMenus&#39;)
  router.push(&#39;/login&#39;)
}

// æ˜¾ç¤ºç”¨æˆ·åç§°ä¿¡æ¯
const loginStore = useLoginStore()
&lt;/script&gt;

&lt;style lang=&quot;less&quot; scoped&gt;
.header-info {
  display: flex;
  align-items: center;
}

.operation {
  display: inline-flex;
  margin-right: 20px;
  span {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 35px;

    &amp;:hover {
      background: #f2f2f2;
    }

    i {
      font-size: 20px;
    }

    .dot {
      position: absolute;
      top: 3px;
      right: 3px;
      z-index: 10;
      width: 6px;
      height: 6px;
      background: red;
      border-radius: 100%;
    }
  }
}

.user-info {
  display: flex;
  align-items: center;
  cursor: pointer;

  .name {
    margin-left: 8px;
  }
}

.info {
  // ä½¿ç”¨globalçš„åŸå› æ˜¯å› ä¸ºå®ƒä¸åœ¨appçˆ¶ç»„ä»¶ä¸‹ï¼Œå®ƒåœ¨ä¸appåŒçº§çš„ç»„ä»¶el-popper-containerä¸‹
  :global(.el-dropdown-menu__item) {
    line-height: 36px !important;
    padding: 6px 22px;
  }
}
&lt;/style&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="åŠ¨æ€è·¯ç”±" tabindex="-1"><a class="header-anchor" href="#åŠ¨æ€è·¯ç”±" aria-hidden="true">#</a> åŠ¨æ€è·¯ç”±</h2><p><img src="https://secure2.wostatic.cn/static/oFj2Q945VD4Dv4kdaW3sqn/image.png" alt=""></p><p>æœ¬æ–‡é‡‡ç”¨åŸºäºèœå•çš„åŠ¨æ€è·¯ç”±ç®¡ç†å®ç°ï¼ˆç»“åˆ coderwhy å…¨å±€å·¥å…·ï¼‰ã€‚</p><h3 id="å®‰è£…è‡ªåŠ¨åŒ–ç”Ÿæˆè·¯ç”±é…ç½®ä¿¡æ¯å’Œ-vue-é¡µé¢çš„å·¥å…·" tabindex="-1"><a class="header-anchor" href="#å®‰è£…è‡ªåŠ¨åŒ–ç”Ÿæˆè·¯ç”±é…ç½®ä¿¡æ¯å’Œ-vue-é¡µé¢çš„å·¥å…·" aria-hidden="true">#</a> å®‰è£…è‡ªåŠ¨åŒ–ç”Ÿæˆè·¯ç”±é…ç½®ä¿¡æ¯å’Œ vue é¡µé¢çš„å·¥å…·</h3><p><code>npm install coderwhy -g</code></p><h3 id="ä½¿ç”¨-coderwhy-å·¥å…·" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-coderwhy-å·¥å…·" aria-hidden="true">#</a> ä½¿ç”¨ coderwhy å·¥å…·</h3><p>ä¾‹ï¼š<code>coderwhy add3page_setup list -d src/views/main/story/list</code></p><p><code>add3page_setup</code>ï¼šé’ˆå¯¹ vue3 çš„ setup è¯­æ³•ã€‚</p><p><code>-d</code>ï¼šç”ŸæˆæŒ‡å®šæ–‡ä»¶çš„åœ°å€ã€‚</p><p><code>list</code>ï¼šç”Ÿæˆçš„è·¯ç”±åå­—å’Œ vue é¡µé¢åå­—ã€‚</p><h3 id="ç¼–å†™èœå•æ˜ å°„è·¯ç”±å·¥å…·ç±»" tabindex="-1"><a class="header-anchor" href="#ç¼–å†™èœå•æ˜ å°„è·¯ç”±å·¥å…·ç±»" aria-hidden="true">#</a> ç¼–å†™èœå•æ˜ å°„è·¯ç”±å·¥å…·ç±»</h3><ol><li>æ ¹æ®èœå•æ˜ å°„å¯¹åº”çš„è·¯ç”±ã€‚</li><li>è¿›å…¥ä¸»é¡µåŒ¹é…ç¬¬ä¸€ä¸ªèœå•çš„è·¯ç”±ã€‚</li></ol><div class="language-Vue ext-Vue line-numbers-mode"><pre class="language-Vue"><code>// utils/map-menus.ts
import type { RouteRecordRaw } from &quot;vue-router&quot;

// è‡ªåŠ¨åŒ–åŠ è½½æ‰€æœ‰çš„è·¯ç”±ï¼ˆä¹Ÿå¯ä»¥æ”¶åˆ°å†™æ­»ï¼‰
function loadLocalRoutes() {
  // 1.åŠ è½½æ‰€æœ‰çš„æ¨¡æ¿
  const modules: Record&lt;string, any&gt; = i<wbr>mport.meta.glob(&#39;../router/main/**/*.ts&#39;, { eager: true })

  // 2.éå†æ‰€æœ‰çš„æ¨¡æ¿ä¸ºè·¯ç”±å¯¹è±¡
  const routes: RouteRecordRaw[] = []
  for (const key in modules) {
    const route = modules[key].default
    routes.push(route)
  }
  return routes
}

// è®°å½•ç¬¬ä¸€ä¸ªèœå•ä¿¡æ¯
export let firstMenu: any = null
/**
 * æ˜ å°„èœå•åˆ°è·¯ç”±
 * @param menus èœå•
 * @returns è·¯ç”±
 */
export function mapMenuToRoutes(menus: any[]) {
    // 1.åŠ è½½æ‰€æœ‰çš„è·¯ç”±å¯¹è±¡
    const loadRoutes = loadLocalRoutes()

    // 2.æ ¹æ®èœå•è·å–éœ€è¦æ·»åŠ çš„è·¯ç”±å¯¹è±¡
    const finalRoutes: RouteRecordRaw[] = []
    for(const menu of menus) {
        for(const submenu of menu.children) {
            const route = loadRoutes.find(route =&gt; route.path === submenu.url)
            if(route) finalRoutes.push(route)

            // è®°å½•ç¬¬ä¸€ä¸ªè¢«åŒ¹é…èœå•
            if(!firstMenu &amp;&amp; route) firstMenu = submenu
        }
    }

    return finalRoutes
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æœ‰å¼Šç«¯-ç™»å½•æ—¶è°ƒç”¨å·¥å…·ç±»" tabindex="-1"><a class="header-anchor" href="#æœ‰å¼Šç«¯-ç™»å½•æ—¶è°ƒç”¨å·¥å…·ç±»" aria-hidden="true">#</a> (æœ‰å¼Šç«¯)ç™»å½•æ—¶è°ƒç”¨å·¥å…·ç±»</h3><p>åœ¨å‘é€ç™»å½•è¯·æ±‚æ—¶ï¼Œä½¿ç”¨<code>router.addRoute(&#39;main&#39;, route)</code>å°†èœå•ä¿¡æ¯<code>userMenus</code>é‡Œçš„è·¯ç”±å’Œå…¨éƒ¨æ³¨å†Œè¿›<code>loadLocalRoutes</code>åŒ¹é…æ—¶è°ƒç”¨ã€‚</p><p>å¼Šç«¯ï¼šåˆ·æ–°æ—¶è·¯ç”±æ³¨å†Œä¸äº†ï¼Œä»£ç é‡æ–°æ‰§è¡Œæ—¶ï¼ŒåŠ¨æ€è·¯ç”±å°±åŠ è½½ä¸äº†ï¼Œå› ä¸ºåªæœ‰ç‚¹å‡»ç™»å½•æŒ‰é’®æ—¶æ‰ä¼šæ‰§è¡Œè¯¥ä»£ç ã€‚</p><div class="language-Vue ext-Vue line-numbers-mode"><pre class="language-Vue"><code>// store/login/login.ts
interface ILoginState {
    // ...
    userMenus: any
}

const useLoginStore = defineStore(&#39;login&#39;, {
    state: (): ILoginState =&gt; ({
        // ...
        userMenus: localCache.getCache(&#39;userMenus&#39;) ?? []
    }),

    actions: {
        async loginAccountAction(account: IAccount) {
            // ...
            // 6.æ ¹æ®èœå•menuåŠ¨æ€åŠ è½½è·¯ç”±(ä½¿ç”¨å·¥å…·ç±»map-menus.ts)ï¼Œåˆ·æ–°æ—¶è¿™æ®µä»£ç ä¸ä¼šé‡æ–°æ‰§è¡Œï¼Œå› ä¸ºåªæœ‰ç‚¹å‡»ç™»å½•æŒ‰é’®æ—¶æ‰ä¼šæ‰§è¡Œè¯¥ä»£ç ã€‚
            const routes = mapMenuToRoutes(this.userMenus)
            // è¿™é‡Œçš„&#39;main&#39;æ˜¯æ ¹æ®è·¯ç”±é‡Œçš„nameå±æ€§æ¥çš„
            routes.forEach(route =&gt; router.addRoute(&#39;main&#39;, route))

            //  é¡µé¢è·³è½¬
            router.push(&#39;/main&#39;)
        }
    }
})

export default useLoginStore
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>router.addRoute(&#39;main&#39;, route)</code>é‡Œçš„ main æ˜¯éœ€è¦åœ¨è·¯ç”±è¡¨ä¸­è®¾ç½®<code>name</code>å±æ€§ã€‚</p><div class="language-Vue ext-Vue line-numbers-mode"><pre class="language-Vue"><code>const router = createRouter({
  history: createWebHashHistory(),
  routes: [
    // ...
    {
      path: &#39;/main&#39;,
      name: &#39;main&#39;,
      component: () =&gt; import(&#39;@/views/main/Main.vue&#39;),
      // ä»¥ä¸‹æ›¿æ¢æˆåŠ¨æ€æ³¨å†Œè·¯ç”±çš„æ–¹æ³•(ä¹Ÿå¯ä»¥ä¸ä½¿ç”¨å·¥å…·ç±»ï¼Œåœ¨è¿™é‡Œå…¨éƒ¨è·¯ç”±å†™æ­»)
      // children: [
      //   {
      //     path: &#39;/main/analysis/overview&#39;,
      //     component: () =&gt; import(&#39;../views/main/analysis/overview/overview.vue&#39;)
      //   },
      //   {
      //     path: &#39;/main/analysis/dashboard&#39;,
      //     component: () =&gt; import(&#39;../views/main/analysis/dashboard/dashboard.vue&#39;)
      //   },
      // ]
    },
    // ....
  ]
})
export default router
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ”¹è¿›-ä½¿ç”¨å…¨å±€åŠ è½½æ•°æ®æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#æ”¹è¿›-ä½¿ç”¨å…¨å±€åŠ è½½æ•°æ®æ–¹æ³•" aria-hidden="true">#</a> (æ”¹è¿›)ä½¿ç”¨å…¨å±€åŠ è½½æ•°æ®æ–¹æ³•</h3><p>ä¸å†ä»…é™äºåœ¨ç™»å½•æ—¶è°ƒç”¨<code>mapMenuToRoutes</code>å·¥å…·ç±»ï¼Œè€Œåœ¨å…¨å±€å½“åˆ·æ–°é¡µé¢æ—¶è°ƒç”¨ã€‚</p><div class="language-Vue ext-Vue line-numbers-mode"><pre class="language-Vue"><code>const useLoginStore = defineStore(&#39;login&#39;, {
    state: (): ILoginState =&gt; ({
        token: &#39;&#39;,
        userInfo: {},
        userMenus: []
    }),

    actions: {
        async loginAccountAction(account: IAccount) {
            // ....
            router.push(&#39;/main&#39;)
        },

        // è§£å†³åˆ·æ–°é¡µé¢åï¼ŒåŠ¨æ€è·¯ç”±ä¸¢å¤±çš„é—®é¢˜(ä¸å†æ˜¯loginAccountActionç™»å½•æ—¶æ‰æ‰§è¡Œ)
        loadLocalDataAction() {
            // ç”¨æˆ·è¿›è¡Œåˆ·æ–°æ—¶é»˜è®¤åŠ è½½æ•°æ®
            const token = localCache.getCache(&#39;token&#39;)
            const userInfo = localCache.getCache(&#39;userInfo&#39;)
            const userMenus = localCache.getCache(&#39;userMenus&#39;)

            if(token &amp;&amp; userInfo &amp;&amp; userMenus) {
                this.token = token
                this.userInfo = userInfo
                this.userMenus = userMenus
                // 6.æ ¹æ®èœå•menuåŠ¨æ€åŠ è½½è·¯ç”±(ä½¿ç”¨å·¥å…·ç±»map-menus.ts)
                const routes = mapMenuToRoutes(userMenus)
                // è¿™é‡Œçš„&#39;main&#39;æ˜¯æ ¹æ®è·¯ç”±é‡Œçš„nameå±æ€§æ¥çš„
                routes.forEach(route =&gt; router.addRoute(&#39;main&#39;, route))
            }
        }
    }
})
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ App ç»„ä»¶ä¸­è°ƒç”¨<code>loadLocalDataAction</code>æ–¹æ³•ï¼Œæ³¨æ„ï¼šæ­¤æ–¹æ³•ä¸€å®šè¦æ”¾åœ¨<code>app.router</code>ä¹‹å‰æ‰§è¡Œã€‚</p><div class="language-Vue ext-Vue line-numbers-mode"><pre class="language-Vue"><code>// App.vue
const app = createApp(App)
app.use(pinia)
const loginStore = useLoginStore()
loginStore.loadLocalDataAction()

app.use(router)
app.use(registerIcons)
app.mount(&#39;#app&#39;)

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯ä»¥å°†<code>loadLocalDataAction</code>æ–¹æ³•å°è£…è¿›<code>pinia</code>å¯¼å‡ºçš„åœ°æ–¹ï¼Œä»è€Œä½¿ç”¨<code>app.use()</code>æ–¹æ³•æ³¨å†Œè¿›å…¨å±€ App ç»„ä»¶ã€‚</p><div class="language-Vue ext-Vue line-numbers-mode"><pre class="language-Vue"><code>//store/index.js
import { createPinia } from &quot;pinia&quot;;
import useLoginStore from &quot;./login/login&quot;;

const pinia = createPinia()

function registerStore(app: App&lt;Element&gt;) {
    app.use(pinia)

    // åŠ è½½æœ¬åœ°ç¼“å­˜æ•°æ®
    const loginStore = useLoginStore()
    loginStore.loadLocalDataAction()
}

export default registerStore

// App.vue
import store from &#39;./store&#39;

app.use(store)
app.use(router)
app.use(registerIcons)
app.mount(&#39;#app&#39;)

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="è¿›å…¥ä¸»é¡µæ—¶åŒ¹é…ç¬¬ä¸€ä¸ªèœå•" tabindex="-1"><a class="header-anchor" href="#è¿›å…¥ä¸»é¡µæ—¶åŒ¹é…ç¬¬ä¸€ä¸ªèœå•" aria-hidden="true">#</a> è¿›å…¥ä¸»é¡µæ—¶åŒ¹é…ç¬¬ä¸€ä¸ªèœå•</h3><p>ä»<code>mapMenuToRoutes</code>å·¥å…·ç±»ä¸­è·å–<code>firstMenu</code>ç¬¬ä¸€ä¸ªèœå•ï¼Œåœ¨è·¯ç”±å¯¼èˆªå®ˆå«ä¸­åˆ¤æ–­ã€‚</p><div class="language-Vue ext-Vue line-numbers-mode"><pre class="language-Vue"><code>import { firstMenu } from &#39;@/utils/map-menus&#39;

const router = createRouter({
  history: createWebHashHistory(),
  routes: // ....
})

router.beforeEach((to, from) =&gt; {
  // ....
  if(to.path === &#39;/main&#39;) {
    return firstMenu.url
  }
})

export default router
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="åˆ·æ–°é¡µé¢æ—¶-èœå•é»˜è®¤å€¼é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#åˆ·æ–°é¡µé¢æ—¶-èœå•é»˜è®¤å€¼é—®é¢˜" aria-hidden="true">#</a> åˆ·æ–°é¡µé¢æ—¶ï¼Œèœå•é»˜è®¤å€¼é—®é¢˜</h3><p>æ ¹æ®è·¯ç”±çš„<code>url</code>è·¯å¾„ï¼Œæ˜ å°„å¯¹åº”èœå•<code>menu</code>ï¼ˆéœ€è¦ä¸€ä¸ªè·¯ç”±æ˜ å°„èœå•çš„å·¥å…·ç±»ï¼‰ï¼Œä»è€Œè·å¾—<code>menu</code>çš„<code>id</code>å±æ€§ï¼Œå°†<code>el-menu</code>ç»„ä»¶å±æ€§<code>:default-active=&quot;defaultValue&quot;</code>çš„<code>defaultValue</code>åŠ¨æ€ç»‘å®šç»™<code>menu.id</code>ã€‚</p><div class="language-Vue ext-Vue line-numbers-mode"><pre class="language-Vue"><code>// utils/map-menus.ts
/**
 * æ˜ å°„è·¯ç”±åˆ°èœå•å·¥å…·ç±»
 * @param path è·¯ç”±url
 * @param menus èœå•
 * @returns èœå•
 */
export function mapPathToMenu(menus: any[], path: string) {
    for (const menu of menus) {
      for (const submenu of menu.children) {
        if (path === submenu.url) return submenu
      }
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-Vue ext-Vue line-numbers-mode"><pre class="language-Vue"><code>// main-menu.vue
&lt;template&gt;
  &lt;div class=&quot;main-menu&quot;&gt;
    // ....
    &lt;div class=&quot;menu&quot;&gt;
      &lt;el-menu
        :default-active=&quot;defaultValue&quot;
        // ....
      &gt;
      // .....
      &lt;/el-menu&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import { mapPathToMenu } from &#39;@/utils/map-menus&#39;;
// .....

// 1.å­˜æ”¾åŠ¨æ€çš„èœå•
const loginStore = useLoginStore();
const userMenus = loginStore.userMenus

// 3.é¡µé¢åˆ·æ–°æ—¶ï¼Œæ ¹æ®å½“å‰çš„è·¯ç”±åœ°å€ï¼Œè®¾ç½®é»˜è®¤é€‰ä¸­çš„èœå•é¡¹(é»˜è®¤å€¼é—®é¢˜)
const route = useRoute()
const defaultValue = computed(() =&gt; {
  const currentMenu = mapPathToMenu(userMenus, route.path)
  return currentMenu.id + &#39;&#39;
})
&lt;/script&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="å®ç°é¢åŒ…å±‘åŠŸèƒ½" tabindex="-1"><a class="header-anchor" href="#å®ç°é¢åŒ…å±‘åŠŸèƒ½" aria-hidden="true">#</a> å®ç°é¢åŒ…å±‘åŠŸèƒ½</h2><p><img src="https://secure2.wostatic.cn/static/97uxoUbD17xWuhYbrNVid1/image.png" alt=""></p><h3 id="æ­å»ºé¢åŒ…å±‘é¡µé¢" tabindex="-1"><a class="header-anchor" href="#æ­å»ºé¢åŒ…å±‘é¡µé¢" aria-hidden="true">#</a> æ­å»ºé¢åŒ…å±‘é¡µé¢</h3><p>ä½¿ç”¨<code>el-breadcrumb</code>æ­å»ºé¢åŒ…å±‘é¡µé¢ï¼Œä½¿ç”¨å·¥å…·ç±»<code>mapPathToBreadCrumb</code>å°†èœå•<code>menu</code>ä»¥åŠå­èœå•<code>submenu</code>æ”¾å…¥<code>breadcrumb</code>æ•°ç»„ï¼Œç”¨äºåŠ¨æ€éå†<code>el-breadcrumb</code>ã€‚</p><div class="language-Vue ext-Vue line-numbers-mode"><pre class="language-Vue"><code>// header-crumb.vue
&lt;template&gt;
  &lt;div class=&quot;header-crumb&quot;&gt;
    &lt;el-breadcrumb separator-icon=&quot;ArrowRight&quot;&gt;
        &lt;template v-for=&quot;(item, index) in breadcrumb&quot; :key=&quot;index&quot;&gt;
            &lt;el-breadcrumb-item :to=item.url&gt;{{ item.name }}&lt;/el-breadcrumb-item&gt;
        &lt;/template&gt;
    &lt;/el-breadcrumb&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { mapPathToBreadCrumb } from &#39;@/utils/map-menus&#39;
import { useRoute } from &#39;vue-router&#39;
import useLoginStore from &#39;@/store/login/login&#39;
import { computed } from &#39;vue&#39;

const route = useRoute()
const loginStore = useLoginStore()

// è·¯å¾„æ”¹å˜æ—¶ï¼Œé‡æ–°è®¡ç®—é¢åŒ…å±‘
const breadcrumb = computed(() =&gt; {
    return mapPathToBreadCrumb(loginStore.userMenus, route.path)
})
&lt;/script&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="è·¯ç”±æ˜ å°„é¢åŒ…å±‘å·¥å…·ç±»" tabindex="-1"><a class="header-anchor" href="#è·¯ç”±æ˜ å°„é¢åŒ…å±‘å·¥å…·ç±»" aria-hidden="true">#</a> è·¯ç”±æ˜ å°„é¢åŒ…å±‘å·¥å…·ç±»</h3><p><code>mapPathToBreadCrumb</code>å·¥å…·ç±»</p><div class="language-Vue ext-Vue line-numbers-mode"><pre class="language-Vue"><code>// map-menus.ts
export function mapPathToBreadCrumb(menus: any[], path: string) {
    const breadCrumb: any[] = []

    for (const menu of menus) {
      for (const submenu of menu.children) {
        if (path === submenu.url){
            breadCrumb.push(menu)
            breadCrumb.push(submenu)
            return breadCrumb
        }
      }
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="è§£å†³ç‚¹å‡»é¢åŒ…å±‘è·³åˆ°ç›®å½•ä¸‹çš„ç¬¬ä¸€ä¸ªå­ç›®å½•é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#è§£å†³ç‚¹å‡»é¢åŒ…å±‘è·³åˆ°ç›®å½•ä¸‹çš„ç¬¬ä¸€ä¸ªå­ç›®å½•é—®é¢˜" aria-hidden="true">#</a> è§£å†³ç‚¹å‡»é¢åŒ…å±‘è·³åˆ°ç›®å½•ä¸‹çš„ç¬¬ä¸€ä¸ªå­ç›®å½•é—®é¢˜</h3><p><code>el-breadcrumb</code>çš„<code>:to=item.url</code>å±æ€§é—®é¢˜ï¼Œä¿®æ”¹å·¥å…·ç±»<code>mapMenuToRoutes</code>å°†æ ¹ç›®å½•è·¯å¾„é‡å®šå‘åˆ°æ ¹ç›®å½•ä¸‹çš„ç¬¬ä¸€ä¸ªå­ç›®å½•ã€‚</p><div class="language-Vue ext-Vue line-numbers-mode"><pre class="language-Vue"><code>export function mapMenuToRoutes(menus: any[]) {
    // ...
    const finalRoutes: RouteRecordRaw[] = []
    for(const menu of menus) {
        for(const submenu of menu.children) {
            // ....
            if(route) {
                // ç»™routeçš„é¡¶å±‚èœå•å¢åŠ é‡å®šå‘åŠŸèƒ½ï¼ˆä½†æ˜¯åªéœ€è¦æ·»åŠ ä¸€æ¬¡å³å¯ï¼‰
                if(!finalRoutes.find((item) =&gt; item.path === route.path)) {
                    finalRoutes.push({ path: menu.url, redirect: route})
                }
                finalRoutes.push(route)
            }
            // è®°å½•ç¬¬ä¸€ä¸ªè¢«åŒ¹é…èœå•
            if(!firstMenu &amp;&amp; route) firstMenu = submenu
        }
    }

    return finalRoutes
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="å®ç°ä¸»é¡µä¸­éƒ¨-main-é¡µé¢" tabindex="-1"><a class="header-anchor" href="#å®ç°ä¸»é¡µä¸­éƒ¨-main-é¡µé¢" aria-hidden="true">#</a> å®ç°ä¸»é¡µä¸­éƒ¨ main é¡µé¢</h2><p>ä¸»ä½“é¡µé¢<code>main</code>ä¸­åŒ…æ‹¬ä¸‰ä¸ªéƒ¨åˆ†è¡¨è¾¾æœç´¢æ¡†<code>search</code>ã€å†…å®¹éƒ¨åˆ†çš„å¤´éƒ¨åŠè¡¨æ ¼æ•°æ®ã€‚</p><h3 id="å®ç°-search-è¡¨å•æœç´¢æ¡†ç•Œé¢" tabindex="-1"><a class="header-anchor" href="#å®ç°-search-è¡¨å•æœç´¢æ¡†ç•Œé¢" aria-hidden="true">#</a> å®ç° search è¡¨å•æœç´¢æ¡†ç•Œé¢</h3><p><img src="https://secure2.wostatic.cn/static/oeywjBVRfpkUuQSiZSgj8M/image.png" alt=""></p><h4 id="æ­å»ºé™æ€-search-è¡¨å•æœç´¢æ¡†ç•Œé¢" tabindex="-1"><a class="header-anchor" href="#æ­å»ºé™æ€-search-è¡¨å•æœç´¢æ¡†ç•Œé¢" aria-hidden="true">#</a> æ­å»ºé™æ€ search è¡¨å•æœç´¢æ¡†ç•Œé¢</h4><p>é€šè¿‡<code>layout</code>å¸ƒå±€ç»„ä»¶ä¸­çš„<code>el-row</code>å’Œ<code>el-col</code>å¯¹æ¯è¡Œæ¯åˆ—åšå¸ƒå±€ï¼Œä½¿ç”¨<code>el-form</code>è¡¨å•ç»„ä»¶åŒ…å«çš„<code>el-input</code>è¾“å…¥æ¡†ã€<code>el-select</code>ä¸‹æ‹‰é€‰æ‹©ä»¥åŠ<code>el-date-picker</code>æ—¥æœŸé€‰æ‹©å™¨å®ç°ã€‚</p><div class="language-Vue ext-Vue line-numbers-mode"><pre class="language-Vue"><code>// user/cpns/user-search.vue
&lt;template&gt;
  &lt;div class=&quot;search&quot;&gt;
    &lt;el-form label-width=&quot;120px&quot; size=&quot;large&quot;&gt;
        &lt;el-row :gutter=&quot;20&quot;&gt;
            &lt;el-col :span=&quot;8&quot;&gt;
                &lt;el-form-item label=&quot;ç”¨æˆ·å&quot;&gt;
                    &lt;el-input placeholder=&quot;è¯·è¾“å…¥æŸ¥è¯¢çš„ç”¨æˆ·å&quot;&gt;&lt;/el-input&gt;
                &lt;/el-form-item&gt;
            &lt;/el-col&gt;
            &lt;el-col :span=&quot;8&quot;&gt;
                &lt;el-form-item label=&quot;çœŸå®å§“å&quot;&gt;
                    &lt;el-input placeholder=&quot;è¯·è¾“å…¥æŸ¥è¯¢çš„çœŸå®å§“å&quot;&gt;&lt;/el-input&gt;
                &lt;/el-form-item&gt;
            &lt;/el-col&gt;
            &lt;el-col :span=&quot;8&quot;&gt;
                &lt;el-form-item label=&quot;ç”µè¯å·ç &quot;&gt;
                    &lt;el-input placeholder=&quot;è¯·è¾“å…¥æŸ¥è¯¢çš„ç”µè¯å·ç &quot;&gt;&lt;/el-input&gt;
                &lt;/el-form-item&gt;
            &lt;/el-col&gt;

            &lt;!-- å¦èµ·ä¸€è¡Œ --&gt;
            &lt;el-col :span=&quot;8&quot;&gt;
                &lt;el-form-item label=&quot;çŠ¶æ€&quot;&gt;
                    &lt;el-select placeholder=&quot;è¯·é€‰æ‹©æŸ¥è¯¢çš„çŠ¶æ€&quot; style=&quot;width: 100%;&quot;&gt;
                        &lt;el-option label=&quot;å¯ç”¨&quot; :value=&quot;1&quot; /&gt;
                        &lt;el-option label=&quot;ç¦ç”¨&quot; :value=&quot;0&quot; /&gt;
                    &lt;/el-select&gt;
                &lt;/el-form-item&gt;
            &lt;/el-col&gt;
            &lt;el-col :span=&quot;8&quot;&gt;
                &lt;el-form-item label=&quot;åˆ›å»ºæ—¶é—´&quot;&gt;
                    &lt;el-date-picker
                        type=&quot;daterange&quot;
                        range-separator=&quot;-&quot;
                        start-placeholder=&quot;å¼€å§‹æ—¶é—´&quot;
                        end-placeholder=&quot;ç»“æŸæ—¶é—´&quot;
                    /&gt;
                &lt;/el-form-item&gt;
            &lt;/el-col&gt;
        &lt;/el-row&gt;
    &lt;/el-form&gt;

    &lt;div class=&quot;btns&quot;&gt;
        &lt;el-button icon=&quot;Refresh&quot; size=&quot;large&quot;&gt;é‡ç½®&lt;/el-button&gt;
        &lt;el-button icon=&quot;Search&quot; size=&quot;large&quot; type=&quot;primary&quot;&gt;æœç´¢&lt;/el-button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;

&lt;/script&gt;

&lt;style lang=&quot;less&quot; scoped&gt;
.search {
    background-color: #fff;
    padding: 20px;

    .el-form-item {
        padding: 20px;
        margin-bottom: 0;
    }

    .btns {
        text-align: right;
        padding: 0 50px 10px 0;
    }
}
&lt;/style&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯¹æ—¥æœŸé€‰æ‹©å™¨é‡Œçš„æ—¥æœŸå®ç°å›½é™…åŒ–ã€‚<a href="https://element-plus.gitee.io/zh-CN/guide/i18n.html" target="_blank" rel="noopener noreferrer">Element Plus<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> æä¾›äº†ä¸€ä¸ª Vue ç»„ä»¶ <a href="https://element-plus.gitee.io/en-US/component/config-provider.html" target="_blank" rel="noopener noreferrer">ConfigProvider<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> ï¼ˆ<code>el-config-provider</code>ï¼‰ç”¨äºå…¨å±€é…ç½®å›½é™…åŒ–çš„è®¾ç½®ã€‚ï¼ˆéœ€è¦åŒ…è£¹ App ç»„ä»¶ï¼‰å¹¶åœ¨<code>env.d.ts</code>ä¸­å£°æ˜<code>.mjs</code>æ–‡ä»¶</p><div class="language-Vue ext-Vue line-numbers-mode"><pre class="language-Vue"><code>// App.vue
&lt;template&gt;
    &lt;div class=&quot;app&quot;&gt;
      &lt;!-- å›½é™…åŒ–é…ç½®ï¼ˆå°†ç»„ä»¶ä¸­çš„è‹±æ–‡è½¬ä¸ºä¸­æ–‡-&gt;æ—¥æœŸç»„ä»¶ï¼‰ --&gt;
      &lt;el-config-provider :locale=&quot;zhCn&quot;&gt;
        &lt;router-view /&gt;
      &lt;/el-config-provider&gt;
    &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import zhCn from &#39;element-plus/dist/locale/zh-cn.mjs&#39;
&lt;/script&gt;

// env.d.ts
declare module &#39;*.vue&#39; {
    import { DefineComponent } from &#39;vue&#39;
    const component: DefineComponent
    export default component
}

// å£°æ˜å›½é™…åŒ–é…ç½®æ–‡ä»¶mjs
declare module &#39;*.mjs&#39;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å®ç°é‡ç½®åŠŸèƒ½" tabindex="-1"><a class="header-anchor" href="#å®ç°é‡ç½®åŠŸèƒ½" aria-hidden="true">#</a> å®ç°é‡ç½®åŠŸèƒ½</h4><p><code>el-form</code>è¡¨å•ç»„ä»¶è¦æƒ³è¾“å…¥å€¼ï¼Œéœ€è¦ä½¿ç”¨<code>reactive()</code>å’Œ<code>:model</code>ç»‘å®šå€¼ï¼Œå¹¶ä¸”åœ¨ç›¸åº”çš„ç»„ä»¶å¦‚<code>el-input</code>ä½¿ç”¨<code>v-model</code>ç»‘å®š<code>reactive</code>é‡Œé¢å¯¹åº”çš„å€¼ã€‚é‡ç½®å€¼è°ƒç”¨<code>formRef.value?.resetFields()</code>æ–¹æ³•ï¼ˆ<code>formRef</code>ç»‘å®šåˆ°<code>el-form</code>ä¸Šï¼Œ<code>el-form-item</code>ä¸Šæ·»åŠ å±æ€§<code>prop=&quot;xxx&quot;</code>å³å¯å®ç°ï¼‰</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>&lt;template&gt;
  &lt;div class=&quot;search&quot;&gt;
    &lt;el-form **:model=&quot;searchForm&quot; ref=&quot;formRef&quot;** label-width=&quot;120px&quot; size=&quot;large&quot;&gt;
        &lt;el-row :gutter=&quot;20&quot;&gt;
            &lt;el-col :span=&quot;8&quot;&gt;
                &lt;el-form-item label=&quot;ç”¨æˆ·å&quot; prop=&quot;name&quot;&gt;
                    &lt;el-input **v-model=&quot;searchForm.name&quot;** placeholder=&quot;è¯·è¾“å…¥æŸ¥è¯¢çš„ç”¨æˆ·å&quot;&gt;&lt;/el-input&gt;
                &lt;/el-form-item&gt;
            &lt;/el-col&gt;
       &lt;/el-row&gt;
    &lt;/el-form&gt;
    // ....
    &lt;div class=&quot;btns&quot;&gt;
        &lt;el-button icon=&quot;Refresh&quot; size=&quot;large&quot; @click=&quot;handleResetClick()&quot;&gt;é‡ç½®&lt;/el-button&gt;
        &lt;el-button icon=&quot;Search&quot; size=&quot;large&quot; type=&quot;primary&quot;&gt;æœç´¢&lt;/el-button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import { reactive, ref } from &quot;vue&quot;;
import type { ElForm } from &quot;element-plus&quot;;

const searchForm = reactive({
    name: &#39;&#39;,
    realname: &#39;&#39;,
    cellphone: &#39;&#39;,
    enable: 1,
    createAt: &#39;&#39;
})

// é‡ç½®åŠŸèƒ½
const formRef = ref&lt;InstanceType&lt;typeof ElForm&gt;&gt;()
function handleResetClick() {
    // æ–¹æ³•ä¸€
    // searchForm.name = &#39;&#39;
    // searchForm.realname = &#39;&#39;
    // searchForm.cellphone = &#39;&#39;
    // searchForm.enable = 1
    // searchForm.createAt = &#39;&#39;

    // æ–¹æ³•äºŒ
    formRef.value?.resetFields()
}
&lt;/script&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®ç°å±•ç¤ºç”¨æˆ·åˆ—è¡¨åŠŸèƒ½" tabindex="-1"><a class="header-anchor" href="#å®ç°å±•ç¤ºç”¨æˆ·åˆ—è¡¨åŠŸèƒ½" aria-hidden="true">#</a> å®ç°å±•ç¤ºç”¨æˆ·åˆ—è¡¨åŠŸèƒ½</h3><p><img src="https://secure2.wostatic.cn/static/hvmWHgnMCqqF1hKgZT64pQ/image.png" alt=""></p><h4 id="ä½¿ç”¨-pinia-å‘èµ·è·å–ç”¨æˆ·æ•°æ®è¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-pinia-å‘èµ·è·å–ç”¨æˆ·æ•°æ®è¯·æ±‚" aria-hidden="true">#</a> ä½¿ç”¨ pinia å‘èµ·è·å–ç”¨æˆ·æ•°æ®è¯·æ±‚</h4><p>ç¼–å†™<code>axios</code>è¯·æ±‚æ¥å£ï¼ˆä½¿ç”¨äº†<code>hyRequest</code>è¿›è¡Œäº†å°è£…ï¼Œç›´æ¥è°ƒç”¨å³å¯ï¼‰</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>import hyRequest from &quot;@/service&quot;;

// è·å–ç”¨æˆ·åˆ—è¡¨æ•°æ®
export function getUserListData() {
    return hyRequest.post({
        url: &#39;/users/list&#39;,
        data: {
            offset: 0,
            size: 10
        }
    })
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¼–å†™<code>pinia</code>è¿›è¡Œæ•°æ®å­˜å‚¨</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>import { getUserListData } from &quot;@/service/main/system/system&quot;;
import { defineStore } from &quot;pinia&quot;;
import type { ISystemState } from &quot;./type&quot;;

const useSystemStore = defineStore(&#39;system&#39;, {
    // ä½¿ç”¨typescriptè¿›è¡Œç±»å‹é™åˆ¶
    state: (): **ISystemState** =&gt; ({
        usersList: [],
        usersTotalCount: 0
    }),
    actions: {
        async getUsersListAction() {
            // è°ƒç”¨axiosè¯·æ±‚
            const userListResult = await getUserListData()
            const { totalCount, list } = userListResult.data
            // å­˜å…¥storeä¸­
            this.usersList = list
            this.usersTotalCount = totalCount
        }
    }
})

export default useSystemStore
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨<code>typescript</code>è¿›è¡Œç±»å‹é™åˆ¶</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// type.ts
export interface IUser {
    id: number
    name: string
    realname: string
    cellphone: number
    enable: number
    departmentId: number
    roleId: number
    createAt: string
    updateAt: string
}

export interface ISystemState {
    usersList: IUser[]
    usersTotalCount: number
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç”¨æˆ·åˆ—è¡¨é¡µé¢ï¼ˆ<code>user-content.vue</code>ï¼‰ä¸­è°ƒç”¨<code>pinia</code>ä¸­çš„<code>getUsersListAction</code>ï¼Œä»è€Œå‘èµ·è¯·æ±‚ã€‚</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// user-content.vue
&lt;script setup&gt;
import useSystemStore from &#39;@/store/main/system/system&#39;;
import { storeToRefs } from &#39;pinia&#39;;

// 1.å‘èµ·actionï¼Œè¯·æ±‚usersListæ•°æ®
const systemStore = useSystemStore()
systemStore.getUsersListAction()

// 2.è·å–usersListæ•°æ®(å“åº”å¼æ•°æ®ï¼šä¸Šé¢ä»£ç æ˜¯å¼‚æ­¥çš„ï¼Œå½“æ•°æ®è¿˜æ²¡æ‹¿åˆ°æ˜¯ï¼Œè¿™ä¸€å¥ä¸èµ·ä½œç”¨ï¼Œéœ€è¦ç”¨storeToRefs)
const { usersList } = storeToRefs(systemStore)
&lt;/script&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="åˆæ­¥æ­å»ºè¡¨æ ¼æ•°æ®é¡µé¢" tabindex="-1"><a class="header-anchor" href="#åˆæ­¥æ­å»ºè¡¨æ ¼æ•°æ®é¡µé¢" aria-hidden="true">#</a> åˆæ­¥æ­å»ºè¡¨æ ¼æ•°æ®é¡µé¢</h4><p>ä½¿ç”¨<code>el-table</code>åŠ<code>el-table-column</code>æ­å»ºè¡¨æ ¼æ•°æ®é¡µé¢ï¼Œ<code>prop</code>å¯¹åº”è¯·æ±‚æ•°æ®ä¸­ç›¸åº”çš„å±æ€§ï¼Œ<code>type</code>ä¸º<code>selection</code>å±•ç¤ºå‹¾é€‰æ¡†ï¼Œ<code>type</code>ä¸º<code>index</code>å±•ç¤ºç´¢å¼•å€¼ã€‚<code>el-table-column</code>å¯ä½œä¸ºæ’æ§½ä¼ å…¥å…¶å®ƒç»„ä»¶ï¼Œ<code>:data</code>ä¼ å…¥è¯·æ±‚è¿”å›çš„æ•°æ®ã€‚</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>&lt;template&gt;
    &lt;div class=&quot;content&quot;&gt;
      &lt;div class=&quot;header&quot;&gt;
        &lt;h2 class=&quot;title&quot;&gt;ç”¨æˆ·åˆ—è¡¨&lt;/h2&gt;
        &lt;el-button type=&quot;primary&quot;&gt;æ–°å»ºç”¨æˆ·&lt;/el-button&gt;
      &lt;/div&gt;
      &lt;div class=&quot;table&quot;&gt;
        &lt;el-table :data=&quot;usersList&quot; border style=&quot;width: 100%&quot;&gt;
            &lt;!-- å‹¾é€‰æ¡† --&gt;
            &lt;el-table-column align=&quot;center&quot; type=&quot;selection&quot; width=&quot;50px&quot;/&gt;
            &lt;!-- åºå· --&gt;
            &lt;el-table-column align=&quot;center&quot; type=&quot;index&quot; label=&quot;åºå·&quot; width=&quot;60px&quot;/&gt;

            &lt;el-table-column align=&quot;center&quot; prop=&quot;name&quot; label=&quot;ç”¨æˆ·å&quot; width=&quot;150px&quot; /&gt;
            &lt;el-table-column align=&quot;center&quot; prop=&quot;realname&quot; label=&quot;çœŸå®å§“å&quot; width=&quot;150px&quot;/&gt;
            &lt;el-table-column align=&quot;center&quot; prop=&quot;cellphone&quot; label=&quot;ç”µè¯å·ç &quot; width=&quot;150px&quot;/&gt;
            &lt;el-table-column align=&quot;center&quot; prop=&quot;enable&quot; label=&quot;çŠ¶æ€&quot; width=&quot;100px&quot;/&gt;
            &lt;el-table-column align=&quot;center&quot; prop=&quot;createAt&quot; label=&quot;åˆ›å»ºæ—¶é—´&quot; /&gt;
            &lt;el-table-column align=&quot;center&quot; prop=&quot;updateAt&quot; label=&quot;æ›´æ–°æ—¶é—´&quot; /&gt;

            &lt;el-table-column align=&quot;center&quot; label=&quot;æ“ä½œ&quot; width=&quot;150px&quot;&gt;
                &lt;el-button type=&quot;primary&quot; icon=&quot;Edit&quot; size=&quot;small&quot; text&gt;ç¼–è¾‘&lt;/el-button&gt;
                &lt;el-button type=&quot;danger &quot; icon=&quot;Delete&quot; size=&quot;small&quot; text&gt;åˆ é™¤&lt;/el-button&gt;
            &lt;/el-table-column&gt;
        &lt;/el-table&gt;
      &lt;/div&gt;
      &lt;div class=&quot;pagination&quot;&gt;åˆ†é¡µ&lt;/div&gt;
    &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import useSystemStore from &#39;@/store/main/system/system&#39;;
import { storeToRefs } from &#39;pinia&#39;;

// 1.å‘èµ·actionï¼Œè¯·æ±‚usersListæ•°æ®
const systemStore = useSystemStore()
systemStore.getUsersListAction()

// 2.è·å–usersListæ•°æ®(å“åº”å¼æ•°æ®ï¼šä¸Šé¢ä»£ç æ˜¯å¼‚æ­¥çš„ï¼Œå½“æ•°æ®è¿˜æ²¡æ‹¿åˆ°æ˜¯ï¼Œè¿™ä¸€å¥ä¸èµ·ä½œç”¨ï¼Œéœ€è¦ç”¨storeToRefs)
const { usersList } = storeToRefs(systemStore)
console.log(usersList);
&lt;/script&gt;

&lt;style lang=&quot;less&quot; scoped&gt;
.content {
    margin-top: 20px;
    padding: 20px;
    background-color: #fff;
}

.header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;

    .title {
        font-size: 22px;
    }
}

.table {
    :deep(.el-table__cell) {
        padding: 12px 0;
    }

    .el-button {
        margin-left: 0;
        padding: 5px 8px;
    }
}

&lt;/style&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ä½¿ç”¨ä½œç”¨åŸŸæ’æ§½å¤„ç†è¡¨æ ¼æ•°æ®ä¸­çš„çŠ¶æ€ä»¥åŠæ—¶é—´æ ¼å¼åŒ–" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨ä½œç”¨åŸŸæ’æ§½å¤„ç†è¡¨æ ¼æ•°æ®ä¸­çš„çŠ¶æ€ä»¥åŠæ—¶é—´æ ¼å¼åŒ–" aria-hidden="true">#</a> ä½¿ç”¨ä½œç”¨åŸŸæ’æ§½å¤„ç†è¡¨æ ¼æ•°æ®ä¸­çš„çŠ¶æ€ä»¥åŠæ—¶é—´æ ¼å¼åŒ–</h4><p>ç§‘æ™®ï¼šä½œç”¨åŸŸæ’æ§½ï¼ˆå­ç»„ä»¶æä¾›å†…å®¹ï¼ˆæ•°æ®ï¼‰ï¼Œåœ¨çˆ¶ç»„ä»¶ä¸­å±•ç¤ºï¼Œå»¶ä¼¸äº†å­ç»„ä»¶çš„ä½œç”¨åŸŸï¼‰ï¼Œæ’æ§½ï¼ˆçˆ¶ç»„ä»¶æä¾›å†…å®¹ï¼Œåœ¨å­ç»„ä»¶ä¸­å±•ç¤ºï¼‰</p><p><strong>å¤„ç†çŠ¶æ€å±æ€§</strong></p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// ....
&lt;el-table-column align=&quot;center&quot; prop=&quot;enable&quot; label=&quot;çŠ¶æ€&quot; width=&quot;100px&quot;&gt;
    &lt;!-- ä½œç”¨åŸŸæ’æ§½ --&gt;
    &lt;template #default=&quot;{ row }&quot;&gt;
        &lt;el-button size=&quot;small&quot; :type=&quot;row.enable ? &#39;primary&#39; : &#39;danger&#39;&quot; plain&gt;
            {{ row.enable ? &#39;å¯ç”¨&#39; : &#39;ç¦ç”¨&#39; }}
        &lt;/el-button&gt;
    &lt;/template&gt;
    //&lt;template #default=&quot;scope&quot;&gt;
    //    &lt;el-button size=&quot;small&quot; :type=&quot;scope.row.enable ? &#39;primary&#39; : &#39;danger&#39;&quot; plain&gt;
    //        {{ scope.row.enable ? &#39;å¯ç”¨&#39; : &#39;ç¦ç”¨&#39; }}
    //    &lt;/el-button&gt;
    //&lt;/template&gt;
&lt;/el-table-column&gt;
// ....
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>å¤„ç†æ—¶é—´æ ¼å¼</strong></p><p>å®‰è£… dayjsï¼š<code>npm install dayjs</code></p><p>å°è£…æ—¶é—´æ ¼å¼åŒ–å·¥å…·<code>format.ts</code></p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>import dayjs from &#39;dayjs&#39;
import utc from &#39;dayjs/plugin/utc&#39;

dayjs.extend(utc)

export function formatUTC(utcString: string, format = &#39;YYYY-MM-DD HH:mm:ss&#39;) {
    // utcOffsetä¸œå…«åŒºåç§»8å°æ—¶
    return dayjs.utc(utcString).utcOffset(8).format(format)
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä½œç”¨åŸŸæ’æ§½ä¸­ä½¿ç”¨<code>formatUTC</code></p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// ...
&lt;el-table-column align=&quot;center&quot; prop=&quot;createAt&quot; label=&quot;åˆ›å»ºæ—¶é—´&quot; &gt;
    &lt;template #default=&quot;scope&quot;&gt;
        {{ formatUTC(scope.row.createAt) }}
    &lt;/template&gt;
&lt;/el-table-column&gt;
// ...
&lt;script&gt;
import { formatUTC } from &#39;@/utils/format&#39;;
// ...
&lt;/script&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®ç°åˆ†é¡µåŠŸèƒ½" tabindex="-1"><a class="header-anchor" href="#å®ç°åˆ†é¡µåŠŸèƒ½" aria-hidden="true">#</a> å®ç°åˆ†é¡µåŠŸèƒ½</h3><p><img src="https://secure2.wostatic.cn/static/wdmWHB3M9KTmPDFXj5Wve6/image.png" alt=""></p><h4 id="ä»è¯·æ±‚æ¥å£ä¸­è·å–offsetå’Œsizeåˆ†é¡µæ•°æ®ã€‚" tabindex="-1"><a class="header-anchor" href="#ä»è¯·æ±‚æ¥å£ä¸­è·å–offsetå’Œsizeåˆ†é¡µæ•°æ®ã€‚" aria-hidden="true">#</a> ä»è¯·æ±‚æ¥å£ä¸­è·å–<code>offset</code>å’Œ<code>size</code>åˆ†é¡µæ•°æ®ã€‚</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>import hyRequest from &quot;@/service&quot;;

// è·å–ç”¨æˆ·åˆ—è¡¨æ•°æ®
export function getUserListData(queryInfo: any) {
    return hyRequest.post({
        url: &#39;/users/list&#39;,
        data: queryInfo
    })
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å‚æ•°ä¼ é€’" tabindex="-1"><a class="header-anchor" href="#å‚æ•°ä¼ é€’" aria-hidden="true">#</a> å‚æ•°ä¼ é€’</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>const useSystemStore = defineStore(&#39;system&#39;, {
    // ...
    actions: {
        async getUsersListAction(queryInfo: any) {
            // è°ƒç”¨axiosè¯·æ±‚
            const userListResult = await getUserListData(queryInfo)
            const { totalCount, list } = userListResult.data
            // ...
        }
    }
})
export default useSystemStore
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ä½¿ç”¨el-paginationå®Œæˆé¡µé¢æ­å»ºã€‚" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨el-paginationå®Œæˆé¡µé¢æ­å»ºã€‚" aria-hidden="true">#</a> ä½¿ç”¨<code>el-pagination</code>å®Œæˆé¡µé¢æ­å»ºã€‚</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// user-content.vue
// ....
&lt;div class=&quot;pagination&quot;&gt;
  &lt;el-pagination
      v-model:current-page=&quot;currentPage&quot;
      v-model:page-size=&quot;pageSize&quot;
      :page-sizes=&quot;[10, 20, 30]&quot;
      :small=&quot;small&quot;
      layout=&quot;sizes, prev, pager, next, jumper, total&quot;
      :total=&quot;usersTotalCount&quot;
      @size-change=&quot;handleSizeChange&quot;
      @current-change=&quot;handleCurrentChange&quot;
  /&gt;
&lt;/div&gt;

&lt;script setup&gt;
import { ref } from &#39;vue&#39;;

// 1.å‘èµ·actionï¼Œè¯·æ±‚usersListå’Œåˆ†é¡µæ•°æ®
const systemStore = useSystemStore()
const currentPage = ref(1)
const pageSize = ref(10)
fetchUserListData()

// 2.è·å–usersListå’ŒusersTotalCountæ•°æ®(å“åº”å¼æ•°æ®ï¼šä¸Šé¢ä»£ç æ˜¯å¼‚æ­¥çš„ï¼Œå½“æ•°æ®è¿˜æ²¡æ‹¿åˆ°æ˜¯ï¼Œè¿™ä¸€å¥ä¸èµ·ä½œç”¨ï¼Œéœ€è¦ç”¨storeToRefs)
const { usersList, usersTotalCount } = storeToRefs(systemStore)

// 3.åˆ†é¡µåŠŸèƒ½
function handleSizeChange() {
    fetchUserListData()
}

function handleCurrentChange() {
    fetchUserListData()
}

// 4.å®šä¹‰å‡½æ•°ï¼Œç”¨äºå‘é€ç½‘ç»œè¯·æ±‚
function fetchUserListData() {
    const size = pageSize.value
    const offset = (currentPage.value - 1) * size
    const info = { size, offset}

    // å‘èµ·ç½‘ç»œè¯·æ±‚
    systemStore.getUsersListAction(info)
}
&lt;/script&gt;

&lt;style lang=&quot;less&quot; scoped&gt;
.pagination {
    display: flex;
    justify-content: flex-end;
    margin-top: 10px;
}
&lt;/style&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®ç°æŸ¥è¯¢ç”¨æˆ·åŠŸèƒ½" tabindex="-1"><a class="header-anchor" href="#å®ç°æŸ¥è¯¢ç”¨æˆ·åŠŸèƒ½" aria-hidden="true">#</a> å®ç°æŸ¥è¯¢ç”¨æˆ·åŠŸèƒ½</h3><p><img src="https://secure2.wostatic.cn/static/ZU6FzP3sKV8Sdjrqc8PYh/image.png" alt=""></p><h4 id="é€šè¿‡äº‹ä»¶å°†è¡¨å•å†…å®¹ä¼ é€’ç»™çˆ¶ç»„ä»¶" tabindex="-1"><a class="header-anchor" href="#é€šè¿‡äº‹ä»¶å°†è¡¨å•å†…å®¹ä¼ é€’ç»™çˆ¶ç»„ä»¶" aria-hidden="true">#</a> é€šè¿‡äº‹ä»¶å°†è¡¨å•å†…å®¹ä¼ é€’ç»™çˆ¶ç»„ä»¶</h4><p>å­ä¼ çˆ¶ï¼šä½¿ç”¨<code>const emit = defineEmits(&#39;xxx&#39;)</code>ï¼Œ<code>emit(&#39;xxx&#39;)</code></p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// user-search.vue
&lt;template&gt;
    // ...
    &lt;div class=&quot;btns&quot;&gt;
        &lt;el-button icon=&quot;Refresh&quot; size=&quot;large&quot; @click=&quot;handleResetClick()&quot;&gt;é‡ç½®&lt;/el-button&gt;
        &lt;el-button icon=&quot;Search&quot; size=&quot;large&quot; type=&quot;primary&quot; @click = &quot;handleQueryClick()&quot;&gt;æœç´¢&lt;/el-button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import { reactive, ref } from &quot;vue&quot;;
import type { ElForm } from &quot;element-plus&quot;;

const emit = defineEmits([&#39;queryClick&#39;, &#39;resetClick&#39;])

const searchForm = reactive({
    name: &#39;&#39;,
    realname: &#39;&#39;,
    cellphone: &#39;&#39;,
    enable: 1,
    createAt: &#39;&#39;
})
// é‡ç½®åŠŸèƒ½
// ...

// æœç´¢åŠŸèƒ½
function handleQueryClick() {
    // é€šè¿‡äº‹ä»¶æŠ›å‡ºï¼ˆå­ä¼ çˆ¶ï¼‰
    emit(&#39;queryClick&#39;, searchForm)
}
&lt;/script&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="çˆ¶ç»„ä»¶æ¥å—äº‹ä»¶å¹¶è°ƒç”¨å¦ä¸€ä¸ªå­ç»„ä»¶æš´éœ²çš„å‡½æ•°" tabindex="-1"><a class="header-anchor" href="#çˆ¶ç»„ä»¶æ¥å—äº‹ä»¶å¹¶è°ƒç”¨å¦ä¸€ä¸ªå­ç»„ä»¶æš´éœ²çš„å‡½æ•°" aria-hidden="true">#</a> çˆ¶ç»„ä»¶æ¥å—äº‹ä»¶å¹¶è°ƒç”¨å¦ä¸€ä¸ªå­ç»„ä»¶æš´éœ²çš„å‡½æ•°</h4><p>å­ä¼ çˆ¶ä¹Ÿå¯ä»¥ç”¨<code>defineExpose()</code>ï¼Œè¿™é‡Œ<code>user-content</code>å­ç»„ä»¶ä½¿ç”¨æ­¤å‡½æ•°æ¥å—çˆ¶ç»„ä»¶ï¼ˆç”±<code>user-search</code>ä¼ è¿‡æ¥ï¼‰ä¼ è¿‡æ¥çš„<code>searchForm</code>ä¿¡æ¯ã€‚</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// user.vue
&lt;template&gt;
  &lt;div class=&quot;user&quot;&gt;
    &lt;user-search @query-click=&quot;handleQueryClick&quot; @reset-click=&quot;handleResetClick&quot;/&gt;
    &lt;user-content ref=&quot;contentRef&quot;/&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import { ref } from &#39;vue&#39;
import userContent from &#39;./cpns/user-content.vue&#39;
import userSearch from &#39;./cpns/user-search.vue&#39;

const contentRef = ref&lt;InstanceType&lt;typeof userContent&gt;&gt;()
function handleQueryClick(searchInfo: any) {
  contentRef.value?.fetchUserListData(searchInfo)
}

function handleResetClick() {
  contentRef.value?.fetchUserListData()
}
&lt;/script&gt;

&lt;style lang=&quot;less&quot; scoped&gt;

&lt;/style&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>&lt;template&gt;
  // ...
&lt;/template&gt;

&lt;script setup&gt;
// ...
// 4.å®šä¹‰å‡½æ•°ï¼Œç”¨äºå‘é€ç½‘ç»œè¯·æ±‚
function fetchUserListData(formData: any = {}) {
    const size = pageSize.value
    const offset = (currentPage.value - 1) * size
    const pageInfo = { size, offset}

    const queryInfo = { ...formData, ...pageInfo }
    // å‘èµ·ç½‘ç»œè¯·æ±‚
    systemStore.getUsersListAction(queryInfo)
}

// æš´éœ²å‡½æ•°ç»™çˆ¶ç»„ä»¶
defineExpose({
    fetchUserListData
})
&lt;/script&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®ç°åˆ é™¤ç”¨æˆ·åŠŸèƒ½" tabindex="-1"><a class="header-anchor" href="#å®ç°åˆ é™¤ç”¨æˆ·åŠŸèƒ½" aria-hidden="true">#</a> å®ç°åˆ é™¤ç”¨æˆ·åŠŸèƒ½</h3><p><img src="https://secure2.wostatic.cn/static/aX3DHhVE3tdWi7KgXFukZ6/image.png" alt=""></p><p>é€šè¿‡ä½œç”¨åŸŸæ’æ§½è·å–å½“å‰ç‚¹å‡»åˆ é™¤æŒ‰é’®é‚£ä¸€è¡Œçš„ç”¨æˆ·<code>id</code>ï¼Œå³<code>scope.row.id</code>ï¼Œå°†<code>id</code>ä¼ å…¥ç”¨æˆ·åˆ é™¤æ¥å£ã€‚</p><h4 id="å°è£…åˆ é™¤ç”¨æˆ·æ•°æ®æ¥å£" tabindex="-1"><a class="header-anchor" href="#å°è£…åˆ é™¤ç”¨æˆ·æ•°æ®æ¥å£" aria-hidden="true">#</a> å°è£…åˆ é™¤ç”¨æˆ·æ•°æ®æ¥å£</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>import hyRequest from &quot;@/service&quot;;
// ...
// åˆ é™¤ç”¨æˆ·æ•°æ®
export function deleteUserData(id: number) {
    return hyRequest.delete({
        url: `/users/${id}`
    })
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="pinia-ä¸­è°ƒç”¨æ¥å£çš„-actions" tabindex="-1"><a class="header-anchor" href="#pinia-ä¸­è°ƒç”¨æ¥å£çš„-actions" aria-hidden="true">#</a> pinia ä¸­è°ƒç”¨æ¥å£çš„ actions</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>const useSystemStore = defineStore(&#39;system&#39;, {
    state: (): ISystemState =&gt; ({
        // ...
    }),
    actions: {
        // ...
        // åˆ é™¤ç”¨æˆ·æ•°æ®
        async deleteUserDataAction(id: number) {
            // è°ƒç”¨axiosè¯·æ±‚
            const res = await deleteUserData(id)
            // é‡æ–°è¯·æ±‚æ•°æ®åˆ·æ–°é¡µé¢
            this.getUsersListAction({ offset: 0, size: 10 })
        }
    }
})

export default useSystemStore
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="é¡µé¢ä¸­è·å–-id-ä¼ å…¥-actions" tabindex="-1"><a class="header-anchor" href="#é¡µé¢ä¸­è·å–-id-ä¼ å…¥-actions" aria-hidden="true">#</a> é¡µé¢ä¸­è·å– id ä¼ å…¥ actions</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>&lt;template&gt;
    &lt;div class=&quot;content&quot;&gt;
      // ...
      &lt;div class=&quot;table&quot;&gt;
        &lt;el-table :data=&quot;usersList&quot; border style=&quot;width: 100%&quot;&gt;
            // ...
            &lt;el-table-column align=&quot;center&quot; label=&quot;æ“ä½œ&quot; width=&quot;150px&quot;&gt;
                &lt;template #default=&quot;scope&quot;&gt;
                    &lt;el-button type=&quot;primary&quot; icon=&quot;Edit&quot; size=&quot;small&quot; text&gt;ç¼–è¾‘&lt;/el-button&gt;
                    &lt;el-button type=&quot;danger&quot; icon=&quot;Delete&quot; size=&quot;small&quot; text @click=&quot;handleDeleteClick(scope.row.id)&quot;&gt;åˆ é™¤&lt;/el-button&gt;
                &lt;/template&gt;
            &lt;/el-table-column&gt;
        &lt;/el-table&gt;
      &lt;/div&gt;
    &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import useSystemStore from &#39;@/store/main/system/system&#39;;
// ...
const systemStore = useSystemStore()

// åˆ é™¤ç”¨æˆ·æ•°æ®
function handleDeleteClick(id) {
    systemStore.deleteUserDataAction(id)
}

&lt;/script&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®ç°æ–°å¢ç”¨æˆ·åŠŸèƒ½" tabindex="-1"><a class="header-anchor" href="#å®ç°æ–°å¢ç”¨æˆ·åŠŸèƒ½" aria-hidden="true">#</a> å®ç°æ–°å¢ç”¨æˆ·åŠŸèƒ½</h3><p><img src="https://secure2.wostatic.cn/static/kiR4cMYTVrkxP3VvGP72Rz/image.png" alt=""></p><p>ç”±äºæ–°å»ºç”¨æˆ·æŒ‰é’®åœ¨<code>user-content.vue</code>é¡µé¢ä¸­ï¼Œä¸<code>user-modal.vue</code>æ˜¯å…„å¼Ÿç»„ä»¶ï¼Œéœ€è¦ç”¨åˆ°ç»„ä»¶é€šä¿¡ï¼Œç”±<code>user-content.vue</code>å‘èµ·äº‹ä»¶<code>defineEmits()</code></p><h4 id="åˆæ­¥æ­å»ºæ¨¡æ€æ¡†é¡µé¢" tabindex="-1"><a class="header-anchor" href="#åˆæ­¥æ­å»ºæ¨¡æ€æ¡†é¡µé¢" aria-hidden="true">#</a> åˆæ­¥æ­å»ºæ¨¡æ€æ¡†é¡µé¢</h4><p>ä½¿ç”¨<code>el-dialog</code>ç»„ä»¶å®ç°ï¼Œ<code>v-model</code>ç»‘å®šæ¨¡æ€æ¡†çš„<code>dialogVisible</code>å¯è§å€¼ï¼Œå°è£…åˆ°å‡½æ•°ä¸­ï¼Œå°†å…¶æš´éœ²ç»™çˆ¶ç»„ä»¶ã€‚</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// user-modal.vue
&lt;template&gt;
  &lt;div class=&quot;modal&quot;&gt;
    &lt;el-dialog v-model=&quot;dialogVisible&quot; title=&quot;æ–°å»ºç”¨æˆ·&quot; width=&quot;30%&quot; center&gt;
    &lt;div class=&quot;form&quot;&gt;
        &lt;el-form :model=&quot;formData&quot; label-width=&quot;80px&quot; size=&quot;large&quot;&gt;
            &lt;el-form-item label=&quot;ç”¨æˆ·å&quot; prop=&quot;name&quot;&gt;
                &lt;el-input v-model=&quot;formData.name&quot; placeholder=&quot;è¯·è¾“å…¥ç”¨æˆ·å&quot;&gt;&lt;/el-input&gt;
            &lt;/el-form-item&gt;
            &lt;el-form-item label=&quot;çœŸå®å§“å&quot; prop=&quot;realname&quot;&gt;
                &lt;el-input v-model=&quot;formData.realname&quot; placeholder=&quot;è¯·è¾“å…¥çœŸå®å§“å&quot;&gt;&lt;/el-input&gt;
            &lt;/el-form-item&gt;
            &lt;el-form-item label=&quot;å¯†ç &quot; prop=&quot;password&quot;&gt;
                &lt;el-input v-model=&quot;formData.password&quot; placeholder=&quot;è¯·è¾“å…¥å¯†ç &quot; show-password&gt;&lt;/el-input&gt;
            &lt;/el-form-item&gt;
            &lt;el-form-item label=&quot;ç”µè¯å·ç &quot; prop=&quot;cellphone&quot;&gt;
                &lt;el-input v-model=&quot;formData.cellphone&quot; placeholder=&quot;è¯·è¾“å…¥ç”µè¯å·ç &quot;&gt;&lt;/el-input&gt;
            &lt;/el-form-item&gt;
            &lt;el-form-item label=&quot;é€‰æ‹©è§’è‰²&quot; prop=&quot;roleId&quot;&gt;
                &lt;el-select v-model=&quot;formData.roleId&quot; placeholder=&quot;è¯·é€‰æ‹©è§’è‰²&quot; style=&quot;width: 100%&quot;&gt;&lt;/el-select&gt;
            &lt;/el-form-item&gt;
            &lt;el-form-item label=&quot;é€‰æ‹©éƒ¨é—¨&quot; prop=&quot;departmentId&quot;&gt;
                &lt;el-select v-model=&quot;formData.departmentId&quot; placeholder=&quot;è¯·é€‰æ‹©éƒ¨é—¨&quot; style=&quot;width: 100%&quot;&gt;&lt;/el-select&gt;
            &lt;/el-form-item&gt;
        &lt;/el-form&gt;
    &lt;/div&gt;
    &lt;template #footer&gt;
      &lt;span class=&quot;dialog-footer&quot;&gt;
        &lt;el-button @click=&quot;dialogVisible = false&quot;&gt;å–æ¶ˆ&lt;/el-button&gt;
        &lt;el-button type=&quot;primary&quot; @click=&quot;dialogVisible = false&quot;&gt;ç¡®å®š&lt;/el-button&gt;
      &lt;/span&gt;
    &lt;/template&gt;
  &lt;/el-dialog&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import { reactive, ref } from &quot;vue&quot;;

const dialogVisible = ref(false)
const formData = reactive({
    name: &#39;&#39;,
    realname: &#39;&#39;,
    password: &#39;&#39;,
    cellphone: &#39;&#39;,
    roleId: &#39;&#39;,
    departmentId: &#39;&#39;
})

function setDialogVisible() {
  dialogVisible.value = true
}

defineExpose({
    setDialogVisible
})
&lt;/script&gt;

&lt;style lang=&quot;less&quot; scoped&gt;

&lt;/style&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ç‚¹å‡»æ–°å»ºç”¨æˆ·æŒ‰é’®å‘èµ·ç»„ä»¶é€šä¿¡</strong></p><p>ä½¿ç”¨<code>defineEmits</code>å‘èµ·ç‚¹å‡»äº‹ä»¶ä¼ é€’ç»™çˆ¶ç»„ä»¶<code>user.vue</code>ã€‚</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// user-content.vue
&lt;template&gt;
    &lt;div class=&quot;content&quot;&gt;
      &lt;div class=&quot;header&quot;&gt;
        &lt;h2 class=&quot;title&quot;&gt;ç”¨æˆ·åˆ—è¡¨&lt;/h2&gt;
        &lt;el-button type=&quot;primary&quot; @click=&quot;handleNewData&quot;&gt;æ–°å»ºç”¨æˆ·&lt;/el-button&gt;
      &lt;/div&gt;
      &lt;div class=&quot;table&quot;&gt;
        &lt;el-table :data=&quot;usersList&quot; border style=&quot;width: 100%&quot;&gt;
           // ...
        &lt;/el-table&gt;
      &lt;/div&gt;
    &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
// ...
const emit = defineEmits([&#39;newDataClick&#39;])

// 6.æ–°å»ºç”¨æˆ·åŠŸèƒ½
function handleNewData() {
    emit(&#39;newDataClick&#39;)
}
&lt;/script&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>çˆ¶ç»„ä»¶è·å–äº‹ä»¶</strong></p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// user.vue
&lt;template&gt;
  &lt;div class=&quot;user&quot;&gt;
    // ...
    &lt;user-content ref=&quot;contentRef&quot; @new-data-click=&quot;handleNewDataClick&quot;/&gt;
    &lt;user-modal ref=&quot;modalRef&quot;/&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import userModal from &#39;./cpns/user-modal.vue&#39;

const modalRef = ref&lt;InstanceType&lt;typeof userModal&gt;&gt;()

// æ–°å¢ç”¨æˆ·åŠŸèƒ½
function handleNewDataClick() {
  modalRef.value?.setDialogVisible()
}
&lt;/script&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å…¨å±€å°è£…è·å–è§’è‰²å’Œéƒ¨é—¨çš„è¯·æ±‚æ¥å£æ•°æ®" tabindex="-1"><a class="header-anchor" href="#å…¨å±€å°è£…è·å–è§’è‰²å’Œéƒ¨é—¨çš„è¯·æ±‚æ¥å£æ•°æ®" aria-hidden="true">#</a> å…¨å±€å°è£…è·å–è§’è‰²å’Œéƒ¨é—¨çš„è¯·æ±‚æ¥å£æ•°æ®</h4><p><code>service</code>å±‚ä½¿ç”¨<code>hyRequest</code>å°è£…æ¥å£ã€‚</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// serivce/main.ts
import hyRequest from &quot;..&quot;;

export function getEntireRoles() {
    return hyRequest.post({
        url: &quot;/role/list&quot;
    })
}

export function getEntireDepartments() {
    return hyRequest.post({
        url: &quot;/department/list&quot;
    })
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>pinia</code>è°ƒç”¨æ¥å£å­˜å‚¨åœ¨æœ¬åœ°<code>store</code>ã€‚</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// store/main.ts
import { getEntireDepartments, getEntireRoles } from &quot;@/service/main/main&quot;;
import { defineStore } from &quot;pinia&quot;;

interface IMainState {
    entireRoles: any[]
    entireDepartments: any[]
}

const useMainStore = defineStore(&#39;main&#39;, {
    state: (): IMainState =&gt; ({
        entireRoles: [],
        entireDepartments: []
    }),
    actions: {
        async fetchEntireDataAction() {
            const rolesResult = await getEntireRoles()
            const departmentResult = await getEntireDepartments()
            this.entireRoles = rolesResult.data.list
            this.entireDepartments = departmentResult.data.list
        }
    }
})
export default useMainStore
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ç™»å½•<code>actions</code>ä¸­å‘èµ·è°ƒç”¨ã€‚</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// store/login.ts
import useMainStore from &quot;../main/main&quot;;

interface ILoginState {
    token: string,
    userInfo: any,
    userMenus: any[]
}

const useLoginStore = defineStore(&#39;login&#39;, {
    state: (): ILoginState =&gt; ({
        token: &#39;&#39;,
        userInfo: {},
        userMenus: []
    }),
    actions: {
        async loginAccountAction(account: IAccount) {
            // ...

            // 6.è¯·æ±‚æ‰€æœ‰roles/departmentæ•°æ®(åˆ·æ–°æ—¶æ•°æ®ä¼šæ¶ˆå¤±)
            const mainStore = useMainStore()
            mainStore.fetchEntireDataAction()

            //  é¡µé¢è·³è½¬
            router.push(&#39;/main&#39;)
        },

        // è§£å†³åˆ·æ–°é¡µé¢åï¼ŒåŠ¨æ€è·¯ç”±ä¸¢å¤±çš„é—®é¢˜(ä¸å†æ˜¯loginAccountActionç™»å½•æ—¶æ‰æ‰§è¡Œ)
        loadLocalDataAction() {
            // ...
            if(token &amp;&amp; userInfo &amp;&amp; userMenus) {
                // ...
                // è¯·æ±‚æ‰€æœ‰roles/departmentæ•°æ®(åˆ·æ–°æ—¶æ•°æ®ä¸ä¼šæ¶ˆå¤±ï¼Œç»å¸¸å˜åŒ–ï¼Œä¸æ”¾ç¼“å­˜ï¼Œåˆ·æ–°æ—¶è¯·æ±‚æœ€æ–°çš„)
                const mainStore = useMainStore()
                mainStore.fetchEntireDataAction()
                // ...
            }
        }
    }
})

export default useLoginStore
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å¤„ç†è§’è‰²å’Œéƒ¨é—¨ä¸‹æ‹‰æ¡†" tabindex="-1"><a class="header-anchor" href="#å¤„ç†è§’è‰²å’Œéƒ¨é—¨ä¸‹æ‹‰æ¡†" aria-hidden="true">#</a> å¤„ç†è§’è‰²å’Œéƒ¨é—¨ä¸‹æ‹‰æ¡†</h4><p>åœ¨<code>el-select</code>ä¸­ä½¿ç”¨<code>v-for</code>å¾ªç¯éå†<code>el-option</code>ï¼ŒåŠ¨æ€å›æ˜¾åˆ°<code>label</code>å±æ€§ä¸­ã€‚è§’è‰²å’Œéƒ¨é—¨æ•°æ®ä»<code>pinia</code>ä¸­è·å–ã€‚</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>&lt;template&gt;
  &lt;div class=&quot;modal&quot;&gt;
    &lt;el-dialog v-model=&quot;dialogVisible&quot; title=&quot;æ–°å»ºç”¨æˆ·&quot; width=&quot;30%&quot; center&gt;
    &lt;div class=&quot;form&quot;&gt;
        &lt;el-form :model=&quot;formData&quot; label-width=&quot;80px&quot; size=&quot;large&quot;&gt;
            // ...
            &lt;el-form-item label=&quot;é€‰æ‹©è§’è‰²&quot; prop=&quot;roleId&quot;&gt;
                &lt;el-select v-model=&quot;formData.roleId&quot; placeholder=&quot;è¯·é€‰æ‹©è§’è‰²&quot; style=&quot;width: 100%&quot;&gt;
                    &lt;template v-for=&quot;item in entireRoles&quot; :key=&quot;item.id&quot;&gt;
                        &lt;el-option :label=&quot;item.name&quot; :value=&quot;item.id&quot;/&gt;
                    &lt;/template&gt;
                &lt;/el-select&gt;
            &lt;/el-form-item&gt;
            &lt;el-form-item label=&quot;é€‰æ‹©éƒ¨é—¨&quot; prop=&quot;departmentId&quot;&gt;
                &lt;el-select v-model=&quot;formData.departmentId&quot; placeholder=&quot;è¯·é€‰æ‹©éƒ¨é—¨&quot; style=&quot;width: 100%&quot;&gt;
                    &lt;template v-for=&quot;item in entireDepartments&quot; :key=&quot;item.id&quot;&gt;
                        &lt;el-option :label=&quot;item.name&quot; :value=&quot;item.id&quot;/&gt;
                    &lt;/template&gt;
                &lt;/el-select&gt;
            &lt;/el-form-item&gt;
        &lt;/el-form&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import useMainStore from &quot;@/store/main/main&quot;;
import { storeToRefs } from &quot;pinia&quot;;
// ...

// è·å–roles/departmentsæ•°æ®
const mainStore = useMainStore()
const { entireRoles, entireDepartments } = storeToRefs(mainStore)
// ...
&lt;/script&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å°è£…æ–°å»ºç”¨æˆ·è¯·æ±‚æ¥å£å¹¶è°ƒç”¨" tabindex="-1"><a class="header-anchor" href="#å°è£…æ–°å»ºç”¨æˆ·è¯·æ±‚æ¥å£å¹¶è°ƒç”¨" aria-hidden="true">#</a> å°è£…æ–°å»ºç”¨æˆ·è¯·æ±‚æ¥å£å¹¶è°ƒç”¨</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>//sevice/main/system/system.ts
import hyRequest from &quot;@/service&quot;;
// è·å–ç”¨æˆ·åˆ—è¡¨æ•°æ®...

// åˆ é™¤ç”¨æˆ·æ•°æ®...

// æ–°å»ºç”¨æˆ·æ•°æ®
export function newUserData(userInfo: any) {
    return hyRequest.post({
        url: &#39;/users&#39;,
        data: userInfo
    })
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>import { deleteUserData, getUserListData, newUserData } from &quot;@/service/main/system/system&quot;;
// ...
const useSystemStore = defineStore(&#39;system&#39;, {
    state: (): ISystemState =&gt; ({
        usersList: [],
        usersTotalCount: 0
    }),
    actions: {
        // è·å–ç”¨æˆ·æ•°æ®åˆ—è¡¨...

        // åˆ é™¤ç”¨æˆ·æ•°æ®...

        // æ–°å¢ç”¨æˆ·æ•°æ®
        async newUserDataAction(userInfo: any) {
            // åˆ›å»ºæ–°çš„ç”¨æˆ·
            const newResult =  await newUserData(userInfo)
            // é‡æ–°å‘é€è¯·æ±‚æ•°æ®åˆ·æ–°é¡µé¢
            this.getUsersListAction({ offset: 0, size: 10 })
        }
    }
})
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>&lt;template&gt;
  &lt;div class=&quot;modal&quot;&gt;
    &lt;el-dialog v-model=&quot;dialogVisible&quot; title=&quot;æ–°å»ºç”¨æˆ·&quot; width=&quot;30%&quot; center&gt;
        &lt;div class=&quot;form&quot;&gt;
            // ...
        &lt;/div&gt;
        &lt;template #footer&gt;
            &lt;span class=&quot;dialog-footer&quot;&gt;
                &lt;el-button @click=&quot;dialogVisible = false&quot;&gt;å–æ¶ˆ&lt;/el-button&gt;
                &lt;el-button type=&quot;primary&quot; @click=&quot;handleConfirmClick&quot;&gt;ç¡®å®š&lt;/el-button&gt;
            &lt;/span&gt;
        &lt;/template&gt;
    &lt;/el-dialog&gt;
  &lt;/div&gt;
&lt;/template&gt;
&lt;script setup lang=&quot;ts&quot;&gt;
import useSystemStore from &quot;@/store/main/system/system&quot;;

const dialogVisible = ref(false)
const formData = reactive({
    name: &#39;&#39;,
    realname: &#39;&#39;,
    password: &#39;&#39;,
    cellphone: &#39;&#39;,
    roleId: &#39;&#39;,
    departmentId: &#39;&#39;
})

const systemStore = useSystemStore()
// ...

// dialogç‚¹å‡»ç¡®å®šæŒ‰é’®é€»è¾‘
function handleConfirmClick() {
    // å…³é—¨dialog
    dialogVisible.value = false
    // å‘é€æ–°å»ºç”¨æˆ·è¯·æ±‚
    systemStore.newUserDataAction(formData)
}
&lt;/script&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®ç°ç¼–è¾‘ç”¨æˆ·åŠŸèƒ½" tabindex="-1"><a class="header-anchor" href="#å®ç°ç¼–è¾‘ç”¨æˆ·åŠŸèƒ½" aria-hidden="true">#</a> å®ç°ç¼–è¾‘ç”¨æˆ·åŠŸèƒ½</h3><p><img src="https://secure2.wostatic.cn/static/2kTCgLjUXD2ooG3Tvr3TMx/image.png" alt=""></p><h4 id="å°è£…ä¿®æ”¹ç”¨æˆ·è¯·æ±‚æ¥å£" tabindex="-1"><a class="header-anchor" href="#å°è£…ä¿®æ”¹ç”¨æˆ·è¯·æ±‚æ¥å£" aria-hidden="true">#</a> å°è£…ä¿®æ”¹ç”¨æˆ·è¯·æ±‚æ¥å£</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>import hyRequest from &quot;@/service&quot;;
// ...
// ç¼–è¾‘ç”¨æˆ·æ•°æ®
export function editUserData(id: number, userInfo: any) {
    return hyRequest.patch({
        url: `/users/${id}`,
        data: userInfo
    })
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="pinia-ä¸­è°ƒç”¨æ¥å£çš„-actions-1" tabindex="-1"><a class="header-anchor" href="#pinia-ä¸­è°ƒç”¨æ¥å£çš„-actions-1" aria-hidden="true">#</a> pinia ä¸­è°ƒç”¨æ¥å£çš„ actions</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>import { deleteUserData, editUserData, getUserListData, newUserData } from &quot;@/service/main/system/system&quot;;

const useSystemStore = defineStore(&#39;system&#39;, {
    state: (): ISystemState =&gt; ({
        // ...
    }),
    actions: {
        // ...
        // ç¼–è¾‘ç”¨æˆ·æ•°æ®
        async editUserDataAction(id: number, userInfo: any) {
            const editResult = await editUserData(id, userInfo)
            this.getUsersListAction({ offset: 0, size: 10 })
        }
    }
})

export default useSystemStore
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å®ç°ç‚¹å‡»ç¼–è¾‘æŒ‰é’®å¼¹å‡ºæ¨¡æ€æ¡†" tabindex="-1"><a class="header-anchor" href="#å®ç°ç‚¹å‡»ç¼–è¾‘æŒ‰é’®å¼¹å‡ºæ¨¡æ€æ¡†" aria-hidden="true">#</a> å®ç°ç‚¹å‡»ç¼–è¾‘æŒ‰é’®å¼¹å‡ºæ¨¡æ€æ¡†</h4><p>ä½¿ç”¨ä½œç”¨åŸŸæ’æ§½å°†å­ç»„ä»¶<code>user-content</code>çš„ç‚¹å‡»äº‹ä»¶å‘é€ç»™çˆ¶ç»„ä»¶ã€‚</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// user-content.vue
&lt;template&gt;
    &lt;div class=&quot;content&quot;&gt;
      // ...
      &lt;div class=&quot;table&quot;&gt;
        &lt;el-table :data=&quot;usersList&quot; border style=&quot;width: 100%&quot;&gt;
            // ...
            &lt;el-table-column align=&quot;center&quot; label=&quot;æ“ä½œ&quot; width=&quot;150px&quot;&gt;
                &lt;template #default=&quot;scope&quot;&gt;
                    &lt;el-button type=&quot;primary&quot; icon=&quot;Edit&quot; size=&quot;small&quot; text @click=&quot;handleEditClick(scope.row)&quot;&gt;ç¼–è¾‘&lt;/el-button&gt;
                    &lt;el-button type=&quot;danger&quot; icon=&quot;Delete&quot; size=&quot;small&quot; text @click=&quot;handleDeleteClick(scope.row.id)&quot;&gt;åˆ é™¤&lt;/el-button&gt;
                &lt;/template&gt;
            &lt;/el-table-column&gt;
        &lt;/el-table&gt;
      &lt;/div&gt;
    &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
// ...
const emit = defineEmits([&#39;newDataClick&#39;, &#39;editDataClick&#39;])
// ...

// 7.ç¼–è¾‘ç”¨æˆ·åŠŸèƒ½
function handleEditClick(itemData) {
    emit(&#39;editDataClick&#39;, itemData)
}
&lt;/script&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>çˆ¶ç»„ä»¶æ¥å—ç‚¹å‡»äº‹ä»¶ã€‚</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>&lt;template&gt;
  &lt;div class=&quot;user&quot;&gt;
    // ...
    &lt;user-content ref=&quot;contentRef&quot; @new-data-click=&quot;handleNewDataClick&quot; @edit-data-click=&quot;handleEditDataClick&quot;/&gt;
    &lt;user-modal ref=&quot;modalRef&quot;/&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import userModal from &#39;./cpns/user-modal.vue&#39;
// ...

const modalRef = ref&lt;InstanceType&lt;typeof userModal&gt;&gt;()
// ...
// ç¼–è¾‘ç”¨æˆ·åŠŸèƒ½
function handleEditDataClick(itemData: any) {
  // setDialogVisibleç”±user-modalå­ç»„ä»¶æš´éœ²å‡ºæ¥çš„æ–¹æ³•
  modalRef.value?.setDialogVisible(false, itemData)
}
&lt;/script&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å­ç»„ä»¶<code>user-modal</code>æ¥å—çˆ¶ç»„ä»¶ä¼ æ¥çš„æ–¹æ³•å’Œå‚æ•°ã€‚å¯¹æ¨¡æ€æ¡†çš„è¡¨å•å†…å®¹è¿›è¡Œåˆ¤æ–­ï¼Œåœ¨ç¼–è¾‘æ•°æ®æ—¶é™¤äº†å¯†ç ï¼Œå…¶å®ƒå±æ€§éƒ½è¿›è¡Œå›æ˜¾ï¼Œ<code>title</code>å˜ä¸ºç¼–è¾‘ç”¨æˆ·æ–‡æœ¬ã€‚</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>&lt;template&gt;
  &lt;div class=&quot;modal&quot;&gt;
    &lt;el-dialog v-model=&quot;dialogVisible&quot; :title=&quot;isNewRef? &#39;æ–°å»ºç”¨æˆ·&#39;: &#39;ç¼–è¾‘ç”¨æˆ·&#39;&quot; width=&quot;30%&quot; center&gt;
        &lt;div class=&quot;form&quot;&gt;
            &lt;el-form :model=&quot;formData&quot; label-width=&quot;80px&quot; size=&quot;large&quot;&gt;
                // ç¼–è¾‘æ•°æ®æ—¶å¯†ç ä¸è¿›è¡Œå›æ˜¾ã€‚
                &lt;el-form-item v-if=&quot;isNewRef&quot; label=&quot;å¯†ç &quot; prop=&quot;password&quot;&gt;
                    &lt;el-input v-model=&quot;formData.password&quot; placeholder=&quot;è¯·è¾“å…¥å¯†ç &quot; show-password&gt;&lt;/el-input&gt;
                &lt;/el-form-item&gt;
                // ...
            &lt;/el-form&gt;
        &lt;/div&gt;
        &lt;template #footer&gt;
            &lt;span class=&quot;dialog-footer&quot;&gt;
                &lt;el-button @click=&quot;dialogVisible = false&quot;&gt;å–æ¶ˆ&lt;/el-button&gt;
                &lt;el-button type=&quot;primary&quot; @click=&quot;handleConfirmClick&quot;&gt;ç¡®å®š&lt;/el-button&gt;
            &lt;/span&gt;
        &lt;/template&gt;
    &lt;/el-dialog&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import useSystemStore from &quot;@/store/main/system/system&quot;;
// ...

const dialogVisible = ref(false)
// ç¼–è¾‘æ—¶å¯†ç ä¸æ˜¾ç¤º
const isNewRef = ref(false)
const editData = ref()

const formData = reactive&lt;any&gt;({
    name: &#39;&#39;,
    realname: &#39;&#39;,
    password: &#39;&#39;,
    cellphone: &#39;&#39;,
    roleId: &#39;&#39;,
    departmentId: &#39;&#39;
})

// ...
// å®šä¹‰è®¾ç½®dialogVisibleçš„æ–¹æ³•
function setDialogVisible(isNew: boolean = true, itemData?: any) {
  dialogVisible.value = true
  isNewRef.value = isNew
  // æ¨¡æ€æ¡†è¡¨å•å›æ˜¾
  if(!isNew &amp;&amp; itemData) {
    // ç¼–è¾‘æ•°æ®
    for(const key in formData) {
        // keyä¸ä¸€å®šåœ¨formDataä¸­,æ‰€ä»¥éœ€è¦åŠ ç±»å‹åˆ¤æ–­any(reactive&lt;any&gt;)
        formData[key] = itemData[key]
    }
    editData.value = itemData
  } else {
    // æ–°å¢æ•°æ®
    for(const key in formData) {
        formData[key] = &#39;&#39;
    }
    editData.value = null
  }
}

// dialogç‚¹å‡»ç¡®å®šæŒ‰é’®é€»è¾‘
function handleConfirmClick() {
    // å…³é—¨dialog
    dialogVisible.value = false
    // isNewRefä¸ºfalseæ—¶ï¼Œå‘é€ç¼–è¾‘ç”¨æˆ·è¯·æ±‚
    if(!isNewRef.value &amp;&amp; editData.value) {
        systemStore.editUserDataAction(editData.value.id, formData)
    } else {
        // å¦åˆ™å‘é€æ–°å»ºç”¨æˆ·è¯·æ±‚
        systemStore.newUserDataAction(formData)
    }
}

// æš´éœ²ç»™çˆ¶ç»„ä»¶çš„æ–¹æ³•
defineExpose({
    setDialogVisible
})
&lt;/script&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="é«˜çº§å¤ç”¨æ€§ä»£ç æŠ½å–" tabindex="-1"><a class="header-anchor" href="#é«˜çº§å¤ç”¨æ€§ä»£ç æŠ½å–" aria-hidden="true">#</a> é«˜çº§å¤ç”¨æ€§ä»£ç æŠ½å–</h2><p><strong>å°è£…æŠ½å–æˆé…ç½®æ–‡ä»¶æ¥å®ç°ï¼Œå¢å¼ºå¤ç”¨æ€§ã€‚</strong></p><h3 id="å°è£…ç½‘ç»œè¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#å°è£…ç½‘ç»œè¯·æ±‚" aria-hidden="true">#</a> å°è£…ç½‘ç»œè¯·æ±‚</h3><h4 id="æŠ½å–æ¥å£çš„å…¬å…±ç‰¹æ€§" tabindex="-1"><a class="header-anchor" href="#æŠ½å–æ¥å£çš„å…¬å…±ç‰¹æ€§" aria-hidden="true">#</a> æŠ½å–æ¥å£çš„å…¬å…±ç‰¹æ€§</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>/** æŠ½å–å…¬å…±é¡µé¢æ¥å£ */
// æŸ¥è¯¢
export function getPageListData(pageName: string, queryInfo: any) {
    return hyRequest.post({
      url: `/${pageName}/list`,
      data: queryInfo
    })
}
// åˆ é™¤
export function deletePageData(pageName: string, id: number) {
    return hyRequest.delete({
      url: `/${pageName}/${id}`
    })
}
// æ–°å¢
export function newPageData(pageName: string, dataInfo: any) {
  return hyRequest.post({
    url: `/${pageName}`,
    data: dataInfo
  })
}
// ä¿®æ”¹
export function editPageData(pageName: string, id: number, dataInfo: any) {
  return hyRequest.patch({
    url: `/${pageName}/${id}`,
    data: dataInfo
  })
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æŠ½å–-pinia-å¯¹åº”çš„-actions" tabindex="-1"><a class="header-anchor" href="#æŠ½å–-pinia-å¯¹åº”çš„-actions" aria-hidden="true">#</a> æŠ½å– pinia å¯¹åº”çš„ actions</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>import { deleteUserData, editUserData, getUserListData, newUserData, deletePageData, editPageData, getPageListData, newPageData } from &quot;@/service/main/system/system&quot;;
import { defineStore } from &quot;pinia&quot;;
import type { ISystemState } from &quot;./type&quot;;

const useSystemStore = defineStore(&#39;system&#39;, {
    state: (): ISystemState =&gt; ({
        // æŠ½å–å…¬å…±é¡µé¢æ•°æ®
        pageList: [],
        pageTotalCount: 0
    }),
    actions: {
        // æŠ½å–å…¬å…±é¡µé¢action
        async getPageListDataAction(pageName: string, queryInfo: any) {
            // 1.è¯·æ±‚ç”¨æˆ·åˆ—è¡¨æ•°æ®
            const pageListResult = await getPageListData(pageName, queryInfo)
            const { list, totalCount } = pageListResult.data
            this.pageList = list
            this.pageTotalCount = totalCount
        },
        async deletePageDataAction(pageName: string, id: number) {
            const res = await deletePageData(pageName, id)
            this.getPageListDataAction(pageName, { offset: 0, size: 10 })
        },
        async newPageDataAction(pageName: string, pageData: any) {
            const res = await newPageData(pageName, pageData)
            this.getPageListDataAction(pageName, { offset: 0, size: 10 })
        },
        async editPageDataAction(pageName: string, id: number, pageData: any) {
            const res = await editPageData(pageName, id, pageData)
            this.getPageListDataAction(pageName, { offset: 0, size: 10 })
        }

    }
})

export default useSystemStore
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>export interface ISystemState {
    // æŠ½å–å…¬å…±é¡µé¢æ•°æ®
    pageList: any[]
    pageTotalCount: number
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å°è£…è¡¨å•æœç´¢ç»„ä»¶" tabindex="-1"><a class="header-anchor" href="#å°è£…è¡¨å•æœç´¢ç»„ä»¶" aria-hidden="true">#</a> å°è£…è¡¨å•æœç´¢ç»„ä»¶</h3><p><img src="https://secure2.wostatic.cn/static/vwRrSUSNbjW7wAgWjK7gp9/image.png" alt=""></p><h4 id="ç¼–å†™è¡¨å•æœç´¢é…ç½®æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#ç¼–å†™è¡¨å•æœç´¢é…ç½®æ–‡ä»¶" aria-hidden="true">#</a> ç¼–å†™è¡¨å•æœç´¢é…ç½®æ–‡ä»¶</h4><p><code>search.config.ts</code></p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>const searchConfig = {
    labelWidth: &#39;120px&#39;,
    formItems: [
        {
            type: &#39;input&#39;,
            prop: &#39;name&#39;,
            label: &#39;éƒ¨é—¨åç§°&#39;,
            placeholder: &#39;è¯·è¾“å…¥æŸ¥è¯¢çš„éƒ¨é—¨åç§°&#39;
        },
        {
            type: &#39;input&#39;,
            prop: &#39;leader&#39;,
            label: &#39;éƒ¨é—¨é¢†å¯¼&#39;,
            placeholder: &#39;è¯·è¾“å…¥æŸ¥è¯¢çš„é¢†å¯¼åç§°&#39;,
            initialValue: &#39;å¼ ä¸‰&#39;
        },
        {
            type: &#39;select&#39;,
            prop: &#39;enable&#39;,
            label: &#39;çŠ¶æ€&#39;,
            placeholder: &#39;è¯·é€‰æ‹©æŸ¥è¯¢çš„çŠ¶æ€&#39;,
            options: [
                { label: &#39;å¯ç”¨&#39;, value: 1 },
                { label: &#39;ç¦ç”¨&#39;, value: 0 }
            ]
        },
        {
            type: &#39;time&#39;,
            prop: &#39;createAt&#39;,
            label: &#39;åˆ›å»ºæ—¶é—´&#39;
        }
    ]
}

export default searchConfig
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="é‡æ„è¡¨å•æœç´¢ç»„ä»¶" tabindex="-1"><a class="header-anchor" href="#é‡æ„è¡¨å•æœç´¢ç»„ä»¶" aria-hidden="true">#</a> é‡æ„è¡¨å•æœç´¢ç»„ä»¶</h4><p>å°†é‡Œé¢çš„å…·ä½“çš„å±æ€§åç§°é€šè¿‡<code>search.config.ts</code>é…ç½®æ–‡ä»¶æ¥åŠ¨æ€éå†å…·ä½“çš„å±æ€§å’Œè¡¨å•ç±»å‹ã€‚</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// page-search.vue
&lt;template&gt;
  &lt;div class=&quot;search&quot;&gt;
    &lt;el-form :model=&quot;searchForm&quot; ref=&quot;formRef&quot; :label-width=&quot;searchConfig.labelWidth ?? &#39;80px&#39;&quot; size=&quot;large&quot;&gt;
        &lt;el-row :gutter=&quot;20&quot;&gt;
            &lt;!-- åŠ¨æ€éå†é…ç½®configæ–‡ä»¶ --&gt;
            &lt;template v-for=&quot;item in searchConfig.formItems&quot; :key=&quot;item.prop&quot;&gt;
                &lt;el-col :span=&quot;8&quot;&gt;
                    &lt;el-form-item :label=&quot;item.label&quot; :prop=&quot;item.prop&quot;&gt;
                        &lt;template v-if=&quot;item.type === &#39;input&#39;&quot;&gt;
                            &lt;el-input v-model=&quot;searchForm[item.prop]&quot; :placeholder=&quot;item.placeholder&quot;&gt;&lt;/el-input&gt;
                        &lt;/template&gt;
                        &lt;template v-if=&quot;item.type === &#39;time&#39;&quot;&gt;
                            &lt;el-date-picker
                                v-model=&quot;searchForm[item.prop]&quot;
                                type=&quot;daterange&quot;
                                range-separator=&quot;-&quot;
                                start-placeholder=&quot;å¼€å§‹æ—¶é—´&quot;
                                end-placeholder=&quot;ç»“æŸæ—¶é—´&quot;
                            /&gt;
                        &lt;/template&gt;
                        &lt;template v-if=&quot;item.type === &#39;select&#39;&quot;&gt;
                            &lt;el-select v-model=&quot;searchForm[item.prop]&quot; :placeholder=&quot;item.placeholder&quot; style=&quot;width: 100%&quot;&gt;
                                &lt;template v-for=&quot;option in item.options&quot; :key=&quot;option.value&quot;&gt;
                                    &lt;el-option :label=&quot;option.label&quot; :value=&quot;option.value&quot;&gt;&lt;/el-option&gt;
                                &lt;/template&gt;
                            &lt;/el-select&gt;
                        &lt;/template&gt;
                    &lt;/el-form-item&gt;
                &lt;/el-col&gt;
            &lt;/template&gt;
        &lt;/el-row&gt;
    &lt;/el-form&gt;

    &lt;div class=&quot;btns&quot;&gt;
        &lt;el-button icon=&quot;Refresh&quot; size=&quot;large&quot; @click=&quot;handleResetClick()&quot;&gt;é‡ç½®&lt;/el-button&gt;
        &lt;el-button icon=&quot;Search&quot; size=&quot;large&quot; type=&quot;primary&quot; @click = &quot;handleQueryClick()&quot;&gt;æœç´¢&lt;/el-button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import { reactive, ref } from &quot;vue&quot;;
import type { ElForm } from &quot;element-plus&quot;;

// å®šä¹‰çš„å‚æ•°éœ€ä¸é…ç½®æ–‡ä»¶ä¸­çš„å‚æ•°ä¸€è‡´
interface IProps {
    searchConfig: {
        labelWidth?: string,
        formItems: any[]
    }
}
// æ¥å—çˆ¶ç»„ä»¶ä¼ æ¥çš„é…ç½®å‚æ•°
const props = defineProps&lt;IProps&gt;()

const emit = defineEmits([&#39;queryClick&#39;, &#39;resetClick&#39;])

const initialForm: any = {}
for(const item of props.searchConfig.formItems) {
    initialForm[item.prop] = item.initialValue ?? &#39;&#39;
}
const searchForm = reactive({
    initialForm
})

// é‡ç½®åŠŸèƒ½
const formRef = ref&lt;InstanceType&lt;typeof ElForm&gt;&gt;()
function handleResetClick() {
    formRef.value?.resetFields()
    // å‘é€è¯·æ±‚é‡ç½®æŸ¥æ‰¾
    emit(&#39;resetClick&#39;)
}

// æœç´¢åŠŸèƒ½
function handleQueryClick() {
    // é€šè¿‡äº‹ä»¶æŠ›å‡ºï¼ˆå­ä¼ çˆ¶ï¼‰
    emit(&#39;queryClick&#39;, searchForm)
}
&lt;/script&gt;

&lt;style lang=&quot;less&quot; scoped&gt;
.search {
    background-color: #fff;
    padding: 20px;

    .el-form-item {
        padding: 20px;
        margin-bottom: 0;
    }

    .btns {
        text-align: right;
        padding: 0 50px 10px 0;
    }
}
&lt;/style&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="çˆ¶ç»„ä»¶å¼•ç”¨é…ç½®æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#çˆ¶ç»„ä»¶å¼•ç”¨é…ç½®æ–‡ä»¶" aria-hidden="true">#</a> çˆ¶ç»„ä»¶å¼•ç”¨é…ç½®æ–‡ä»¶</h4><p>çˆ¶ç»„ä»¶ä¼ é€’å‚æ•°ä¸º<code>search-config</code>ç»™å­ç»„ä»¶ã€‚</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// department.vue
&lt;template&gt;
  &lt;div class=&quot;department&quot;&gt;
    &lt;page-search :search-config=&quot;searchConfig&quot;/&gt;
    // ...
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot; name=&quot;department&quot;&gt;
import pageSearch from &#39;@/components/page-search/page-search.vue&#39;
import searchConfig from &#39;./config/search.config&#39;
// ...
&lt;/script&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å°è£…è¡¨æ ¼å†…å®¹ç»„ä»¶" tabindex="-1"><a class="header-anchor" href="#å°è£…è¡¨æ ¼å†…å®¹ç»„ä»¶" aria-hidden="true">#</a> å°è£…è¡¨æ ¼å†…å®¹ç»„ä»¶</h3><p><img src="https://secure2.wostatic.cn/static/6zGDaiK1EqPzQCHsgAaWAT/image.png" alt=""></p><h4 id="ç¼–å†™è¡¨æ ¼å†…å®¹é…ç½®æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#ç¼–å†™è¡¨æ ¼å†…å®¹é…ç½®æ–‡ä»¶" aria-hidden="true">#</a> ç¼–å†™è¡¨æ ¼å†…å®¹é…ç½®æ–‡ä»¶</h4><p><code>content.config.ts</code></p><p>é’ˆå¯¹ä¸åŒç±»å‹çš„è¡¨æ ¼æ•°æ®çš„ä½œç”¨åŸŸæ’æ§½ï¼ŒåŒºåˆ†ä¸åŒçš„<code>type</code>ã€‚</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>const contentConfig = {
    pageName: &#39;Department&#39;,
    header: {
        title: &#39;éƒ¨é—¨åˆ—è¡¨&#39;,
        btnTitle: &#39;æ–°å»ºéƒ¨é—¨&#39;
    },
    propsList:[
        { type: &#39;selection&#39;, label: &#39;é€‰æ‹©&#39;, width: &#39;80px&#39; },
        { type: &#39;index&#39;, label: &#39;åºå·&#39;, width: &#39;80px&#39; },

        { type: &#39;normal&#39;, prop: &#39;name&#39;, label: &#39;éƒ¨é—¨åç§°&#39;, width: &#39;150px&#39; },
        { type: &#39;normal&#39;, prop: &#39;leader&#39;, label: &#39;éƒ¨é—¨é¢†å¯¼&#39;, width: &#39;150px&#39; },
        { type: &#39;normal&#39;, prop: &#39;parentId&#39;, label: &#39;ä¸Šçº§éƒ¨é—¨&#39;, width: &#39;150px&#39; },

        { type: &#39;time&#39;, prop: &#39;createAt&#39;, label: &#39;åˆ›å»ºæ—¶é—´&#39; },
        { type: &#39;time&#39;, prop: &#39;updateAt&#39;, label: &#39;æ›´æ–°æ—¶é—´&#39; },

        { type: &#39;handler&#39;, label: &#39;æ“ä½œ&#39;, width: &#39;180px&#39; },
    ]
}

export default contentConfig
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="é‡æ„è¡¨æ ¼å†…å®¹ç»„ä»¶" tabindex="-1"><a class="header-anchor" href="#é‡æ„è¡¨æ ¼å†…å®¹ç»„ä»¶" aria-hidden="true">#</a> é‡æ„è¡¨æ ¼å†…å®¹ç»„ä»¶</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// page-content.vue
&lt;template&gt;
  &lt;div class=&quot;content&quot;&gt;
    &lt;div class=&quot;header&quot;&gt;
      &lt;h3 class=&quot;title&quot;&gt;{{ contentConfig?.header?.title ?? &#39;æ•°æ®åˆ—è¡¨&#39; }}&lt;/h3&gt;
      &lt;el-button type=&quot;primary&quot; @click=&quot;handleNewData&quot;&gt;{{ contentConfig?.header?.btnTitle ?? &#39;æ–°å»ºæ•°æ®&#39; }}&lt;/el-button&gt;
    &lt;/div&gt;
    &lt;div class=&quot;table&quot;&gt;
      &lt;el-table :data=&quot;pageList&quot; :border=&quot;true&quot; style=&quot;width: 100%&quot;&gt;
        &lt;template v-for=&quot;item in contentConfig.propsList&quot; :key=&quot;item.prop&quot;&gt;

          &lt;!-- å¤„ç†å¸¦è‡ªå®šä¹‰æ’æ§½çš„æ—¶é—´æ ¼å¼ç±»å‹ --&gt;
          &lt;template v-if=&quot;item.type === &#39;time&#39;&quot;&gt;
            &lt;el-table-column align=&quot;center&quot; v-bind=&quot;item&quot;&gt;
              &lt;template #default=&quot;scope&quot;&gt;
                {{ formatUTC(scope.row[item.prop]) }}
              &lt;/template&gt;
            &lt;/el-table-column&gt;
          &lt;/template&gt;

          &lt;!-- å¤„ç†handleç±»å‹ --&gt;
          &lt;template v-else-if=&quot;item.type === &#39;handler&#39;&quot;&gt;
            &lt;el-table-column align=&quot;center&quot; v-bind=&quot;item&quot;&gt;
              &lt;template #default=&quot;scope&quot;&gt;
                &lt;el-button type=&quot;primary&quot; size=&quot;small&quot; icon=&quot;EditPen&quot; link @click=&quot;handleEditClick(scope.row)&quot;&gt;
                  ç¼–è¾‘
                &lt;/el-button&gt;
                &lt;el-button type=&quot;danger&quot; size=&quot;small&quot; icon=&quot;Delete&quot; link @click=&quot;handleDeleteClick(scope.row.id)&quot;&gt;
                  åˆ é™¤
                &lt;/el-button&gt;
              &lt;/template&gt;
            &lt;/el-table-column&gt;
          &lt;/template&gt;

          &lt;!-- å¤„ç†æ™®é€šç±»å‹ --&gt;
          &lt;template v-else&gt;
            &lt;!-- &lt;el-table-column align=&quot;center&quot; :type=&quot;item.type&quot; :prop=&quot;item.prop&quot; :label=&quot;item.label&quot; :width=&quot;item.width&quot; /&gt; ç›¸å½“äºä¸‹é¢--&gt;
            &lt;el-table-column align=&quot;center&quot; v-bind=&quot;item&quot; /&gt;
          &lt;/template&gt;
        &lt;/template&gt;
      &lt;/el-table&gt;
    &lt;/div&gt;
    &lt;div class=&quot;footer&quot;&gt;
      &lt;el-pagination
        v-model:currentPage=&quot;currentPage&quot;
        v-model:page-size=&quot;pageSize&quot;
        :page-sizes=&quot;[10, 20, 30]&quot;
        layout=&quot;total, sizes, prev, pager, next, jumper&quot;
        :total=&quot;pageTotalCount&quot;
        @current-change=&quot;handleCurrentChange&quot;
      /&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot; name=&quot;content&quot;&gt;
import { storeToRefs } from &#39;pinia&#39;
import useSystemStore from &#39;@/store/main/system/system&#39;
import { formatUTC } from &#39;@/utils/format&#39;;
import { ref } from &#39;vue&#39;

interface IProps {
  contentConfig: {
    // ç”¨äºå¤„ç†æ¥å£æ–¹æ³•ä¸­ä¼ å…¥çš„pageNameå‚æ•°
    pageName: string,
    header?: {
      title?: string,
      btnTitle: string
    },
    propsList: any[]
  }
}

const props = defineProps&lt;IProps&gt;()

const emit = defineEmits([&#39;newDataClick&#39;, &#39;editDataClick&#39;])

// 1.è¯·æ±‚æ•°æ®
const systemStore = useSystemStore()
const currentPage = ref(1)
const pageSize = ref(10)
function fetchPageListData(formData: any = {}) {
  // 1.è·å–offsetå’Œsize
  const size = pageSize.value
  const offset = (currentPage.value - 1) * size
  const pageInfo = { size, offset}

  // 2.å‘èµ·ç½‘ç»œè¯·æ±‚
  const queryInfo = { ...pageInfo, ...formData}
  // ä»é…ç½®æ–‡ä»¶ä¸­è·å–pageName
  systemStore.getPageListDataAction(props.contentConfig.pageName, { offset, size, ...queryInfo })
}
fetchPageListData()

// 2.å±•ç¤ºæ•°æ®
const { pageList, pageTotalCount } = storeToRefs(systemStore)

// 3.ç»‘å®šåˆ†é¡µæ•°æ®
function handleCurrentChange() {
  fetchPageListData()
}
function handleResetClick() {
  currentPage.value = 1
  pageSize.value = 10
  fetchPageListData()
}

// 4.æ–°å»ºæ•°æ®çš„å¤„ç†
function handleNewData() {
  emit(&#39;newDataClick&#39;)
}

// 5.åˆ é™¤å’Œç¼–è¾‘æ“ä½œ
function handleDeleteClick(id: number) {
  // ä»é…ç½®æ–‡ä»¶ä¸­è·å–pageName
  systemStore.deletePageDataAction(props.contentConfig.pageName, id)
}

function handleEditClick(data: any) {
  emit(&#39;editDataClick&#39;, data)
}

// æš´éœ²å‡½æ•°
defineExpose({
  fetchPageListData,
  handleResetClick
})
&lt;/script&gt;

&lt;style scoped lang=&quot;less&quot;&gt;
.content {
  margin-top: 20px;
  padding: 20px;
  background-color: #fff;

  .header {
    display: flex;
    height: 45px;
    padding: 0 5px;
    justify-content: space-between;
    align-items: center;

    .title {
      font-size: 20px;
      font-weight: 700;
    }

    .handler {
      align-items: center;
    }
  }

  .table {
    :deep(.el-table__cell) {
      padding: 14px 0;
    }
  }

  .footer {
    display: flex;
    justify-content: flex-end;
    margin-top: 15px;
  }
}
&lt;/style&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="çˆ¶ç»„ä»¶å¼•ç”¨é…ç½®æ–‡ä»¶-åé¢ç»Ÿä¸€èµ·æ¥æ•´ç†" tabindex="-1"><a class="header-anchor" href="#çˆ¶ç»„ä»¶å¼•ç”¨é…ç½®æ–‡ä»¶-åé¢ç»Ÿä¸€èµ·æ¥æ•´ç†" aria-hidden="true">#</a> çˆ¶ç»„ä»¶å¼•ç”¨é…ç½®æ–‡ä»¶ï¼ˆåé¢ç»Ÿä¸€èµ·æ¥æ•´ç†ï¼‰</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>&lt;template&gt;
  &lt;div class=&quot;department&quot;&gt;
    &lt;page-search @query-click=&quot;handleQueryClick&quot; @reset-click=&quot;handleResetClick&quot; :search-config=&quot;searchConfig&quot;/&gt;
    &lt;page-content ref=&quot;contentRef&quot; @new-data-click=&quot;handleNewDataClick&quot; @edit-data-click=&quot;handleEditDataClick&quot; :content-config=&quot;contentConfig&quot;/&gt;
    &lt;page-modal ref=&quot;modalRef&quot; /&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot; name=&quot;department&quot;&gt;
import pageSearch from &#39;@/components/page-search/page-search.vue&#39;
import PageContent from &#39;@/components/page-content/page-content.vue&#39;
import PageModal from &#39;./cpns/page-modal.vue&#39;
import { ref } from &#39;vue&#39;

import searchConfig from &#39;./config/search.config&#39;
import contentConfig from &#39;./config/content.config&#39;

const contentRef = ref&lt;InstanceType&lt;typeof PageContent&gt;&gt;()
const modalRef = ref&lt;InstanceType&lt;typeof PageModal&gt;&gt;()
// æœç´¢åŠŸèƒ½
function handleQueryClick(searchInfo: any) {
  console.log(searchInfo);
  contentRef.value?.fetchPageListData(searchInfo)
}
// é‡ç½®åŠŸèƒ½
function handleResetClick() {
  contentRef.value?.fetchPageListData()
}
// æ–°å¢åŠŸèƒ½
function handleNewDataClick() {
  modalRef.value?.setDialogVisible()
}
// ç¼–è¾‘åŠŸèƒ½
function handleEditDataClick(itemData: any) {
  modalRef.value?.setDialogVisible(false, itemData)
}
&lt;/script&gt;

&lt;style scoped&gt;&lt;/style&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="è¿›é˜¶-å°è£…è‡ªå®šä¹‰çš„å®šåˆ¶ä½œç”¨åŸŸæ’æ§½" tabindex="-1"><a class="header-anchor" href="#è¿›é˜¶-å°è£…è‡ªå®šä¹‰çš„å®šåˆ¶ä½œç”¨åŸŸæ’æ§½" aria-hidden="true">#</a> (è¿›é˜¶)å°è£…è‡ªå®šä¹‰çš„å®šåˆ¶ä½œç”¨åŸŸæ’æ§½</h4><p>ä»¥ä¸Šä»£ç æ˜¯é€šè¿‡ä¸æ–­çš„<code>if</code>åˆ¤æ–­ <code>&lt;template v-else-if=&quot;item.type === &#39;custom&#39;&quot;&gt;</code>ï¼Œæ¥å¤„ç†ä¸åŒç±»å‹ï¼ˆå¸¦æœ‰ä½œç”¨åŸŸæ’æ§½ï¼‰çš„<code>table</code>æ•°æ®ï¼Œå¦‚å›¾ç‰‡ã€<code>el-tag</code>ã€<code>button</code>ç­‰ã€‚å› æ­¤é€šè¿‡ç¼–å†™é€šç”¨çš„è‡ªå®šä¹‰æ’æ§½æ¥é¢„ç•™ä¸€ä¸ªæ’æ§½<code>slot</code>ç»™çˆ¶ç»„ä»¶ï¼Œä½¿ç”¨æˆ·å¯ä»¥å®šåˆ¶<code>table</code>æ•°æ®å†…å®¹ã€‚</p><p><strong>é…ç½®æ–‡ä»¶</strong></p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>const contentConfig = {
    // ...
    propsList:[
        // ...
        // è‡ªå®šä¹‰æ’æ§½å®šåˆ¶ï¼ˆé€šç”¨ï¼‰
        { type: &#39;custom&#39;, label: &#39;è‡ªå®šä¹‰æ’æ§½1&#39;, prop: &#39;leader&#39;, width: &#39;150px&#39;, slotName: &#39;leader&#39;},
        { type: &#39;custom&#39;, label: &#39;è‡ªå®šä¹‰æ’æ§½2&#39;, prop: &#39;parentId&#39;, width: &#39;150px&#39;, slotName: &#39;parent&#39;},
    ]
}

export default contentConfig
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>è‡ªå®šä¹‰æ’æ§½çš„ç»„ä»¶æ¨¡ç‰ˆ</strong></p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>&lt;template&gt;
  &lt;div class=&quot;content&quot;&gt;
    // ...
    &lt;div class=&quot;table&quot;&gt;
      &lt;el-table :data=&quot;pageList&quot; :border=&quot;true&quot; style=&quot;width: 100%&quot;&gt;
        &lt;template v-for=&quot;item in contentConfig.propsList&quot; :key=&quot;item.prop&quot;&gt;
          &lt;!-- å¤„ç†å¸¦è‡ªå®šä¹‰æ’æ§½çš„æ—¶é—´æ ¼å¼ç±»å‹ --&gt;
          // ...
          &lt;!-- å¤„ç†handleç±»å‹ --&gt;
          // ....
          &lt;!-- å¤„ç†æ™®é€šç±»å‹ --&gt;
          // ....

          &lt;!-- è‡ªå®šä¹‰æ’æ§½å®šåˆ¶å¤„ç†(é€šç”¨) --&gt;
          &lt;template v-else-if=&quot;item.type === &#39;custom&#39;&quot;&gt;
            &lt;el-table-column align=&quot;center&quot; v-bind=&quot;item&quot;&gt;
              &lt;template #default=&quot;scope&quot;&gt;
                &lt;!-- ç»™ç”¨æˆ·é¢„ç•™å®šåˆ¶æ’æ§½ --&gt;
                &lt;slot :name=&quot;item.slotName&quot; v-bind=&quot;scope&quot; :prop=&quot;item.prop&quot;&gt;&lt;/slot&gt;
              &lt;/template&gt;
            &lt;/el-table-column&gt;
          &lt;/template&gt;

        &lt;/template&gt;

      &lt;/el-table&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>çˆ¶ç»„ä»¶ç¼–å†™å®šåˆ¶æ’æ§½</strong></p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>&lt;template&gt;
  &lt;div class=&quot;department&quot;&gt;
    &lt;page-search @query-click=&quot;handleQueryClick&quot; @reset-click=&quot;handleResetClick&quot; :search-config=&quot;searchConfig&quot;/&gt;

    &lt;page-content ref=&quot;contentRef&quot; @new-data-click=&quot;handleNewDataClick&quot; @edit-data-click=&quot;handleEditDataClick&quot; :content-config=&quot;contentConfig&quot;&gt;
      &lt;template #leader=&quot;scope&quot;&gt;
        &lt;span style=&quot;color: red;&quot;&gt;
          {{ scope.row[scope.prop] }}
        &lt;/span&gt;
      &lt;/template&gt;
      &lt;template #parent=&quot;scope&quot;&gt;
        &lt;el-tag&gt;
          {{ scope.row[scope.prop] }}
        &lt;/el-tag&gt;
      &lt;/template&gt;
    &lt;/page-content&gt;

    &lt;page-modal ref=&quot;modalRef&quot; /&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å°è£…æ¨¡æ€æ¡†ç»„ä»¶" tabindex="-1"><a class="header-anchor" href="#å°è£…æ¨¡æ€æ¡†ç»„ä»¶" aria-hidden="true">#</a> å°è£…æ¨¡æ€æ¡†ç»„ä»¶</h3><p><img src="https://secure2.wostatic.cn/static/kbS9pkH3ukfcY4E2cyhBUd/image.png" alt=""></p><h4 id="ç¼–å†™æ¨¡æ€æ¡†å†…å®¹é…ç½®æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#ç¼–å†™æ¨¡æ€æ¡†å†…å®¹é…ç½®æ–‡ä»¶" aria-hidden="true">#</a> ç¼–å†™æ¨¡æ€æ¡†å†…å®¹é…ç½®æ–‡ä»¶</h4><p><code>motal.config.ts</code></p><p>è¿™é‡Œçš„<code>options</code>åº”è¯¥æ˜¯ç”±è·å–æ¥å£æ•°æ®å¾—åˆ°çš„ï¼Œåç»­ä¼šè¿›è¡Œå°è£…ï¼Œè¿™é‡Œå…ˆå†™ä¸ºé™æ€çš„ã€‚</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>const modalConfig = {
    header: {
        newTitle: &#39;æ–°å»ºéƒ¨é—¨&#39;,
        editTitle: &#39;ç¼–è¾‘éƒ¨é—¨&#39;,
    },
    pageName: &#39;department&#39;,
    formItems: [
        {
            type: &#39;input&#39;,
            prop: &#39;name&#39;,
            label: &#39;éƒ¨é—¨åç§°&#39;,
            placeholder: &#39;è¯·è¾“å…¥éƒ¨é—¨åç§°&#39;
        },
        {
            type: &#39;input&#39;,
            prop: &#39;leader&#39;,
            label: &#39;éƒ¨é—¨é¢†å¯¼&#39;,
            placeholder: &#39;è¯·è¾“å…¥æŸ¥è¯¢çš„é¢†å¯¼åç§°&#39;,
            initialValue: &#39;å¼ ä¸‰&#39;
        },
        {
            type: &#39;select&#39;,
            prop: &#39;parentId&#39;,
            label: &#39;ä¸Šçº§éƒ¨é—¨&#39;,
            options: [
                // åé¢ä½¿ç”¨åŠ¨æ€è·å–
                // { label: &#39;éƒ¨é—¨1&#39;, value: &#39;1&#39; },
            ]
        }
    ]
}

export default modalConfig
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="é‡æ„æ¨¡æ€æ¡†å†…å®¹ç»„ä»¶" tabindex="-1"><a class="header-anchor" href="#é‡æ„æ¨¡æ€æ¡†å†…å®¹ç»„ä»¶" aria-hidden="true">#</a> é‡æ„æ¨¡æ€æ¡†å†…å®¹ç»„ä»¶</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// page-modal.vue
&lt;template&gt;
  &lt;div class=&quot;modal&quot;&gt;
    &lt;el-dialog v-model=&quot;dialogVisible&quot; :title=&quot;isEdit ? modalConfig.header.editTitle : modalConfig.header.newTitle&quot; width=&quot;30%&quot; center&gt;
      &lt;div class=&quot;form&quot;&gt;
        &lt;el-form :model=&quot;formData&quot; label-width=&quot;80px&quot; size=&quot;large&quot;&gt;
          &lt;template v-for=&quot;item in modalConfig.formItems&quot; :key=&quot;item.prop&quot;&gt;
            &lt;el-form-item v-bind=&quot;item&quot;&gt;
              &lt;template v-if=&quot;item.type === &#39;input&#39;&quot;&gt;
                &lt;el-input v-model=&quot;formData[item.prop]&quot; :placeholder=&quot;item.placeholder&quot; /&gt;
              &lt;/template&gt;

              &lt;template v-if=&quot;item.type === &#39;select&#39;&quot;&gt;
                &lt;el-select v-model=&quot;formData[item.prop]&quot; :placeholder=&quot;item.placeholder&quot; style=&quot;width: 100%&quot;&gt;
                  &lt;template v-for=&quot;option in item.options&quot; :key=&quot;option.value&quot;&gt;
                    &lt;el-option :value=&quot;option.value&quot; :label=&quot;option.label&quot; /&gt;
                  &lt;/template&gt;
                &lt;/el-select&gt;
              &lt;/template&gt;
            &lt;/el-form-item&gt;
          &lt;/template&gt;
        &lt;/el-form&gt;
      &lt;/div&gt;
      &lt;template #footer&gt;
        &lt;span class=&quot;dialog-footer&quot;&gt;
          &lt;el-button @click=&quot;dialogVisible = false&quot;&gt;å–æ¶ˆ&lt;/el-button&gt;
          &lt;el-button type=&quot;primary&quot; @click=&quot;handleConfirmClick&quot;&gt;ç¡®å®š&lt;/el-button&gt;
        &lt;/span&gt;
      &lt;/template&gt;
    &lt;/el-dialog&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot; name=&quot;modal&quot;&gt;
import useMainStore from &#39;@/store/main/main&#39;
import useSystemStore from &#39;@/store/main/system/system&#39;
import { storeToRefs } from &#39;pinia&#39;
import { reactive, ref } from &#39;vue&#39;

const dialogVisible = ref(false)
const isEdit = ref(false)
const editData = ref()

// éƒ¨é—¨å’Œè§’è‰²çš„æ•°æ®
const mainStore = useMainStore()
const { entireDepartments } = storeToRefs(mainStore)

interface IProps {
  modalConfig: {
    header: {
      newTitle: string,
      editTitle: string
    }
    pageName: string,
    formItems: any[]
  }
}

// å®šä¹‰props
const props = defineProps&lt;IProps&gt;()

// å®šä¹‰æ•°æ®ç»‘å®š
const initialForm: any = {}
for(const item of props.modalConfig.formItems) {
    initialForm[item.prop] = item.initialValue ?? &#39;&#39;
}
const formData = reactive&lt;any&gt;(initialForm)

// ç‚¹å‡»ç¡®å®š
const systemStore = useSystemStore()
function handleConfirmClick() {
  dialogVisible.value = false
  if (!isEdit.value) {
    systemStore.newPageDataAction(props.modalConfig.pageName, formData)
  } else {
    systemStore.editPageDataAction(props.modalConfig.pageName, editData.value.id, formData)
  }
}

// æ–°å»ºæˆ–è€…ç¼–è¾‘
function setDialogVisible(isNew: boolean = true, data: any = {}) {
  dialogVisible.value = true
  isEdit.value = !isNew
  editData.value = data
  for (const key in formData) {
    if (isNew) {
      formData[key] = &#39;&#39;
    } else {
      formData[key] = data[key]
    }
  }
}

defineExpose({
  setDialogVisible
})
&lt;/script&gt;

&lt;style scoped lang=&quot;less&quot;&gt;
.form {
  padding: 10px 30px;
}
&lt;/style&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å°†é€‰æ‹©å™¨ä¸‹æ‹‰å†…å®¹-options-æ”¹ä¸ºåŠ¨æ€è·å–æ¥å£æ•°æ®" tabindex="-1"><a class="header-anchor" href="#å°†é€‰æ‹©å™¨ä¸‹æ‹‰å†…å®¹-options-æ”¹ä¸ºåŠ¨æ€è·å–æ¥å£æ•°æ®" aria-hidden="true">#</a> å°†é€‰æ‹©å™¨ä¸‹æ‹‰å†…å®¹ options æ”¹ä¸ºåŠ¨æ€è·å–æ¥å£æ•°æ®</h4><p>åœ¨çˆ¶ç»„ä»¶ä¸­å°†è¦ä¼ å…¥çš„<code>modalConfig</code>è¿›è¡Œé¢„å¤„ç†ï¼Œä½¿ç”¨<code>pinia</code>å°†æ¥å£æ•°æ®ï¼ˆ<code>name</code>, <code>id</code>ï¼‰å…ˆæ˜ å°„æˆ<code>options</code>éœ€è¦çš„å‚æ•°ï¼ˆ<code>label</code>, <code>value</code>ï¼‰ï¼Œå†å°†æ•°æ®æ¨å…¥åˆ°<code>prop</code>ä¸º<code>parentId</code>ä¸‹çš„<code>options</code>æ•°ç»„ä¸­ã€‚</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// çˆ¶ç»„ä»¶deparment.vue
&lt;template&gt;
  &lt;div class=&quot;department&quot;&gt;
    // ...
    &lt;page-modal ref=&quot;modalRef&quot; :modal-config=&quot;modalConfigRef&quot;/&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot; name=&quot;department&quot;&gt;
// ...
import PageModal from &#39;@/components/page-modal/page-modal.vue&#39;
import { computed, ref } from &#39;vue&#39;
import modalConfig from &#39;./config/modal.config&#39;
import useMainStore from &#39;@/store/main/main&#39;

// å¯¹modalConfigè¿›è¡Œæ“ä½œï¼Œç”¨äºselectä¸­çš„optionsæ¥è‡ªäºæ¥å£æ•°æ®
const modalConfigRef = computed(() =&gt; {
  const mainStore = useMainStore()
  // å°†è·å–åˆ°çš„nameå’Œidæ˜ å°„æˆoptionéœ€è¦çš„labelå’Œvalueå½¢å¼
  const departments = mainStore.entireDepartments.map((item) =&gt; {
    return { label: item.name, value: item.id }
  })
  modalConfig.formItems.forEach((item) =&gt; {
    if (item.prop === &#39;parentId&#39;) {
      item.options.push(...departments)
    }
  })
  return modalConfig
})

// ...
&lt;/script&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="é¡µé¢å…¬å…±é€»è¾‘çš„-hooks-æŠ½å–" tabindex="-1"><a class="header-anchor" href="#é¡µé¢å…¬å…±é€»è¾‘çš„-hooks-æŠ½å–" aria-hidden="true">#</a> é¡µé¢å…¬å…±é€»è¾‘çš„ hooks æŠ½å–</h3><h4 id="æŠ½å–è¡¨å•æœç´¢å†…å®¹ä¸­çš„æœç´¢åŠŸèƒ½å’Œé‡ç½®åŠŸèƒ½ã€‚" tabindex="-1"><a class="header-anchor" href="#æŠ½å–è¡¨å•æœç´¢å†…å®¹ä¸­çš„æœç´¢åŠŸèƒ½å’Œé‡ç½®åŠŸèƒ½ã€‚" aria-hidden="true">#</a> æŠ½å–è¡¨å•æœç´¢å†…å®¹ä¸­çš„æœç´¢åŠŸèƒ½å’Œé‡ç½®åŠŸèƒ½ã€‚</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// hooks/usePageContent.ts
import type PageContent from &quot;@/components/page-content/page-content.vue&quot;
import { ref } from &quot;vue&quot;

export function usePageContent() {
    const contentRef = ref&lt;InstanceType&lt;typeof PageContent&gt;&gt;()
    // æœç´¢åŠŸèƒ½
    function handleQueryClick(searchInfo: any) {
        console.log(searchInfo);
        contentRef.value?.fetchPageListData(searchInfo)
    }
    // é‡ç½®åŠŸèƒ½
    function handleResetClick() {
        contentRef.value?.fetchPageListData()
    }

    return {
        contentRef,
        handleQueryClick,
        handleResetClick
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æŠ½å–æ¨¡æ€æ¡†ä¸­æ–°å¢å’Œç¼–è¾‘åŠŸèƒ½ã€‚" tabindex="-1"><a class="header-anchor" href="#æŠ½å–æ¨¡æ€æ¡†ä¸­æ–°å¢å’Œç¼–è¾‘åŠŸèƒ½ã€‚" aria-hidden="true">#</a> æŠ½å–æ¨¡æ€æ¡†ä¸­æ–°å¢å’Œç¼–è¾‘åŠŸèƒ½ã€‚</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// hooks/usePageModal.ts
import type PageModal from &quot;@/components/page-modal/page-modal.vue&quot;
import { ref } from &quot;vue&quot;

export function usePageModal() {
    const modalRef = ref&lt;InstanceType&lt;typeof PageModal&gt;&gt;()

    // æ–°å¢åŠŸèƒ½
    function handleNewDataClick() {
        modalRef.value?.setDialogVisible()
    }
    // ç¼–è¾‘åŠŸèƒ½
    function handleEditDataClick(itemData: any) {
        modalRef.value?.setDialogVisible(false, itemData)
    }

    return {
        modalRef,
        handleEditDataClick,
        handleNewDataClick
    }
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="çˆ¶ç»„ä»¶ä¸­è°ƒç”¨-hooksã€‚" tabindex="-1"><a class="header-anchor" href="#çˆ¶ç»„ä»¶ä¸­è°ƒç”¨-hooksã€‚" aria-hidden="true">#</a> çˆ¶ç»„ä»¶ä¸­è°ƒç”¨ hooksã€‚</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>&lt;script setup lang=&quot;ts&quot; name=&quot;department&quot;&gt;
import { usePageContent } from &#39;@/hooks/usePageContent&#39;
import { usePageModal } from &#39;@/hooks/usePageModal&#39;
// ...
// æŠ½å–æˆhooks
const { contentRef, handleQueryClick, handleResetClick } = usePageContent()

const { modalRef, handleEditDataClick, handleNewDataClick } = usePageModal()
&lt;/script&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="å®ç°èœå•ç®¡ç†åŠŸèƒ½" tabindex="-1"><a class="header-anchor" href="#å®ç°èœå•ç®¡ç†åŠŸèƒ½" aria-hidden="true">#</a> å®ç°èœå•ç®¡ç†åŠŸèƒ½</h2><p><img src="https://secure2.wostatic.cn/static/7XLVEKxN4tVF4ssBfRRq6H/image.png" alt=""></p><h3 id="å®ç°æ ‘å½¢å­æ ‘çš„å±•ç¤º" tabindex="-1"><a class="header-anchor" href="#å®ç°æ ‘å½¢å­æ ‘çš„å±•ç¤º" aria-hidden="true">#</a> å®ç°æ ‘å½¢å­æ ‘çš„å±•ç¤º</h3><p>ä½¿ç”¨<code>el-table</code>ä¸­çš„<code>row-key=&quot;id&quot;</code>æ¥ç»‘å®šå­æ ‘çš„<code>id</code>ã€‚è¿™é‡Œä½¿ç”¨é…ç½®é¡¹æ¥åœ¨è¡¨æ ¼æ•°æ®ä¸­åŠ¨æ€ç»‘å®šã€‚</p><blockquote><p><a href="https://element-plus.gitee.io/zh-CN/component/table.html#%E6%A0%91%E5%BD%A2%E6%95%B0%E6%8D%AE%E4%B8%8E%E6%87%92%E5%8A%A0%E8%BD%BD" target="_blank" rel="noopener noreferrer">æ ‘å½¢æ•°æ®<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼šæ”¯æŒæ ‘ç±»å‹çš„æ•°æ®çš„æ˜¾ç¤ºã€‚ å½“ row ä¸­åŒ…å« <code>children</code> å­—æ®µæ—¶ï¼Œè¢«è§†ä¸ºæ ‘å½¢æ•°æ®ã€‚ æ¸²æŸ“åµŒå¥—æ•°æ®éœ€è¦ prop çš„ <code>row-key</code>ã€‚ æ­¤å¤–ï¼Œå­è¡Œæ•°æ®å¯ä»¥å¼‚æ­¥åŠ è½½ã€‚ è®¾ç½® Table çš„<code>lazy</code>å±æ€§ä¸º true ä¸åŠ è½½å‡½æ•° <code>load</code> ã€‚ é€šè¿‡æŒ‡å®š row ä¸­çš„<code>hasChildren</code>å­—æ®µæ¥æŒ‡å®šå“ªäº›è¡Œæ˜¯åŒ…å«å­èŠ‚ç‚¹ã€‚ <code>children</code> ä¸<code>hasChildren</code>éƒ½å¯ä»¥é€šè¿‡ <code>tree-props</code> é…ç½®ã€‚</p></blockquote><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// page-content.vue
&lt;template&gt;
  &lt;div class=&quot;content&quot;&gt;
    &lt;div class=&quot;header&quot;&gt;
      &lt;h3 class=&quot;title&quot;&gt;{{ contentConfig?.header?.title ?? &#39;æ•°æ®åˆ—è¡¨&#39; }}&lt;/h3&gt;
      &lt;el-button type=&quot;primary&quot; @click=&quot;handleNewData&quot;&gt;{{ contentConfig?.header?.btnTitle ?? &#39;æ–°å»ºæ•°æ®&#39; }}&lt;/el-button&gt;
    &lt;/div&gt;
    &lt;div class=&quot;table&quot;&gt;
      &lt;el-table :data=&quot;pageList&quot; :border=&quot;true&quot; style=&quot;width: 100%&quot; v-bind=&quot;contentConfig.childrenTree&quot;&gt;
        &lt;template v-for=&quot;item in contentConfig.propsList&quot; :key=&quot;item.prop&quot;&gt;
          &lt;!-- å¤„ç†å¸¦è‡ªå®šä¹‰æ’æ§½çš„æ—¶é—´æ ¼å¼ç±»å‹ --&gt;
          &lt;template v-if=&quot;item.type === &#39;timer&#39;&quot;&gt;
            &lt;el-table-column align=&quot;center&quot; v-bind=&quot;item&quot;&gt;
              &lt;template #default=&quot;scope&quot;&gt;
                {{ formatUTC(scope.row[item.prop]) }}
              &lt;/template&gt;
            &lt;/el-table-column&gt;
          &lt;/template&gt;

          &lt;!-- å¤„ç†handleç±»å‹ --&gt;
          &lt;template v-else-if=&quot;item.type === &#39;handler&#39;&quot;&gt;
            &lt;el-table-column align=&quot;center&quot; v-bind=&quot;item&quot;&gt;
              &lt;template #default=&quot;scope&quot;&gt;
                &lt;el-button type=&quot;primary&quot; size=&quot;small&quot; icon=&quot;EditPen&quot; link @click=&quot;handleEditClick(scope.row)&quot;&gt;
                  ç¼–è¾‘
                &lt;/el-button&gt;
                &lt;el-button type=&quot;danger&quot; size=&quot;small&quot; icon=&quot;Delete&quot; link @click=&quot;handleDeleteClick(scope.row.id)&quot;&gt;
                  åˆ é™¤
                &lt;/el-button&gt;
              &lt;/template&gt;
            &lt;/el-table-column&gt;
          &lt;/template&gt;

          &lt;!-- å¤„ç†æ™®é€šç±»å‹ --&gt;
          &lt;template v-else&gt;
            &lt;!-- &lt;el-table-column align=&quot;center&quot; :type=&quot;item.type&quot; :prop=&quot;item.prop&quot; :label=&quot;item.label&quot; :width=&quot;item.width&quot; /&gt; ç›¸å½“äºä¸‹é¢--&gt;
            &lt;el-table-column align=&quot;center&quot; v-bind=&quot;item&quot; /&gt;
          &lt;/template&gt;
        &lt;/template&gt;

      &lt;/el-table&gt;
    &lt;/div&gt;
    &lt;div class=&quot;footer&quot;&gt;
      &lt;el-pagination
        v-model:currentPage=&quot;currentPage&quot;
        v-model:page-size=&quot;pageSize&quot;
        :page-sizes=&quot;[10, 20, 30]&quot;
        layout=&quot;total, sizes, prev, pager, next, jumper&quot;
        :total=&quot;pageTotalCount&quot;
        @current-change=&quot;handleCurrentChange&quot;
      /&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot; name=&quot;content&quot;&gt;
import { storeToRefs } from &#39;pinia&#39;
import useSystemStore from &#39;@/store/main/system/system&#39;
import { formatUTC } from &#39;@/utils/format&#39;;
import { ref } from &#39;vue&#39;

interface IProps {
  contentConfig: {
    // ç”¨äºå¤„ç†æ¥å£æ–¹æ³•ä¸­ä¼ å…¥çš„pageNameå‚æ•°
    pageName: string,
    header?: {
      title?: string,
      btnTitle: string
    },
    propsList: any[],
    childrenTree: any[]
  }
}

const props = defineProps&lt;IProps&gt;()

const emit = defineEmits([&#39;newDataClick&#39;, &#39;editDataClick&#39;])

// 1.è¯·æ±‚æ•°æ®
const systemStore = useSystemStore()
const currentPage = ref(1)
const pageSize = ref(10)
function fetchPageListData(formData: any = {}) {
  // 1.è·å–offsetå’Œsize
  const size = pageSize.value
  const offset = (currentPage.value - 1) * size
  const pageInfo = { size, offset}

  // 2.å‘èµ·ç½‘ç»œè¯·æ±‚
  const queryInfo = { ...pageInfo, ...formData}
  systemStore.getPageListDataAction(props.contentConfig.pageName, { offset, size, ...queryInfo })
}
fetchPageListData()

// 2.å±•ç¤ºæ•°æ®
const { pageList, pageTotalCount } = storeToRefs(systemStore)

// 3.ç»‘å®šåˆ†é¡µæ•°æ®
function handleCurrentChange() {
  fetchPageListData()
}
function handleResetClick() {
  currentPage.value = 1
  pageSize.value = 10
  fetchPageListData()
}

// 4.æ–°å»ºæ•°æ®çš„å¤„ç†
function handleNewData() {
  emit(&#39;newDataClick&#39;)
}

// 5.åˆ é™¤å’Œç¼–è¾‘æ“ä½œ
function handleDeleteClick(id: number) {
  systemStore.deletePageDataAction(props.contentConfig.pageName, id)
}

function handleEditClick(data: any) {
  emit(&#39;editDataClick&#39;, data)
}

// æš´éœ²å‡½æ•°
defineExpose({
  fetchPageListData,
  handleResetClick
})
&lt;/script&gt;

&lt;style scoped lang=&quot;less&quot;&gt;
.content {
  margin-top: 20px;
  padding: 20px;
  background-color: #fff;

  .header {
    display: flex;
    height: 45px;
    padding: 0 5px;
    justify-content: space-between;
    align-items: center;

    .title {
      font-size: 20px;
      font-weight: 700;
    }

    .handler {
      align-items: center;
    }
  }

  .table {
    :deep(.el-table__cell) {
      padding: 14px 0;
    }
  }

  .footer {
    display: flex;
    justify-content: flex-end;
    margin-top: 15px;
  }
}
&lt;/style&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨é…ç½®é¡¹ç»‘å®š<code>row-key</code>å±æ€§ã€‚</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// content.config.ts
const contentConfig = {
    pageName: &#39;menu&#39;,
    header: {
      title: &#39;èœå•åˆ—è¡¨&#39;,
      btnTitle: &#39;æ–°å»ºèœå•&#39;
    },
    propsList: [
      // è‹¥è¦å®ç°æ ‘å½¢æ•°æ®ï¼Œå°±ä¸èƒ½åŠ typeï¼Œä¼šå†²çª
      { prop: &#39;name&#39;, label: &#39;èœå•åç§°&#39;, width: &#39;180px&#39; },
      { prop: &#39;type&#39;, label: &#39;çº§åˆ«&#39;, width: &#39;120px&#39; },
      { prop: &#39;url&#39;, label: &#39;èœå•url&#39;, width: &#39;150px&#39; },
      { prop: &#39;icon&#39;, label: &#39;èœå•icon&#39;, width: &#39;180px&#39; },
      { prop: &#39;sort&#39;, label: &#39;æ’åº&#39;, width: &#39;120px&#39; },
      { prop: &#39;permission&#39;, label: &#39;æƒé™&#39;, width: &#39;150px&#39; },
      { type: &#39;time&#39;, prop: &#39;createAt&#39;, label: &#39;åˆ›å»ºæ—¶é—´&#39; },
      { type: &#39;time&#39;, prop: &#39;updateAt&#39;, label: &#39;æ›´æ–°æ—¶é—´&#39; },
      { type: &#39;handler&#39;, label: &#39;æ“ä½œ&#39;, width: &#39;150px&#39;}
    ],
    childrenTree: {
      rowKey: &#39;id&#39;,
      treeProps: {
        children: &#39;children&#39;
      }
    }
  }

export default contentConfig
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®ç°æ–°å¢ã€ç¼–è¾‘æ¨¡æ€æ¡†åŠŸèƒ½ä»¥åŠåˆ é™¤åŠŸèƒ½" tabindex="-1"><a class="header-anchor" href="#å®ç°æ–°å¢ã€ç¼–è¾‘æ¨¡æ€æ¡†åŠŸèƒ½ä»¥åŠåˆ é™¤åŠŸèƒ½" aria-hidden="true">#</a> å®ç°æ–°å¢ã€ç¼–è¾‘æ¨¡æ€æ¡†åŠŸèƒ½ä»¥åŠåˆ é™¤åŠŸèƒ½</h3><p>ä½¿ç”¨é…ç½®æ–‡ä»¶å®Œæˆã€‚</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// modal.config.ts
const modalConfig = {
    pageName: &#39;menu&#39;,
    header: {
      newTitle: &#39;æ–°å»ºèœå•&#39;,
      editTitle: &#39;ç¼–è¾‘èœå•&#39;
    },
    formItems: [
      {
        type: &#39;input&#39;,
        label: &#39;èœå•åç§°&#39;,
        prop: &#39;name&#39;,
        placeholder: &#39;è¯·è¾“å…¥èœå•åç§°&#39;
      },
      {
        type: &#39;input&#39;,
        label: &#39;èœå•çº§åˆ«&#39;,
        prop: &#39;type&#39;,
        placeholder: &#39;è¯·è¾“å…¥èœå•çº§åˆ«&#39;
      },
      {
        type: &#39;input&#39;,
        label: &#39;èœå•çº§åˆ«&#39;,
        prop: &#39;type&#39;,
        placeholder: &#39;è¯·è¾“å…¥èœå•çº§åˆ«&#39;
      },
      {
        type: &#39;input&#39;,
        label: &#39;èœå•url&#39;,
        prop: &#39;url&#39;,
        placeholder: &#39;è¯·è¾“å…¥èœå•url&#39;
      },
      {
        type: &#39;input&#39;,
        label: &#39;èœå•icon&#39;,
        prop: &#39;icon&#39;,
        placeholder: &#39;è¯·è¾“å…¥èœå•icon&#39;
      },
      {
        type: &#39;input&#39;,
        label: &#39;æ’åº&#39;,
        prop: &#39;sort&#39;,
        placeholder: &#39;è¯·è¾“å…¥æ’åº&#39;
      },
      {
        type: &#39;input&#39;,
        label: &#39;æƒé™&#39;,
        prop: &#39;permission&#39;,
        placeholder: &#39;è¯·è¾“å…¥æƒé™&#39;
      },
      {
        type: &#39;input&#39;,
        label: &#39;åˆ›å»ºæ—¶é—´&#39;,
        prop: &#39;createAt&#39;,
        placeholder: &#39;è¯·è¾“å…¥åˆ›å»ºæ—¶é—´&#39;
      },
      {
        type: &#39;input&#39;,
        label: &#39;æ›´æ–°æ—¶é—´&#39;,
        prop: &#39;updateAt&#39;,
        placeholder: &#39;è¯·è¾“å…¥æ›´æ–°æ—¶é—´&#39;
      },
      {
        type: &#39;custom&#39;,
        slotName: &#39;menulist&#39;
      }
    ]
}
export default modalConfig

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>çˆ¶ç»„ä»¶<code>menu.vue</code>ä¼ é€’é…ç½®æ–‡ä»¶ä¸­çš„é…ç½®é¡¹ã€‚</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>&lt;template&gt;
  &lt;div class=&quot;menu&quot;&gt;
    &lt;page-content :content-config=&quot;contentConfig&quot; @new-data-click=&quot;handleNewDataClick&quot; @edit-data-click=&quot;handleEditDataClick&quot;/&gt;
    &lt;page-modal :modal-config=&quot;modalConfig&quot; ref=&quot;modalRef&quot;/&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot; name=&quot;menu&quot;&gt;
import PageContent from &#39;@/components/page-content/page-content.vue&#39;;
import contentConfig from &#39;./config/content.config&#39;;

import PageModal from &#39;@/components/page-modal/page-modal.vue&#39;;
import modalConfig from &#39;./config/modal.config&#39;;

import { usePageModal } from &#39;@/hooks/usePageModal&#39;;

const { modalRef, handleEditDataClick, handleNewDataClick } = usePageModal()
&lt;/script&gt;

&lt;style scoped&gt;
&lt;/style&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="å®ç°è§’è‰²ç®¡ç†ä¸­çš„æƒé™åˆ†é…-éš¾ç‚¹" tabindex="-1"><a class="header-anchor" href="#å®ç°è§’è‰²ç®¡ç†ä¸­çš„æƒé™åˆ†é…-éš¾ç‚¹" aria-hidden="true">#</a> å®ç°è§’è‰²ç®¡ç†ä¸­çš„æƒé™åˆ†é…ï¼ˆéš¾ç‚¹ï¼‰</h2><p><strong>åœ¨æ–°å»ºè§’è‰²æ—¶ä½¿ç”¨ä¸Šæ–‡å†™çš„è‡ªå®šä¹‰ä½œç”¨åŸŸæ’æ§½å®šåˆ¶åŒ–æ ‘å½¢é€‰æ‹©è§’è‰²æƒé™åˆ—è¡¨ã€‚</strong></p><h3 id="åˆ›å»ºè§’è‰²çš„èœå•æ ‘å±•ç¤º" tabindex="-1"><a class="header-anchor" href="#åˆ›å»ºè§’è‰²çš„èœå•æ ‘å±•ç¤º" aria-hidden="true">#</a> åˆ›å»ºè§’è‰²çš„èœå•æ ‘å±•ç¤º</h3><p><img src="https://secure2.wostatic.cn/static/6rSjN4g6PwbrGQjTNx1xjF/image.png" alt=""></p><h4 id="å°è£…è¯·æ±‚æ¥å£æ•°æ®" tabindex="-1"><a class="header-anchor" href="#å°è£…è¯·æ±‚æ¥å£æ•°æ®" aria-hidden="true">#</a> å°è£…è¯·æ±‚æ¥å£æ•°æ®</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// service/main.ts
// è·å–æ‰€æœ‰èœå•
export function getEntireMenus() {
    return hyRequest.post({
        url: &quot;/menu/list&quot;
    })
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// store/main.ts
import { getEntireDepartments, getEntireMenus, getEntireRoles } from &quot;@/service/main/main&quot;;
import { defineStore } from &quot;pinia&quot;;

interface IMainState {
    // ...
    entireMenus: any[]
}
const useMainStore = defineStore(&#39;main&#39;, {
    state: (): IMainState =&gt; ({
        // ...
        entireMenus: []
    }),
    actions: {
        async fetchEntireDataAction() {
            // ...
            const menuResult = await getEntireMenus()
            this.entireMenus = menuResult.data.list
        }
    }

})
export default useMainStore

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="åœ¨é…ç½®æ–‡ä»¶ä¸­å®šä¹‰è‡ªå®šä¹‰ç±»å‹" tabindex="-1"><a class="header-anchor" href="#åœ¨é…ç½®æ–‡ä»¶ä¸­å®šä¹‰è‡ªå®šä¹‰ç±»å‹" aria-hidden="true">#</a> åœ¨é…ç½®æ–‡ä»¶ä¸­å®šä¹‰è‡ªå®šä¹‰ç±»å‹</h4><p>å› ä¸ºæ–°å»ºè§’è‰²åœ¨æ¨¡æ€æ¡†ä¸­å±•ç°ï¼Œå› æ­¤åœ¨<code>modal.config.ts</code>ä¸­å®šä¹‰ã€‚</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>const modalConfig = {
    pageName: &#39;role&#39;,
    header: {
      newTitle: &#39;æ–°å»ºè§’è‰²&#39;,
      editTitle: &#39;ç¼–è¾‘è§’è‰²&#39;
    },
    formItems: [
      {
        type: &#39;input&#39;,
        label: &#39;è§’è‰²åç§°&#39;,
        prop: &#39;name&#39;,
        placeholder: &#39;è¯·è¾“å…¥è§’è‰²åç§°&#39;
      },
      {
        type: &#39;input&#39;,
        label: &#39;æƒé™ä»‹ç»&#39;,
        prop: &#39;intro&#39;,
        placeholder: &#39;è¯·è¾“å…¥æƒé™ä»‹ç»&#39;
      },
      // è‡ªå®šä¹‰ç±»å‹
      {
        type: &#39;custom&#39;,
        slotName: &#39;menulist&#39;
      }
    ]
}
export default modalConfig

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¼–å†™è‡ªå®šä¹‰æ’æ§½" tabindex="-1"><a class="header-anchor" href="#ç¼–å†™è‡ªå®šä¹‰æ’æ§½" aria-hidden="true">#</a> ç¼–å†™è‡ªå®šä¹‰æ’æ§½</h4><p>åœ¨<code>page-modal.vue</code>ä¸­ç¼–å†™<code>type</code>ä¸º<code>custom</code>çš„ä½œç”¨åŸŸæ’æ§½ã€‚</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>&lt;template&gt;
  &lt;div class=&quot;modal&quot;&gt;
    &lt;el-dialog v-model=&quot;dialogVisible&quot; :title=&quot;isEdit ? modalConfig.header.editTitle : modalConfig.header.newTitle&quot; width=&quot;30%&quot; center&gt;
      &lt;div class=&quot;form&quot;&gt;
        &lt;el-form :model=&quot;formData&quot; label-width=&quot;80px&quot; size=&quot;large&quot;&gt;
          &lt;template v-for=&quot;item in modalConfig.formItems&quot; :key=&quot;item.prop&quot;&gt;
            &lt;el-form-item v-bind=&quot;item&quot;&gt;
              &lt;template v-if=&quot;item.type === &#39;input&#39;&quot;&gt;
                // ...
              &lt;/template&gt;

              &lt;template v-if=&quot;item.type === &#39;select&#39;&quot;&gt;
                // ...
              &lt;/template&gt;

              &lt;!-- è‡ªå®šä¹‰æ’æ§½ï¼šå¦‚è§’è‰²ç®¡ç†ä¸­çš„æƒé™æ ‘å½¢é€‰æ‹© --&gt;
              &lt;template v-if=&quot;item.type === &#39;custom&#39;&quot;&gt;
                &lt;slot :name=&quot;item.slotName&quot;&gt;&lt;/slot&gt;
              &lt;/template&gt;
            &lt;/el-form-item&gt;
          &lt;/template&gt;
        &lt;/el-form&gt;
      &lt;/div&gt;
      // ...
    &lt;/el-dialog&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="åœ¨çˆ¶ç»„ä»¶ä¸­å®ç°èœå•åˆ—è¡¨çš„è‡ªå®šä¹‰æ’æ§½" tabindex="-1"><a class="header-anchor" href="#åœ¨çˆ¶ç»„ä»¶ä¸­å®ç°èœå•åˆ—è¡¨çš„è‡ªå®šä¹‰æ’æ§½" aria-hidden="true">#</a> åœ¨çˆ¶ç»„ä»¶ä¸­å®ç°èœå•åˆ—è¡¨çš„è‡ªå®šä¹‰æ’æ§½</h4><p>ä½¿ç”¨<code>el-tree</code>ä¸­çš„æ ‘èŠ‚ç‚¹é€‰æ‹©å®ç°ï¼Œå°†è¯·æ±‚æ¥å£æ•°æ®<code>entireMenus</code>ä¼ å…¥ç»™<code>:data</code>å³å¯ã€‚</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>&lt;template&gt;
  &lt;div class=&quot;role&quot;&gt;
    &lt;page-search :search-config=&quot;searchConfig&quot; @query-click=&quot;handleQueryClick&quot; @reset-click=&quot;handleResetClick&quot;/&gt;
    &lt;page-content :content-config=&quot;contentConfig&quot; ref=&quot;contentRef&quot; @new-data-click=&quot;handleNewDataClick&quot; @edit-data-click=&quot;handleEditDataClick&quot;/&gt;
    &lt;page-modal :modal-config=&quot;modalConfig&quot; ref=&quot;modalRef&quot;&gt;
      &lt;!-- è‡ªå®šä¹‰èœå•åˆ—è¡¨ --&gt;
      &lt;template #menulist&gt;
        &lt;el-tree
          ref=&quot;treeRef&quot;
          :data=&quot;entireMenus&quot;
          show-checkbox
          default-expand-all
          node-key=&quot;id&quot;
          highlight-current
          :props=&quot;{ children: &#39;children&#39;, label: &#39;name&#39; }&quot;
        /&gt;
      &lt;/template&gt;
    &lt;/page-modal&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import pageSearch from &#39;@/components/page-search/page-search.vue&#39;;
import searchConfig from &#39;./config/search.config&#39;

import pageContent from &#39;@/components/page-content/page-content.vue&#39;;
import contentConfig from &#39;./config/content.config&#39;;

import pageModal from &#39;@/components/page-modal/page-modal.vue&#39;;
import modalConfig from &#39;./config/modal.config&#39;;

import { usePageContent } from &#39;@/hooks/usePageContent&#39;;
import { usePageModal } from &#39;@/hooks/usePageModal&#39;;
import useMainStore from &#39;@/store/main/main&#39;;
import { storeToRefs } from &#39;pinia&#39;;

// hooksé€»è¾‘å…³ç³»
const { contentRef, handleQueryClick, handleResetClick } = usePageContent()
const { modalRef, handleEditDataClick, handleNewDataClick } = usePageModal()

const mainStore = useMainStore()
const { entireMenus } = storeToRefs(mainStore)
&lt;/script&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="åˆ›å»ºè§’è‰²æºå¸¦èœå•æ ‘çš„æƒé™æ•°æ®" tabindex="-1"><a class="header-anchor" href="#åˆ›å»ºè§’è‰²æºå¸¦èœå•æ ‘çš„æƒé™æ•°æ®" aria-hidden="true">#</a> åˆ›å»ºè§’è‰²æºå¸¦èœå•æ ‘çš„æƒé™æ•°æ®</h3><p>å°†èœå•æ ‘çš„<code>menulist</code>å’Œ<code>formData</code>ç»‘å®šä¸€èµ·ä¼ é€’ç»™æœåŠ¡å™¨ï¼Œä½¿ç”¨<code>el-tree</code>ä¸­<code>check</code>å±æ€§è·å–é€‰ä¸­å€¼ï¼Œé‡Œé¢æœ‰ 2 ä¸ªå‚æ•°ï¼Œç¬¬ 2 ä¸ªå‚æ•°èƒ½å¤Ÿè·å–å½“å‰é€‰ä¸­çš„ç»“ç‚¹<code>checkedNodes</code>ä»¥åŠå®ƒçš„çˆ¶ç»“ç‚¹<code>halfCheckedNodes</code>å’Œå®ƒä»¬çš„<code>key</code>ã€‚</p><h4 id="çˆ¶ç»„ä»¶ä¸­è·å–æƒé™æ•°æ®å¹¶ä¼ é€’ç»™-page-modal-å­ç»„ä»¶" tabindex="-1"><a class="header-anchor" href="#çˆ¶ç»„ä»¶ä¸­è·å–æƒé™æ•°æ®å¹¶ä¼ é€’ç»™-page-modal-å­ç»„ä»¶" aria-hidden="true">#</a> çˆ¶ç»„ä»¶ä¸­è·å–æƒé™æ•°æ®å¹¶ä¼ é€’ç»™ page-modal å­ç»„ä»¶</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// role.vue
&lt;template&gt;
  &lt;div class=&quot;role&quot;&gt;
    // ...
    &lt;page-modal :modal-config=&quot;modalConfig&quot; ref=&quot;modalRef&quot; :other-info=&quot;otherInfo&quot;&gt;
      &lt;!-- è‡ªå®šä¹‰èœå•åˆ—è¡¨ --&gt;
      &lt;template #menulist&gt;
        &lt;el-tree
          // ...
          @check=&quot;handleELTreeCheck&quot;
        /&gt;
      &lt;/template&gt;
    &lt;/page-modal&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
// ...
// è·å–æ ‘å½¢åˆ—è¡¨çš„key(id)
const otherInfo = ref({})
function handleELTreeCheck(data1: any, data2: any) {
  const menuList = [...data2.checkedKeys, ...data2.halfCheckedKeys]
  otherInfo.value = { menuList }
}
&lt;/script&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å­ç»„ä»¶æ¥å—æ•°æ®å¹¶å°†å…¶åˆå¹¶å‘é€ç»™æœåŠ¡å™¨" tabindex="-1"><a class="header-anchor" href="#å­ç»„ä»¶æ¥å—æ•°æ®å¹¶å°†å…¶åˆå¹¶å‘é€ç»™æœåŠ¡å™¨" aria-hidden="true">#</a> å­ç»„ä»¶æ¥å—æ•°æ®å¹¶å°†å…¶åˆå¹¶å‘é€ç»™æœåŠ¡å™¨</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// page-modal.vue
&lt;script setup lang=&quot;ts&quot; name=&quot;modal&quot;&gt;
// ...
interface IProps {
  modalConfig: {
    // ...
  }
  otherInfo?: any
}

// ...

// ç‚¹å‡»ç¡®å®š
const systemStore = useSystemStore()
function handleConfirmClick() {
  dialogVisible.value = false

  // è‹¥æœ‰å…¶å®ƒinfoè¿›è¡Œåˆå¹¶å‘é€ç»™æœåŠ¡å™¨ï¼ˆå¦‚ï¼šè§’è‰²ç®¡ç†ä¸­æ–°å»ºè§’è‰²çš„æƒé™åˆ†é…èœå•æ ‘menuListï¼‰
  let infoData = formData
  if(props.otherInfo) {
    infoData = { ...formData, ...props.otherInfo}
  }

  if (!isEdit.value) {
    systemStore.newPageDataAction(props.modalConfig.pageName, infoData)
  } else {
    systemStore.editPageDataAction(props.modalConfig.pageName, editData.value.id, infoData)
  }
}
&lt;/script&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ç¼–è¾‘æ—¶è§’è‰²èœå•æƒé™å›æ˜¾" tabindex="-1"><a class="header-anchor" href="#ç¼–è¾‘æ—¶è§’è‰²èœå•æƒé™å›æ˜¾" aria-hidden="true">#</a> ç¼–è¾‘æ—¶è§’è‰²èœå•æƒé™å›æ˜¾</h3><h4 id="å°è£…èœå•æ˜ å°„æƒé™-id-åˆ—è¡¨çš„å·¥å…·" tabindex="-1"><a class="header-anchor" href="#å°è£…èœå•æ˜ å°„æƒé™-id-åˆ—è¡¨çš„å·¥å…·" aria-hidden="true">#</a> å°è£…èœå•æ˜ å°„æƒé™ Id åˆ—è¡¨çš„å·¥å…·</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// utils/map-menus.ts
/**
 * èœå•æ˜ å°„åˆ°idçš„åˆ—è¡¨ï¼ˆç”¨äºè§’è‰²ç®¡ç†çš„æƒé™æ ‘åˆ†é…ï¼‰
 * @param menuList
 */
export function mapMenuListToIds(menuList: any[]) {
  const ids: number[] = []

  function recurseGetId(menus: any[]) {
    for(const item of menus) {
      // å¦‚æœæœ‰å­èœå•ï¼Œå°±é€’å½’ç›´åˆ°æ²¡æœ‰å­èœå•ï¼Œç„¶åæŠŠidæ·»åŠ åˆ°idsä¸­
      if(item.children) {
        recurseGetId(item.children)
      } else {
        ids.push(item.id)
      }
    }
  }
  recurseGetId(menuList)
  return ids
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="è·å–è§’è‰²æƒé™èœå•çš„æ•°æ®" tabindex="-1"><a class="header-anchor" href="#è·å–è§’è‰²æƒé™èœå•çš„æ•°æ®" aria-hidden="true">#</a> è·å–è§’è‰²æƒé™èœå•çš„æ•°æ®</h4><p>åœ¨ç‚¹å‡»ç¼–è¾‘æŒ‰é’®è§¦å‘<code>usePageModal</code>äº‹ä»¶æ—¶ï¼Œä¼ å…¥çš„å‚æ•°<code>itemData</code>ä¸­å¯ä»¥æ‹¿åˆ°æ¨¡æ€æ¡†é‡Œçš„æ•°æ®ï¼ˆåŒ…æ‹¬èœå•æ ‘æ§ä»¶<code>el-tree</code>ï¼‰ï¼Œä½†æ˜¯å› ä¸ºç‚¹å‡»ç¼–è¾‘äº‹ä»¶å°è£…åœ¨<code>hooks</code>é‡Œé¢ï¼Œåœ¨<code>role.vue</code>ä¸­éœ€è¦ä¼ å…¥ä¸€ä¸ªå‡½æ•°<code>editCallback</code>æ¥è·å–ã€‚</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>type callbackType = (item: any) =&gt; void
export function usePageModal(editCallback?: callbackType) {
    const modalRef = ref&lt;InstanceType&lt;typeof PageModal&gt;&gt;()
    // ...
    // ç¼–è¾‘åŠŸèƒ½
    function handleEditDataClick(itemData: any) {
        modalRef.value?.setDialogVisible(false, itemData)
        // å›æ˜¾è§’è‰²ç®¡ç†ä¸­æƒé™èœå•æ ‘
        if(editCallback) editCallback(itemData)
    }
    return {
        handleEditDataClick,
        // ...
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ role.vue ä¸­ä½¿ç”¨<code>editCallback</code>å‡½æ•°æ¥æ¥å—ç¼–è¾‘äº‹ä»¶ä¼ æ¥çš„<code>itemData</code>ï¼ˆå¯¹è±¡ï¼‰ï¼Œå¹¶å°†å…¶ç”¨<code>mapMenuListToIds</code>å·¥å…·å¤„ç†æˆ<code>id</code>æ•°ç»„ï¼Œåœ¨<code>nextTick()</code>ä¸­è°ƒç”¨ã€‚</p><blockquote><p><code>nextTick</code>ï¼šå½“ä½ åœ¨ Vue ä¸­æ›´æ”¹å“åº”å¼çŠ¶æ€æ—¶ï¼Œæœ€ç»ˆçš„ DOM æ›´æ–°å¹¶ä¸æ˜¯åŒæ­¥ç”Ÿæ•ˆçš„ï¼Œè€Œæ˜¯ç”± Vue å°†å®ƒä»¬ç¼“å­˜åœ¨ä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œç›´åˆ°ä¸‹ä¸€ä¸ªâ€œtickâ€æ‰ä¸€èµ·æ‰§è¡Œã€‚è¿™æ ·æ˜¯ä¸ºäº†ç¡®ä¿æ¯ä¸ªç»„ä»¶æ— è®ºå‘ç”Ÿå¤šå°‘çŠ¶æ€æ”¹å˜ï¼Œéƒ½ä»…æ‰§è¡Œä¸€æ¬¡æ›´æ–°ã€‚<code>nextTick()</code> å¯ä»¥åœ¨çŠ¶æ€æ”¹å˜åç«‹å³ä½¿ç”¨ï¼Œä»¥ç­‰å¾… DOM æ›´æ–°å®Œæˆã€‚</p></blockquote><blockquote><p>Vue æ˜¯å¼‚æ­¥æ‰§è¡Œ dom æ›´æ–°çš„ï¼Œä¸€æ—¦è§‚å¯Ÿåˆ°æ•°æ®å˜åŒ–ï¼ŒVue å°±ä¼šå¼€å¯ä¸€ä¸ªé˜Ÿåˆ—ï¼Œç„¶åæŠŠåœ¨åŒä¸€ä¸ªäº‹ä»¶å¾ªç¯ (event loop) å½“ä¸­è§‚å¯Ÿåˆ°æ•°æ®å˜åŒ–çš„ watcher æ¨é€è¿›è¿™ä¸ªé˜Ÿåˆ—ã€‚å¦‚æœè¿™ä¸ª watcher è¢«è§¦å‘å¤šæ¬¡ï¼Œåªä¼šè¢«æ¨é€åˆ°é˜Ÿåˆ—ä¸€æ¬¡ã€‚è¿™ç§ç¼“å†²è¡Œä¸ºå¯ä»¥æœ‰æ•ˆçš„å»æ‰é‡å¤æ•°æ®é€ æˆçš„ä¸å¿…è¦çš„è®¡ç®—å’Œ DOm æ“ä½œã€‚è€Œåœ¨ä¸‹ä¸€ä¸ªäº‹ä»¶å¾ªç¯æ—¶ï¼ŒVue ä¼šæ¸…ç©ºé˜Ÿåˆ—ï¼Œå¹¶è¿›è¡Œå¿…è¦çš„ DOM æ›´æ–°ã€‚<br> å½“ä½ è®¾ç½® vm.someData = &#39;new value&#39;ï¼ŒDOM å¹¶ä¸ä¼šé©¬ä¸Šæ›´æ–°ï¼Œè€Œæ˜¯åœ¨å¼‚æ­¥é˜Ÿåˆ—è¢«æ¸…é™¤ï¼Œä¹Ÿå°±æ˜¯ä¸‹ä¸€ä¸ªäº‹ä»¶å¾ªç¯å¼€å§‹æ—¶æ‰§è¡Œæ›´æ–°æ—¶æ‰ä¼šè¿›è¡Œå¿…è¦çš„ DOM æ›´æ–°ã€‚å¦‚æœæ­¤æ—¶ä½ æƒ³è¦æ ¹æ®æ›´æ–°çš„ DOM çŠ¶æ€å»åšæŸäº›äº‹æƒ…ï¼Œå°±ä¼šå‡ºç°é—®é¢˜ã€‚ã€‚ä¸ºäº†åœ¨æ•°æ®å˜åŒ–ä¹‹åç­‰å¾… Vue å®Œæˆæ›´æ–° DOM ï¼Œå¯ä»¥åœ¨æ•°æ®å˜åŒ–ä¹‹åç«‹å³ä½¿ç”¨ Vue.nextTick(callback) ï¼Œè¿™æ ·å›è°ƒå‡½æ•°åœ¨ DOM æ›´æ–°å®Œæˆåå°±ä¼šè°ƒç”¨ã€‚åœ¨ Vue3 ä¸­æ˜¯å¾®ä»»åŠ¡ï¼ŒVue2 ä¸­ä¸æ–­æ›´æ–°å˜åŒ–ã€‚</p></blockquote><p><img src="https://secure2.wostatic.cn/static/g74CyDLQpixmcAHwDpCFbs/image.png" alt=""></p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>&lt;template&gt;
  &lt;div class=&quot;role&quot;&gt;
    // ...
    &lt;page-modal :modal-config=&quot;modalConfig&quot; ref=&quot;modalRef&quot; :other-info=&quot;otherInfo&quot;&gt;
      &lt;!-- è‡ªå®šä¹‰èœå•åˆ—è¡¨ --&gt;
      &lt;template #menulist&gt;
        &lt;el-tree
          ref=&quot;treeRef&quot;
          :data=&quot;entireMenus&quot;
          show-checkbox
          default-expand-all
          node-key=&quot;id&quot;
          highlight-current
          :props=&quot;{ children: &#39;children&#39;, label: &#39;name&#39; }&quot;
          @check=&quot;handleELTreeCheck&quot;
        /&gt;
      &lt;/template&gt;
    &lt;/page-modal&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
// ...
import { ref, nextTick } from &#39;vue&#39;;
import { mapMenuListToIds } from &#39;@/utils/map-menus&#39;;
import type { ElTree } from &#39;element-plus/es/components/index.js&#39;;
// ...
const { modalRef, handleEditDataClick, handleNewDataClick } = usePageModal(editCallback)

// ...
// ç¼–è¾‘è§’è‰²èœå•æƒé™å›æ˜¾
const treeRef = ref&lt;InstanceType&lt;typeof ElTree&gt;&gt;()
function editCallback(data: any){
  nextTick(() =&gt; {
    const menuList = mapMenuListToIds(data.menuList)
    // åªæœ‰åœ¨nextTickä¹‹åæ‰èƒ½è®¾ç½®setCheckedKeys
    treeRef.value?.setCheckedKeys(menuList)
  })
}
&lt;/script&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ–°å¢æ—¶è§’è‰²èœå•æƒé™å›æ˜¾é‡ç½®" tabindex="-1"><a class="header-anchor" href="#æ–°å¢æ—¶è§’è‰²èœå•æƒé™å›æ˜¾é‡ç½®" aria-hidden="true">#</a> æ–°å¢æ—¶è§’è‰²èœå•æƒé™å›æ˜¾é‡ç½®</h3><h4 id="é‡ç½®è§’è‰²æƒé™èœå•æ ‘çš„æ•°æ®" tabindex="-1"><a class="header-anchor" href="#é‡ç½®è§’è‰²æƒé™èœå•æ ‘çš„æ•°æ®" aria-hidden="true">#</a> é‡ç½®è§’è‰²æƒé™èœå•æ ‘çš„æ•°æ®</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// role.vue
&lt;script setup lang=&quot;ts&quot;&gt;
import { ref, nextTick } from &#39;vue&#39;;
import { mapMenuListToIds } from &#39;@/utils/map-menus&#39;;
import type { ElTree } from &#39;element-plus/es/components/index.js&#39;;
// ...
const { modalRef, handleEditDataClick, handleNewDataClick } = usePageModal(newCallback, editCallback)

// ...
// æ–°å¢è§’è‰²èœå•æƒé™é‡ç½®
function newCallback(){
  nextTick(() =&gt; {
    treeRef.value?.setCheckedKeys([])
  })
}
// ç¼–è¾‘è§’è‰²èœå•æƒé™å›æ˜¾...
}
&lt;/script&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="hooks-ä¸­è°ƒç”¨" tabindex="-1"><a class="header-anchor" href="#hooks-ä¸­è°ƒç”¨" aria-hidden="true">#</a> hooks ä¸­è°ƒç”¨</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// ...
type callbackType = (item?: any) =&gt; void
export function usePageModal(newCallback?: callbackType, editCallback?: callbackType) {
    const modalRef = ref&lt;InstanceType&lt;typeof PageModal&gt;&gt;()
    // æ–°å¢åŠŸèƒ½
    function handleNewDataClick() {
        modalRef.value?.setDialogVisible()
        if(newCallback) newCallback()
    }
    // ç¼–è¾‘åŠŸèƒ½...
    return {
        modalRef,
        handleEditDataClick,
        handleNewDataClick
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="å®ç°ç™»å½•ç”¨æˆ·çš„æƒé™åŠŸèƒ½" tabindex="-1"><a class="header-anchor" href="#å®ç°ç™»å½•ç”¨æˆ·çš„æƒé™åŠŸèƒ½" aria-hidden="true">#</a> å®ç°ç™»å½•ç”¨æˆ·çš„æƒé™åŠŸèƒ½</h2><p>é€šè¿‡æ¯ä¸ªå­èœå•ä¸‹å¢åˆ æ”¹æŸ¥çš„å¦‚<code>permission:&quot;system:users:create&quot;</code>å­—æ®µå®ç°ï¼Œç”¨äºæ§åˆ¶æŒ‰é’®æƒé™çš„å±•ç¤ºã€‚</p><h3 id="å°è£…èœå•æ˜ å°„æŒ‰é’®æƒé™å·¥å…·" tabindex="-1"><a class="header-anchor" href="#å°è£…èœå•æ˜ å°„æŒ‰é’®æƒé™å·¥å…·" aria-hidden="true">#</a> å°è£…èœå•æ˜ å°„æŒ‰é’®æƒé™å·¥å…·</h3><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// map-menus.ts
/**
 * èœå•æ˜ å°„åˆ°æŒ‰é’®çš„æƒé™permissions
 * @param menuList èœå•åˆ—è¡¨
 * @returns æƒé™çš„æ•°ç»„
 */
export function mapMenuListToPermissions(menuList :any) {
  const permissions: string[] = []

  function recurseGetPermission(menus: any[]) {
    for(const item of menus) {
      if(item.type === 3) {
        permissions.push(item.permission)
      } else {
        // æ²¡æœ‰å­æ ‘çš„è¯å°±å°†menusè®¾ç½®ä¸ºç©ºæ•°ç»„ï¼Œå¦åˆ™ä¼šnull/undefineæŠ¥é”™
        recurseGetPermission(item.children ?? [])
      }
    }
  }
  recurseGetPermission(menuList)

  return permissions
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="è·å–ç™»å½•ç”¨æˆ·çš„æ‰€æœ‰æŒ‰é’®æƒé™" tabindex="-1"><a class="header-anchor" href="#è·å–ç™»å½•ç”¨æˆ·çš„æ‰€æœ‰æŒ‰é’®æƒé™" aria-hidden="true">#</a> è·å–ç™»å½•ç”¨æˆ·çš„æ‰€æœ‰æŒ‰é’®æƒé™</h3><p>ä½¿ç”¨èœå•æ˜ å°„æŒ‰é’®æƒé™å·¥å…·ï¼Œè·å–ç™»å½•ç”¨æˆ·çš„æ‰€æœ‰æƒé™ï¼Œå­˜å…¥<code>pinia</code>ä¸­ã€‚</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>import { mapMenuListToPermissions, mapMenuToRoutes } from &quot;@/utils/map-menus&quot;;

interface ILoginState {
    // ...
    permissions: string[],
}

const useLoginStore = defineStore(&#39;login&#39;, {
    state: (): ILoginState =&gt; ({
        // ...
        permissions: []
    }),
    actions: {
        async loginAccountAction(account: IAccount) {
            // ...

            // 7.è·å–ç™»å½•ç”¨æˆ·çš„æ‰€æœ‰æŒ‰é’®æƒé™
            const permissions = mapMenuListToPermissions(this.userMenus)
            this.permissions = permissions
        },

        // è§£å†³åˆ·æ–°é¡µé¢åï¼ŒåŠ¨æ€è·¯ç”±ä¸¢å¤±çš„é—®é¢˜(ä¸å†æ˜¯loginAccountActionç™»å½•æ—¶æ‰æ‰§è¡Œ)
        loadLocalDataAction() {
            // ...
            if(token &amp;&amp; userInfo &amp;&amp; userMenus) {
                // ...
                // åˆ·æ–°æ—¶ç¼“å­˜æŒ‰é’®æƒé™
                const permissions = mapMenuListToPermissions(userMenus)
                this.permissions = permissions
            }
        }
    }
})

export default useLoginStore
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å°è£…æƒé™-hooks" tabindex="-1"><a class="header-anchor" href="#å°è£…æƒé™-hooks" aria-hidden="true">#</a> å°è£…æƒé™ hooks</h3><p>ç”¨äºæŸ¥è¯¢æŸä¸ªé¡µé¢çš„æƒé™æ˜¯å¦åœ¨è·å–åˆ°çš„ç™»å½•ç”¨æˆ·æ‰€æœ‰æƒé™ä¸­ï¼Œå¦‚åˆ¤æ–­<code>department:create</code>ã€<code>department:update</code>æ˜¯å¦åŒ…å«åœ¨ç™»å½•ç”¨æˆ·å­˜å…¥åœ¨<code>pinia</code>ä¸­çš„<code>permissions</code>æ•°ç»„ï¼Œç”¨<code>permissions.find</code>å»æŸ¥æ‰¾ã€‚</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// hooks/usePermission.ts
import useLoginStore from &#39;@/store/login/login&#39;

function usePermission(pageName: string, handleName: string) {
  const queryPermission = `${pageName}:${handleName}`
  const { permissions } = useLoginStore()

  // !!å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå¸ƒå°”å€¼
  return !!permissions.find((item) =&gt; item.includes(queryPermission))
}

export default usePermission

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ç¼–å†™-page-content-ç»„ä»¶" tabindex="-1"><a class="header-anchor" href="#ç¼–å†™-page-content-ç»„ä»¶" aria-hidden="true">#</a> ç¼–å†™ Page-content ç»„ä»¶</h3><p>è°ƒç”¨ hooksï¼Œåˆ¤æ–­æ¯ä¸€ä¸ªæŒ‰é’®æ˜¯å¦æœ‰æœ‰å¯¹åº”çš„å¢åˆ æ”¹æŸ¥æƒé™ï¼Œä½¿ç”¨<code>v-if</code>æ§åˆ¶å¯¹åº”æŒ‰é’®çš„æ˜¾ç¤ºã€‚</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>&lt;template&gt;
  &lt;div class=&quot;content&quot;&gt;
    &lt;div class=&quot;header&quot;&gt;
      // ...
      // å¢
      &lt;el-button v-if=&quot;isCreate&quot; type=&quot;primary&quot; @click=&quot;handleNewData&quot;&gt;{{ contentConfig?.header?.btnTitle ?? &#39;æ–°å»ºæ•°æ®&#39; }}&lt;/el-button&gt;
    &lt;/div&gt;
    &lt;div class=&quot;table&quot;&gt;
      &lt;el-table :data=&quot;pageList&quot; :border=&quot;true&quot; style=&quot;width: 100%&quot; v-bind=&quot;contentConfig.childrenTree&quot;&gt;
            // ...
          &lt;!-- å¤„ç†handleç±»å‹ --&gt;
          &lt;template v-else-if=&quot;item.type === &#39;handler&#39;&quot;&gt;
            // ...
            // æ”¹
            &lt;el-button v-if=&quot;isUpdate&quot; type=&quot;primary&quot; size=&quot;small&quot; icon=&quot;EditPen&quot; link @click=&quot;handleEditClick(scope.row)&quot;&gt;
              ç¼–è¾‘
            &lt;/el-button&gt;
            // åˆ 
            &lt;el-button v-if=&quot;isDelete&quot; type=&quot;danger&quot; size=&quot;small&quot; icon=&quot;Delete&quot; link @click=&quot;handleDeleteClick(scope.row.id)&quot;&gt;
              åˆ é™¤
            &lt;/el-button&gt;
          &lt;/template&gt;
          // ...
      &lt;/el-table&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot; name=&quot;content&quot;&gt;
import usePermission from &#39;@/hooks/usePermission&#39;

interface IProps {
  contentConfig: {
    // ç”¨äºå¤„ç†æ¥å£æ–¹æ³•ä¸­ä¼ å…¥çš„pageNameå‚æ•°
    pageName: string,
    header?: {
      title?: string,
      btnTitle: string
    },
    propsList: any[],
    childrenTree: any[]
  }
}
const props = defineProps&lt;IProps&gt;()
const emit = defineEmits([&#39;newDataClick&#39;, &#39;editDataClick&#39;])

// 0. è·å–æ˜¯å¦æœ‰å¯¹åº”çš„å¢åˆ æ”¹æŸ¥æƒé™
// å¢
const isCreate = usePermission(props.contentConfig.pageName, &#39;create&#39;)
// åˆ 
const isDelete = usePermission(props.contentConfig.pageName, &#39;delete&#39;)ã€‘
// æ”¹
const isUpdate = usePermission(props.contentConfig.pageName, &#39;update&#39;)
// æŸ¥
const isQuery = usePermission(props.contentConfig.pageName, &#39;query&#39;)

// 1.è¯·æ±‚æ•°æ®...
function fetchPageListData(formData: any = {}) {
  // æŸ¥
  if(!isQuery) return
  // ...
}
// ...
&lt;/script&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ç»†èŠ‚å¤„ç†-æ–°å¢ç¼–è¾‘åˆ é™¤æ“ä½œé‡ç½®-current-åˆ†é¡µ" tabindex="-1"><a class="header-anchor" href="#ç»†èŠ‚å¤„ç†-æ–°å¢ç¼–è¾‘åˆ é™¤æ“ä½œé‡ç½®-current-åˆ†é¡µ" aria-hidden="true">#</a> (ç»†èŠ‚å¤„ç†)æ–°å¢ç¼–è¾‘åˆ é™¤æ“ä½œé‡ç½® current åˆ†é¡µ</h2><p>é€šè¿‡ä½¿ç”¨<code>pinia</code>ä¸­çš„<a href="https://pinia.vuejs.org/zh/core-concepts/actions.html#subscribing-to-actions" target="_blank" rel="noopener noreferrer">è®¢é˜…<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a><a href="https://pinia.vuejs.org/zh/core-concepts/actions.html#subscribing-to-actions" target="_blank" rel="noopener noreferrer"><code>action</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼Œå»ç›‘å¬å¢åˆ æ”¹çš„<code>actions</code>ï¼Œä»è€Œå°†<code>current</code>é‡ç½®ã€‚</p><blockquote><p>è®¢é˜… <code>action</code>ï¼šä½ å¯ä»¥é€šè¿‡ <code>store.$onAction()</code> æ¥ç›‘å¬ <code>action</code> å’Œå®ƒä»¬çš„ç»“æœã€‚ä¼ é€’ç»™å®ƒçš„å›è°ƒå‡½æ•°ä¼šåœ¨ <code>action</code> æœ¬èº«ä¹‹å‰æ‰§è¡Œã€‚<code>after</code> è¡¨ç¤ºåœ¨ promise è§£å†³ä¹‹åï¼Œå…è®¸ä½ åœ¨ <code>action</code> è§£å†³åæ‰§è¡Œä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚åŒæ ·åœ°ï¼Œ<code>onError</code> å…è®¸ä½ åœ¨ <code>action</code> æŠ›å‡ºé”™è¯¯æˆ– <code>reject</code> æ—¶æ‰§è¡Œä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚</p></blockquote><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// page-content.vue
&lt;script setup lang=&quot;ts&quot; name=&quot;content&quot;&gt;
// ...
// 6.ç›‘å¬systemStoreçš„å¢åˆ æ”¹action,å°†é¡µé¢currentPageé‡ç½®
systemStore.$onAction(({ name, after }) =&gt; {
  // afterè¡¨ç¤ºåœ¨actionæˆåŠŸæ‰§è¡Œä¹‹åæ‰§è¡Œï¼ˆå¤±è´¥æ—¶ä¸æ‰§è¡Œï¼‰
  after(() =&gt; {
    if(name === &#39;editPageDataAction&#39; || name === &#39;newPageDataAction&#39; || name === &#39;deletePageDataAction&#39;) {
      currentPage.value = 1
    }
  })
})
&lt;/script&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="å®ç°æ•°æ®ç»Ÿè®¡é¡µé¢" tabindex="-1"><a class="header-anchor" href="#å®ç°æ•°æ®ç»Ÿè®¡é¡µé¢" aria-hidden="true">#</a> å®ç°æ•°æ®ç»Ÿè®¡é¡µé¢</h2><h3 id="å®ç°é¡¶éƒ¨å¡ç‰‡ç»„ä»¶é¡µé¢" tabindex="-1"><a class="header-anchor" href="#å®ç°é¡¶éƒ¨å¡ç‰‡ç»„ä»¶é¡µé¢" aria-hidden="true">#</a> å®ç°é¡¶éƒ¨å¡ç‰‡ç»„ä»¶é¡µé¢</h3><h4 id="å®ç°å­ç»„ä»¶æ•°å­—ç»Ÿè®¡å¡ç‰‡çš„é™æ€é»˜è®¤å±•ç¤ºã€‚" tabindex="-1"><a class="header-anchor" href="#å®ç°å­ç»„ä»¶æ•°å­—ç»Ÿè®¡å¡ç‰‡çš„é™æ€é»˜è®¤å±•ç¤ºã€‚" aria-hidden="true">#</a> å®ç°å­ç»„ä»¶æ•°å­—ç»Ÿè®¡å¡ç‰‡çš„é™æ€é»˜è®¤å±•ç¤ºã€‚</h4><p>ä½¿ç”¨äº†<code>withDefaults</code>å®ç°ã€‚</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// cpns/count-card/count-card.vue
&lt;template&gt;
  &lt;div class=&quot;count-card&quot;&gt;
    &lt;div class=&quot;header&quot;&gt;
        &lt;span class=&quot;title&quot;&gt;{{ title }}&lt;/span&gt;
        &lt;el-tooltip :content=&quot;tips&quot; placement=&quot;top-start&quot; effect=&quot;dark&quot;&gt;
            &lt;el-icon&gt;&lt;Warning /&gt;&lt;/el-icon&gt;
        &lt;/el-tooltip&gt;
    &lt;/div&gt;
    &lt;div class=&quot;content&quot;&gt;
        &lt;span class=&quot;count&quot;&gt;{{ number1 }}&lt;/span&gt;
    &lt;/div&gt;
    &lt;div class=&quot;footer&quot;&gt;
        &lt;span&gt;{{ subtitle }}&lt;/span&gt;
        &lt;span&gt;{{ number2 }}&lt;/span&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
interface IProps {
    title?: string,
    tips?: string,
    number1?: number,
    number2?: number,
    subtitle?: string
}

// withDefaultsé»˜è®¤å€¼
withDefaults(defineProps&lt;IProps&gt;(), {
    title: &#39;å•†å“æ€»é”€é‡&#39;,
    tips: &#39;æ‰€æœ‰å•†å“çš„æ€»é”€é‡&#39;,
    number1: 509989,
    number2: 509989,
    subtitle: &#39;å•†å“æ€»é”€é‡&#39;
})

&lt;/script&gt;

&lt;style lang=&quot;less&quot; scoped&gt;
.count-card {
    display: flex;
    flex-direction: column;
    padding: 0 20px;
    height: 130px;
    background: white;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);

    .header {
        display: flex;
        height: 38px;
        font-size: 14px;
        color: rgba(0, 0, 0, 0.45);
        justify-content: space-between;
        align-items: flex-end
    }

    .content {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: flex-start;
        flex: 1;
        margin-left: 0px;
        font-size: 26px;
        color: rgba(0, 0, 0, 0.85);
    }

    .footer {
        display: flex;
        height: 38px;
        line-height: 38px;
        letter-spacing: 1px;
        color: rgba(0, 0, 0, 0.85);
        border-top: 1px solid #f0f0f0;
    }
}
&lt;/style&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å°è£…ç½‘ç»œè¯·æ±‚å®ç°åŠ¨æ€é¡µé¢" tabindex="-1"><a class="header-anchor" href="#å°è£…ç½‘ç»œè¯·æ±‚å®ç°åŠ¨æ€é¡µé¢" aria-hidden="true">#</a> å°è£…ç½‘ç»œè¯·æ±‚å®ç°åŠ¨æ€é¡µé¢</h4><p>ä½¿ç”¨<code>hyRequest</code>å’Œ<code>pinia</code>å°è£…ç½‘ç»œè¯·æ±‚ä»¥åŠæ•°æ®ã€‚</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// service/main/analysis.ts
import hyRequest from &quot;@/service&quot;;

export function getAmountListData() {
    return hyRequest.get({
        url: &#39;/goods/amount/list&#39;
    })
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>import { getAmountListData } from &quot;@/service/main/analysis/analysis&quot;;
import { defineStore } from &quot;pinia&quot;;

interface IAnalysisState {
    amountList: any[],
}
const useAnalysisStore = defineStore(&#39;analysis&#39;, {
    state: (): IAnalysisState =&gt; ({
        amountList: [],
    }),
    actions: {
        async fetchAnalysisDataAction() {
            const amountResult = await getAmountListData()
            this.amountList = amountResult.data
        }
    }
})

export default useAnalysisStore
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="çˆ¶ç»„ä»¶è·å–è¯·æ±‚æ•°æ®å¹¶ä¼ é€’ç»™å­ç»„ä»¶" tabindex="-1"><a class="header-anchor" href="#çˆ¶ç»„ä»¶è·å–è¯·æ±‚æ•°æ®å¹¶ä¼ é€’ç»™å­ç»„ä»¶" aria-hidden="true">#</a> çˆ¶ç»„ä»¶è·å–è¯·æ±‚æ•°æ®å¹¶ä¼ é€’ç»™å­ç»„ä»¶</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// views/main/analysis.vue
&lt;template&gt;
  &lt;div class=&quot;dashboard&quot;&gt;
    &lt;el-row :gutter=&quot;10&quot;&gt;
      &lt;template v-for=&quot;item in amountList&quot; :key=&quot;item.amount&quot;&gt;
        &lt;el-col :span=&quot;6&quot; :xs=&quot;24&quot; :sm=&quot;12&quot; :md=&quot;8&quot; :lg=&quot;6&quot;&gt;
          &lt;count-card v-bind=&quot;item&quot;/&gt;
        &lt;/el-col&gt;
      &lt;/template&gt;
    &lt;/el-row&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import countCard from &quot;./cpns/count-card/count-card.vue&quot;;
import useAnalysisStore from &#39;@/store/main/analysis/analysis&#39;
import { storeToRefs } from &#39;pinia&#39;

// å‘èµ·actionså°è£…çš„ç½‘ç»œè¯·æ±‚
const analysisStore = useAnalysisStore()
analysisStore.fetchAnalysisDataAction()

// è·å–æ•°æ®
const { amountList } = storeToRefs(analysisStore)
&lt;/script&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="é¡¶éƒ¨å¡ç‰‡ä¸­çš„æ•°æ®é€’å¢åŠ¨ç”»å®ç°" tabindex="-1"><a class="header-anchor" href="#é¡¶éƒ¨å¡ç‰‡ä¸­çš„æ•°æ®é€’å¢åŠ¨ç”»å®ç°" aria-hidden="true">#</a> é¡¶éƒ¨å¡ç‰‡ä¸­çš„æ•°æ®é€’å¢åŠ¨ç”»å®ç°</h3><p>å®‰è£…<code>npm install countup.js</code></p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>&lt;template&gt;
  // ...
  &lt;span ref=&quot;count1Ref&quot;&gt;{{ number1 }}&lt;/span&gt;
  &lt;span ref=&quot;count2Ref&quot;&gt;{{ number2 }}&lt;/span&gt;
&lt;/template&gt;
&lt;script setup lang=&quot;ts&quot;&gt;
// æ•°å­—é€’å¢åŠ¨ç”»
import { CountUp } from &#39;countup.js&#39;;
import { onMounted, ref } from &#39;vue&#39;;

interface IProps {
    amount? :string,
    title?: string,
    tips?: string,
    number1?: number,
    number2?: number,
    subtitle?: string
}

// withDefaultsé»˜è®¤å€¼
const props = withDefaults(defineProps&lt;IProps&gt;(), {
    title: &#39;å•†å“æ€»é”€é‡&#39;,
    tips: &#39;æ‰€æœ‰å•†å“çš„æ€»é”€é‡&#39;,
    number1: 509989,
    number2: 509989,
    subtitle: &#39;å•†å“æ€»é”€é‡&#39;
})

// ç»™æ•°å­—å‰é¢åŠ å‰ç¼€Â¥
const countOption = {
    prefix: props.amount == &#39;sale&#39; ? &#39;Â¥&#39; : &#39;&#39;
}

// åˆ›å»ºCountUpçš„å®ä¾‹å¯¹è±¡
const count1Ref = ref&lt;HTMLElement&gt;()
const count2Ref = ref&lt;HTMLElement&gt;()
// å‚æ•°1: æ•°å­—åŠ¨ç”»çš„å…ƒç´ 
// å‚æ•°2: æ•°å­—å¢åŠ åˆ°å¤šå°‘
// å‚æ•°3: ç»™å‚æ•°1å‰é¢åŠ ä¸ªå‰ç¼€ï¼Œå¦‚Â¥
// è¿™é‡Œä½¿ç”¨onMountedæ˜¯å› ä¸ºsetupçš„æ—¶å€™è¿˜æ²¡æŒ‚è½½åˆ°ref,å°±ä¼šæŠ¥é”™
onMounted(() =&gt; {
    const countup1 = new CountUp(count1Ref.value!, props.number1, countOption)
    const countup2 = new CountUp(count2Ref.value!, props.number2, countOption)

    countup1.start()
    countup2.start()
})
&lt;/script&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®ç°é¡¶éƒ¨å¡ç‰‡å“åº”å¼å¸ƒå±€" tabindex="-1"><a class="header-anchor" href="#å®ç°é¡¶éƒ¨å¡ç‰‡å“åº”å¼å¸ƒå±€" aria-hidden="true">#</a> å®ç°é¡¶éƒ¨å¡ç‰‡å“åº”å¼å¸ƒå±€</h3><p>ä½¿ç”¨<code>el-col</code>çš„<code>xs</code>ï¼Œ<code>sm</code>ï¼Œ<code>md</code>ï¼Œ<code>lg</code>ï¼Œ<code>xl</code>å®ç°ã€‚</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>&lt;el-col :span=&quot;6&quot; :xs=&quot;24&quot; :sm=&quot;12&quot; :md=&quot;8&quot; :lg=&quot;6&quot;&gt;
  // ...
&lt;/el-col&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="å®ç°-echart-å¯è§†åŒ–" tabindex="-1"><a class="header-anchor" href="#å®ç°-echart-å¯è§†åŒ–" aria-hidden="true">#</a> å®ç° echart å¯è§†åŒ–</h2><p>å®‰è£…ï¼š<a href="https://echarts.apache.org/handbook/zh/get-started/" target="_blank" rel="noopener noreferrer"><code>npm install echarts --save</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="åˆæ­¥æ­å»ºå¯è§†åŒ–é¡µé¢" tabindex="-1"><a class="header-anchor" href="#åˆæ­¥æ­å»ºå¯è§†åŒ–é¡µé¢" aria-hidden="true">#</a> åˆæ­¥æ­å»ºå¯è§†åŒ–é¡µé¢</h3><h4 id="ä½¿ç”¨-element-å°è£…å¡ç‰‡ç»„ä»¶" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-element-å°è£…å¡ç‰‡ç»„ä»¶" aria-hidden="true">#</a> ä½¿ç”¨ element å°è£…å¡ç‰‡ç»„ä»¶</h4><p>ä½¿ç”¨<code>el-card</code>å¡ç‰‡ï¼Œå°†<code>echart</code>å¯è§†åŒ–å›¾å½¢èšåˆåœ¨å¡ç‰‡å®¹å™¨ä¸­å±•ç¤ºã€‚</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// chart-card.vue
&lt;template&gt;
    &lt;div class=&quot;chart-card&quot;&gt;
      &lt;el-card class=&quot;box-card&quot;&gt;
        &lt;template #header&gt;
          &lt;div class=&quot;cart-header&quot;&gt;
            &lt;span&gt;åˆ†ç±»å•†å“æ•°é‡(é¥¼å›¾)&lt;/span&gt;
          &lt;/div&gt;
        &lt;/template&gt;

        &lt;div class=&quot;content&quot;&gt;
          &lt;slot&gt;&lt;/slot&gt;
        &lt;/div&gt;
      &lt;/el-card&gt;
    &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;&lt;/script&gt;
&lt;style lang=&quot;less&quot; scoped&gt;&lt;/style&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å¼•å…¥-echarts-çš„é¥¼å›¾" tabindex="-1"><a class="header-anchor" href="#å¼•å…¥-echarts-çš„é¥¼å›¾" aria-hidden="true">#</a> å¼•å…¥ ECharts çš„é¥¼å›¾</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// dashboard.vue
&lt;template&gt;
  &lt;div class=&quot;dashboard&quot;&gt;
    // é¡¶éƒ¨å¡ç‰‡ç»„ä»¶
    &lt;el-row :gutter=&quot;10&quot;&gt;
      &lt;template v-for=&quot;item in amountList&quot; :key=&quot;item.amount&quot;&gt;
        &lt;el-col :span=&quot;6&quot;&gt;
          &lt;count-card v-bind=&quot;item&quot;/&gt;
        &lt;/el-col&gt;
      &lt;/template&gt;
    &lt;/el-row&gt;

    &lt;el-row :gutter=&quot;10&quot;&gt;
      // echarté¥¼å›¾
      &lt;el-col :span=&quot;7&quot;&gt;
        &lt;chart-card&gt;
          &lt;div class=&quot;echart&quot; ref=&quot;echartRef&quot;&gt;&lt;/div&gt;
        &lt;/chart-card&gt;
      &lt;/el-col&gt;

      &lt;el-col :span=&quot;10&quot;&gt;
        &lt;chart-card/&gt;
      &lt;/el-col&gt;

      &lt;el-col :span=&quot;7&quot;&gt;
        &lt;chart-card/&gt;
      &lt;/el-col&gt;
    &lt;/el-row&gt;

    &lt;el-row :gutter=&quot;10&quot;&gt;
      &lt;el-col :span=&quot;12&quot;&gt;
        &lt;chart-card&gt;æŠ˜çº¿å›¾&lt;/chart-card&gt;
      &lt;/el-col&gt;

      &lt;el-col :span=&quot;12&quot;&gt;
        &lt;chart-card&gt;æŸ±çŠ¶å›¾&lt;/chart-card&gt;
      &lt;/el-col&gt;
    &lt;/el-row&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
// ...
import chartCard from &quot;./cpns/chart-card/chart-card.vue&quot;;
import { onMounted, ref } from &quot;vue&quot;;

import * as echarts from &#39;echarts&#39;

// å‘èµ·actionså°è£…çš„ç½‘ç»œè¯·æ±‚...
// è·å–æ•°æ®...

// 1. å¼•ç”¨domå®ä¾‹
const echartRef = ref&lt;HTMLElement&gt;()
onMounted(() =&gt; {
  // 2. åŸºäºå‡†å¤‡å¥½çš„domï¼Œåˆå§‹åŒ–echartå®ä¾‹
  const echartInstance = echarts.init(echartRef.value!, &quot;light&quot;, {
    renderer: &#39;canvas&#39;
  })

  // 3.è®¾ç½®options(é…ç½®)
  echartInstance.setOption({
    title: {
      text: &#39;Referer of a Website&#39;,
      subtext: &#39;Fake Data&#39;,
      left: &#39;center&#39;
    },
    tooltip: {
      trigger: &#39;item&#39;
    },
    legend: {
      orient: &#39;vertical&#39;,
      left: &#39;left&#39;
    },
    series: [
      {
        name: &#39;Access From&#39;,
        type: &#39;pie&#39;,
        radius: &#39;50%&#39;,
        data: [
          { value: 1048, name: &#39;Search Engine&#39; },
          { value: 735, name: &#39;Direct&#39; },
          { value: 580, name: &#39;Email&#39; },
          { value: 484, name: &#39;Union Ads&#39; },
          { value: 300, name: &#39;Video Ads&#39; }
        ],
        emphasis: {
          itemStyle: {
            shadowBlur: 10,
            shadowOffsetX: 0,
            shadowColor: &#39;rgba(0, 0, 0, 0.5)&#39;
          }
        }
      }
    ]
  })
})
&lt;/script&gt;

&lt;style lang=&quot;less&quot; scoped&gt;
.el-row {
  margin-bottom: 15px;
}

.echart {
  height: 250px;
}
&lt;/style&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ä¸‰å±‚ç»„ä»¶å°è£…-echart" tabindex="-1"><a class="header-anchor" href="#ä¸‰å±‚ç»„ä»¶å°è£…-echart" aria-hidden="true">#</a> ä¸‰å±‚ç»„ä»¶å°è£… echart</h3><h4 id="å°è£…-base-echart-ç»„ä»¶" tabindex="-1"><a class="header-anchor" href="#å°è£…-base-echart-ç»„ä»¶" aria-hidden="true">#</a> å°è£… Base-echart ç»„ä»¶</h4><p><code>base-echart</code>åšåˆå§‹åŒ–ï¼ˆåŸºäºå‡†å¤‡å¥½çš„<code>dom</code>ï¼Œåˆå§‹åŒ–<code>echart</code>å®ä¾‹ï¼‰ï¼Œç”¨äºæ¥æ”¶ä¸åŒ<code>echart</code>å›¾å½¢çš„<code>option</code>é…ç½®ã€‚ç›‘å¬<code>window</code>çš„<code>resize</code>å±æ€§è®¾ç½®<code>echartInstance.resize()</code>å¯ä»¥å®ç°<code>echart</code>çš„å“åº”å¼ã€‚</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// base-echart.vue
&lt;template&gt;
  &lt;div class=&quot;base-echart&quot;&gt;
    &lt;div class=&quot;echart&quot; ref=&quot;echartRef&quot;&gt;&lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import * as echarts from &#39;echarts&#39;
import { onMounted, ref, watchEffect } from &#39;vue&#39;
// è·å–echartçš„optionç±»å‹
import type { EChartsOption } from &#39;echarts&#39;

// æ¥æ”¶æ¯ä¸ªechartä¸åŒé…ç½®
interface IProps {
    option: EChartsOption
}
const props = defineProps&lt;IProps&gt;()

// 1. å¼•ç”¨domå®ä¾‹
const echartRef = ref&lt;HTMLElement&gt;()
onMounted(() =&gt; {
  // 2. åŸºäºå‡†å¤‡å¥½çš„domï¼Œåˆå§‹åŒ–echartå®ä¾‹
  const echartInstance = echarts.init(echartRef.value!, &quot;light&quot;, {
    renderer: &#39;canvas&#39;
  })

  // 3.ç¬¬ä¸€æ¬¡options(é…ç½®),åŠ¨æ€ä¼ å…¥æ¯ä¸ªå›¾çš„option
  // watchEffectç›‘å¬optionå˜åŒ–ï¼Œé‡æ–°æ‰§è¡Œ
  watchEffect(() =&gt; echartInstance.setOption(props.option))

  // 4.ç›‘å¬windowç¼©æ”¾å®ç°echartå“åº”å¼å¸ƒå±€
  window.addEventListener(&#39;resize&#39;, () =&gt; {
    echartInstance.resize()
  })
})
&lt;/script&gt;

&lt;style lang=&quot;less&quot; scoped&gt;
.echart {
  height: 250px;
}
&lt;/style&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç»˜åˆ¶-echarts-å›¾å½¢" tabindex="-1"><a class="header-anchor" href="#ç»˜åˆ¶-echarts-å›¾å½¢" aria-hidden="true">#</a> ç»˜åˆ¶ ECharts å›¾å½¢</h4><p>ç¼–å†™<code>option</code>é…ç½®ï¼Œå°†<code>option</code>ä¼ å…¥å­ç»„ä»¶<code>base-echart.vue</code>ï¼Œä½¿ç”¨<code>:option</code>æ¥æ”¶ã€‚</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// pie-echart.vue
&lt;template&gt;
  &lt;div class=&quot;pie-echart&quot;&gt;
    &lt;base-echart :option=&quot;option&quot;/&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import BaseEchart from &#39;./base-echart.vue&#39;
import type { EChartsOption } from &#39;echarts&#39;

// åªè´Ÿè´£ä¼ å…¥é¥¼å›¾çš„option
const option: EChartsOption = {
    title: {
      text: &#39;Referer of a Website&#39;,
      subtext: &#39;Fake Data&#39;,
      left: &#39;center&#39;
    },
    tooltip: {
      trigger: &#39;item&#39;
    },
    legend: {
      orient: &#39;vertical&#39;,
      left: &#39;left&#39;
    },
    series: [
      {
        name: &#39;Access From&#39;,
        type: &#39;pie&#39;,
        radius: &#39;50%&#39;,
        data: [
          { value: 1048, name: &#39;Search Engine&#39; },
          { value: 735, name: &#39;Direct&#39; },
          { value: 580, name: &#39;Email&#39; },
          { value: 484, name: &#39;Union Ads&#39; },
          { value: 300, name: &#39;Video Ads&#39; }
        ],
        emphasis: {
          itemStyle: {
            shadowBlur: 10,
            shadowOffsetX: 0,
            shadowColor: &#39;rgba(0, 0, 0, 0.5)&#39;
          }
        }
      }
    ]
}
&lt;/script&gt;

&lt;style lang=&quot;less&quot; scoped&gt;
&lt;/style&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç»Ÿä¸€å¯¼å‡º" tabindex="-1"><a class="header-anchor" href="#ç»Ÿä¸€å¯¼å‡º" aria-hidden="true">#</a> ç»Ÿä¸€å¯¼å‡º</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// index.ts
import BaseEchart from &#39;./src/base-echart.vue&#39;
import PieEchart from &#39;./src/pie-echart.vue&#39;
import LineEchart from &#39;./src/line-echart.vue&#39;

export { PieEchart, LineEchart }

export default BaseEchart
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å¼•å…¥-echarts-å›¾å½¢" tabindex="-1"><a class="header-anchor" href="#å¼•å…¥-echarts-å›¾å½¢" aria-hidden="true">#</a> å¼•å…¥ ECharts å›¾å½¢</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// dashboard,vue
&lt;template&gt;
  &lt;div class=&quot;dashboard&quot;&gt;
    &lt;!--é¡¶éƒ¨å¡ç‰‡ç»„ä»¶ --&gt;
    &lt;el-row :gutter=&quot;10&quot;&gt;
      &lt;template v-for=&quot;item in amountList&quot; :key=&quot;item.amount&quot;&gt;
        &lt;el-col :span=&quot;6&quot;&gt;
          &lt;count-card v-bind=&quot;item&quot;/&gt;
        &lt;/el-col&gt;
      &lt;/template&gt;
    &lt;/el-row&gt;
    &lt;el-row :gutter=&quot;10&quot;&gt;
      &lt;el-col :span=&quot;7&quot;&gt;
        &lt;chart-card&gt;
          &lt;pie-echart/&gt;
        &lt;/chart-card&gt;
      &lt;/el-col&gt;

      &lt;el-col :span=&quot;10&quot;&gt;
        &lt;chart-card&gt;
          &lt;line-echart/&gt;
        &lt;/chart-card&gt;
      &lt;/el-col&gt;
    &lt;/el-row&gt;
    // ...
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
// ...
&lt;/style&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="è·å–è¯·æ±‚æ•°æ®ç”¨äº-echarts-æ˜¾ç¤º" tabindex="-1"><a class="header-anchor" href="#è·å–è¯·æ±‚æ•°æ®ç”¨äº-echarts-æ˜¾ç¤º" aria-hidden="true">#</a> è·å–è¯·æ±‚æ•°æ®ç”¨äº ECharts æ˜¾ç¤º</h3><h4 id="å°è£…-service-è¯·æ±‚æ¥å£" tabindex="-1"><a class="header-anchor" href="#å°è£…-service-è¯·æ±‚æ¥å£" aria-hidden="true">#</a> å°è£… service è¯·æ±‚æ¥å£</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// service/analysis.ts
// è·å–é¥¼å›¾åˆ†ç±»å•†å“æ•°é‡
export function getGoodsCategoryCount() {
    return hyRequest.get({
        url: &#39;/goods/category/count&#39;
    })
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å°è£…-pinia-è¯·æ±‚æ•°æ®" tabindex="-1"><a class="header-anchor" href="#å°è£…-pinia-è¯·æ±‚æ•°æ®" aria-hidden="true">#</a> å°è£… pinia è¯·æ±‚æ•°æ®</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// store/analysis.ts
import { getAmountListData, getGoodsCategoryCount } from &quot;@/service/main/analysis/analysis&quot;;
import { defineStore } from &quot;pinia&quot;;

interface IAnalysisState {
    amountList: any[],
    goodsCategoryCount: any[]
}
const useAnalysisStore = defineStore(&#39;analysis&#39;, {
    state: (): IAnalysisState =&gt; ({
        amountList: [],
        goodsCategoryCount: []
    }),
    actions: {
        async fetchAnalysisDataAction() {
            // é¡¶éƒ¨å¡ç‰‡æ•°æ®
            const amountResult = await getAmountListData()
            this.amountList = amountResult.data

            // è·å–é¥¼å›¾æ•°æ®
            const goodsResult = await getGoodsCategoryCount()
            this.goodsCategoryCount = goodsResult.data
        },
    }
})
export default useAnalysisStore
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="çˆ¶ç»„ä»¶è°ƒç”¨-pinia-ä¸­çš„-actions-å‘èµ·è¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#çˆ¶ç»„ä»¶è°ƒç”¨-pinia-ä¸­çš„-actions-å‘èµ·è¯·æ±‚" aria-hidden="true">#</a> çˆ¶ç»„ä»¶è°ƒç”¨ pinia ä¸­çš„ actions å‘èµ·è¯·æ±‚</h4><p>çˆ¶ç»„ä»¶<code>dashboard.vue</code>å‘èµ·è¯·æ±‚è·å–é¥¼å›¾æ•°æ®ï¼Œå°†æ•°æ®ï¼ˆ<code>name</code>ï¼Œ<code>goodsCount</code>ï¼‰é€šè¿‡<code>map</code>æ˜ å°„æˆé¥¼å›¾éœ€è¦çš„æ•°æ®ï¼ˆ<code>name</code>ï¼Œ<code>value</code>ï¼‰ï¼Œé€šè¿‡<code>:pie-data=&quot;showGoodsCategoryCount</code>ä¼ é€’ç»™å­ç»„ä»¶<code>pie-echart.vue</code>ã€‚</p><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// dashboard.vue
&lt;template&gt;
  &lt;div class=&quot;dashboard&quot;&gt;
    &lt;!--é¡¶éƒ¨å¡ç‰‡ç»„ä»¶ --&gt;
    // ...
    // é¥¼å›¾
    &lt;el-row :gutter=&quot;10&quot;&gt;
      &lt;el-col :span=&quot;7&quot;&gt;
        &lt;chart-card&gt;
          &lt;pie-echart :pie-data=&quot;showGoodsCategoryCount&quot;/&gt;
        &lt;/chart-card&gt;
      &lt;/el-col&gt;
     &lt;/el-row&gt;
  &lt;/div&gt;
&lt;/template&gt;
&lt;script setup lang=&quot;ts&quot;&gt;
import { storeToRefs } from &#39;pinia&#39;
import { computed } from &quot;vue&quot;;
import countCard from &quot;./cpns/count-card/count-card.vue&quot;;
import chartCard from &quot;./cpns/chart-card/chart-card.vue&quot;;
import useAnalysisStore from &#39;@/store/main/analysis/analysis&#39;

// å‘èµ·actionså°è£…çš„ç½‘ç»œè¯·æ±‚
const analysisStore = useAnalysisStore()
analysisStore.fetchAnalysisDataAction()

// è·å–æ•°æ®
const { amountList, goodsCategoryCount } = storeToRefs(analysisStore)

// è·å–echarté¥¼å›¾æ•°æ®
const showGoodsCategoryCount = computed(() =&gt; {
  return goodsCategoryCount.value.map((item) =&gt; ({
    name: item.name,
    value: item.goodsCount
  }))
})
&lt;/script&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å­ç»„ä»¶åŠ¨æ€æ¥æ”¶é¥¼å›¾-option-æ•°æ®" tabindex="-1"><a class="header-anchor" href="#å­ç»„ä»¶åŠ¨æ€æ¥æ”¶é¥¼å›¾-option-æ•°æ®" aria-hidden="true">#</a> å­ç»„ä»¶åŠ¨æ€æ¥æ”¶é¥¼å›¾ option æ•°æ®</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>&lt;template&gt;
  &lt;div class=&quot;pie-echart&quot;&gt;
    &lt;base-echart :option=&quot;option&quot;/&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import BaseEchart from &#39;./base-echart.vue&#39;
import type { EChartsOption } from &#39;echarts&#39;
import { computed } from &#39;vue&#39;

interface IEchartValueType {
  value: number
  name: string
}

interface IProps {
  pieData: IEchartValueType[]
}

const props = defineProps&lt;IProps&gt;()

// åªè´Ÿè´£ä¼ å…¥é¥¼å›¾çš„option
const option = computed&lt;EChartsOption&gt;(() =&gt; {
    return {
      tooltip: {
        trigger: &#39;item&#39;
      },
      legend: {
        orient: &#39;horizontal&#39;,
        left: &#39;left&#39;
      },
      series: [
        {
          name: &#39;è®¿é—®æ¥é—®&#39;,
          type: &#39;pie&#39;,
          radius: &#39;50%&#39;,
          bottom: &#39;-10%&#39;,
          data: props.pieData,
          emphasis: {
            itemStyle: {
              shadowBlur: 10,
              shadowOffsetX: 0,
              shadowColor: &#39;rgba(0, 0, 0, 0.5)&#39;
            }
          }
        }
      ]
    }
})
&lt;/script&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®ç°å„ç§-echart-å›¾åŠ¨æ€æ•°æ®å±•ç¤º" tabindex="-1"><a class="header-anchor" href="#å®ç°å„ç§-echart-å›¾åŠ¨æ€æ•°æ®å±•ç¤º" aria-hidden="true">#</a> å®ç°å„ç§ Echart å›¾åŠ¨æ€æ•°æ®å±•ç¤º</h3><h4 id="å°è£…è¯·æ±‚æ¥å£çš„åŠ¨æ€æ•°æ®" tabindex="-1"><a class="header-anchor" href="#å°è£…è¯·æ±‚æ¥å£çš„åŠ¨æ€æ•°æ®" aria-hidden="true">#</a> å°è£…è¯·æ±‚æ¥å£çš„åŠ¨æ€æ•°æ®</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// service/analysis.ts
// è·å–é¥¼å›¾ã€ç«ç‘°å›¾åˆ†ç±»å•†å“æ•°é‡
export function getGoodsCategoryCount() {
    return hyRequest.get({
        url: &#39;/goods/category/count&#39;
    })
}

// è·å–æŠ˜çº¿å›¾å•†å“é”€é‡
export function getGoodsCategorySale() {
    return hyRequest.get({
        url: &#39;/goods/category/sale&#39;
    })
}

// è·å–æŸ±çŠ¶å›¾å•†å“æ”¶è—æ•°é‡
export function getGoodsCategoryFavor() {
    return hyRequest.get({
        url: &#39;/goods/category/favor&#39;
    })
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// store/analysis.ts
import { getAmountListData, getGoodsCategoryCount, getGoodsCategoryFavor, getGoodsCategorySale } from &quot;@/service/main/analysis/analysis&quot;;
import { defineStore } from &quot;pinia&quot;;

interface IAnalysisState {
    amountList: any[],
    goodsCategoryCount: any[],
    goodsCategorySale: any[],
    goodsCategoryFavor: any[]
}
const useAnalysisStore = defineStore(&#39;analysis&#39;, {
    state: (): IAnalysisState =&gt; ({
        amountList: [],
        goodsCategoryCount: [],
        goodsCategorySale: [],
        goodsCategoryFavor: []
    }),
    actions: {
        async fetchAnalysisDataAction() {
            // é¡¶éƒ¨å¡ç‰‡æ•°æ®
            const amountResult = await getAmountListData()
            this.amountList = amountResult.data

            // è·å–é¥¼å›¾ã€ç«ç‘°å›¾æ•°æ®
            const goodsCountResult = await getGoodsCategoryCount()
            this.goodsCategoryCount = goodsCountResult.data

            // è·å–æŠ˜çº¿å›¾æ•°æ®
            const goodsSaleResult = await getGoodsCategorySale()
            this.goodsCategorySale = goodsSaleResult.data

            // è·å–æŸ±çŠ¶å›¾æ•°æ®
            const goodsFavorResult = await getGoodsCategoryFavor()
            this.goodsCategoryFavor = goodsFavorResult.data
        },
    }
})

export default useAnalysisStore

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å°è£…-type-ç±»å‹æ¥å£" tabindex="-1"><a class="header-anchor" href="#å°è£…-type-ç±»å‹æ¥å£" aria-hidden="true">#</a> å°è£… Type ç±»å‹æ¥å£</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// types/index.ts
export interface IEchartValueType {
    value: number
    name: string
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å®ç°ç«ç‘°å›¾æ•°æ®å±•ç¤º" tabindex="-1"><a class="header-anchor" href="#å®ç°ç«ç‘°å›¾æ•°æ®å±•ç¤º" aria-hidden="true">#</a> å®ç°ç«ç‘°å›¾æ•°æ®å±•ç¤º</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// page-echarts/src/rose-echart.vue
&lt;template&gt;
  &lt;div class=&quot;pie-echart&quot;&gt;
    &lt;base-echart :option=&quot;option&quot; /&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import BaseEchart from &#39;./base-echart.vue&#39;
import { computed } from &#39;vue&#39;
import type { IEchartValueType } from &#39;../types&#39;
import type { EChartsOption } from &#39;echarts&#39;

interface IProps {
  roseData: IEchartValueType[]
}

const props = defineProps&lt;IProps&gt;()

// ç«ç‘°å›¾
const option = computed&lt;EChartsOption&gt;(() =&gt; {
  return {
    tooltip: {
      trigger: &#39;item&#39;
    },
    toolbox: {
      show: true,
      feature: {
        mark: { show: true },
        dataView: { show: true, readOnly: false },
        restore: { show: true },
        saveAsImage: { show: true }
      }
    },
    series: [
      {
        name: &#39;è®¿é—®æ¥æº&#39;,
        type: &#39;pie&#39;,
        radius: [10, 160],
        center: [&#39;50%&#39;, &#39;50%&#39;],
        roseType: &#39;area&#39;,
        itemStyle: {
          borderRadius: 8
        },
        bottom: &#39;-25%&#39;,
        data: props.roseData,
        label: {
            show: false
        }
      }
    ]
  }
})
&lt;/script&gt;
&lt;style lang=&quot;less&quot; scoped&gt;&lt;/style&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å®ç°æŠ˜çº¿å›¾æ•°æ®å±•ç¤º" tabindex="-1"><a class="header-anchor" href="#å®ç°æŠ˜çº¿å›¾æ•°æ®å±•ç¤º" aria-hidden="true">#</a> å®ç°æŠ˜çº¿å›¾æ•°æ®å±•ç¤º</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// page-echarts/src/line-echart.vue
&lt;template&gt;
  &lt;div class=&quot;line-echart&quot;&gt;
    &lt;base-echart :option=&quot;option&quot; /&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import BaseEchart from &#39;./base-echart.vue&#39;
import { computed } from &#39;vue&#39;
import type { EChartsOption } from &#39;echarts&#39;

interface IProps {
  labels: string[]
  values: string[]
}

const props = defineProps&lt;IProps&gt;()

// ç«ç‘°å›¾
const option = computed&lt;EChartsOption&gt;(() =&gt; {
  return {
    grid: {
      left: &#39;3%&#39;,
      right: &#39;4%&#39;,
      bottom: &#39;3%&#39;,
      containLabel: true
    },
    xAxis: {
      type: &#39;category&#39;,
      boundaryGap: false,
      data: props.labels
    },
    yAxis: {
      type: &#39;value&#39;
    },
    series: [
      {
        name: &#39;åˆ†ç±»é”€é‡ç»Ÿè®¡&#39;,
        type: &#39;line&#39;,
        stack: &#39;æ€»é‡&#39;,
        areaStyle: {},
        emphasis: {
          focus: &#39;series&#39;
        },
        data: props.values
      }
    ]
  }
})
&lt;/script&gt;

&lt;style lang=&quot;less&quot; scoped&gt;&lt;/style&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å®ç°æŸ±çŠ¶å›¾æ•°æ®å±•ç¤º" tabindex="-1"><a class="header-anchor" href="#å®ç°æŸ±çŠ¶å›¾æ•°æ®å±•ç¤º" aria-hidden="true">#</a> å®ç°æŸ±çŠ¶å›¾æ•°æ®å±•ç¤º</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// // page-echarts/src/bar-echart.vue
&lt;template&gt;
  &lt;div class=&quot;bar-echart&quot;&gt;
    &lt;base-echart :option=&quot;option&quot; /&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import BaseEchart from &#39;./base-echart.vue&#39;
import { computed } from &#39;vue&#39;
import type { EChartsOption } from &#39;echarts&#39;
import * as echarts from &#39;echarts&#39;

interface IProps {
  labels: string[]
  values: string[]
}

const props = defineProps&lt;IProps&gt;()

// ç«ç‘°å›¾
const option = computed&lt;EChartsOption&gt;(() =&gt; {
  return {
    title: {
      text: &#39;æ”¯æŒé¼ æ ‡æ»šåŠ¨ç¼©æ”¾&#39;
    },
    grid: {
      bottom: &#39;5%&#39;
    },
    xAxis: {
      data: props.labels,
      axisLabel: {
        inside: true,
        color: &#39;#fff&#39;
      },
      z: 10
    },
    yAxis: {
      axisLabel: {
        color: &#39;#999&#39;
      }
    },
    series: [
      {
        type: &#39;bar&#39;,
        showBackground: true,
        data: props.values,
        itemStyle: {
          color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
            { offset: 0, color: &#39;#2378f7&#39; },
            { offset: 0.5, color: &#39;#188df0&#39; },
            { offset: 1, color: &#39;#188df0&#39; }
          ])
        },
        emphasis: {
          itemStyle: {
            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
              { offset: 0, color: &#39;#2378f7&#39; },
              { offset: 0.7, color: &#39;#2378f7&#39; },
              { offset: 1, color: &#39;#83bff6&#39; }
            ])
          }
        }
      }
    ]
  }
})
&lt;/script&gt;

&lt;style lang=&quot;less&quot; scoped&gt;&lt;/style&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="çˆ¶ç»„ä»¶å°†æ¥å£æ•°æ®æ˜ å°„-echart-éœ€è¦çš„æ•°æ®è¿›è¡Œä¼ é€’ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#çˆ¶ç»„ä»¶å°†æ¥å£æ•°æ®æ˜ å°„-echart-éœ€è¦çš„æ•°æ®è¿›è¡Œä¼ é€’ä½¿ç”¨" aria-hidden="true">#</a> çˆ¶ç»„ä»¶å°†æ¥å£æ•°æ®æ˜ å°„ Echart éœ€è¦çš„æ•°æ®è¿›è¡Œä¼ é€’ä½¿ç”¨</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// dashboard.vue
&lt;template&gt;
  &lt;div class=&quot;dashboard&quot;&gt;
    &lt;!--é¡¶éƒ¨å¡ç‰‡ç»„ä»¶ --&gt;
    &lt;el-row :gutter=&quot;10&quot;&gt;
      &lt;template v-for=&quot;item in amountList&quot; :key=&quot;item.amount&quot;&gt;
        &lt;el-col :span=&quot;6&quot; :xs=&quot;24&quot; :sm=&quot;12&quot; :md=&quot;8&quot; :lg=&quot;6&quot;&gt;
          &lt;count-card v-bind=&quot;item&quot;/&gt;
        &lt;/el-col&gt;
      &lt;/template&gt;
    &lt;/el-row&gt;

    &lt;el-row :gutter=&quot;10&quot;&gt;
      &lt;el-col :span=&quot;7&quot;&gt;
        &lt;chart-card&gt;
          &lt;pie-echart :pie-data=&quot;showGoodsCategoryCount&quot;/&gt;
        &lt;/chart-card&gt;
      &lt;/el-col&gt;

      &lt;el-col :span=&quot;10&quot;&gt;
        &lt;chart-card&gt;
          &lt;line-echart/&gt;
        &lt;/chart-card&gt;

      &lt;/el-col&gt;

      &lt;el-col :span=&quot;7&quot;&gt;
        &lt;chart-card&gt;
          &lt;rose-echart :rose-data=&quot;showGoodsCategoryCount&quot;/&gt;
        &lt;/chart-card&gt;
      &lt;/el-col&gt;
    &lt;/el-row&gt;

    &lt;el-row :gutter=&quot;10&quot;&gt;
      &lt;el-col :span=&quot;12&quot;&gt;
        &lt;chart-card&gt;
          &lt;line-echart :labels=&quot;showGoodsCategorySale.labels&quot; :values=&quot;showGoodsCategorySale.values&quot;/&gt;
        &lt;/chart-card&gt;
      &lt;/el-col&gt;

      &lt;el-col :span=&quot;12&quot;&gt;
        &lt;chart-card&gt;
          &lt;bar-echart v-bind=&quot;showGoodsCategoryFavor&quot;/&gt;
        &lt;/chart-card&gt;
      &lt;/el-col&gt;
    &lt;/el-row&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import { storeToRefs } from &#39;pinia&#39;
import { computed } from &quot;vue&quot;;
import countCard from &quot;./cpns/count-card/count-card.vue&quot;;
import chartCard from &quot;./cpns/chart-card/chart-card.vue&quot;;
import useAnalysisStore from &#39;@/store/main/analysis/analysis&#39;

// å‘èµ·actionså°è£…çš„ç½‘ç»œè¯·æ±‚
const analysisStore = useAnalysisStore()
analysisStore.fetchAnalysisDataAction()

// è·å–æ•°æ®
const { amountList, goodsCategoryCount, goodsCategorySale, goodsCategoryFavor } = storeToRefs(analysisStore)

// è·å–echarté¥¼å›¾ã€ç«ç‘°å›¾æ•°æ®(å°†æ¥å£æ•°æ®æ˜ å°„æˆname, value)
const showGoodsCategoryCount = computed(() =&gt; {
  return goodsCategoryCount.value.map((item) =&gt; ({
    name: item.name,
    value: item.goodsCount
  }))
})

// è·å–echartæŠ˜çº¿å›¾æ•°æ®(å°†æ¥å£æ•°æ®æ˜ å°„æˆlabelsã€values)
const showGoodsCategorySale = computed(() =&gt; {
  const labels = goodsCategorySale.value.map((item) =&gt; item.name)
  const values = goodsCategorySale.value.map((item) =&gt; item.goodsSale)
  return { labels, values }
})

// è·å–echartæŸ±çŠ¶å›¾æ•°æ®
const showGoodsCategoryFavor = computed(() =&gt; {
  const labels = goodsCategoryFavor.value.map((item) =&gt; item.name)
  const values = goodsCategoryFavor.value.map((item) =&gt; item.goodsFavor)
  return { labels, values }
})
&lt;/script&gt;

&lt;style lang=&quot;less&quot; scoped&gt;
.el-row {
  margin-bottom: 15px;
}
&lt;/style&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å®ç°-echart-åœ°å›¾æ•°æ®å±•ç¤º" tabindex="-1"><a class="header-anchor" href="#å®ç°-echart-åœ°å›¾æ•°æ®å±•ç¤º" aria-hidden="true">#</a> å®ç° echart åœ°å›¾æ•°æ®å±•ç¤º</h3><h4 id="å¼•å…¥åœ°å›¾ä½ç½®ç»çº¬åº¦-json-æ•°æ®" tabindex="-1"><a class="header-anchor" href="#å¼•å…¥åœ°å›¾ä½ç½®ç»çº¬åº¦-json-æ•°æ®" aria-hidden="true">#</a> å¼•å…¥åœ°å›¾ä½ç½®ç»çº¬åº¦ json æ•°æ®</h4><p><a href="https://datav.aliyun.com/portal/school/atlas/area_selector#&amp;lat=31.769817845138945&amp;lng=104.29901249999999&amp;zoom=4" target="_blank" rel="noopener noreferrer">é˜¿é‡Œäº‘åœ°å›¾ JSON API<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼š<a href="https://geo.datav.aliyun.com/areas_v3/bound/100000_full.json" target="_blank" rel="noopener noreferrer">https://geo.datav.aliyun.com/areas_v3/bound/100000_full.json<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h4 id="å°è£…åæ ‡ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#å°è£…åæ ‡ä¿¡æ¯" aria-hidden="true">#</a> å°è£…åæ ‡ä¿¡æ¯</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// utils/coordinate-data.ts
export const coordinateData: any = {
  ä¸Šæµ·: [121.487899486, 31.24916171],
  ä¸´æ²§: [100.092612914, 23.8878061038],
  ä¸½æ±Ÿ: [100.229628399, 26.8753510895],
  ä¿å±±: [99.1779956133, 25.1204891962],
  å¤§ç†ç™½æ—è‡ªæ²»å·: [100.223674789, 25.5968996394],
  å¾·å®å‚£æ—æ™¯é¢‡æ—è‡ªæ²»å·: [98.5894342874, 24.441239663],
  æ€’æ±Ÿå‚ˆåƒ³æ—è‡ªæ²»å·: [98.8599320425, 25.8606769782],
  æ–‡å±±å£®æ—è‹—æ—è‡ªæ²»å·: [104.246294318, 23.3740868504],
  æ˜†æ˜: [102.714601139, 25.0491531005],
  æ˜­é€š: [103.725020656, 27.3406329636],
  æ™®æ´±: [100.98005773, 22.7887777801],
  æ›²é–: [103.782538888, 25.5207581429],
  æ¥šé›„å½æ—è‡ªæ²»å·: [101.529382239, 25.0663556742],
  ç‰æºª: [102.545067892, 24.3704471344],
  çº¢æ²³å“ˆå°¼æ—å½æ—è‡ªæ²»å·: [103.384064757, 23.3677175165],
  è¥¿åŒç‰ˆçº³å‚£æ—è‡ªæ²»å·: [100.803038275, 22.0094330022],
  è¿ªåº†è—æ—è‡ªæ²»å·: [99.7136815989, 27.8310294612],
  ä¹Œå…°å¯Ÿå¸ƒ: [113.112846391, 41.0223629468],
  ä¹Œæµ·: [106.831999097, 39.6831770068],
  å…´å®‰ç›Ÿ: [122.048166514, 46.0837570652],
  åŒ…å¤´: [109.846238532, 40.6471194257],
  å‘¼ä¼¦è´å°”: [119.760821794, 49.2016360546],
  å‘¼å’Œæµ©ç‰¹: [111.66035052, 40.8283188731],
  å·´å½¦æ·–å°”: [107.42380672, 40.7691799024],
  èµ¤å³°: [118.930761192, 42.2971123203],
  é€šè¾½: [122.260363263, 43.633756073],
  é„‚å°”å¤šæ–¯: [109.993706251, 39.8164895606],
  é”¡æ—éƒ­å‹’ç›Ÿ: [116.027339689, 43.9397048423],
  é˜¿æ‹‰å–„ç›Ÿ: [105.695682871, 38.8430752644],
  åŒ—äº¬: [116.395645038, 39.9299857781],
  å°ä¸­: [119.337634104, 26.0911937119],
  å°åŒ—: [114.130474436, 22.3748329286],
  å°å—: [121.360525873, 38.9658447898],
  å˜‰ä¹‰: [114.246701335, 22.7288657203],
  é«˜é›„: [111.590952812, 21.9464822541],
  å‰æ—: [126.564543989, 43.8719883344],
  å››å¹³: [124.391382074, 43.1755247011],
  å»¶è¾¹æœé²œæ—è‡ªæ²»å·: [129.485901958, 42.8964136037],
  æ¾åŸ: [124.832994532, 45.1360489701],
  ç™½åŸ: [122.840776679, 45.6210862752],
  ç™½å±±: [126.435797675, 41.945859397],
  è¾½æº: [125.133686052, 42.9233026191],
  é€šåŒ–: [125.942650139, 41.7363971299],
  é•¿æ˜¥: [125.313642427, 43.8983376071],
  ä¹å±±: [103.760824239, 29.6009576111],
  å†…æ±Ÿ: [105.073055992, 29.5994615348],
  å‡‰å±±å½æ—è‡ªæ²»å·: [102.259590803, 27.8923929037],
  å—å……: [106.105553984, 30.8009651682],
  å®œå®¾: [104.633019062, 28.7696747963],
  å·´ä¸­: [106.757915842, 31.8691891592],
  å¹¿å…ƒ: [105.81968694, 32.4410401584],
  å¹¿å®‰: [106.635720331, 30.4639838879],
  å¾·é˜³: [104.402397818, 31.1311396527],
  æˆéƒ½: [104.067923463, 30.6799428454],
  æ”€æèŠ±: [101.722423152, 26.5875712571],
  æ³¸å·: [105.443970289, 28.8959298039],
  ç”˜å­œè—æ—è‡ªæ²»å·: [101.969232063, 30.0551441144],
  çœ‰å±±: [103.841429563, 30.0611150799],
  ç»µé˜³: [104.705518975, 31.5047012581],
  è‡ªè´¡: [104.776071339, 29.3591568895],
  èµ„é˜³: [104.635930302, 30.132191434],
  è¾¾å·: [107.494973447, 31.2141988589],
  é‚å®: [105.564887792, 30.5574913504],
  é˜¿åè—æ—ç¾Œæ—è‡ªæ²»å·: [102.228564689, 31.9057628583],
  é›…å®‰: [103.009356466, 29.9997163371],
  å¤©æ´¥: [117.210813092, 39.1439299033],
  ä¸­å«: [105.196754199, 37.5211241916],
  å´å¿ : [106.208254199, 37.9935610029],
  å›ºåŸ: [106.285267996, 36.0215234807],
  çŸ³å˜´å±±: [106.379337202, 39.0202232836],
  é“¶å·: [106.206478608, 38.5026210119],
  äº³å·: [115.787928245, 33.8712105653],
  å…­å®‰: [116.505252683, 31.7555583552],
  åˆè‚¥: [117.282699092, 31.8669422607],
  å®‰åº†: [117.058738772, 30.5378978174],
  å®£åŸ: [118.752096311, 30.9516423543],
  å®¿å·: [116.988692412, 33.6367723858],
  æ± å·: [117.494476772, 30.6600192482],
  æ·®åŒ—: [116.791447429, 33.9600233054],
  æ·®å—: [117.018638863, 32.6428118237],
  æ»å·: [118.324570351, 32.3173505954],
  èŠœæ¹–: [118.384108423, 31.3660197875],
  èšŒåŸ : [117.357079866, 32.9294989067],
  é“œé™µ: [117.819428729, 30.9409296947],
  é˜œé˜³: [115.820932259, 32.9012113306],
  é©¬éå±±: [118.515881847, 31.6885281589],
  é»„å±±: [118.293569632, 29.7344348562],
  ä¸œè¥: [118.583926333, 37.4871211553],
  ä¸´æ²‚: [118.340768237, 35.0724090744],
  å¨æµ·: [122.093958366, 37.5287870813],
  å¾·å·: [116.328161364, 37.4608259263],
  æ—¥ç…§: [119.507179943, 35.4202251931],
  æ£åº„: [117.279305383, 34.8078830784],
  æ³°å®‰: [117.089414917, 36.1880777589],
  æµå—: [117.024967066, 36.6827847272],
  æµå®: [116.600797625, 35.4021216643],
  æ·„åš: [118.059134278, 36.8046848542],
  æ»¨å·: [117.968292415, 37.4053139418],
  æ½åŠ: [119.142633823, 36.7161148731],
  çƒŸå°: [121.30955503, 37.5365615629],
  èŠåŸ: [115.986869139, 36.4558285147],
  è±èŠœ: [117.684666912, 36.2336541336],
  èæ³½: [115.463359775, 35.2624404961],
  é’å²›: [120.384428184, 36.1052149013],
  ä¸´æ±¾: [111.538787596, 36.0997454436],
  å•æ¢: [111.143156602, 37.527316097],
  å¤§åŒ: [113.290508673, 40.1137444997],
  å¤ªåŸ: [112.550863589, 37.890277054],
  å¿»å·: [112.727938829, 38.461030573],
  æ™‹ä¸­: [112.7385144, 37.6933615268],
  æ™‹åŸ: [112.867332758, 35.4998344672],
  æœ”å·: [112.479927727, 39.3376719662],
  è¿åŸ: [111.006853653, 35.0388594798],
  é•¿æ²»: [113.120292086, 36.2016643857],
  é˜³æ³‰: [113.569237602, 37.8695294932],
  ä¸œè: [113.763433991, 23.0430238154],
  ä¸­å±±: [113.422060021, 22.5451775145],
  äº‘æµ®: [112.050945959, 22.9379756855],
  ä½›å±±: [113.134025635, 23.0350948405],
  å¹¿å·: [113.307649675, 23.1200491021],
  æƒ å·: [114.41065808, 23.1135398524],
  æ­é˜³: [116.379500855, 23.5479994669],
  æ¢…å·: [116.126403098, 24.304570606],
  æ±•å¤´: [116.728650288, 23.3839084533],
  æ±•å°¾: [115.372924289, 22.7787305002],
  æ±Ÿé—¨: [113.078125341, 22.5751167835],
  æ²³æº: [114.713721476, 23.7572508505],
  æ·±åœ³: [114.025973657, 22.5460535462],
  æ¸…è¿œ: [113.040773349, 23.6984685504],
  æ¹›æ±Ÿ: [110.365067263, 21.2574631038],
  æ½®å·: [116.630075991, 23.6618116765],
  ç æµ·: [113.562447026, 22.2569146461],
  è‚‡åº†: [112.47965337, 23.0786632829],
  èŒ‚å: [110.931245331, 21.6682257188],
  é˜³æ±Ÿ: [111.977009756, 21.8715173045],
  éŸ¶å…³: [113.594461107, 24.8029603119],
  åŒ—æµ·: [109.122627919, 21.472718235],
  å—å®: [108.297233556, 22.8064929356],
  å´‡å·¦: [107.357322038, 22.4154552965],
  æ¥å®¾: [109.231816505, 23.7411659265],
  æŸ³å·: [109.42240181, 24.3290533525],
  æ¡‚æ—: [110.260920147, 25.262901246],
  æ¢§å·: [111.30547195, 23.4853946367],
  æ²³æ± : [108.069947709, 24.6995207829],
  ç‰æ—: [110.151676316, 22.6439736084],
  ç™¾è‰²: [106.631821404, 23.9015123679],
  è´µæ¸¯: [109.613707557, 23.1033731644],
  è´ºå·: [111.552594179, 24.4110535471],
  é’¦å·: [108.638798056, 21.9733504653],
  é˜²åŸæ¸¯: [108.351791153, 21.6173984705],
  ä¹Œé²æœ¨é½: [87.5649877411, 43.8403803472],
  ä¼ŠçŠå“ˆè¨å…‹è‡ªæ²»å·: [81.2978535304, 43.9222480963],
  å…‹å­œå‹’è‹æŸ¯å°”å…‹å­œè‡ªæ²»å·: [76.1375644775, 39.7503455778],
  å…‹æ‹‰ç›ä¾: [84.8811801861, 45.5943310667],
  åšå°”å¡”æ‹‰è’™å¤è‡ªæ²»å·: [82.0524362672, 44.9136513743],
  åé²ç•ªåœ°åŒº: [89.1815948657, 42.9604700169],
  å’Œç”°åœ°åŒº: [79.9302386372, 37.1167744927],
  å“ˆå¯†åœ°åŒº: [93.5283550928, 42.8585963324],
  å–€ä»€åœ°åŒº: [75.9929732675, 39.4706271887],
  å¡”åŸåœ°åŒº: [82.9748805837, 46.7586836297],
  æ˜Œå‰å›æ—è‡ªæ²»å·: [87.2960381257, 44.0070578985],
  è‡ªæ²»åŒºç›´è¾–: [85.6148993383, 42.1270009576],
  é˜¿å…‹è‹åœ°åŒº: [80.2698461793, 41.1717309015],
  é˜¿å‹’æ³°åœ°åŒº: [88.1379154871, 47.8397444862],
  å—äº¬: [118.778074408, 32.0572355018],
  å—é€š: [120.873800951, 32.0146645408],
  å®¿è¿: [118.296893379, 33.9520497337],
  å¸¸å·: [119.981861013, 31.7713967447],
  å¾å·: [117.188106623, 34.2715534311],
  æ‰¬å·: [119.427777551, 32.4085052546],
  æ— é”¡: [120.305455901, 31.5700374519],
  æ³°å·: [119.919606016, 32.4760532748],
  æ·®å®‰: [119.030186365, 33.6065127393],
  ç›åŸ: [120.148871818, 33.3798618771],
  è‹å·: [120.619907115, 31.317987368],
  è¿äº‘æ¸¯: [119.173872217, 34.601548967],
  é•‡æ±Ÿ: [119.455835405, 32.2044094436],
  ä¸Šé¥¶: [117.955463877, 28.4576225539],
  ä¹æ±Ÿ: [115.999848022, 29.7196395261],
  å—æ˜Œ: [115.893527546, 28.6895780001],
  å‰å®‰: [114.992038711, 27.1138476502],
  å®œæ˜¥: [114.400038672, 27.8111298958],
  æŠšå·: [116.360918867, 27.9545451703],
  æ–°ä½™: [114.947117417, 27.8223215586],
  æ™¯å¾·é•‡: [117.186522625, 29.3035627684],
  èä¹¡: [113.859917033, 27.639544223],
  èµ£å·: [114.935909079, 25.8452955363],
  é¹°æ½­: [117.035450186, 28.2413095972],
  ä¿å®š: [115.494810169, 38.886564548],
  å”å±±: [118.183450598, 39.6505309225],
  å»ŠåŠ: [116.703602223, 39.5186106251],
  å¼ å®¶å£: [114.89378153, 40.8111884911],
  æ‰¿å¾·: [117.933822456, 40.9925210525],
  æ²§å·: [116.863806476, 38.2976153503],
  çŸ³å®¶åº„: [114.522081844, 38.0489583146],
  ç§¦çš‡å²›: [119.604367616, 39.9454615659],
  è¡¡æ°´: [115.686228653, 37.7469290459],
  é‚¢å°: [114.520486813, 37.0695311969],
  é‚¯éƒ¸: [114.482693932, 36.6093079285],
  ä¸‰é—¨å³¡: [111.181262093, 34.7833199411],
  ä¿¡é˜³: [114.085490993, 32.1285823075],
  å—é˜³: [112.542841901, 33.0114195691],
  å‘¨å£: [114.654101942, 33.6237408181],
  å•†ä¸˜: [115.641885688, 34.4385886402],
  å®‰é˜³: [114.351806508, 36.1102667222],
  å¹³é¡¶å±±: [113.300848978, 33.7453014565],
  å¼€å°: [114.351642118, 34.8018541758],
  æ–°ä¹¡: [113.912690161, 35.3072575577],
  æ´›é˜³: [112.447524769, 34.6573678177],
  æ¼¯æ²³: [114.0460614, 33.5762786885],
  æ¿®é˜³: [115.026627441, 35.7532978882],
  ç„¦ä½œ: [113.211835885, 35.234607555],
  è®¸æ˜Œ: [113.83531246, 34.0267395887],
  éƒ‘å·: [113.64964385, 34.7566100641],
  é©»é©¬åº—: [114.049153547, 32.9831581541],
  é¹¤å£: [114.297769838, 35.7554258742],
  ä¸½æ°´: [119.929575843, 28.4562995521],
  å°å·: [121.440612936, 28.6682832857],
  å˜‰å…´: [120.760427699, 30.7739922396],
  å®æ³¢: [121.579005973, 29.8852589659],
  æ­å·: [120.219375416, 30.2592444615],
  æ¸©å·: [120.690634734, 28.002837594],
  æ¹–å·: [120.137243163, 30.8779251557],
  ç»å…´: [120.592467386, 30.0023645805],
  èˆŸå±±: [122.169872098, 30.0360103026],
  è¡¢å·: [118.875841652, 28.9569104475],
  é‡‘å: [119.652575704, 29.1028991054],
  ä¸‰äºš: [109.522771281, 18.2577759149],
  ä¸‰æ²™: [112.350383075, 16.840062894],
  æµ·å£: [110.330801848, 20.022071277],
  åå °: [110.801228917, 32.6369943395],
  å’¸å®: [114.300060592, 29.8806567577],
  å­æ„Ÿ: [113.935734392, 30.9279547842],
  å®œæ˜Œ: [111.310981092, 30.732757818],
  æ©æ–½åœŸå®¶æ—è‹—æ—è‡ªæ²»å·: [109.491923304, 30.2858883166],
  æ­¦æ±‰: [114.316200103, 30.5810841269],
  çœç›´è¾–: [112.410562192, 31.2093162501],
  è†å·: [112.241865807, 30.332590523],
  è†é—¨: [112.217330299, 31.0426112029],
  è¥„é˜³: [112.250092848, 32.2291685915],
  é„‚å·: [114.895594041, 30.3844393228],
  éšå·: [113.379358364, 31.7178576082],
  é»„å†ˆ: [114.906618047, 30.4461089379],
  é»„çŸ³: [115.050683164, 30.2161271277],
  å¨„åº•: [111.996396357, 27.7410733023],
  å²³é˜³: [113.146195519, 29.3780070755],
  å¸¸å¾·: [111.653718137, 29.0121488552],
  å¼ å®¶ç•Œ: [110.481620157, 29.1248893532],
  æ€€åŒ–: [109.986958796, 27.5574829012],
  æ ªæ´²: [113.131695341, 27.8274329277],
  æ°¸å·: [111.614647686, 26.4359716468],
  æ¹˜æ½­: [112.935555633, 27.835095053],
  æ¹˜è¥¿åœŸå®¶æ—è‹—æ—è‡ªæ²»å·: [109.7457458, 28.3179507937],
  ç›Šé˜³: [112.366546645, 28.5880877799],
  è¡¡é˜³: [112.583818811, 26.8981644154],
  é‚µé˜³: [111.461525404, 27.2368112449],
  éƒ´å·: [113.037704468, 25.7822639757],
  é•¿æ²™: [112.979352788, 28.2134782309],
  æ— å ‚åŒºåˆ’åˆ†åŒºåŸŸ: [113.557519102, 22.2041179884],
  æ¾³é—¨åŠå²›: [113.566432335, 22.1950041592],
  æ¾³é—¨ç¦»å²›: [113.557519102, 22.2041179884],
  ä¸´å¤å›æ—è‡ªæ²»å·: [103.215249178, 35.5985143488],
  å…°å·: [103.823305441, 36.064225525],
  å˜‰å³ªå…³: [98.2816345853, 39.8023973267],
  å¤©æ°´: [105.736931623, 34.5843194189],
  å®šè¥¿: [104.626637601, 35.5860562418],
  å¹³å‡‰: [106.688911157, 35.55011019],
  åº†é˜³: [107.644227087, 35.7268007545],
  å¼ æ–: [100.459891869, 38.939320297],
  æ­¦å¨: [102.640147343, 37.9331721429],
  ç”˜å—è—æ—è‡ªæ²»å·: [102.917442486, 34.9922111784],
  ç™½é“¶: [104.171240904, 36.5466817062],
  é…’æ³‰: [98.5084145062, 39.7414737682],
  é‡‘æ˜Œ: [102.208126263, 38.5160717995],
  é™‡å—: [104.934573406, 33.3944799729],
  ä¸‰æ˜: [117.642193934, 26.2708352794],
  å—å¹³: [118.181882949, 26.6436264742],
  å¦é—¨: [118.103886046, 24.4892306125],
  å®å¾·: [119.54208215, 26.6565274192],
  æ³‰å·: [118.600362343, 24.901652384],
  æ¼³å·: [117.676204679, 24.5170647798],
  ç¦å·: [119.330221107, 26.0471254966],
  è†ç”°: [119.077730964, 25.4484501367],
  é¾™å²©: [117.017996739, 25.0786854335],
  å±±å—åœ°åŒº: [91.7506438744, 29.2290269317],
  æ‹‰è¨: [91.111890896, 29.6625570621],
  æ—¥å–€åˆ™åœ°åŒº: [88.8914855677, 29.2690232039],
  æ˜Œéƒ½åœ°åŒº: [97.18558158, 31.1405756319],
  æ—èŠåœ°åŒº: [94.3499854582, 29.6669406258],
  é‚£æ›²åœ°åŒº: [92.0670183689, 31.4806798301],
  é˜¿é‡Œåœ°åŒº: [81.1076686895, 30.4045565883],
  å…­ç›˜æ°´: [104.85208676, 26.5918660603],
  å®‰é¡º: [105.928269966, 26.2285945777],
  æ¯•èŠ‚: [105.333323371, 27.4085621313],
  è´µé˜³: [106.709177096, 26.6299067414],
  éµä¹‰: [106.931260316, 27.6999613771],
  é“œä»: [109.168558028, 27.6749026906],
  é»”ä¸œå—è‹—æ—ä¾—æ—è‡ªæ²»å·: [107.985352573, 26.5839917665],
  é»”å—å¸ƒä¾æ—è‹—æ—è‡ªæ²»å·: [107.52320511, 26.2645359974],
  é»”è¥¿å—å¸ƒä¾æ—è‹—æ—è‡ªæ²»å·: [104.900557798, 25.0951480559],
  ä¸¹ä¸œ: [124.338543115, 40.1290228266],
  å¤§è¿: [121.593477781, 38.9487099383],
  æŠšé¡º: [123.929819767, 41.8773038296],
  æœé˜³: [120.446162703, 41.5718276679],
  æœ¬æºª: [123.77806237, 41.3258376266],
  æ²ˆé˜³: [123.432790922, 41.8086447835],
  ç›˜é”¦: [122.07322781, 41.141248023],
  è¥å£: [122.233391371, 40.6686510665],
  è‘«èŠ¦å²›: [120.860757645, 40.7430298813],
  è¾½é˜³: [123.172451205, 41.2733392656],
  é“å²­: [123.854849615, 42.2997570121],
  é”¦å·: [121.147748738, 41.1308788759],
  é˜œæ–°: [121.660822129, 42.0192501071],
  éå±±: [123.007763329, 41.1187436822],
  é‡åº†: [106.530635013, 29.5446061089],
  å’¸é˜³: [108.707509278, 34.345372996],
  å•†æ´›: [109.934208154, 33.8739073951],
  å®‰åº·: [109.038044563, 32.70437045],
  å®é¸¡: [107.170645452, 34.3640808097],
  å»¶å®‰: [109.500509757, 36.6033203523],
  æ¦†æ—: [109.745925744, 38.2794392401],
  æ±‰ä¸­: [107.045477629, 33.0815689782],
  æ¸­å—: [109.483932697, 34.5023579758],
  è¥¿å®‰: [108.953098279, 34.2777998978],
  é“œå·: [108.968067013, 34.9083676964],
  æœæ´›è—æ—è‡ªæ²»å·: [100.223722769, 34.4804845846],
  æµ·ä¸œåœ°åŒº: [102.085206987, 36.5176101677],
  æµ·åŒ—è—æ—è‡ªæ²»å·: [100.879802174, 36.9606541011],
  æµ·å—è—æ—è‡ªæ²»å·: [100.624066094, 36.2843638038],
  æµ·è¥¿è’™å¤æ—è—æ—è‡ªæ²»å·: [97.3426254153, 37.3737990706],
  ç‰æ ‘è—æ—è‡ªæ²»å·: [97.0133161374, 33.0062399097],
  è¥¿å®: [101.76792099, 36.640738612],
  é»„å—è—æ—è‡ªæ²»å·: [102.007600308, 35.5228515517],
  ä¹é¾™: [114.173291988, 22.3072458588],
  æ–°ç•Œ: [114.146701965, 22.4274312754],
  é¦™æ¸¯å²›: [114.183870524, 22.2721034276],
  ä¸ƒå°æ²³: [131.019048047, 45.7750053686],
  ä¼Šæ˜¥: [128.910765978, 47.7346850751],
  ä½³æœ¨æ–¯: [130.284734586, 46.8137796047],
  åŒé¸­å±±: [131.17140174, 46.6551020625],
  å“ˆå°”æ»¨: [126.657716855, 45.7732246332],
  å¤§å…´å®‰å²­åœ°åŒº: [124.19610419, 51.991788968],
  å¤§åº†: [125.02183973, 46.59670902],
  ç‰¡ä¸¹æ±Ÿ: [129.608035396, 44.5885211528],
  ç»¥åŒ–: [126.989094572, 46.646063927],
  é¸¡è¥¿: [130.941767273, 45.3215398866],
  é¹¤å²—: [130.292472051, 47.3386659037],
  é»‘æ²³: [127.500830295, 50.2506900907],
  é½é½å“ˆå°”: [123.987288942, 47.3476998134]
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å°è£…è½¬åŒ–åæ ‡ä¿¡æ¯å±æ€§ä¸º-echart-åœ°å›¾æ‰€éœ€å±æ€§å·¥å…·" tabindex="-1"><a class="header-anchor" href="#å°è£…è½¬åŒ–åæ ‡ä¿¡æ¯å±æ€§ä¸º-echart-åœ°å›¾æ‰€éœ€å±æ€§å·¥å…·" aria-hidden="true">#</a> å°è£…è½¬åŒ–åæ ‡ä¿¡æ¯å±æ€§ä¸º echart åœ°å›¾æ‰€éœ€å±æ€§å·¥å…·</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// utils/convert-data.ts
import { coordinateData } from &quot;./coordinate-data&quot;

export function convertData(data: any) {
    const res = []
    for(let i = 0; i &lt; data.length; i++) {
        const geoCoord = coordinateData[data[i].name]
        if(geoCoord) {
            res.push({
                name: data[i].name,
                value: geoCoord.concat(data[i].value)
            })
        }
    }
    return res
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="echart-æ³¨å†Œåœ°å›¾" tabindex="-1"><a class="header-anchor" href="#echart-æ³¨å†Œåœ°å›¾" aria-hidden="true">#</a> echart æ³¨å†Œåœ°å›¾</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// base-echart.vue
&lt;template&gt;
  &lt;div class=&quot;base-echart&quot;&gt;
    &lt;div class=&quot;echart&quot; ref=&quot;echartRef&quot;&gt;&lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import * as echarts from &#39;echarts&#39;
import { onMounted, ref, watchEffect } from &#39;vue&#39;
// è·å–echartçš„optionç±»å‹
import type { EChartsOption } from &#39;echarts&#39;
import ChinaJSON from &#39;../data/china.json&#39;

// echartæ³¨å†Œåœ°å›¾
echarts.registerMap(&#39;china&#39;, ChinaJSON as any)

// æ¥æ”¶æ¯ä¸ªechartä¸åŒé…ç½®
interface IProps {
    option: EChartsOption
}
const props = defineProps&lt;IProps&gt;()

// 1. å¼•ç”¨domå®ä¾‹
const echartRef = ref&lt;HTMLElement&gt;()
onMounted(() =&gt; {
  // 2. åŸºäºå‡†å¤‡å¥½çš„domï¼Œåˆå§‹åŒ–echartå®ä¾‹
  const echartInstance = echarts.init(echartRef.value!, &quot;light&quot;, {
    renderer: &#39;canvas&#39;
  })

  // 3.ç¬¬ä¸€æ¬¡options(é…ç½®),åŠ¨æ€ä¼ å…¥æ¯ä¸ªå›¾çš„option
  // watchEffectç›‘å¬optionå˜åŒ–ï¼Œé‡æ–°æ‰§è¡Œ
  watchEffect(() =&gt; echartInstance.setOption(props.option))

  // 4.ç›‘å¬windowç¼©æ”¾å®ç°echartå“åº”å¼å¸ƒå±€
  window.addEventListener(&#39;resize&#39;, () =&gt; {
    echartInstance.resize()
  })
})
&lt;/script&gt;

&lt;style lang=&quot;less&quot; scoped&gt;
.echart {
  height: 250px;
}
&lt;/style&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç¼–å†™-echart-åœ°å›¾ç»„ä»¶" tabindex="-1"><a class="header-anchor" href="#ç¼–å†™-echart-åœ°å›¾ç»„ä»¶" aria-hidden="true">#</a> ç¼–å†™ echart åœ°å›¾ç»„ä»¶</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// map-echart.vue
&lt;template&gt;
  &lt;div class=&quot;map-echart&quot;&gt;
    &lt;base-echart :option=&quot;option&quot; /&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import { computed } from &#39;vue&#39;
import BaseEchart from &#39;./base-echart.vue&#39;
import type { EChartsOption } from &#39;echarts&#39;
import type { IEchartValueType } from &#39;../types&#39;
import { convertData } from &#39;../utils/convert-data&#39;

const props = defineProps&lt;{
    mapData: IEchartValueType[]
}&gt;()

// åªè´Ÿè´£ä¼ å…¥é¥¼å›¾çš„option
const option = computed&lt;EChartsOption&gt;(() =&gt; {
  return {
    width: &#39;270px&#39;,
    height: &#39;250px&#39;,
    center: [100, 32],
    backgroundColor: &#39;#fff&#39;,
    title: {
        text: &#39;å…¨å›½é”€é‡ç»Ÿè®¡&#39;,
        left: &#39;center&#39;,
        textStyle: {
            color: &#39;#fff&#39;
        }
    },
    tooltip: {
        trigger: &#39;item&#39;,
        formatter: function(params: any) {
            return params.name + &#39; : &#39; + params.value[2]
        }
    },
    visualMap: {
        min: 0,
        max: 60000,
        left: 20,
        bottom: 20,
        calculable: true,
        text: [&#39;é«˜&#39;, &#39;ä½&#39;],
        inRange: {
            color: [&#39;rgb(70, 240, 252)&#39;, &#39;rgb(250, 220, 46)&#39;, &#39;rgb(245, 38, 186)&#39;]
        },
        textStyle: {
            color: &#39;#fff&#39;
        }
    },
    geo: {
        // è®¾ç½®ä½¿ç”¨çš„åœ°å›¾(æ³¨å†Œè¿‡çš„chinaåœ°å€)
        map: &#39;china&#39;,
        // æ”¯æŒé¼ æ ‡ç¼©æ”¾æ•ˆæœ
        // roam: &#39;scale&#39;,
        emphasis: {
            areaColor: &#39;#f4cccc&#39;,
            borderColor: &#39;rgb(9, 54, 95)&#39;,
            itemStyle: {
                areaColor: &#39;#f4cccc&#39;
            }
        }
    },
    series: [
        {
            name: &#39;é”€é‡&#39;,
            // æ•£ç‚¹å›¾åœ¨åœ°å›¾ä¸Šå±•ç¤ºæ•°æ®
            type: &#39;scatter&#39;,
            coordinateSystem: &#39;geo&#39;,
            data: convertData(props.mapData),
            // æ•£ç‚¹çš„å¤§å°ï¼ˆå¯ä»¥æ ¹æ®æ•°æ®ä¸åŒæ˜¾ç¤ºä¸åŒçš„å¤§å°ï¼Œè®¾ç½®ä¸ºä¸€ä¸ªå‡½æ•°ï¼‰
            symbolSize: 11,
            emphasis: {
                itemStyle: {
                    borderCap: &#39;#fff&#39;,
                    borderWidth: 1
                }
            }
        },
        {
            // ä¼šè‡ªåŠ¨ç”Ÿæˆgeoåœ°ç†åæ ‡ç³»ç»Ÿ
            type: &#39;map&#39;,
            // è®¾ç½®ä½¿ç”¨çš„åœ°å›¾åç§°ï¼Œå¤ç”¨çš„æ˜¯ç¬¬0ä¸ªåæ ‡ç³»ç»Ÿ
            map: &#39;china&#39;
        }
    ]
  }
})
&lt;/script&gt;

&lt;style lang=&quot;less&quot; scoped&gt;&lt;/style&gt;


</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å°è£…åœ°å›¾å•†å“é”€é‡è¯·æ±‚æ•°æ®" tabindex="-1"><a class="header-anchor" href="#å°è£…åœ°å›¾å•†å“é”€é‡è¯·æ±‚æ•°æ®" aria-hidden="true">#</a> å°è£…åœ°å›¾å•†å“é”€é‡è¯·æ±‚æ•°æ®</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// service/analysis.ts
// è·å–åœ°å›¾æ•°æ®
export function getGoodsAddressSale() {
    return hyRequest.get({
        url: &#39;/goods/address/sale&#39;
    })
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>import { getAmountListData, getGoodsAddressSale, getGoodsCategoryCount, getGoodsCategoryFavor, getGoodsCategorySale } from &quot;@/service/main/analysis/analysis&quot;;
import { defineStore } from &quot;pinia&quot;;

interface IAnalysisState {
    // ...
    goodsAddressSale: any[]
}
const useAnalysisStore = defineStore(&#39;analysis&#39;, {
    state: (): IAnalysisState =&gt; ({
        // ....
        goodsAddressSale: []
    }),
    actions: {
        async fetchAnalysisDataAction() {
            // é¡¶éƒ¨å¡ç‰‡æ•°æ®...
            // è·å–é¥¼å›¾ã€ç«ç‘°å›¾æ•°æ®...
            // è·å–æŠ˜çº¿å›¾æ•°æ®...
            // è·å–æŸ±çŠ¶å›¾æ•°æ®...

            // è·å–åœ°å›¾æ•°æ®
            const goodsAddressSaleResult = await getGoodsAddressSale()
            this.goodsAddressSale = goodsAddressSaleResult.data
            console.log(this.goodsAddressSale);
        },
    }
})

export default useAnalysisStore
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="çˆ¶ç»„ä»¶ä¼ é€’æ•°æ®ç»™åœ°å›¾ç»„ä»¶" tabindex="-1"><a class="header-anchor" href="#çˆ¶ç»„ä»¶ä¼ é€’æ•°æ®ç»™åœ°å›¾ç»„ä»¶" aria-hidden="true">#</a> çˆ¶ç»„ä»¶ä¼ é€’æ•°æ®ç»™åœ°å›¾ç»„ä»¶</h4><div class="language-JavaScript ext-JavaScript line-numbers-mode"><pre class="language-JavaScript"><code>// dashboard.vue
&lt;template&gt;
  &lt;div class=&quot;dashboard&quot;&gt;
    &lt;!--é¡¶éƒ¨å¡ç‰‡ç»„ä»¶ --&gt;
    // ...
    &lt;el-row :gutter=&quot;10&quot;&gt;
      &lt;el-col :span=&quot;10&quot;&gt;
        &lt;chart-card&gt;
          &lt;map-echart :map-data=&quot;showGoodsAddressSale&quot;/&gt;
        &lt;/chart-card&gt;
      &lt;/el-col&gt;
    &lt;/el-row&gt;
    // ....
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import useAnalysisStore from &#39;@/store/main/analysis/analysis&#39;
// ...

// å‘èµ·actionså°è£…çš„ç½‘ç»œè¯·æ±‚
const analysisStore = useAnalysisStore()
analysisStore.fetchAnalysisDataAction()

// è·å–æ•°æ®
const { amountList, goodsCategoryCount, goodsCategorySale, goodsCategoryFavor, goodsAddressSale } = storeToRefs(analysisStore)

// è·å–echarté¥¼å›¾æ•°æ®...
// è·å–echartæŠ˜çº¿å›¾æ•°æ®...
// è·å–echartæŸ±çŠ¶å›¾æ•°æ®...

// è·å–echartåœ°å›¾æ•°æ®
const showGoodsAddressSale = computed(() =&gt; {
  return goodsAddressSale.value.map((item) =&gt; ({
    name: item.address,
    value: item.count
  }))
})
&lt;/script&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/xumingyu2018/xumingyu2018.github.io/edit/main/vuepress-blog/projects/vue/cms.md" rel="noopener noreferrer" target="_blank" aria-label="ç¼–è¾‘æ­¤é¡µ" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->ç¼–è¾‘æ­¤é¡µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><span class="info">2023/8/22 15:12:26</span></div><div class="meta-item contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: xmy981022@163.com">Nevermore</span><!--]--><!--]--></div></footer><!----><div class="giscus-wrapper input-top" style="display:block;"><div style="text-align:center">Loading...</div></div><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">MIT Licensed | Copyright Â© 2022-present Nevermoreæ¯“</div><div class="copyright">Copyright Â© 2023 Nevermoreæ¯“</div></footer><!--]--></div><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app.8c0e81d7.js" defer></script>
  </body>
</html>
